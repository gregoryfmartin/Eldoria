using namespace System
using namespace System.Collections
using namespace System.Collections.Generic
using namespace System.Management.Automation.Host
using namespace System.Management.Automation.Runspaces
using namespace System.Media

Add-Type -AssemblyName PresentationCore

Set-StrictMode -Version Latest





###############################################################################
#
# ENUMERATION DEFINITIONS
#
###############################################################################
Enum GameStatePrimary {
    SplashScreenA
    SplashScreenB
    TitleScreen
    PlayerSetupScreen
    GamePlayScreen
    InventoryScreen
    BattleScreen
    PlayerStatusScreen
    Cleanup
}

Enum StatNumberState {
    Normal
    Caution
    Danger
}

Enum ItemRemovalStatus {
    Success
    FailGeneral
    FailKeyItem
}

Enum ActionInvRemovalStatus {
    Success
    Fail
}

Enum BattleActionType {
    Physical
    ElementalFire
    ElementalWater
    ElementalEarth
    ElementalWind
    ElementalLight
    ElementalDark
    ElementalIce
    MagicPoison
    MagicConfuse
    MagicSleep
    MagicAging
    MagicHealing
    MagicStatAugment
    None
}

Enum StatId {
    HitPoints
    MagicPoints
    Attack
    Defense
    MagicAttack
    MagicDefense
    Speed
    Luck
    Accuracy
}

Enum ActionSlot {
    A
    B
    C
    D
    None
}

Enum BattleManagerState {
    HealthCheck
    TurnIncrement
    PhaseOrdering
    PhaseAExecution
    PhaseBExecution
    Calculation
    BattleWon
    BattleLost
}

Enum BattleActionResultType {
    Success
    SuccessWithCritical
    SuccessWithAffinityBonus
    SuccessWithCritAndAffinityBonus
    FailedAttackMissed
    FailedAttackFailed
    FailedElementalMatch
    FailedNoUsesRemaining
    FailedNotEnoughMp
}

Enum StatusScreenMode {
    EquippedTechSelection
    TechInventorySelection
}

Enum FnlNoiseType {
    OpenSimplex2
    OpenSimplex2S
    Cellular
    Perlin
    ValueCubic
    Value
}

Enum FnlRotationType3D {
    None
    ImproveXYPlanes
    ImproveXZPlanes
}

Enum FnlFractalType {
    None
    FBm
    Ridged
    PingPong
    DomainWarpProgressive
    DomainWarpIndependent
}

Enum FnlCellularDistanceFunction {
    Euclidean
    EuclideanSq
    Manhattan
    Hybrid
}

Enum FnlCellularReturnType {
    CellValue
    Distance
    Distance2
    Distance2Add
    Distance2Sub
    Distance2Mul
    Distance2Div
}

Enum FnlDomainWarpType {
    OpenSimplex2
    OpenSimplex2Reduced
    BasicGrid
}

Enum FnlTransformType3D {
    None
    ImproveXYPlanes
    ImproveXZPlanes
    DefaultOpenSimplex2
}

Enum WindowBorderPart {
    LeftTop
    Top
    RightTop
    Right
    RightBottom
    Bottom
    LeftBottom
    Left
}

Enum WindowBorderPartDirty {
    Top
    Bottom
    Left
    Right
}

Enum UIELayout {
    Horizontal
    Vertical
}

Enum TtySpeed {
    SuperSlow = 1000000
    Slow   = 750000
    Normal = 100000
    Moderate = 75000
    Quick = 65000
    Fast = 50000
    SuperFast = 25000
}





###############################################################################
#
# GLOBAL VARIABLE DECLARATIONS
#
###############################################################################
$PSStyle.Progress.View = 'Classic'
Write-Progress -Activity 'Setting up Globals' -Id 1 -PercentComplete -1
[Int]                             $Script:SceneImagesToLoad            = $(Get-ChildItem "$(Get-Location)\Image Data").Count
[Int]                             $Script:SceneImagesLoaded            = 0
[Int]                             $Script:MaxWidth                     = 80
[Int]                             $Script:SSAPECounter                 = 0
[Int]                             $Script:SSAPETimeout                 = 1000
[String]                          $Script:SfxUiChevronMove             = "$(Get-Location)\Assets\SFX\UI Chevron Move.wav"
[String]                          $Script:SfxUiSelectionValid          = "$(Get-Location)\Assets\SFX\UI Selection Valid.wav"
[String]                          $Script:SfxBaPhysicalStrikeA         = "$(Get-Location)\Assets\SFX\BA Physical Strike 0001.wav"
[String]                          $Script:SfxBaMissFail                = "$(Get-Location)\Assets\SFX\BA Miss Fail.wav"
[String]                          $Script:SfxBaActionDisabled          = "$(Get-Location)\Assets\SFX\BA Action Disabled.wav"
[String]                          $Script:SfxBaFireStrikeA             = "$(Get-Location)\Assets\SFX\BA Fire Strike 0001.wav"
[String]                          $Script:SfxBattleIntro               = "$(Get-Location)\Assets\SFX\Battle Intro.wav"
[String]                          $Script:SfxBattlePlayerWin           = "$(Get-Location)\Assets\SFX\Battle Player Win.wav"
[String]                          $Script:SfxBattlePlayerLose          = "$(Get-Location)\Assets\SFX\Battle Player Lose.wav"
[String]                          $Script:BgmBattleThemeA              = "$(Get-Location)\Assets\BGM\Battle Theme A.wav"
[String]                          $Script:SfxBattleNem                 = "$(Get-Location)\Assets\SFX\UI Selection NEM.wav"
[String]                          $Script:BgmTitleThemeA               = "$(Get-Location)\Assets\BGM\Title Theme A.wav"
[String]                          $Script:BgmTitleThemeB               = "$(Get-Location)\Assets\BGM\Title Theme B.wav"
[String]                          $Script:TheGameSubtitle              = 'A NOT GARY GAME'
[Hashtable]                       $Script:SpectreBBPRounded            = @{}
[Hashtable]                       $Script:SpectreBBPSquare             = @{}
[Hashtable]                       $Script:CurrentWindowDesign          = @{}
[String[]]                        $Script:BadCommandRetorts            = @()
[StatusWindow]                    $Script:TheStatusWindow              = [StatusWindow]::new()
[CommandWindow]                   $Script:TheCommandWindow             = [CommandWindow]::new()
[SceneWindow]                     $Script:TheSceneWindow               = [SceneWindow]::new()
[MessageWindow]                   $Script:TheMessageWindow             = [MessageWindow]::new()
[InventoryWindow]                 $Script:TheInventoryWindow           = $null
[ATCoordinatesDefault]            $Script:DefaultCursorCoordinates     = [ATCoordinatesDefault]::new()
[BattleEntityStatusWindow]        $Script:ThePlayerBattleStatWindow    = $null
[BattleEntityStatusWindow]        $Script:TheEnemyBattleStatWindow     = $null
[BattlePlayerActionWindow]        $Script:ThePlayerBattleActionWindow  = $null
[BattleStatusMessageWindow]       $Script:TheBattleStatusMessageWindow = $null
[BattleEnemyImageWindow]          $Script:TheBattleEnemyImageWindow    = $null
[BattlePhaseIndicator]            $Script:TheBattlePhaseIndicator      = $null
[StatusHudWindow]                 $Script:TheStatusHudWindow           = $null
[StatusTechniqueSelectionWindow]  $Script:TheStatusTechSelectionWindow = $null
[StatusTechniqueInventoryWindow]  $Script:TheStatusTechInventoryWindow = $null
[BufferManager]                   $Script:TheBufferManager             = [BufferManager]::new()
[GameCore]                        $Script:TheGameCore                  = [GameCore]::new()
[EnemyBattleEntity]               $Script:TheCurrentEnemy              = $null
[BattleManager]                   $Script:TheBattleManager             = $null
[SoundPlayer]                     $Script:TheSfxMachine                = [SoundPlayer]::new()
[SoundPlayer]                     $Script:TheBgmMachine                = [SoundPlayer]::new()
[Boolean]                         $Script:IsBattleBgmPlaying           = $false
[Boolean]                         $Script:HasBattleIntroPlayed         = $false
[Boolean]                         $Script:HasBattleWonChimePlayed      = $false
[Boolean]                         $Script:HasBattleLostChimePlayed     = $false
[Boolean]                         $Script:GpsRestoredFromInvBackup     = $true
[Boolean]                         $Script:GpsRestoredFromBatBackup     = $false
[Boolean]                         $Script:GpsRestoredFromStaBackup     = $false
[Boolean]                         $Script:BattleCursorVisible          = $false
[Boolean]                         $Script:HasTitleBgmStarted           = $false
[Boolean]                         $Script:HasSubtitleBeenWritten       = $false
[Boolean]                         $Script:HasSubtitleBeenColored       = $false
[Boolean]                         $Script:HasSSAPressEnterShown        = $false
[Boolean]                         $Script:HasSSAPressEnterToggled      = $false
[Boolean]                         $Script:HasSSASetupRunspace          = $false
[EEIBat]                          $Script:EeiBat                       = [EEIBat]::new()
[EEINightwing]                    $Script:EeiNightwing                 = [EEINightwing]::new()
[EEIWingblight]                   $Script:EeiWingblight                = [EEIWingblight]::new()
[EEIDarkfang]                     $Script:EeiDarkfang                  = [EEIDarkfang]::new()
[EEINocturna]                     $Script:EeiNocturna                  = [EEINocturna]::new()
[EEIBloodswoop]                   $Script:EeiBloodswoop                = [EEIBloodswoop]::new()
[EEIDuskbane]                     $Script:EeiDuskbane                  = [EEIDuskbane]::new()
[System.Windows.Media.MediaPlayer]$Script:TheSfxMPlayer                = [System.Windows.Media.MediaPlayer]::new()
[System.Windows.Media.MediaPlayer]$Script:TheBgmMPlayer                = [System.Windows.Media.MediaPlayer]::new()
[Double]                          $Script:AffinityMultNeg              = -0.75
[Double]                          $Script:AffinityMultPos              = 1.6
[ActionSlot]                      $Script:StatusEsSelectedSlot         = [ActionSlot]::None
[BattleAction]                    $Script:StatusIsSelected             = $null
[StatusScreenMode]                $Script:StatusScreenMode             = [StatusScreenMode]::EquippedTechSelection
[GameStatePrimary]                $Script:TheGlobalGameState           = [GameStatePrimary]::TitleScreen
[GameStatePrimary]                $Script:ThePreviousGlobalGameState   = $Script:TheGlobalGameState
[Map]                             $Script:SampleMap                    = $null
[Map]                             $Script:SampleWarpMap01              = $null
[Map]                             $Script:SampleWarpMap02              = $null
[Map]                             $Script:CurrentMap                   = $null
[Map]                             $Script:PreviousMap                  = $null
[SSAFiglet]                       $Script:TheTitleFiglet               = [SSAFiglet]::new()
[SSASubtitle]                     $Script:TheSubtitleFiglet            = [SSASubtitle]::new()
[SSAPressEnterPrompt]             $Script:TheSSAPressEnterPrompt       = [SSAPressEnterPrompt]::new()
[TtySpeed]                        $Script:TeletypeSpeed                = [TtySpeed]::Slow
[Runspace]                        $Script:TheOffThread                 = [RunspaceFactory]::CreateRunspace()
[PowerShell]                      $Script:TheOffShell                  = [PowerShell]::Create()
[IAsyncResult]                    $Script:SSAInputAsr                  = $null
Write-Progress -Activity 'Setting up Globals' -Id 1 -PercentComplete -1 -Completed

Write-Progress -Activity 'Creating Scene Images' -Id 2 -PercentComplete 0
[Hashtable]$Script:TheSceneImages = @{
    'FieldPlainsNoRoad'                          = [SIFieldPlainsNoRoad]::new()
    'FieldPlainsRoadNorth'                       = [SIFieldPlainsRoadNorth]::new()
    'FieldPlainsRoadSouth'                       = [SIFieldPlainsRoadSouth]::new()
    'FieldPlainsRoadEast'                        = [SIFieldPlainsRoadEast]::new()
    'FieldPlainsRoadWest'                        = [SIFieldPlainsRoadWest]::new()
    'FieldPlainsRoadNorthEast'                   = [SIFieldPlainsRoadNorthEast]::new()
    'FieldPlainsRoadNorthWest'                   = [SIFieldPlainsRoadNorthWest]::new()
    'FieldPlainsRoadNorthSouth'                  = [SIFieldPlainsRoadNorthSouth]::new()
    'FieldPlainsRoadEastWest'                    = [SIFieldPlainsRoadEastWest]::new()
    'FieldPlainsRoadNorthSouthEast'              = [SIFieldPlainsRoadNorthSouthEast]::new()
    'FieldPlainsRoadNorthSouthEastWest'          = [SIFieldPlainsRoadNorthSouthEastWest]::new()
    'FieldPlainsRoadNorthSouthWest'              = [SIFieldPlainsRoadNorthSouthWest]::new()
    'RiverRoadSample'                            = [SIRiverRoadSample]::new()
    'RiverRoadEWNSSample'                        = [SIRiverRoadEWNSSample]::new()
    'RiverRoadEWSSSample'                        = [SIRiverRoadEWSSSample]::new()
    'Random'                                     = [SIRandomNoise]::new()
    'SIRiverOnEastAtNorth'                       = [SIRiverOnEastAtNorth]::new()
    'SIRiverOnEastAtSouth'                       = [SIRiverOnEastAtSouth]::new()
    'SIRiverOnEastWestAtNorth'                   = [SIRiverOnEastWestAtNorth]::new()
    'SIRiverOnEastWestAtNorthSouth'              = [SIRiverOnEastWestAtNorthSouth]::new()
    'SIRiverOnEastWestNorthSouthAtEast'          = [SIRiverOnEastWestNorthSouthAtEast]::new()
    'SIRiverOnEastWestNorthSouthAtEastWest'      = [SIRiverOnEastWestNorthSouthAtEastWest]::new()
    'SIRiverOnEastWestNorthSouthAtEastWestSouth' = [SIRiverOnEastWestNorthSouthAtEastWestSouth]::new()
    'SIRiverOnEastWestNorthSouthAtWest'          = [SIRiverOnEastWestNorthSouthAtWest]::new()
    'SIRiverOnNorthEastAtNorth'                  = [SIRiverOnNorthEastAtNorth]::new()
    'SIRiverOnNorthSouthAtEast'                  = [SIRiverOnNorthSouthAtEast]::new()
    'SIRiverOnNorthSouthAtWest'                  = [SIRiverOnNorthSouthAtWest]::new()
    'SIRiverOnNorthSouthEastAtEast'              = [SIRiverOnNorthSouthEastAtEast]::new()
    'SIRiverOnNorthSouthEastAtNorth'             = [SIRiverOnNorthSouthEastAtNorth]::new()
    'SIRiverOnSouthAtEast'                       = [SIRiverOnSouthAtEast]::new()
    'SIRiverOnSouthEastAtSouthEast'              = [SIRiverOnSouthEastAtSouthEast]::new()
    'SIRiverOnWestAtNorth'                       = [SIRiverOnWestAtNorth]::new()
    'SIRiverOnWestAtSouth'                       = [SIRiverOnWestAtSouth]::new()
    'SIRiverOnWestEastAtSouth'                   = [SIRiverOnWestEastAtSouth]::new()
    'SIRiverOnWestNorthAtNorth'                  = [SIRiverOnWestNorthAtNorth]::new()
    'SIRiverOnWestNorthSouthAtNorth'             = [SIRiverOnWestNorthSouthAtNorth]::new()
}
Write-Progress -Activity 'Creating Scene Images' -Id 2 -Completed





###############################################################################
#
# MAP WARP FUNCTION
#
# THIS IS LIKELY A PRETTY NAIEVE APPROACH TO THIS AT THE MOMENT, BUT WHAT THE
# HELL?
#
###############################################################################
[ScriptBlock]$Script:MapWarpHandler = {
    Param(
        [Map]$TargetMap,
        [Int]$WarpX,
        [Int]$WarpY
    )

    # ASSIGN THE PREVIOUS MAP
    $Script:PreviousMap = $Script:CurrentMap

    # ASSIGN THE CURRENT MAP
    $Script:CurrentMap = $TargetMap

    # SET THE PLAYER'S MAP COORDINATES
    $Script:ThePlayer.MapCoordinates.Row    = $WarpY
    $Script:ThePlayer.MapCoordinates.Column = $WarpX

    # TODO: THIS WOULD HAVE TO TRIGGER A REFRESH OF THE GPS IN ORDER FOR THE
    # CHANGE TO BE VISIBLE. WHATEVER LOGIC I'VE BEEN USING FOR THE TILE CHANGE
    # WOULD LIKELY SUFFICE (AGAIN, MAY BE A BIT NAIEVE BUT I THINK IT SHOULD WORK).
    # CORRECTION: THIS HAS BEEN MOVED TO THE COMMAND BLOCK CALL RATHER THAN HERE.
}





[Map]$Script:SampleMap       = [Map]::new('Map Data\SampleMap.json')
[Map]$Script:SampleWarpMap01 = [Map]::new('Map Data\MapWarpTest01.json')
[Map]$Script:SampleWarpMap02 = [Map]::new('Map Data\MapWarpTest02.json')
[Map]$Script:CurrentMap      = $Script:SampleWarpMap01

$Script:BadCommandRetorts = @(
    'Huh?',
    'Do what now?',
    'Come again?',
    'Pardon?',
    'Y U no type rite?',
    'Bruh...',
    'Are you drunk?',
    'Your commands are sus.',
    'Git gud, scrub.',
    'Did you RTFM?',
    'git commit -am "Eye kant spell"',
    'ceuwcnesckldsc',
    '843214385321832904'
)

$Script:SpectreBBPRounded = @{
    [WindowBorderPart]::LeftTop     = '╭'
    [WindowBorderPart]::Top         = '─'
    [WindowBorderPart]::RightTop    = '╮'
    [WindowBorderPart]::Left        = '│'
    [WindowBorderPart]::Right       = '│'
    [WindowBorderPart]::LeftBottom  = '╰'
    [WindowBorderPart]::Bottom      = '─'
    [WindowBorderPart]::RightBottom = '╯'
}

$Script:SpectreBBPSquare = @{
    [WindowBorderPart]::LeftTop     = '┌'
    [WindowBorderPart]::Top         = '─'
    [WindowBorderPart]::RightTop    = '┐'
    [WindowBorderPart]::Left        = '│'
    [WindowBorderPart]::Right       = '│'
    [WindowBorderPart]::LeftBottom  = '└'
    [WindowBorderPart]::Bottom      = '─'
    [WindowBorderPart]::RightBottom = '┘'
}

$Script:CurrentWindowDesign = $SpectreBBPRounded

$Script:BattleEncounterRegionTable = @{
    0 = @(
        'EEBat',
        'EENightwing',
        'EEWingblight',
        'EEDarkfang',
        'EENocturna',
        'EEBloodswoop',
        'EEDuskbane'
    )
}

$Script:BATAdornmentCharTable = @{
    [BattleActionType]::Physical         = [Tuple[[String], [ConsoleColor24]]]::new("`u{2022}", [CCTextDefault24]::new())
    [BattleActionType]::ElementalFire    = [Tuple[[String], [ConsoleColor24]]]::new("`u{03B6}", [CCAppleRedLight24]::new())
    [BattleActionType]::ElementalWater   = [Tuple[[String], [ConsoleColor24]]]::new("`u{03C8}", [CCAppleBlueLight24]::new())
    [BattleActionType]::ElementalEarth   = [Tuple[[String], [ConsoleColor24]]]::new("`u{03B5}", [CCAppleBrownLight24]::new())
    [BattleActionType]::ElementalWind    = [Tuple[[String], [ConsoleColor24]]]::new("`u{03C6}", [CCAppleGreenLight24]::new())
    [BattleActionType]::ElementalLight   = [Tuple[[String], [ConsoleColor24]]]::new("`u{03BC}", [CCAppleYellowLight24]::new())
    [BattleActionType]::ElementalDark    = [Tuple[[String], [ConsoleColor24]]]::new("`u{03B4}", [CCApplePurpleDark24]::new())
    [BattleActionType]::ElementalIce     = [Tuple[[String], [ConsoleColor24]]]::new("`u{03B9}", [CCAppleCyanDark24]::new())
    [BattleActionType]::MagicPoison      = [Tuple[[String], [ConsoleColor24]]]::new("`u{03BE}", [CCAppleIndigoLight24]::new())
    [BattleActionType]::MagicConfuse     = [Tuple[[String], [ConsoleColor24]]]::new("`u{0398}", [CCAppleCyanDark24]::new())
    [BattleActionType]::MagicSleep       = [Tuple[[String], [ConsoleColor24]]]::new("`u{03B7}", [CCAppleGrey4Light24]::new())
    [BattleActionType]::MagicAging       = [Tuple[[String], [ConsoleColor24]]]::new("`u{03C3}", [CCAppleGrey6Light24]::new())
    [BattleActionType]::MagicHealing     = [Tuple[[String], [ConsoleColor24]]]::new("`u{20AA}", [CCAppleMintLight24]::new())
    [BattleActionType]::MagicStatAugment = [Tuple[[String], [ConsoleColor24]]]::new("`u{20B9}", [CCAppleOrangeLight24]::new())
}

#
# BATTLE ACTION TABLE - LOOKUP TABLE
#
# LOOKUP FOR RESISTANCE/WEAKNESS SCALARS. THIS IS GREATLY SENSITIVE TO THE ENUMERATION
# ORDERING IN THE BATTLE ACTION TYPE ENUMERATION.
#
$Script:BATLut = @(
	# PHYSICAL ATTACKS AGAINST OTHERS
	@(1, 1, 1, 1, 1, 1, 1, 1),

	# ELEMENTAL FIRE ATTACKS AGAINST OTHERS
	@(1, -0.75, 0.5, 0.5, 0.5, 1, 1, 1.75),

	# ELEMENTAL WATER ATTACKS AGAINST OTHERS
	@(1, 1.75, -0.75, 1, 0.5, 1, 1, 0.5),

	# ELEMENTAL EARTH ATTACKS AGAINST OTHERS
	@(1, 0.5, 1, -0.75, 0.5, 1, 1, 1.75),

	# ELEMENTAL WIND ATTACKS AGAINST OTHERS
	@(1, 1, 1, 1.75, -0.75, 1, 1, 0.5),

	# ELEMENTAL LIGHT ATTACKS AGAINST OTHERS
	@(1, 1, 1, 1, 1, -0.75, 1.75, 1),

	# ELEMENTAL DARK ATTACKS AGAINST OTHERS
	@(1, 1, 1, 1, 1, 1.75, -0.75, 1),

	# ELEMENTAL ICE ATTACKS AGAINST OTHERS
	@(1, 0.5, 1.75, 1.75, 1, 1, 1, -0.75)
)

$Script:Rui = $(Get-Host).UI.RawUI





###############################################################################
#
# THE STATE BLOCK TABLE SCRIPTBLOCK DEFINITIONS
#
###############################################################################
[ScriptBlock]$Script:TheSplashScreenAState = {}

[ScriptBlock]$Script:TheSplashScreenBState = {}

[ScriptBlock]$Script:TheTitleScreenState = {
    Write-Host "$([ATControlSequences]::CursorHide)"

    If($Script:HasSSASetupRunspace -EQ $false) {
        $Script:TheOffThread = [RunspaceFactory]::CreateRunspace()
        $Script:TheOffShell  = [PowerShell]::Create()

        $Script:TheOffThread.Open()
        $Script:TheOffShell.Runspace = $Script:TheOffThread
        $Script:TheOffShell.AddScript({
            [Console]::ReadKey($true)
        })

        $Script:SSAInputAsr = $Script:TheOffShell.BeginInvoke()

        $Script:HasSSASetupRunspace = $true
    }

    If($Script:HasTitleBgmStarted -EQ $false) {
        Start-Sleep -Seconds 1
        Try {
            $Script:TheBgmMPlayer.Open($Script:BgmTitleThemeB)
            $Script:TheBgmMPlayer.Play()
        } Catch {}
        $Script:HasTitleBgmStarted = $true
    }

    $Script:TheTitleFiglet.Draw()

    If($Script:HasSubtitleBeenWritten -EQ $false) {
        [Char[]]$CharArr   = $Script:TheGameSubtitle.ToCharArray()
        [Int]$PrintCounter = 0
        [Int]$Probe        = 0
        [Int]$PrintCol     = 33

        While($Probe -LE ($CharArr.Count - 1)) {
            $PrintCounter++
            If($PrintCounter -GE $Script:TeletypeSpeed) {
                $PrintCounter = 0
                Write-Host "$([ATControlSequences]::GenerateCoordinateString(9, $PrintCol))$($CharArr[$Probe])" -NoNewline
                $Probe++
                $PrintCol++
            }
        }

        $Script:HasSubtitleBeenWritten = $true
    }

    If($Script:HasSubtitleBeenColored -EQ $false) {
        $Script:TheSubtitleFiglet.Draw()
        $Script:HasSubtitleBeenColored = $true
    }

    If((Get-Random -Minimum 1 -Maximum 50000) -LT 250) {
        $Script:HasSubtitleBeenColored  = $false
        $Script:TheSubtitleFiglet.Dirty = $true
    }

    If($Script:HasSSAPressEnterShown -EQ $false) {
        $Script:TheSSAPressEnterPrompt.Draw()
        $Script:HasSSAPressEnterShown = $true
    }

    If($Script:HasSSAPressEnterShown -EQ $true) {
        $Script:SSAPECounter++
        If($Script:SSAPECounter -GE $Script:SSAPETimeout) {
            $Script:SSAPECounter                    = 0
            $Script:TheSSAPressEnterPrompt.DrawMode = -NOT $Script:TheSSAPressEnterPrompt.DrawMode
            $Script:TheSSAPressEnterPrompt.Dirty    = $true
            $Script:TheSSAPressEnterPrompt.Draw()
        }
    }

    If($Script:SSAInputAsr.IsCompleted -EQ $true) {
        $SSAKeyPressInfo = $Script:TheOffShell.EndInvoke($Script:SSAInputAsr) | Select-Object -First 1
        
        If($SSAKeyPressInfo.Key -NE [ConsoleKey]::Enter) {
            $Script:HasSSASetupRunspace = $false
        } Else {
            Try {
                $Script:TheBgmMPlayer.Stop()
            } Catch {}
            $Script:HasTitleBgmStarted = $false

            $Script:TheOffThread.Dispose()
            $Script:TheOffShell.Dispose()

            $Script:TheBufferManager.CopyActiveToBufferAWithWipe()

            Start-Sleep -Seconds 1

            $Script:ThePreviousGlobalGameState = $Script:TheGlobalGameState
            $Script:TheGlobalGameState         = [GameStatePrimary]::GamePlayScreen   
        }
    }

    Write-Host "$([ATControlSequences]::GenerateCoordinateString(1, 1))"
}

[ScriptBlock]$Script:ThePlayerSetupState = {}

[ScriptBlock]$Script:TheGamePlayScreenState = {
    If($null -NE $Script:TheInventoryWindow) {
        $Script:TheInventoryWindow = $null
    }
    If($null -NE $Script:TheBattleManager) {
        $Script:TheBattleManager.Cleanup()
        $Script:TheBattleManager = $null
    }
    If($null -NE $Script:ThePlayerBattleStatWindow) {
        $Script:ThePlayerBattleStatWindow = $null
    }
    If($null -NE $Script:TheEnemyBattleStatWindow) {
        $Script:TheEnemyBattleStatWindow = $null
    }
    If($null -NE $Script:ThePlayerBattleActionWindow) {
        $Script:ThePlayerBattleActionWindow = $null
    }
    If($null -NE $Script:TheBattleStatusMessageWindow) {
        $Script:TheBattleStatusMessageWindow = $null
    }
    If($null -NE $Script:TheBattleEnemyImageWindow) {
        $Script:TheBattleEnemyImageWindow = $null
    }
    If($null -NE $Script:TheStatusHudWindow) {
        $Script:TheStatusHudWindow = $null
    }
    If($null -NE $Script:TheStatusTechSelectionWindow) {
        $Script:TheStatusTechSelectionWindow = $null
    }
    If($null -NE $Script:TheStatusTechInventoryWindow) {
        $Script:TheStatusTechInventoryWindow = $null
    }

    #######################################################################
    #
    # I REALLY NEED TO UNDERSTAND WHAT THE FUCK I WAS TRYING TO DO HERE.
    # THIS CODE SEEMS LIKE A FUCKING CRIME AGAINST HUMANITY, BUT I CAN'T
    # REMEMBER WHY I DID IT THIS WAY.
    #
    #######################################################################
    If(($Script:ThePreviousGlobalGameState -EQ [GameStatePrimary]::InventoryScreen) -AND ($Script:GpsRestoredFromInvBackup -EQ $false)) {
        $Script:TheBufferManager.RestoreBufferAToActive()

        # Force redraws of the content; a restoration from a buffer capture will NOT retain the 24-bit color information
        # and I really don't feel like trying to figure out how to grab the buffer manually
        $Script:GpsRestoredFromInvBackup             = $true
        $Script:TheSceneWindow.SceneImageDirty       = $true
        $Script:TheStatusWindow.PlayerNameDrawDirty  = $true
        $Script:TheStatusWindow.PlayerHpDrawDirty    = $true
        $Script:TheStatusWindow.PlayerMpDrawDirty    = $true
        $Script:TheStatusWindow.PlayerGoldDrawDirty  = $true
        $Script:TheCommandWindow.CommandHistoryDirty = $true
        $Script:TheMessageWindow.MessageADirty       = $true
        $Script:TheMessageWindow.MessageBDirty       = $true
        $Script:TheMessageWindow.MessageCDirty       = $true
        Write-Host "$([ATControlSequences]::CursorShow)"
    } Elseif(($Script:ThePreviousGlobalGameState -EQ [GameStatePrimary]::BattleScreen) -AND ($Script:GpsRestoredFromBatBackup -EQ $false)) {
        $Script:TheBufferManager.RestoreBufferAToActive()
        
        # Force redraws of the content; a restoration from a buffer capture will NOT retain the 24-bit color information
        # and I really don't feel like trying to figure out how to grab the buffer manually
        $Script:GpsRestoredFromBatBackup             = $true
        $Script:TheSceneWindow.SceneImageDirty       = $true
        $Script:TheStatusWindow.PlayerNameDrawDirty  = $true
        $Script:TheStatusWindow.PlayerHpDrawDirty    = $true
        $Script:TheStatusWindow.PlayerMpDrawDirty    = $true
        $Script:TheStatusWindow.PlayerGoldDrawDirty  = $true
        $Script:TheCommandWindow.CommandHistoryDirty = $true
        $Script:TheMessageWindow.MessageADirty       = $true
        $Script:TheMessageWindow.MessageBDirty       = $true
        $Script:TheMessageWindow.MessageCDirty       = $true
        Write-Host "$([ATControlSequences]::CursorShow)"
    } Elseif(($Script:ThePreviousGlobalGameState -EQ [GameStatePrimary]::PlayerStatusScreen) -AND ($Script:GpsRestoredFromStaBackup -EQ $false)) {
        $Script:TheBufferManager.RestoreBufferAToActive()
        
        # Force redraws of the content; a restoration from a buffer capture will NOT retain the 24-bit color information
        # and I really don't feel like trying to figure out how to grab the buffer manually
        $Script:GpsRestoredFromStaBackup             = $true
        $Script:TheSceneWindow.SceneImageDirty       = $true
        $Script:TheStatusWindow.PlayerNameDrawDirty  = $true
        $Script:TheStatusWindow.PlayerHpDrawDirty    = $true
        $Script:TheStatusWindow.PlayerMpDrawDirty    = $true
        $Script:TheStatusWindow.PlayerGoldDrawDirty  = $true
        $Script:TheCommandWindow.CommandHistoryDirty = $true
        $Script:TheMessageWindow.MessageADirty       = $true
        $Script:TheMessageWindow.MessageBDirty       = $true
        $Script:TheMessageWindow.MessageCDirty       = $true
        Write-Host "$([ATControlSequences]::CursorShow)"
    }

    $Script:ThePlayer.Update()
    $Script:TheStatusWindow.Draw()
    $Script:TheCommandWindow.Draw()
    $Script:TheSceneWindow.Draw()
    $Script:TheMessageWindow.Draw()
    $Script:TheCommandWindow.HandleInput()
}

[ScriptBlock]$Script:TheInventoryScreenState = {
    If($null -EQ $Script:TheInventoryWindow) {
        Try {
            $Script:TheInventoryWindow = [InventoryWindow]::new()
        } Catch {
            Write-Error $_.Exception.Message
            Write-Error $_.Exception.StackTrace
        }
    }
    If($Script:GpsRestoredFromInvBackup -EQ $true) {
        $Script:GpsRestoredFromInvBackup = $false
    }
    $Script:TheInventoryWindow.Draw()
    $Script:TheInventoryWindow.HandleInput()
}

[ScriptBlock]$Script:TheBattleScreenState = {
    If($Script:HasBattleIntroPlayed -EQ $false) {
        If($Script:ThePreviousGlobalGameState -EQ [GameStatePrimary]::GamePlayScreen) {
            [ATString]$Banner = [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleMintLight24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = 7
                        Column = 40 - (15 / 2)
                    }
                }
                UserData   = 'BATTLE COMMENCE'
                UseATReset = $true
            }
            Write-Host "$($Banner.ToAnsiControlSequenceString())"
            Write-Host "$([ATControlSequences]::CursorHide)"
            Try {
                $Script:TheSfxMPlayer.Open($Script:SfxBattleIntro)
                $Script:TheSfxMPlayer.Play()
            } Catch {}
            Start-Sleep -Seconds 1.75
            Clear-Host
        }
        $Script:HasBattleIntroPlayed = $true
    }
    If($null -EQ $Script:TheBattleManager) {
        $Script:TheBattleManager       = [BattleManager]::new()
        $Script:TheBattleManager.State = [BattleManagerState]::TurnIncrement
    }
    If($Script:BattleCursorVisible -EQ $false) {
        Write-Host "$([ATControlSequences]::CursorHide)"
        $Script:BattleCursorVisible = $true
    }
    If($null -EQ $Script:ThePlayerBattleStatWindow) {
        $Script:ThePlayerBattleStatWindow = [BattleEntityStatusWindow]::new(1, 1, 17, 19, $Script:ThePlayer)
    }
    If($null -EQ $Script:TheEnemyBattleStatWindow) {
        $Script:TheEnemyBattleStatWindow = [BattleEntityStatusWindow]::new(1, 22, 17, 40, $Script:TheCurrentEnemy)
    }
    If($null -EQ $Script:ThePlayerBattleActionWindow) {
        $Script:ThePlayerBattleActionWindow = [BattlePlayerActionWindow]::new()
    }
    If($null -EQ $Script:TheBattleStatusMessageWindow) {
        $Script:TheBattleStatusMessageWindow = [BattleStatusMessageWindow]::new()
    }
    If($null -EQ $Script:TheBattleEnemyImageWindow) {
        $Script:TheBattleEnemyImageWindow = [BattleEnemyImageWindow]::new()
    }
    If($null -EQ $Script:TheBattlePhaseIndicator) {
        $Script:TheBattlePhaseIndicator = [BattlePhaseIndicator]::new()
    }
    If($Script:GpsRestoredFromBatBackup -EQ $true) {
        $Script:GpsRestoredFromBatBackup = $false
    }
    If($Script:IsBattleBgmPlaying -EQ $false) {
        $Script:TheBgmMPlayer.Open($Script:BgmBattleThemeA)
        $Script:TheBgmMPlayer.Volume = 0.5
        $Script:TheBgmMPlayer.Play()
        $Script:IsBattleBgmPlaying = $true
    }
    $Script:TheBattleManager.Update()
}

[ScriptBlock]$Script:ThePlayerStatusScreenState = {
    Write-Host "$([ATControlSequences]::CursorHide)"
    $Script:Rui.CursorPosition = [Coordinates]::new(1, 1)

    If($null -EQ $Script:TheStatusHudWindow) {
        $Script:TheStatusHudWindow = [StatusHudWindow]::new()
    }
    If($null -EQ $Script:TheStatusTechSelectionWindow) {
        $Script:TheStatusTechSelectionWindow = [StatusTechniqueSelectionWindow]::new()
    }
    If($null -EQ $Script:TheStatusTechInventoryWindow) {
        $Script:TheStatusTechInventoryWindow = [StatusTechniqueInventoryWindow]::new()
    }
    If($Script:GpsRestoredFromStaBackup -EQ $true) {
        $Script:GpsRestoredFromStaBackup = $false
    }
    $Script:TheStatusHudWindow.Draw()
    $Script:TheStatusTechSelectionWindow.Draw()
    $Script:TheStatusTechInventoryWindow.Draw()
    Switch($Script:StatusScreenMode) {
        ([StatusScreenMode]::EquippedTechSelection) {
            If($Script:TheStatusTechSelectionWindow.IsActive -NE $true) {
                $Script:TheStatusTechSelectionWindow.SetAllActionDrawDirty()
                $Script:TheStatusTechSelectionWindow.IsActive = $true
            }
            If($Script:TheStatusTechInventoryWindow.IsActive -NE $false) {
                $Script:TheStatusTechInventoryWindow.IsActive = $false
                $Script:TheStatusTechInventoryWindow.SetFlagsDirty()
            }
            $Script:TheStatusTechSelectionWindow.PlayerChevronDirty = $true # Now the redraw should work... hopefully
            $Script:TheStatusTechSelectionWindow.Draw() # See if this trips the Chevron color change; didn't work :'(
            $Script:TheStatusTechInventoryWindow.Draw()
            $Script:TheStatusTechSelectionWindow.HandleInput()
            $Script:TheStatusTechSelectionWindow.Draw()
        }

        ([StatusScreenMode]::TechInventorySelection) {
            If($Script:TheStatusTechSelectionWindow.IsActive -NE $false) {
                $Script:TheStatusTechSelectionWindow.IsActive = $false
            }
            If($Script:TheStatusTechInventoryWindow.IsActive -NE $true) {
                $Script:TheStatusTechInventoryWindow.IsActive = $true
            }
            $Script:TheStatusTechSelectionWindow.PlayerChevronDirty = $true # Now the redraw should work... hopefully
            $Script:TheStatusTechSelectionWindow.Draw() # See if this trips the Chevron color change; didn't work :'(
            $Script:TheStatusTechInventoryWindow.Draw()
            $Script:TheStatusTechInventoryWindow.HandleInput()
            $Script:TheStatusTechInventoryWindow.Draw()
        }

        Default {
            # DO NOTHING
            # BECAUSE I'M A FUCKING GENIUS
        }
    }
}

[ScriptBlock]$Script:TheCleanupState = {}





###############################################################################
#
# THE COMMAND TABLE AND ITS ASSOCIATED SCRIPT BLOCKS
#
###############################################################################
[ScriptBlock]$Script:TheMoveCommand = {
    Param(
        [String]$a0
    )

    If($args.Length -GT 0) {
        $Script:TheMessageWindow.WriteCmdExtraArgsWarning('move', $args)
    }

    If($PSBoundParameters.ContainsKey('a0') -EQ $true) {
        If([String]::IsNullOrEmpty($a0) -EQ $true) {
            $Script:TheCommandWindow.UpdateCommandHistory($false)
            $Script:TheMessageWindow.WriteBadArg0Message('move', '')

            Return
        } Else {
            Switch($a0) {
                { $_ -IEQ 'north' -OR $_ -IEQ 'n' } {
                    $Script:ThePlayer.MapMoveNorth()
                }
    
                { $_ -IEQ 'south' -OR $_ -IEQ 's' } {
                    $Script:ThePlayer.MapMoveSouth()
                }
    
                { $_ -IEQ 'east' -OR $_ -IEQ 'e' } {
                    $Script:ThePlayer.MapMoveEast()
                }
    
                { $_ -IEQ 'west' -OR $_ -IEQ 'w' } {
                    $Script:ThePlayer.MapMoveWest()
                }
    
                Default {
                    $Script:TheCommandWindow.UpdateCommandHistory($false)
                    $Script:TheMessageWindow.WriteBadCommandMessage('move')
    
                    Return
                }
            }
        }
    } Else {
        $Script:TheMessageWindow.WriteBadCommandRetortMessage()
        $Script:TheCommandWindow.UpdateCommandHistory($false)

        Return
    }

    Return
}

[ScriptBlock]$Script:TheLookCommand = {
    If($args.Length -GT 0) {
        $Script:TheMessageWindow.WriteCmdExtraArgsWarning('look', $args)
    }

    $Script:TheCommandWindow.UpdateCommandHistory($true)

    $a = $Script:CurrentMap.GetTileAtPlayerCoordinates().ObjectListing
    $b = 78
    $c = ''
    $f = ''
    $z = 0
    $y = $false

    If($a.Count -LE 0) {
        $Script:TheMessageWindow.WriteMapNoItemsFoundMessage()
        Return
    }
    Foreach($d in $a) {
        If($z -EQ $a.Count - 1) {
            $c += $d.Name
        } Else {
            $c += $d.Name + ', '
        }
        $z++
    }
    $e = $c.Length
    If($e -GT $b) {
        $y = $true
        $c -MATCH '([\s,]+\w+){5}$' | Out-Null
        If($_ -EQ $true) {
            $c = $c -REPLACE '([\s,]+\w+){5}$', ''
            $f = $matches[0].Remove(0, 2)
        }
    }

    $Script:TheMessageWindow.WriteLookMessage($c, $f, $y)

    Return
}

[ScriptBlock]$Script:TheInventoryCommand = {
    If($args.Length -GT 0) {
        $Script:TheMessageWindow.WriteCmdExtraArgsWarning('inventory', $args)
    }

    $Script:TheCommandWindow.UpdateCommandHistory($true)
    $Script:TheBufferManager.CopyActiveToBufferAWithWipe()
    $Script:ThePreviousGlobalGameState = $Script:TheGlobalGameState
    $Script:TheGlobalGameState         = [GameStatePrimary]::InventoryScreen

    Return
}

[ScriptBlock]$Script:TheExamineCommand = {
    Param(
        [String]$a0
    )

    If($args.Length -GT 0) {
        $Script:TheMessageWindow.WriteCmdExtrasArgsWarning('examine', $args)
    }

    If($PSBoundParameters.ContainsKey('a0') -EQ $true) {
        If([String]::IsNullOrEmpty($a0) -EQ $true) {
            $Script:TheCommandWindow.UpdateCommandHistory($false)
            $Script:TheMessageWindow.WriteBadArg0Message('examine', '')

            Return
        } Else {
            Foreach($a in $Script:CurrentMap.GetTileAtPlayerCoordinates().ObjectListing) {
                If($a.Name -IEQ $a0) {
                    $Script:TheCommandWindow.UpdateCommandHistory($true)
                    $Script:TheMessageWindow.WriteItemExamineMessage($a.ExamineString)
    
                    Return
                }
            }
            $Script:TheCommandWindow.UpdateCommandHistory($false)
            $Script:TheMessageWindow.WriteMapInvalidItemMessage($ItemName)
    
            Return
        }
    } Else {
        $Script:TheMessageWindow.WriteBadCommandRetortMessage()
        $Script:TheCommandWindow.UpdateCommandHistory($false)

        Return
    }

    Return
}

[ScriptBlock]$Script:TheGetCommand = {
    Param(
        [String]$a0
    )

    If($args.Length -GT 0) {
        $Script:TheMessageWindow.WriteCmdExtraArgsWarning('get', $args)
    }

    If($PSBoundParameters.ContainsKey('a0') -EQ $true) {
        If([String]::IsNullOrEmpty($a0) -EQ $true) {
            $Script:TheCommandWindow.UpdateCommandHistory($false)
            $Script:TheMessageWindow.WriteBadArg0Message('get', '')

            Return
        } Else {
            $a = $Script:CurrentMap.GetTileAtPlayerCoordinates().ObjectListing

            If($a.Count -LE 0) {
                $Script:TheCommandWindow.UpdateCommandHistory($false)
                $Script:TheMessageWindow.WriteMapNoItemsFoundMessage()

                Return
            }
            Foreach($b in $a) {
                If($b.Name -IEQ $a0) {
                    If($b.CanAddToInventory -EQ $true) {
                        $Script:ThePlayer.Inventory.Add($b) | Out-Null
                        $c = $a.Remove($b) | Out-Null
                        If($c -EQ $false) {
                            Write-Error 'Failed to remove an item from the Map Tile!'

                            Exit
                        } Else {
                            $Script:TheCommandWindow.UpdateCommandHistory($true)
                            $Script:TheMessageWindow.WriteItemTakenMessage($a0)

                            Return
                        }
                    } Else {
                        $Script:TheCommandWindow.UpdateCommandHistory($true)
                        $Script:TheMessageWindow.WriteItemCantTakeMessage($a0)

                        Return
                    }
                }
            }
            $Script:TheCommandWindow.UpdateCommandHistory($false)
            $Script:TheMessageWindow.WriteMapInvalidItemMessage($a0)

            Return
        }
    } Else {
        $Script:TheMessageWindow.WriteBadCommandRetortMessage()
        $Script:TheCommandWindow.UpdateCommandHistory($false)

        Return
    }

    Return
}

[ScriptBlock]$Script:TheUseCommand = {
    Param(
        [String]$a0,
        [String]$a1
    )

    If($args.Length -GT 0) {
        $Script:TheMessageWindow.WriteCmdExtrasArgsWarning('use', $args)
    }

    If(($PSBoundParameters.ContainsKey('a0') -EQ $true) -AND ($PSBoundParameters.ContainsKey('a1') -EQ $true)) {
        If($Script:ThePlayer.IsItemInInventory($a0) -EQ $true) {
            If($Script:CurrentMap.GetTileAtPlayerCoordinates().IsItemInTile($a1) -EQ $true) {
                [MapTileObject]$pi  = $Script:ThePlayer.GetItemReference($a0)
                [MapTileObject]$mti = $Script:CurrentMap.GetTileAtPlayerCoordinates().GetItemReference($a1)

                If($mti.ValidateSourceInFilter($pi.PSTypeNames[0]) -EQ $true) {
                    $Script:TheCommandWindow.UpdateCommandHistory($true)
                    Invoke-Command $mti.Effect -ArgumentList $mti, $pi
                } Else {
                    $Script:TheCommandWindow.UpdateCommandHistory($false)
                    $Script:TheMessageWindow.WriteCantUseItemMessage($a0, $a1)
                }
            } Else {
                If($a1 -IEQ 'self') {
                    [MapTileObject]$pi = $Script:ThePlayer.GetItemReference($a0)

                    # This code is problematic if the filter has no items in it
                    If($Script:ThePlayer.ValidateSourceInFilter($pi.PSTypeNames[0]) -EQ $true) {
                        $Script:TheCommandWindow.UpdateCommandHistory($true)
                        Invoke-Command $pi.Effect -ArgumentList $pi, $Script:ThePlayer
                    } Else {
                        $Script:TheCommandWindow.UpdateCommandHistory($false)
                        $Script:TheMessageWindow.WriteCatUseItemOnSelfMessage($a0)
                    }
                } Else {
                    $Script:TheCommandWindow.UpdateCommandHistory($false)
                    $Script:TheMessageWindow.WriteBadCommandRetortMessage()
                }
            }
        } Else {
            # The item isn't in the Player's Inventory, thus rendering this an inoperable command (despite not being syntactically invalid).
            $Script:TheCommandWindow.UpdateCommandHistory($false)
            $Script:TheMessageWindow.WriteNoItemInInvMessage($a0)

            Return
        }
    } Elseif(($PSBoundParameters.ContainsKey('a0') -EQ $true) -AND ((-NOT $PSBoundParameters.ContainsKey('a1')) -EQ $true)) {
        $Script:TheCommandWindow.UpdateCommandHistory($false)

        If($Script:ThePlayer.IsItemInInventory($a0) -EQ $true) {
            $Script:TheMessageWindow.WriteNoItemTargetMessage($a0)
        } Else {
            $Script:TheMessageWindow.WriteItemUseUnsureMessage($a0)
        }
    } Elseif(((-NOT $PSBoundParameters.ContainsKey('a0')) -EQ $true) -AND ((-NOT $PSBoundParameters.ContainsKey('a1')) -EQ $true)) {
        $Script:TheMessageWindow.WriteBadCommandRetortMessage()
        $Script:TheCommandWindow.UpdateCommandHistory($false)
    }
}

[ScriptBlock]$Script:TheDropCommand = {
    Param(
        [String]$a0
    )

    If($args.Length -GE 1) {
        $Script:TheCommandWindow.UpdateCommandHistory($false)
        $Script:TheMessageWindow.WriteCantDropMultMessage()

        Return
    }

    If($PSBoundParameters.ContainsKey('a0') -EQ $true) {
        If($Script:ThePlayer.IsItemInInventory($a0) -EQ $true) {
            If($Script:ThePlayer.RemoveInventoryItemByName($a0) -EQ [ItemRemovalStatus]::Success) {
                $Script:TheCommandWindow.UpdateCommandHistory($true)
                $Script:TheMessageWindow.WriteItemDroppedMessage($a0)

                Return
            } Else {
                # WARNING
                # At this point, this branch is considered a fatal error
                # There really should be a better way of handling this, however
                Exit
            }
        } Else {
            $Script:TheCommandWindow.UpdateCommandHistory($false)
            $Script:TheMessageWindow.WriteNoItemInInvMessage($a0)

            Return
        }
    } Else {
        $Script:TheMessageWindow.WriteBadCommandRetortMessage()
        $Script:TheCommandWindow.UpdateCommandHistory($false)

        Return
    }
}

[ScriptBlock]$Script:TheStatusCommand = {
    If($args.Length -GT 0) {
        $Script:TheMessageWindow.WriteCmdExtraArgsWarning('use', $args)
    }

    $Script:TheCommandWindow.UpdateCommandHistory($true)
    $Script:TheBufferManager.CopyActiveToBufferAWithWipe()
    $Script:ThePreviousGlobalGameState = $Script:TheGlobalGameState
    $Script:TheGlobalGameState         = [GameStatePrimary]::PlayerStatusScreen
}

[ScriptBlock]$Script:TheEnterCommand = {
    If($args.Length -GT 0) {
        $Script:TheMessageWindow.WriteCmdExtraArgsWarning('enter', $args)
    }

    $a = $Script:CurrentMap.GetTileAtPlayerCoordinates().ObjectListing

    If($a.Count -LE 0) {
        $Script:TheCommandWindow.UpdateCommandHistory($false)

        # THIS MAY NEED MODIFIED TO A DIFFERENT METHOD CALL GIVEN THE NATURE
        # OF THE ACTION.
        $Script:TheMessageWindow.WriteMapNoItemsFoundMessage()

        Return
    }

    Foreach($b in $a) {
        # THIS COULD BE PROBLEMATIC IF THERE ARE MULTIPLE WARPABLE ITEMS ON A SINGLE TILE
        # BUT REALLY? WHY?
        If($b -IS [MTOWarpable]) {
            # ASIDE FROM THE OTHER WAYS IN WHICH WARPABLES DIFFER FROM THEIR OTHER MTO
            # CONTEMPORARIES IS THAT THEY DON'T MAKE USE OF THE MTO TARGET OF FILTER.
            # WE'RE JUST GOING TO INVOKE THE EFFECT METHOD, WHICH WOULD BE THE MAP
            # WARPING FUNCTION.
            $Script:TheCommandWindow.UpdateCommandHistory($true)
            Invoke-Command $b.Effect -ArgumentList $b.WarpToReference.Value, $b.WarpToX, $b.WarpToY

            # I MAY ALSO WANT TO WRITE A MESSAGE TO THE MESSAGE WINDOW ABOUT HAVING
            # ENTERED A MAP? I'LL LEAVE THIS AS A TODO HERE.

            $Script:TheSceneWindow.UpdateCurrentImage($Script:CurrentMap.GetTileAtPlayerCoordinates().BackgroundImage)
            
            # THIS NEXT PART IS LIKELY SUBJECT TO CHANGE BECAUSE IT WOULD IMPLY THAT
            # BATTLES CAN OCCUR ON THE WARPING TILES, AND THIS MAY NOT MAKE MUCH SENSE
            $Script:CurrentMap.GetTileAtPlayerCoordinates().BattleStep()

            Return
        }
    }

    # THERE ARE NO WARPABLE INSTANCES ON THIS TILE, REPORT TO THE MESSAGE WINDOW
    $Script:TheCommandWindow.UpdateCommandHistory($false)
    $Script:TheMessageWindow.WriteBadCommandRetortMessage()
}

$Script:TheCommandTable = @{
    'move'      = $Script:TheMoveCommand
    'm'         = $Script:TheMoveCommand
    'look'      = $Script:TheLookCommand
    'l'         = $Script:TheLookCommand
    'inventory' = $Script:TheInventoryCommand
    'i'         = $Script:TheInventoryCommand
    'inv'       = $Script:TheInventoryCommand
    'examine'   = $Script:TheExamineCommand
    'exa'       = $Script:TheExamineCommand
    'get'       = $Script:TheGetCommand
    'g'         = $Script:TheGetCommand
    'take'      = $Script:TheGetCommand
    't'         = $Script:TheGetCommand
    'use'       = $Script:TheUseCommand
    'u'         = $Script:TheUseCommand
    'drop'      = $Script:TheDropCommand
    'd'         = $Script:TheDropCommand
    'status'    = $Script:TheStatusCommand
    'sta'       = $Script:TheStatusCommand
    'enter'     = $Script:TheEnterCommand
    'en'        = $Script:TheEnterCommand
    'exit'      = $Script:TheEnterCommand
    'ex'        = $Script:TheEnterCommand
}





###############################################################################
#
# BATTLE ACTION CALCULATION
#
###############################################################################
[ScriptBlock]$Script:BaCalc = {
    Param(
        [BattleEntity]$Self,
        [BattleEntity]$Target,
        [BattleAction]$SelfAction
    )

    [Boolean]$CanExecute   = $false
    [Boolean]$ReduceSelfMp = $false

    If($SelfAction.MpCost -GT 0) {
        If($Self.Stats[[StatId]::MagicPoints].Base -GE $SelfAction.MpCost) {
            $CanExecute   = $true
            $ReduceSelfMp = $true
        }
    } Elseif($SelfAction.MpCost -LE 0) {
        $CanExecute = $true
    }

    If($CanExecute -EQ $true) {
        If($ReduceSelfMp -EQ $true) {
            [Int]$DecRes = $Self.Stats[[StatId]::MagicPoints].DecrementBase($SelfAction.MpCost * -1)
            If($Self -IS [Player]) {
                $Script:ThePlayerBattleStatWindow.MpDrawDirty = $true
            } Else {
                $Script:TheEnemyBattleStatWindow.MpDrawDirty = $true
            }
        }

        $ExecuteChance = Get-Random -Minimum 0.0 -Maximum 1.0
        If($ExecuteChance -GT $SelfAction.Chance) {
            Return [BattleActionResult]@{
                Type            = [BattleActionResultType]::FailedAttackFailed
                Originator      = $Self
                Target          = $Target
                ActionEffectSum = 0
            }
        }

        $TargetEffectiveEvasion = [Math]::Round((0.1 + ($Target.Stats[[StatId]::Speed].Base * (Get-Random -Minimum 0.001 -Maximum 0.003))) * 100)
        $EvRandFactor           = Get-Random -Minimum 1 -Maximum 100
        If($EvRandFactor -LE $TargetEffectiveEvasion) {
            Return [BattleActionResult]@{
                Type            = [BattleActionResultType]::FailedAttackMissed
                Originator      = $Self
                Target          = $Target
                ActionEffectSum = 0
            }
        }

        $EffectiveDamageP1 = [Math]::Round([Math]::Abs(
            $SelfAction.EffectValue * (
                ($Self.Stats[[StatId]::Attack].Base - $Target.Stats[[StatId]::Defense].Base) *
                (1 + ($Self.Stats[[StatId]::Luck].Base - $Target.Stats[[StatId]::Luck].Base))
            ) * (Get-Random -Minimum 0.07 -Maximum 0.15)
        ))
        $EffectiveDamageCritFactor     = 1.0
        $EffectiveDamageAffinityFactor = 1.0

        $CriticalChance = Get-Random -Minimum 1 -Maximum 1000
        If($CriticalChance -LE $Self.Stats[[StatId]::Luck].Base) {
            $EffectiveDamageCritFactor = 1.5
        }

        $EffectiveDamageAffinityFactor = $Script:BATLut[$SelfAction.Type][$Target.Affinity]

        $FinalDamage = [Math]::Round($EffectiveDamageP1 * $EffectiveDamageCritFactor * $EffectiveDamageAffinityFactor)

        [Int]$DecRes = $Target.Stats[[StatId]::HitPoints].DecrementBase(($FinalDamage * -1))

        If(0 -NE $DecRes) {
            Return [BattleActionResultType]@{
                Type            = [BattleActionResultType]::FailedAttackFailed
                Originator      = $Self
                Target          = $Target
                ActionEffectSum = $FinalDamage
            }
        } Else {
            If($Target -IS [Player]) {
                $Script:ThePlayerBattleStatWindow.HpDrawDirty = $true
            } Else {
                $Script:TheEnemyBattleStatWindow.HpDrawDirty = $true
            }

            If($EffectiveDamageCritFactor -GT 1.0 -AND $EffectiveDamageAffinityFactor -EQ 1.0) {
                Return [BattleActionResult]@{
                    Type            = [BattleActionResultType]::SuccessWithCritical
                    Originator      = $Self
                    Target          = $Target
                    ActionEffectSum = $FinalDamage
                }
            } Elseif($EffectiveDamageCritFactor -EQ 1.0 -AND $EffectiveDamageAffinityFactor -GT 1.0) {
                Return [BattleActionResult]@{
                    Type            = [BattleActionResultType]::SuccessWithAffinityBonus
                    Originator      = $Self
                    Target          = $Target
                    ActionEffectSum = $FinalDamage
                }
            } Elseif($EffectiveDamageCritFactor -GT 1.0 -AND $EffectiveDamageAffinityFactor -GT 1.0) {
                Return [BattleActionResult]@{
                    Type            = [BattleActionResultType]::SuccessWithCritAndAffinityBonus
                    Originator      = $Self
                    Target          = $Target
                    ActionEffectSum = $FinalDamage
                }
            }

            Return [BattleActionResult]@{
                Type            = [BattleActionResultType]::Success
                Originator      = $Self
                Target          = $Target
                ActionEffectSum = $FinalDamage
            }
        }
    } Else {
        Return [BattleActionResult]@{
            Type            = [BattleActionResultType]::FailedNoUsesRemaining
            Originator      = $Self
            Target          = $Target
            ActionEffectSum = 0
        }
    }
}





###############################################################################
#
# PLAYER INITIALIZATION
#
###############################################################################
[Player]$Script:ThePlayer = [Player]@{
    Name  = 'Steve'
    Stats = @{
        [StatId]::HitPoints = [BattleEntityProperty]@{
            Base                = 1000
            Max                 = 1000
            ValidateFunction    = {
                Param(
                    [BattleEntityProperty]$Self
                )
                
                Switch($Self.Base) {
                    { $_ -GT ($Self.Max * [BattleEntityProperty]::StatNumThresholdCaution) } {
                        $Self.State = [StatNumberState]::Normal
                        Return
                    }

                    { ($_ -GT ($Self.Max * [BattleEntityProperty]::StatNumThresholdDanger)) -AND ($_ -LT ($Self.Max * [BattleEntityProperty]::StatNumThresholdCaution)) } {
                        $Self.State = [StatNumberState]::Caution
                        Return
                    }

                    { $_ -LT ($Self.Max * [BattleEntityProperty]::StatNumThresholdDanger) } {
                        $Self.State = [StatNumberState]::Danger
                        Return
                    }
                }
            }
        }
        [StatId]::MagicPoints = [BattleEntityProperty]@{
            Base                = 500
            Max                 = 500
            ValidateFunction    = {
                Param(
                    [BattleEntityProperty]$Self
                )
                
                Switch($Self.Base) {
                    { $_ -GT ($Self.Max * [BattleEntityProperty]::StatNumThresholdCaution) } {
                        $Self.State = [StatNumberState]::Normal
                        Return
                    }

                    { ($_ -GT ($Self.Max * [BattleEntityProperty]::StatNumThresholdDanger)) -AND ($_ -LT ($Self.Max * [BattleEntityProperty]::StatNumThresholdCaution)) } {
                        $Self.State = [StatNumberState]::Caution
                        Return
                    }

                    { $_ -LT ($Self.Max * [BattleEntityProperty]::StatNumThresholdDanger) } {
                        $Self.State = [StatNumberState]::Danger
                        Return
                    }
                }
            }
        }
        [StatId]::Attack = [BattleEntityProperty]@{
            Base                = 25
            BasePre             = 25
            BaseAugmentValue    = 5
            Max                 = 15
            MaxPre              = 15
            MaxAugmentValue     = 0
            AugmentTurnDuration = 2
            ValidateFunction    = {
                Param(
                    [BattleEntityProperty]$Self
                )
                
                Return $Self.Base
            }
        }
        [StatId]::Defense = [BattleEntityProperty]@{
            Base                = 8
            Max                 = 8
            ValidateFunction    = {
                Param(
                    [BattleEntityProperty]$Self
                )
                
                Return
            }
        }
        [StatId]::MagicAttack = [BattleEntityProperty]@{
            Base                = 6
            Max                 = 6
            ValidateFunction    = {
                Param(
                    [BattleEntityProperty]$Self
                )
                
                Return
            }
        }
        [StatId]::MagicDefense = [BattleEntityProperty]@{
            Base                = 4
            Max                 = 4
            ValidateFunction    = {
                Param(
                    [BattleEntityProperty]$Self
                )
                
                Return
            }
        }
        [StatId]::Speed = [BattleEntityProperty]@{
            Base                = 9
            Max                 = 9
            ValidateFunction    = {
                Param(
                    [BattleEntityProperty]$Self
                )
                
                Return
            }
        }
        [StatId]::Luck = [BattleEntityProperty]@{
            Base                = 5
            Max                 = 5
            ValidateFunction    = {
                Param(
                    [BattleEntityProperty]$Self
                )
                
                Return
            }
        }
        [StatId]::Accuracy = [BattleEntityProperty]@{
            Base                = 9
            BaseAugmentValue    = -5
            Max                 = 9
            AugmentTurnDuration = 2
            ValidateFunction    = {
                Param(
                    [BattleEntityProperty]$Self
                )
                
                Return
            }
        }
    }
    ActionListing = @{
        [ActionSlot]::A = [BAPunch]::new()
        [ActionSlot]::B = [BAKick]::new()
        [ActionSlot]::C = [BAFlamePunch]::new()
        [ActionSlot]::D = [BAIKill]::new()
    }
    SpoilsEffect    = {}
    ActionMarbleBag = @()
    CurrentGold     = 500
    Affinity        = [BattleActionType]::ElementalFire
}





###############################################################################
#
# GLOBAL STATE BLOCK TABLE DEFINITION
#
###############################################################################
$Script:TheGlobalStateBlockTable = @{
    [GameStatePrimary]::SplashScreenA      = $Script:TheSplashScreenAState
    [GameStatePrimary]::SplashScreenB      = $Script:TheSplashScreenBState
    [GameStatePrimary]::TitleScreen        = $Script:TheTitleScreenState
    [GameStatePrimary]::PlayerSetupScreen  = $Script:ThePlayerSetupState
    [GameStatePrimary]::GamePlayScreen     = $Script:TheGamePlayScreenState
    [GameStatePrimary]::InventoryScreen    = $Script:TheInventoryScreenState
    [GameStatePrimary]::BattleScreen       = $Script:TheBattleScreenState
    [GameStatePrimary]::PlayerStatusScreen = $Script:ThePlayerStatusScreenState
    [GameStatePrimary]::Cleanup            = $Script:TheCleanupState
}





###############################################################################
#
# CONSOLE COLOR 24 CLASS
#
# BASIC 24-BIT COLOR DEFINITION
#
###############################################################################
Class ConsoleColor24 {
    [ValidateRange(0, 255)][Int]$Red
    [ValidateRange(0, 255)][Int]$Green
    [ValidateRange(0, 255)][Int]$Blue

    ConsoleColor24(
        [Int]$Red,
        [Int]$Green,
        [Int]$Blue
    ) {
        $this.Red   = $Red
        $this.Green = $Green
        $this.Blue  = $Blue
    }
}





###############################################################################
#
# CONSOLE COLOR 24 SPECIALIZATIONS
#
###############################################################################
Class CCBlack24 : ConsoleColor24 {
    CCBlack24() : base(0, 0, 0) {}
}

Class CCWhite24 : ConsoleColor24 {
    CCWhite24() : base(255, 255, 255) {}
}

Class CCRed24 : ConsoleColor24 {
    CCRed24() : base(255, 0, 0) {}
}

Class CCGreen24 : ConsoleColor24 {
    CCGreen24() : base(0, 255, 0) {}
}

Class CCBlue24 : ConsoleColor24 {
    CCBlue24() : base (0, 0, 255) {}
}

Class CCYellow24 : ConsoleColor24 {
    CCYellow24() : base(255, 255, 0) {}
}

Class CCDarkYellow24 : ConsoleColor24 {
    CCDarkYellow24() : base(255, 204, 0) {}
}

Class CCDarkCyan24 : ConsoleColor24 {
    CCDarkCyan24() : base(0, 139, 139) {}
}

Class CCDarkGrey24 : ConsoleColor24 {
    CCDarkGrey24() : base(45, 45, 45) {}
}

Class CCRandom24 : ConsoleColor24 {
    CCRandom24() : base($(Get-Random -Maximum 255 -Minimum 0), $(Get-Random -Maximum 255 -Minimum 0), $(Get-Random -Maximum 255 -Minimum 0)) {}
}

Class CCAppleRedLight24 : ConsoleColor24 {
    CCAppleRedLight24() : base(255, 59, 48) {}
}

Class CCAppleRedDark24 : ConsoleColor24 {
    CCAppleRedDark24() : base(255, 69, 58) {}
}

Class CCAppleOrangeLight24 : ConsoleColor24 {
    CCAppleOrangeLight24() : base(255, 149, 0) {}
}

Class CCAppleOrangeDark24 : ConsoleColor24 {
    CCAppleOrangeDark24() : base(255, 159, 10) {}
}

Class CCAppleYellowLight24 : ConsoleColor24 {
    CCAppleYellowLight24() : base(255, 204, 0) {}
}

Class CCAppleYellowDark24 : ConsoleColor24 {
    CCAppleYellowDark24() : base(255, 214, 10) {}
}

Class CCAppleGreenLight24 : ConsoleColor24 {
    CCAppleGreenLight24() : base(52, 199, 89) {}
}

Class CCAppleGreenDark24 : ConsoleColor24 {
    CCAppleGreenDark24() : base(48, 209, 88) {}
}

Class CCAppleMintLight24 : ConsoleColor24 {
    CCAppleMintLight24() : base(0, 199, 190) {}
}

Class CCAppleMintDark24 : ConsoleColor24 {
    CCAppleMintDark24() : base(99, 230, 226) {}
}

Class CCAppleTealLight24 : ConsoleColor24 {
    CCAppleTealLight24() : base(48, 176, 199) {}
}

Class CCAppleTealDark24 : ConsoleColor24 {
    CCAppleTealDark24() : base(64, 200, 224) {}
}

Class CCAppleCyanLight24 : ConsoleColor24 {
    CCAppleCyanLight24() : base(50, 173, 230) {}
}

Class CCAppleCyanDark24 : ConsoleColor24 {
    CCAppleCyanDark24() : base(100, 210, 255) {}
}

Class CCAppleBlueLight24 : ConsoleColor24 {
    CCAppleBlueLight24() : base(0, 122, 255) {}
}

Class CCAppleBlueDark24 : ConsoleColor24 {
    CCAppleBlueDark24() : base(10, 132, 255) {}
}

Class CCAppleIndigoLight24 : ConsoleColor24 {
    CCAppleIndigoLight24() : base(88, 86, 214) {}
}

Class CCAppleIndigoDark24 : ConsoleColor24 {
    CCAppleIndigoDark24() : base(94, 92, 230) {}
}

Class CCApplePurpleLight24 : ConsoleColor24 {
    CCApplePurpleLight24() : base(175, 82, 222) {}
}

Class CCApplePurpleDark24 : ConsoleColor24 {
    CCApplePurpleDark24() : base(191, 90, 242) {}
}

Class CCApplePinkLight24 : ConsoleColor24 {
    CCApplePinkLight24() : base(255, 45, 85) {}
}

Class CCApplePinkDark24 : ConsoleColor24 {
    CCApplePinkDark24() : base(255, 55, 95) {}
}

Class CCAppleBrownLight24 : ConsoleColor24 {
    CCAppleBrownLight24() : base(162, 132, 94) {}
}

Class CCAppleBrownDark24 : ConsoleColor24 {
    CCAppleBrownDark24() : base(172, 142, 104) {}
}

Class CCAppleGrey1Light24 : ConsoleColor24 {
    CCAppleGrey1Light24() : base(142, 142, 147) {}
}

Class CCAppleGrey1Dark24 : ConsoleColor24 {
    CCAppleGrey1Dark24() : base(142, 142, 147) {}
}

Class CCAppleGrey2Light24 : ConsoleColor24 {
    CCAppleGrey2Light24() : base(174, 174, 178) {}
}

Class CCAppleGrey2Dark24 : ConsoleColor24 {
    CCAppleGrey2Dark24() : base(99, 99, 102) {}
}

Class CCAppleGrey3Light24 : ConsoleColor24 {
    CCAppleGrey3Light24() : base(199, 199, 204) {}
}

Class CCAppleGrey3Dark24 : ConsoleColor24 {
    CCAppleGrey3Dark24() : base(72, 72, 74) {}
}

Class CCAppleGrey4Light24 : ConsoleColor24 {
    CCAppleGrey4Light24() : base(209, 209, 214) {}
}

Class CCAppleGrey4Dark24 : ConsoleColor24 {
    CCAppleGrey4Dark24() : base(58, 58, 60) {}
}

Class CCAppleGrey5Light24 : ConsoleColor24 {
    CCAppleGrey5Light24() : base(229, 229, 234) {}
}

Class CCAppleGrey5Dark24 : ConsoleColor24 {
    CCAppleGrey5Dark24() : base(44, 44, 46) {}
}

Class CCAppleGrey6Light24 : ConsoleColor24 {
    CCAppleGrey6Light24() : base(242, 242, 247) {}
}

Class CCAppleGrey6Dark24 : ConsoleColor24 {
    CCAppleGrey6Dark24() : base(28, 28, 30) {}
}

<#
https://www.pantone.com/connect/14-4318-TCX
#>
Class CCPantoneSkyBlue24 : ConsoleColor24 {
    CCPantoneSkyBlue24() : base(54, 73, 83) {}
}
<#
https://www.pantone.com/connect/15-6322-TPX
#>
Class CCPantoneLightGrassGreen24 : ConsoleColor24 {
    CCPantoneLightGrassGreen24() : base(49, 70, 53) {}
}

<#
https://www.pantone.com/connect/19-1218-TCX
#>
Class CCPantonePottingSoil24 : ConsoleColor24 {
    CCPantonePottingSoil24() : base(33, 22, 18) {}
}

<# COLOR VARIATIONS RECENTLY UPDATED FROM APPLE'S DOCUMENTATION #>
<# https://developer.apple.com/design/human-interface-guidelines/color#Specifications #>

Class CCAppleNRedLight24 : ConsoleColor24 {
    CCAppleNRedLight24() : base(255, 59, 48) {}
}

Class CCAppleNRedDark24 : ConsoleColor24 {
    CCAppleNRedDark24() : base(255, 69, 58) {}
}

Class CCAppleNRedALight24 : ConsoleColor24 {
    CCAppleNRedALight24() : base(215, 0, 21) {}
}

Class CCAppleNRedADark24 : ConsoleColor24 {
    CCAppleNRedADark24() : base(255, 105, 97) {}
}

Class CCAppleNOrangeLight24 : ConsoleColor24 {
    CCAppleNOrangeLight24() : base(255, 149, 0) {}
}

Class CCAppleNOrangeDark24 : ConsoleColor24 {
    CCAppleNOrangeDark24() : base(255, 159, 10) {}
}

Class CCAppleNOrangeALight24 : ConsoleColor24 {
    CCAppleNOrangeALight24() : base(201, 52, 0) {}
}

Class CCAppleNOrangeADark24 : ConsoleColor24 {
    CCAppleNOrangeADark24() : base(255, 179, 64) {}
}

Class CCAppleNYellowLight24 : ConsoleColor24 {
    CCAppleNYellowLight24() : base(255, 204, 0) {}
}

Class CCAppleNYellowDark24 : ConsoleColor24 {
    CCAppleNYellowDark24() : base(255, 214, 10) {}
}

Class CCAppleNYellowALight24 : ConsoleColor24 {
    CCAppleNYellowALight24() : base(178, 80, 0) {}
}

Class CCAppleNYellowADark24 : ConsoleColor24 {
    CCAppleNYellowADark24() : base(255, 212, 38) {}
}

Class CCAppleNGreenLight24 : ConsoleColor24 {
    CCAppleNGreenLight24() : base(52, 199, 89) {}
}

Class CCAppleNGreenDark24 : ConsoleColor24 {
    CCAppleNGreenDark24() : base(48, 209, 88) {}
}

Class CCAppleNGreenALight24 : ConsoleColor24 {
    CCAppleNGreenALight24() : base(36, 138, 61) {}
}

Class CCAppleNGreenADark24 : ConsoleColor24 {
    CCAppleNGreenADark24() : base(48, 219, 91) {}
}

Class CCAppleNMintLight24 : ConsoleColor24 {
    CCAppleNMintLight24() : base(0, 199, 190) {}
}

Class CCAppleNMintDark24 : ConsoleColor24 {
    CCAppleNMintDark24() : base(99, 230, 226) {}
}

Class CCAppleNMintALight24 : ConsoleColor24 {
    CCAppleNMintALight24() : base(12, 129, 123) {}
}

Class CCAppleNMintADark24 : ConsoleColor24 {
    CCAppleNMintADark24() : base(102, 212, 207) {}
}

Class CCAppleNTealLight24 : ConsoleColor24 {
    CCAppleNTealLight24() : base(48, 176, 199) {}
}

Class CCAppleNTealDark24 : ConsoleColor24 {
    CCAppleNTealDark24() : base(64, 200, 224) {}
}

Class CCAppleNTealALight24 : ConsoleColor24 {
    CCAppleNTealALight24() : base(0, 130, 153) {}
}

Class CCAppleNTealADark24 : ConsoleColor24 {
    CCAppleNTealADark24() : base(93, 230, 255) {}
}

Class CCAppleNCyanLight24 : ConsoleColor24 {
    CCAppleNCyanLight24() : base(50, 173, 230) {}
}

Class CCAppleNCyanDark24 : ConsoleColor24 {
    CCAppleNCyanDark24() : base(100, 210, 255) {}
}

Class CCAppleNCyanALight24 : ConsoleColor24 {
    CCAppleNCyanALight24() : base(0, 113, 164) {}
}

Class CCAppleNCyanADark24 : ConsoleColor24 {
    CCAppleNCyanADark24() : base(112, 215, 255) {}
}

Class CCAppleNBlueLight24 : ConsoleColor24 {
    CCAppleNBlueLight24() : base(0, 122, 255) {}
}

Class CCAppleNBlueDark24 : ConsoleColor24 {
    CCAppleNBlueDark24() : base(10, 132, 255) {}
}

Class CCAppleNBlueALight24 : ConsoleColor24 {
    CCAppleNBlueALight24() : base(0, 64, 221) {}
}

Class CCAppleNBlueADark24 : ConsoleColor24 {
    CCAppleNBlueADark24() : base(64, 156, 255) {}
}

Class CCAppleNIndigoLight24 : ConsoleColor24 {
    CCAppleNIndigoLight24() : base(88, 86, 214) {}
}

Class CCAppleNIndigoDark24 : ConsoleColor24 {
    CCAppleNIndigoDark24() : base(94, 92, 230) {}
}

Class CCAppleNIndigoALight24 : ConsoleColor24 {
    CCAppleNIndigoALight24() : base(54, 52, 163) {}
}

Class CCAppleNIndigoADark24 : ConsoleColor24 {
    CCAppleNIndigoADark24() : base(125, 122, 255) {}
}

Class CCAppleNPurpleLight24 : ConsoleColor24 {
    CCAppleNPurpleLight24() : base(175, 82, 222) {}
}

Class CCAppleNPurpleDark24 : ConsoleColor24 {
    CCAppleNPurpleDark24() : base(191, 90, 242) {}
}

Class CCAppleNPurpleALight24 : ConsoleColor24 {
    CCAppleNPurpleALight24() : base(137, 68, 171) {}
}

Class CCAppleNPurpleADark24 : ConsoleColor24 {
    CCAppleNPurpleADark24() : base(218, 143, 255) {}
}

Class CCAppleNPinkLight24 : ConsoleColor24 {
    CCAppleNPinkLight24() : base(255, 45, 85) {}
}

Class CCAppleNPinkDark24 : ConsoleColor24 {
    CCAppleNPinkDark24() : base(255, 55, 95) {}
}

Class CCAppleNPinkALight24 : ConsoleColor24 {
    CCAppleNPinkALight24() : base(211, 15, 69) {}
}

Class CCAppleNPinkADark24 : ConsoleColor24 {
    CCAppleNPinkADark24() : base(255, 100, 130) {}
}

Class CCAppleNBrownLight24 : ConsoleColor24 {
    CCAppleNBrownLight24() : base(162, 132, 94) {}
}

Class CCAppleNBrownDark24 : ConsoleColor24 {
    CCAppleNBrownDark24() : base(172, 142, 104) {}
}

Class CCAppleNBrownALight24 : ConsoleColor24 {
    CCAppleNBrownALight24() : base(127, 101, 69) {}
}

Class CCAppleNBrownADark24 : ConsoleColor24 {
    CCAppleNBrownADark24() : base(181, 148, 105) {}
}

Class CCAppleNGreyLight24 : ConsoleColor24 {
    CCAppleNGreyLight24() : base(142, 142, 147) {}
}

Class CCAppleNGreyDark24 : ConsoleColor24 {
    CCAppleNGreyDark24() : base(142, 142, 147) {}
}

Class CCAppleNGreyALight24 : ConsoleColor24 {
    CCAppleNGreyALight24() : base(108, 108, 112) {}
}

Class CCAppleNGreyADark24 : ConsoleColor24 {
    CCAppleNGreyADark24() : base(174, 174, 178) {}
}

Class CCAppleNGrey2Light24 : ConsoleColor24 {
    CCAppleNGrey2Light24() : base(174, 174, 178) {}
}

Class CCAppleNGrey2Dark24 : ConsoleColor24 {
    CCAppleNGrey2Dark24() : base(99, 99, 102) {}
}

Class CCAppleNGrey2ALight24 : ConsoleColor24 {
    CCAppleNGrey2ALight24() : base(142, 142, 147) {}
}

Class CCAppleNGrey2ADark24 : ConsoleColor24 {
    CCAppleNGrey2ADark24() : base(124, 124, 128) {}
}

Class CCAppleNGrey3Light24 : ConsoleColor24 {
    CCAppleNGrey3Light24() : base(199, 199, 204) {}
}

Class CCAppleNGrey3Dark24 : ConsoleColor24 {
    CCAppleNGrey3Dark24() : base(72, 72, 74) {}
}

Class CCAppleNGrey4ALight24 : ConsoleColor24 {
    CCAppleNGrey4ALight24() : base(188, 188, 192) {}
}

Class CCAppleNGrey4ADark24 : ConsoleColor24 {
    CCAppleNGrey4ADark24() : base(68, 68, 70) {}
}

Class CCAppleNGrey5Light24 : ConsoleColor24 {
    CCAppleNGrey5Light24() : base(229, 229, 234) {}
}

Class CCAppleNGrey5Dark24 : ConsoleColor24 {
    CCAppleNGrey5Dark24() : base(44, 44, 46) {}
}

Class CCAppleNGrey5ALight24 : ConsoleColor24 {
    CCAppleNGrey5ALight24() : base(216, 216, 220) {}
}

Class CCAppleNGrey5ADark24 : ConsoleColor24 {
    CCAppleNGrey5ADark24() : base(54, 54, 56) {}
}

Class CCAppleNGrey6Light24 : ConsoleColor24 {
    CCAppleNGrey6Light24() : base(242, 242, 247) {}
}

Class CCAppleNGrey6Dark24 : ConsoleColor24 {
    CCAppleNGrey6Dark24() : base(28, 28, 30) {}
}

Class CCAppleNGrey6ALight24 : ConsoleColor24 {
    CCAppleNGrey6ALight24() : base(235, 235, 240) {}
}

Class CCAppleNGrey6ADark24 : ConsoleColor24 {
    CCAppleNGrey6ADark24() : base(36, 36, 38) {}
}

Class CCAppleVRedLight24 : ConsoleColor24 {
    CCAppleVRedLight24() : base(255, 49, 38) {}
}

Class CCAppleVRedDark24 : ConsoleColor24 {
    CCAppleVRedDark24() : base(255, 79, 68) {}
}

Class CCAppleVRedALight24 : ConsoleColor24 {
    CCAppleVRedALight24() : base(194, 6, 24) {}
}

Class CCAppleVRedADark24 : ConsoleColor24 {
    CCAppleVRedADark24() : base(255, 65, 54) {}
}

Class CCAppleVOrangeLight24 : ConsoleColor24 {
    CCAppleVOrangeLight24() : base(245, 139, 0) {}
}

Class CCAppleVOrangeDark24 : ConsoleColor24 {
    CCAppleVOrangeDark24() : base(255, 169, 20) {}
}

Class CCAppleVOrangeALight24 : ConsoleColor24 {
    CCAppleVOrangeALight24() : base(173, 58, 0) {}
}

Class CCAppleVOrangeADark24 : ConsoleColor24 {
    CCAppleVOrangeADark24() : base(255, 179, 64) {}
}

Class CCAppleVYellowLight24 : ConsoleColor24 {
    CCAppleVYellowLight24() : base(245, 194, 0) {}
}

Class CCAppleVYellowDark24 : ConsoleColor24 {
    CCAppleVYellowDark24() : base(255, 224, 20) {}
}

Class CCAppleVYellowALight24 : ConsoleColor24 {
    CCAppleVYellowALight24() : base(146, 81, 0) {}
}

Class CCAppleVYellowADark24 : ConsoleColor24 {
    CCAppleVYellowADark24() : base(255, 212, 38) {}
}

Class CCAppleVGreenLight24 : ConsoleColor24 {
    CCAppleVGreenLight24() : base(30, 195, 55) {}
}

Class CCAppleVGreenDark24 : ConsoleColor24 {
    CCAppleVGreenDark24() : base(60, 225, 85) {}
}

Class CCAppleVGreenALight24 : ConsoleColor24 {
    CCAppleVGreenALight24() : base(0, 112, 24) {}
}

Class CCAppleVGreenADark24 : ConsoleColor24 {
    CCAppleVGreenADark24() : base(49, 222, 75) {}
}

Class CCAppleVMintLight24 : ConsoleColor24 {
    CCAppleVMintLight24() : base(0, 189, 180) {}
}

Class CCAppleVMintDark24 : ConsoleColor24 {
    CCAppleVMintDark24() : base(108, 224, 219) {}
}

Class CCAppleVMintALight24 : ConsoleColor24 {
    CCAppleVMintALight24() : base(11, 117, 112) {}
}

Class CCAppleVMintADark24 : ConsoleColor24 {
    CCAppleVMintADark24() : base(49, 222, 75) {}
}

Class CCAppleVTealLight24 : ConsoleColor24 {
    CCAppleVTealLight24() : base(46, 167, 189) {}
}

Class CCAppleVTealDark24 : ConsoleColor24 {
    CCAppleVTealDark24() : base(68, 212, 237) {}
}

Class CCAppleVTealALight24 : ConsoleColor24 {
    CCAppleVTealALight24() : base(0, 119, 140) {}
}

Class CCAppleVTealADark24 : ConsoleColor24 {
    CCAppleVTealADark24() : base(93, 230, 255) {}
}

Class CCAppleVCyanLight24 : ConsoleColor24 {
    CCAppleVCyanLight24() : base(65, 175, 220) {}
}

Class CCAppleVCyanDark24 : ConsoleColor24 {
    CCAppleVCyanDark24() : base(90, 205, 250) {}
}

Class CCAppleVCyanALight24 : ConsoleColor24 {
    CCAppleVCyanALight24() : base(0, 103, 150) {}
}

Class CCAppleVCyanADark24 : ConsoleColor24 {
    CCAppleVCyanADark24() : base(112, 215, 255) {}
}

Class CCAppleVBlueLight24 : ConsoleColor24 {
    CCAppleVBlueLight24() : base(0, 122, 245) {}
}

Class CCAppleVBlueDark24 : ConsoleColor24 {
    CCAppleVBlueDark24() : base(20, 142, 255) {}
}

Class CCAppleVBlueALight24 : ConsoleColor24 {
    CCAppleVBlueALight24() : base(0, 64, 221) {}
}

Class CCAppleVBlueADark24 : ConsoleColor24 {
    CCAppleVBlueADark24() : base(64, 156, 255) {}
}

Class CCAppleVIndigoLight24 : ConsoleColor24 {
    CCAppleVIndigoLight24() : base(84, 82, 204) {}
}

Class CCAppleVIndigoDark24 : ConsoleColor24 {
    CCAppleVIndigoDark24() : base(99, 97, 242) {}
}

Class CCAppleVIndigoALight24 : ConsoleColor24 {
    CCAppleVIndigoALight24() : base(54, 52, 163) {}
}

Class CCAppleVIndigoADark24 : ConsoleColor24 {
    CCAppleVIndigoADark24() : base(125, 122, 255) {}
}

Class CCAppleVPurpleLight24 : ConsoleColor24 {
    CCAppleVPurpleLight24() : base(159, 75, 201) {}
}

Class CCAppleVPurpleDark24 : ConsoleColor24 {
    CCAppleVPurpleDark24() : base(204, 101, 255) {}
}

Class CCAppleVPurpleALight24 : ConsoleColor24 {
    CCAppleVPurpleALight24() : base(173, 68, 171) {}
}

Class CCAppleVPurpleADark24 : ConsoleColor24 {
    CCAppleVPurpleADark24() : base(218, 143, 255) {}
}

Class CCAppleVPinkLight24 : ConsoleColor24 {
    CCAppleVPinkLight24() : base(245, 35, 75) {}
}

Class CCAppleVPinkDark24 : ConsoleColor24 {
    CCAppleVPinkDark24() : base(255, 65, 105) {}
}

Class CCAppleVPinkALight24 : ConsoleColor24 {
    CCAppleVPinkALight24() : base(193, 16, 50) {}
}

Class CCAppleVPinkADark24 : ConsoleColor24 {
    CCAppleVPinkADark24() : base(255, 58, 95) {}
}

Class CCAppleVBrownLight24 : ConsoleColor24 {
    CCAppleVBrownLight24() : base(152, 122, 84) {}
}

Class CCAppleVBrownDark24 : ConsoleColor24 {
    CCAppleVBrownDark24() : base(182, 152, 114) {}
}

Class CCAppleVBrownALight24 : ConsoleColor24 {
    CCAppleVBrownALight24() : base(119, 93, 59) {}
}

Class CCAppleVGreyLight24 : ConsoleColor24 {
    CCAppleVGreyLight24() : base(132, 132, 137) {}
}

Class CCAppleVGreyDark24 : ConsoleColor24 {
    CCAppleVGreyDark24() : base(162, 162, 167) {}
}

Class CCAppleVGreyALight24 : ConsoleColor24 {
    CCAppleVGreyALight24() : base(97, 97, 101) {}
}

Class CCAppleVGreyADark24 : ConsoleColor24 {
    CCAppleVGreyADark24() : base(152, 152, 157) {}
}

Class CCPixenSkyBlue24 : ConsoleColor24 {
    CCPixenSkyBlue24() : base(0, 253, 255) {}
}

Class CCPixenGrassDarkGreen24 : ConsoleColor24 {
    CCPixenGrassDarkGreen24() : base(0, 165, 0) {}
}

Class CCPixenRoadDarkBrown24 : ConsoleColor24 {
    CCPixenRoadDarkBrown24() : base(122, 67, 0) {}
}

Class CCPixenGrassLightGreen24 : ConsoleColor24 {
    CCPixenGrassLightGreen24() : base(0, 209, 66) {}
}

Class CCTextDefault24 : CCAppleGrey5Light24 {}

Class CCListItemCurrentHighlight24 : CCAppleNPinkLight24 {}

Class CCWindowBorderDefault24 : CCTextDefault24 {}






###############################################################################
#
# ANSI-TERMINATED STRING SUPPORT
#
# THIS IS WHERE ALL THE MAGIC SAUCE HAPPENS AT. BECAUSE, FUCKERS.
#
###############################################################################

###############################################################################
#
# AT CONTROL SEQUENCES
#
# CONTAINS COMMON ANSI-TERMINATED STRINGS THAT ARE USED THROUGHT THE PROGRAM.
#
###############################################################################
Class ATControlSequences {
    Static [String]$ForegroundColor24Prefix = "`e[38;2;"
    Static [String]$BackgroundColor24Prefix = "`e[48;2;"
    Static [String]$DecorationBlink         = "`e[5m"
    Static [String]$DecorationItalic        = "`e[3m"
    Static [String]$DecorationUnderline     = "`e[4m"
    Static [String]$DecorationStrikethru    = "`e[9m"
    Static [String]$ModifierReset           = "`e[0m"
    Static [String]$CursorHide              = "`e[?25l"
    Static [String]$CursorShow              = "`e[?25h"

    Static [String]GenerateFG24String([ConsoleColor24]$Color) {
        Return "$([ATControlSequences]::ForegroundColor24Prefix)$($Color.Red.ToString());$($Color.Green.ToString());$($Color.Blue.ToString())m"
    }

    Static [String]GenerateBG24String([ConsoleColor24]$Color) {
        Return "$([ATControlSequences]::BackgroundColor24Prefix)$($Color.Red.ToString());$($Color.Green.ToString());$($Color.Blue.ToString())m"
    }

    Static [String]GenerateCoordinateString([Int]$Row, [Int]$Column) {
        Return "`e[$($Row.ToString());$($Column.ToString())H"
    }
}

###############################################################################
#
# AT FOREGROUND COLOR 24
#
# A SYMBOLIC ENCAPSULATION OF CONSOLE COLOR 24 TO BE USED SPECIFICALLY FOR
# FOREGROUND COLOR APPLICATIONS.
#
###############################################################################
Class ATForegroundColor24 {
    [ValidateNotNull()][ConsoleColor24]$Color

    ATForegroundColor24(
        [ConsoleColor24]$Color
    ) {
        $this.Color = $Color
    }

    [String]ToAnsiControlSequenceString() {
        Return [ATControlSequences]::GenerateFG24String($this.Color)
    }
}

###############################################################################
#
# AT FOREGROUND COLOR 24 NONE
#
# AN ABSTRACTION OF AT FOREGROUND COLOR 24 INTENDED TO BE USED TO IMPLY NO
# FOREGROUND COLOR IN THE PRECEEDING STRING LITERAL.
#
###############################################################################
Class ATForegroundColor24None : ATForegroundColor24 {
    ATForegroundColor24None() : base([CCBlack24]::new()) {}

    [String]ToAnsiControlSequenceString() {
        Return ''
    }
}

###############################################################################
#
# AT BACKGROUND COLOR 24
#
# A SYMBOLIC ENCAPSULATION OF CONSOLE COLOR 24 TO BE USED SPECIFICALLY FOR
# BACKGROUND COLOR APPLICATIONS.
#
###############################################################################
Class ATBackgroundColor24 {
    [ValidateNotNull()][ConsoleColor24]$Color

    ATBackgroundColor24(
        [ConsoleColor24]$Color
    ) {
        $this.Color = $Color
    }

    [String]ToAnsiControlSequenceString() {
        Return [ATControlSequences]::GenerateBG24String($this.Color)
    }
}

###############################################################################
#
# AT BACKGROUND COLOR 24 NONE
#
# AN ABSTRACTION OF AT BACKGROUND COLOR 24 INTENDED TO BE USED TO IMPLY NO
# BACKGROUND COLOR IN THE PRECEEDING STRING LITERAL.
#
###############################################################################
Class ATBackgroundColor24None : ATBackgroundColor24 {
    ATBackgroundColor24None() : base([CCBlack24]::new()) {}

    [String]ToAnsiControlSequenceString() {
        Return ''
    }
}

###############################################################################
#
# AT DECORATION
#
# A SYMBOLIC ENCAPSULATION OF ONE OR MANY ANSI DECORATIONS TO APPLY TO A
# PRECEEDING STRING LITERAL.
#
###############################################################################
Class ATDecoration {
    [ValidateNotNull()][Boolean]$Blink
    [ValidateNotNull()][Boolean]$Italic
    [ValidateNotNull()][Boolean]$Underline
    [ValidateNotNull()][Boolean]$Strikethru

    ATDecoration() {
        $this.Blink      = $false
        $this.Italic     = $false
        $this.Underline  = $false
        $this.Strikethru = $false
    }

    [String]ToAnsiControlSequenceString() {
        [String]$a = ''

        If($this.Blink -EQ $true) {
            $a += [ATControlSequences]::DecorationBlink
        }
        If($this.Italic -EQ $true) {
            $a += [ATControlSequences]::DecorationItalic
        }
        If($this.Underline -EQ $true) {
            $a += [ATControlSequences]::DecorationUnderline
        }
        If($this.Strikethru -EQ $true) {
            $a += [ATControlSequences]::DecorationStrikethru
        }

        Return $a
    }
}

###############################################################################
#
# AT COORDINATES NONE
#
# AN ABSTRACTION OF AT DECORATION INTENDED TO IMPLY NO ANSI DECORATORS BE
# APPLIED TO THE PRECEEDING STRING LITERAL.
#
###############################################################################
Class ATDecorationNone : ATDecoration {
    ATDecorationNone() : base() {}

    [String]ToAnsiControlSequenceString() {
        Return ''
    }
}

###############################################################################
#
# AT COORDINATES
#
# A SYMBOLIC ENCAPSULATION OF A COORDINATE PAIR IN ROW,COLUMN (Y,X) ORDER.
#
###############################################################################
Class ATCoordinates {
    [ValidateNotNull()][Int]$Row
    [ValidateNotNull()][Int]$Column

    ATCoordinates() {
        $this.Row    = 1
        $this.Column = 1
    }

    ATCoordinates(
        [Int]$Row,
        [Int]$Column
    ) {
        $this.Row    = $Row
        $this.Column = $Column
    }

    ATCoordinates(
        [Coordinates]$AutomationCoordinates
    ) {
        $this.Row    = $AutomationCoordinates.X
        $this.Column = $AutomationCoordinates.Y
    }

    ATCoordinates(
        [ATCoordinates]$CopyFrom
    ) {
        $this.Row    = $CopyFrom.Row
        $this.Column = $CopyFrom.Column
    }

    [String]ToAnsiControlSequenceString() {
        Return [ATControlSequences]::GenerateCoordinateString($this.Row, $this.Column)
    }

    [Coordinates]ToAutomationCoordinates() {
        Return [Coordinates]::new($this.Row, $this.Column)
    }
}

###############################################################################
#
# AT COORDINATES NONE
#
# AN ABSTRACTION OF AT COORDINATES INTENDED TO IMPLY NO ANSI COORDINATE
# MODIFIER BE APPLIED TO THE PRECEEDING STRING LITERAL.
#
###############################################################################
Class ATCoordinatesNone : ATCoordinates {
    ATCoordinatesNone() : base(0, 0) {}

    [String]ToAnsiControlSequenceString() {
        Return ''
    }
}

###############################################################################
#
# AT COORDINATES DEFAULT
#
# AN ABSTRACTION OF AT COORDINATES INTENDED TO IMPLY AN ANSI COORDINATE
# MODIFIER BE APPLIED TO THE PRECEEDING STRING LITERAL THAT MOVES THE CURSOR TO
# A "DEFAULT" LOCATION.
#
###############################################################################
Class ATCoordinatesDefault : ATCoordinates {
    ATCoordinatesDefault() : base(1, 18) {}
}

###############################################################################
#
# AT STRING PREFIX
#
# AN AGGREGATE OF SEVERAL ANSI MODIFIERS THAT COLLECTIVELY MODIFY A PRECEEDING
# STRING LITERAL.
#
###############################################################################
Class ATStringPrefix {
    [ValidateNotNull()][ATForegroundColor24]$ForegroundColor
    [ValidateNotNull()][ATBackgroundColor24]$BackgroundColor
    [ValidateNotNull()][ATDecoration]$Decorations
    [ValidateNotNull()][ATCoordinates]$Coordinates

    ATStringPrefix() {
        $this.ForegroundColor = [ATForegroundColor24None]::new()
        $this.BackgroundColor = [ATBackgroundColor24None]::new()
        $this.Decorations     = [ATDecorationNone]::new()
        $this.Coordinates     = [ATCoordinatesNone]::new()
    }

    ATStringPrefix(
        [ATForegroundColor24]$ForegroundColor,
        [ATBackgroundColor24]$BackgroundColor,
        [ATDecoration]$Decorations,
        [ATCoordinates]$Coordinates
    ) {
        $this.ForegroundColor = $ForegroundColor
        $this.BackgroundColor = $BackgroundColor
        $this.Decorations     = $Decorations
        $this.Coordinates     = $Coordinates
    }

    [String]ToAnsiControlSequenceString() {
        Return "$($this.Coordinates.ToAnsiControlSequenceString())$($this.Decorations.ToAnsiControlSequenceString())$($this.ForegroundColor.ToAnsiControlSequenceString())$($this.BackgroundColor.ToAnsiControlSequenceString())"
    }
}

###############################################################################
#
# AT STRING PREFIX NONE
#
# AN ABSTRACTION OF AT STRING PREFIX INTENDED TO IMPLY NO ANSI MODIFIERS BE
# APPLIED TO A PRECEEDING STRING LITERAL.
#
###############################################################################
Class ATStringPrefixNone : ATStringPrefix {
    ATStringPrefixNone() : base() {}

    [String]ToAnsiControlSequenceString() {
        Return ''
    }
}

###############################################################################
#
# AT STRING
#
# AN AGGREGATE THAT COMBINES AN AT STRING PREFIX, A TARGET STRING LITERAL TO
# APPLY THE ANSI MODIFIERS TO, AND AN OPTIONAL ANSI RESET MODIFIER TO APPEND
# TO THE RESULTANT STRING ENSURING THE MODIFIERS FROM THE PREFIX AREN'T CARRIED
# BEYOND THE LENGTH OF THE LITERAL.
#
###############################################################################
Class ATString {
    [ValidateNotNull()][ATStringPrefix]$Prefix
    [ValidateNotNull()][String]$UserData
    [ValidateNotNull()][Boolean]$UseATReset

    ATString() {
        $this.Prefix     = [ATStringPrefixNone]::new()
        $this.UserData   = ''
        $this.UseATReset = $false
    }

    ATString(
        [ATStringPrefix]$Prefix,
        [String]$UserData,
        [Boolean]$UseATReset
    ) {
        $this.Prefix     = $Prefix
        $this.UserData   = $UserData
        $this.UseATReset = $UseATReset
    }

    [String]ToAnsiControlSequenceString() {
        [String]$a = "$($this.Prefix.ToAnsiControlSequenceString())$($this.UserData)"

        If($this.UseATReset -EQ $true) {
            $a += [ATControlSequences]::ModifierReset
        }

        Return $a
    }
}

###############################################################################
#
# AT STRING NONE
#
# AN ABSTRACTION OF AT STRING INTENDED TO IMPLY NO AT STRING BE USED. THIS
# CLASS IS GENERALLY USED AS A SANE DEFAULT INITIALIZATION POINT FOR WHAT WOULD
# EVENTUALLY BE PROPER AT STRING INSTANCES.
#
###############################################################################
Class ATStringNone : ATString {
    ATStringNone() : base() {}

    [String]ToAnsiControlSequenceString() {
        Return ''
    }
}

###############################################################################
#
# AT STRING COMPOSITE
#
# AN AGGREGATE OF AT STRING INSTANCES IN A COLLECTION. THIS CLASS PERMITS FOR
# PRETTY COMPLEX DISPLAYS BY COMBINING MULTIPLE INDEPENDENT AT STRING INSTANCES
# INTO ONE.
#
###############################################################################
Class ATStringComposite {
    [List[ATString]]$CompositeActual = [List[ATString]]::new()

    ATStringComposite() {
        If($null -EQ $this.CompositeActual) {
            $this.CompositeActual = [List[ATString]]::new()
        }

        $this.CompositeActual.Add([ATStringNone]::new()) | Out-Null
    }

    ATStringComposite(
        [ATString[]]$Components
    ) {
        If($null -EQ $this.CompositeActual) {
            $this.CompositeActual = [List[ATString]]::new()
        }

        Foreach($a in $Components) {
            $this.CompositeActual.Add($a) | Out-Null
        }
    }

    ATStringComposite(
        [List[ATString]]$Components
    ) {
        $this.CompositeActual = $Components
    }

    [String]ToAnsiControlSequenceString() {
        [String]$a = ''

        Foreach($b in $this.CompositeActual) {
            $a += $b.ToAnsiControlSequenceString()
        }

        Return $a
    }
}

###############################################################################
#
# AT SCENE IMAGE STRING
#
# AN ABSTRACTION OF AT STRING INTENDED TO BE USED FOR GENERATING "IMAGES". THIS
# CLASS SHORTCUTS MOST PROPERTIES OF AT STRING AND AT STRING PREFIX EXCEPT FOR
# BACKGROUND COLOR AND COORDINATES.
#
###############################################################################
Class ATSceneImageString : ATString {
    Static [String]$SceneImageBlank = ' '

    ATSceneImageString(
        [ATBackgroundColor24]$BackgroundColor,
        [ATCoordinates]$Coordinates
    ) : base() {
        $this.Prefix = [ATStringPrefix]::new(
            [ATForegroundColor24None]::new(),
            $BackgroundColor,
            [ATDecorationNone]::new(),
            $Coordinates
        )
        $this.UserData   = [ATSceneImageString]::SceneImageBlank
        $this.UseATReset = $true
    }
}





###############################################################################
#
# BATTLE ENGINE SUPPORT
#
# CLASSES THAT DEFINE INTERACTIONS THAT FACILITATE THE COMBAT SYSTEM. GENERAL
# CLASSES ARE INCLUDED IN HERE AS WELL AS BEING "IN-SCOPE".
#
###############################################################################

###############################################################################
#
# BATTLE ENTITY PROPERTY
#
# DESCRIBES A PROPERTY OF A BATTLE ENTITY. THIS IS A NUMERIC VALUE THAT HAS A
# MINIMUM AND MAXIMUM, SUPPORTS TEMPORARY AUGMENTATION, AND IS CAPABLE OF
# MAINTAINING ITS OWN STATE.
#
###############################################################################
Class BattleEntityProperty {
    Static [Single]$StatNumThresholdCaution          = 0.6D
    Static [Single]$StatNumThresholdDanger           = 0.3D
    Static [ConsoleColor24]$StatNumDrawColorSafe     = [CCAppleGreenLight24]::new()
    Static [ConsoleColor24]$StatNumDrawColorCaution  = [CCAppleYellowLight24]::new()
    Static [ConsoleColor24]$StatNumDrawColorDanger   = [CCAppleRedLight24]::new()
    Static [ConsoleColor24]$StatAugDrawColorPositive = [CCAppleCyanLight24]::new()
    Static [ConsoleColor24]$StatAugDrawColorNegative = [CCApplePurpleDark24]::new()

    [Int]$Base
    [Int]$BasePre
    [Int]$BaseAugmentValue
    [Int]$Max
    [Int]$MaxPre
    [Int]$MaxAugmentValue
    [Int]$AugmentTurnDuration
    [Boolean]$BaseAugmentActive
    [Boolean]$MaxAugmentActive
    [StatNumberState]$State
    [ScriptBlock]$ValidateFunction

    BattleEntityProperty() {
        $this.Base                = 0
        $this.BasePre             = 0
        $this.BaseAugmentValue    = 0
        $this.Max                 = 0
        $this.MaxPre              = 0
        $this.MaxAugmentValue     = 0
        $this.AugmentTurnDuration = 0
        $this.BaseAugmentActive   = $false
        $this.MaxAugmentActive    = $false
        $this.State               = [StatNumberState]::Normal
        $this.ValidateFunction    = $null
    }

    # THIS CTOR CAN LIKELY GO AWAY
    # BattleEntityProperty(
    #     [Int]$Base,
    #     [Int]$BasePre,
    #     [Int]$BaseAugmentValue,
    #     [Int]$Max,
    #     [Int]$MaxPre,
    #     [Int]$MaxAugmentValue,
    #     [Int]$AugmentTurnDuration,
    #     [Boolean]$BaseAugmentActive,
    #     [Boolean]$MaxAugmentActive,
    #     [StatNumberState]$State,
    #     [ScriptBlock]$ValidateFunction
    # ) {
    #     $this.Base                = $Base
    #     $this.BasePre             = $BasePre
    #     $this.BaseAugmentValue    = $BaseAugmentValue
    #     $this.Max                 = $Max
    #     $this.MaxPre              = $MaxPre
    #     $this.MaxAugmentValue     = $MaxAugmentValue
    #     $this.AugmentTurnDuration = $AugmentTurnDuration
    #     $this.BaseAugmentActive   = $BaseAugmentActive
    #     $this.MaxAugmentActive    = $MaxAugmentActive
    #     $this.State               = $State
    #     $this.ValidateFunction    = $ValidateFunction
    # }

    [Void]Update() {
        If($this.AugmentTurnDuration -GT 0) {
            $this.AugmentTurnDuration--
            If($this.BasePre -EQ 0) {
                $this.BasePre = $this.Base
            }
            If($this.MaxPre -EQ 0) {
                $this.MaxPre = $this.Max
            }
            If($this.MaxAugmentActive -EQ $false) {
                [Int]$t                = $this.Max + $this.MaxAugmentValue
                $t                     = [Math]::Clamp($t, 0, [Int]::MaxValue)
                $this.Max              = $t
                $this.MaxAugmentActive = $true
            }
            If($this.BaseAugmentActive -EQ $false) {
                [Int]$t                 = $this.Base + $this.BaseAugmentValue
                $t                      = [Math]::Clamp($t, 0, [Int]::MaxValue)
                $this.Base              = $t
                $this.BaseAugmentActive = $true
            }
        } Else {
            If($this.MaxAugmentActive -EQ $true) {
                $this.Max              = $this.MaxPre
                $this.MaxPre           = 0
                $this.MaxAugmentActive = $false
            }
            If($this.BaseAugmentActive -EQ $true) {
                $this.Base              = $this.BasePre
                $this.BasePre           = 0
                $this.BaseAugmentActive = $false
            }
        }

        Invoke-Command $this.ValidateFunction -ArgumentList $this
    }

    <#
    .OUTPUTS
    Integer
        -1 - The value of IncAmt is less than or equal to zero.
        -2 - The value of Base is equal to Max (no need to increment Base at this point)
        0  - Base was successfully incremented by IncAmt
    #>
    [Int]IncrementBase(
        [Int]$IncAmt
    ) {
        If($IncAmt -LE 0) {
            Return -1
        }
        If($this.Base -EQ $this.Max) {
            Return -2
        }
        [Int]$t    = $this.Base + $IncAmt
        $t         = [Math]::Clamp($t, 0, $this.Max) # This should work regardless if BaseAugmentActive = true
        $this.Base = $t

        Return 0
    }

    <#
    .OUTPUTS
    Integer
        -1 - The value of DecAmt is greater than or equal to zero.
        -2 - The value of Base is less than or equal to zero.
        0  - Base was successfully decremented by DecAmt.
    #>
    [Int]DecrementBase(
        [Int]$DecAmt
    ) {
        If($DecAmt -GE 0) {
            Return -1
        }
        If($this.Base -LE 0) {
            Return -2
        }
        [Int]$t    = $this.Base + $DecAmt
        $t         = [Math]::Clamp($t, 0, $this.Max)
        $this.Base = $t
        
        Return 0
    }

    <# 
    .OUTPUTS
    Integer
        -1 - The value of IncAmt is less than or equal to zero.
        0  - Max was successfully incremented by IncAmt.
    #>
    [Int]IncrementMax(
        [Int]$IncAmt
    ) {
        If($IncAmt -LE 0) {
            Return -1
        }
        $this.Max += $IncAmt

        Return 0
    }

    <#
    .OUTPUTS
    Integer
        -1 - The value of DecAmt is greater than or equal to zero.
        0  - Max was successfully decremented by DecAmt.
    #>
    [Int]DecrementMax(
        [Int]$DecAmt
    ) {
        If($DecAmt -GE 0) {
            Return -1
        }
        [Int]$t   = $this.Max - $DecAmt
        $t        = [Math]::Clamp($t, 0, [Int]::MaxValue)
        $this.Max = $t
        If($this.Max -LT $this.Base) {
            $this.Base = $this.Max
        }

        Return 0
    }
}

###############################################################################
#
# BATTLE ACTION
#
# DESCRIBES AN ACTION THAT AN ENTITY CAN TAKE IN BATTLE. ACTIONS GENERALLY ARE
# CAPABLE OF DETERMINING THEIR OWN DAMAGE RESULT AND CAN RUN ROUTINES BEFORE AND
# AFTER SAID CALCULATIONS.
#
###############################################################################
Class BattleAction {
    [String]$Name
    [ScriptBlock]$Effect
    [ScriptBlock]$PreCalc
    [ScriptBlock]$PostCalc
    [BattleActionType]$Type
    [Int]$MpCost
    [Int]$EffectValue
    [Single]$Chance
    [String]$Description

    BattleAction() {
        $this.Name        = ''
        $this.Type        = [BattleActionType]::None
        $this.Effect      = $Script:BaCalc
        $this.PreCalc     = $null
        $this.PostCalc    = $null
        $this.EffectValue = 0
        $this.Chance      = 0.0
        $this.Description = ''
    }

    # IT'S UNLIKELY THAT ANY OF THESE CTORS ARE NEEDED
    # BattleAction(
    #     [String]$Name,
    #     [BattleActionType]$Type,
    #     [ScriptBlock]$Effect,
    #     [Int]$Uses,
    #     [Int]$EffectValue,
    #     [Single]$Chance
    # ) {
    #     $this.Name        = $Name
    #     $this.Type        = $Type
    #     $this.Effect      = $Effect
    #     $this.PreCalc     = {}
    #     $this.PostCalc    = {}
    #     $this.EffectValue = $EffectValue
    #     $this.Chance      = $Chance
    #     $this.Description = ''
    # }

    # BattleAction(
    #     [String]$Name,
    #     [String]$Description,
    #     [BattleActionType]$Type,
    #     [ScriptBlock]$Effect,
    #     [Int]$Uses,
    #     [Int]$UsesMax,
    #     [Int]$EffectValue,
    #     [Single]$Chance
    # ) {
    #     $this.Name        = $Name
    #     $this.Type        = $Type
    #     $this.Effect      = $Effect
    #     $this.PreCalc     = {}
    #     $this.PostCalc    = {}
    #     $this.EffectValue = $EffectValue
    #     $this.Chance      = $Chance
    #     $this.Description = $Description
    # }

    # BattleAction(
    #     [String]$Name,
    #     [String]$Description,
    #     [BattleActionType]$Type,
    #     [ScriptBlock]$Effect,
    #     [Int]$MpCost,
    #     [Int]$EffectValue,
    #     [Single]$Chance
    # ) {
    #     $this.Name        = $Name
    #     $this.Type        = $Type
    #     $this.Effect      = $Effect
    #     $this.PreCalc     = {}
    #     $this.PostCalc    = {}
    #     $this.MpCost      = $MpCost
    #     $this.EffectValue = $EffectValue
    #     $this.Chance      = $Chance
    #     $this.Description = $Description
    # }

    # THIS CTOR IS NEEDED BECAUSE POWERSHELL ASSIGNMENT IS BY REFERENCE
    # THANKS C++
    BattleAction(
        [BattleAction]$Copy
    ) {
        $this.Name        = $Copy.Name
        $this.Type        = $Copy.Type
        $this.Effect      = $Copy.Effect
        $this.PreCalc     = $Copy.PreCalc
        $this.PostCalc    = $Copy.PostCalc
        $this.MpCost      = $Copy.MpCost
        $this.EffectValue = $Copy.EffectValue
        $this.Chance      = $Copy.Chance
        $this.Description = $Copy.Description
    }
}





###############################################################################
#
# BATTLE ACTION RESULT
#
###############################################################################
Class BattleActionResult {
    [Int]$ActionEffectSum
    [BattleEntity]$Originator
    [BattleEntity]$Target
    [BattleActionResultType]$Type

    BattleActionResult() {
        $this.ActionEffectSum = 0
        $this.Originator      = $null
        $this.Target          = $null
        $this.Type            = [BattleActionResultType]::Success
    }
}






###############################################################################
#
# SPECIALIZED BATTLE ACTION CLASSES
#
# THESE SPECIALIZATIONS DEFINE ACTUAL ACTIONS THE PLAYER ENTITY OR ANY ENEMY
# ENTITY CAN USE. EACH CLASS, UPON READING THE PROPERTY VALUES, IS
# SELF-DOCUMENTING AND WILL CONSEQUENTLY NOT BE DOCUMENTED INDEPENDENTLY.
#
# IT'S ALSO WORTH NOTING TOO THAT THE VALUES ASSIGNED TO SOME OF THESE
# PROPERTIES HAVEN'T YET BEEN TESTED AND ARE SUBJECT TO CHANGE UPON FURTHER
# REFINEMENT. THIS MAY PRESENT A GOOD OPPORTUNITY FOR A TEST SUITE.
#
###############################################################################
Class BAPunch : BattleAction {
    BAPunch() : base() {
        $this.Name        = 'Punch'
        $this.Description = 'A punch. Just like dad taught you.'
        $this.Type        = [BattleActionType]::Physical
        # $this.Effect      = $Script:BaPhysicalCalc
        $this.MpCost      = 0
        $this.EffectValue = 50
        $this.Chance      = 1.0
    }
}

Class BAKick : BattleAction {
    BAKick() : base() {
        $this.Name        = 'Kick'
        $this.Description = 'A kick. Don''t stub your toe.'
        $this.Type        = [BattleActionType]::Physical
        # $this.Effect      = $Script:BaPhysicalCalc
        $this.MpCost      = 0
        $this.EffectValue = 50
        $this.Chance      = 1.0
    }
}

Class BAKarateChop : BattleAction {
    BAKarateChop() : base() {
        $this.Name        = 'Karate Chop'
        $this.Description = 'Test your might!'
        $this.Type        = [BattleActionType]::Physical
        # $this.Effect      = $Script:BaPhysicalCalc
        $this.MpCost      = 0
        $this.EffectValue = 60
        $this.Chance      = 0.8
    }
}

Class BAKarateKick : BattleAction {
    BAKarateKick() : base() {
        $this.Name        = 'Karate Kick'
        $this.Description = 'I hope your shins are fit.'
        $this.Type        = [BattleActionType]::Physical
        # $this.Effect      = $Script:BAPhysicalCalc
        $this.MpCost      = 0
        $this.EffectValue = 65
        $this.Chance      = 0.75
    }
}

Class BABash : BattleAction {
    BABash() : base() {
        $this.Name        = 'Bash'
        $this.Description = 'HULK SMASH!'
        $this.Type        = [BattleActionType]::Physical
        # $this.Effect      = $Script:BaPhysicalCalc
        $this.MpCost      = 0
        $this.EffectValue = 75
        $this.Chance      = 0.7
    }
}

Class BABite : BattleAction {
    BABite() : base() {
        $this.Name        = 'Bite'
        $this.Description = 'When fists fail, teeth do just fine.'
        $this.Type        = [BattleActionType]::Physical
        # $this.Effect      = $Script:BaPhysicalCalc
        $this.MpCost      = 0
        $this.EffectValue = 40
        $this.Chance      = 0.9
    }
}

Class BAScratch : BattleAction {
    BAScratch() : base() {
        $this.Name        = 'Scratch'
        $this.Description = 'Nails are sometimes useful.'
        $this.Type        = [BattleActionType]::Physical
        # $this.Effect      = $Script:BaPhysicalCalc
        $this.MpCost      = 0
        $this.EffectValue = 45
        $this.Chance      = 1.0
    }
}

Class BADoubleScratch : BattleAction {
    BADoubleScratch() : base() {
        $this.Name        = 'Double Scratch'
        $this.Description = 'The manicure on these is lethal.'
        $this.Type        = [BattleActionType]::Physical
        # $this.Effect      = $Script:BaPhysicalCalc
        $this.MpCost      = 0
        $this.EffectValue = 85
        $this.Chance      = 0.75
    }
}

Class BAHeadbutt : BattleAction {
    BAHeadbutt() : base() {
        $this.Name        = 'Headbutt'
        $this.Description = 'Put that noggin'' to work!'
        $this.Type        = [BattleActionType]::Physical
        # $this.Effect      = $Script:BaPhysicalCalc
        $this.MpCost      = 0
        $this.EffectValue = 160
        $this.Chance      = 0.4
    }
}

Class BADropKick : BattleAction {
    BADropKick() : base() {
        $this.Name        = 'Dropkick'
        $this.Description = 'Don''t use this on Murphy.'
        $this.Type        = [BattleActionType]::Physical
        # $this.Effect      = $Script:BaPhysicalCalc
        $this.MpCost      = 0
        $this.EffectValue = 120
        $this.Chance      = 0.3
    }
}

Class BAThrow : BattleAction {
    BAThrow() : base() {
        $this.Name        = 'Throw'
        $this.Description = 'One man''s trash is a useful weapon.'
        $this.Type        = [BattleActionType]::Physical
        # $this.Effect      = $Script:BaPhysicalCalc
        $this.MpCost      = 0
        $this.EffectValue = 0
        $this.Chance      = 0.9
    }
}

Class BAPeck : BattleAction {
    BAPeck() : base() {
        $this.Name        = 'Peck'
        $this.Description = 'One from Grandma usually means cookies later.'
        $this.Type        = [BattleActionType]::Physical
        # $this.Effect      = $Script:BaPhysicalCalc
        $this.MpCost      = 0
        $this.EffectValue = 20
        $this.Chance      = 1.0
    }
}

Class BATalonStab : BattleAction {
    BATalonStab() : base() {
        $this.Name        = 'Talon Stab'
        $this.Description = 'You don''t want a hug from these.'
        $this.Type        = [BattleActionType]::Physical
        # $this.Effect      = $Script:BaPhysicalCalc
        $this.MpCost      = 0
        $this.EffectValue = 70
        $this.Chance      = 1.0
    }
}

Class BASwordSlash : BattleAction {
    BASwordSlash() : base() {
        $this.Name        = 'Sword Slash'
        $this.Description = 'A basic sword attack.'
        $this.Type        = [BattleActionType]::Physical
        # $this.Effect      = $Script:BaPhysicalCalc
        $this.MpCost      = 0
        $this.EffectValue = 60
        $this.Chance      = 1.0
    }
}

Class BASwordStab : BattleAction {
    BASwordStab() : base() {
        $this.Name        = 'Sword Stab'
        $this.Description = 'This was practiced with toothpicks.'
        $this.Type        = [BattleActionType]::Physical
        # $this.Effect      = $Script:BaPhysicalCalc
        $this.MpCost      = 0
        $this.EffectValue = 80
        $this.Chance      = 0.7
    }
}

Class BAAxeSlash : BattleAction {
    BAAxeSlash() : base() {
        $this.Name        = 'Axe Slash'
        $this.Description = 'Chopping trees pays off.'
        $this.Type        = [BattleActionType]::Physical
        # $this.Effect      = $Script:BaPhysicalCalc
        $this.MpCost      = 0
        $this.EffectValue = 70
        $this.Chance      = 1.0
    }
}

Class BAAxeCleave : BattleAction {
    BAAxeCleave() : base() {
        $this.Name        = 'Axe Cleave'
        $this.Description = 'Before his fury, the trees stood no chance.'
        $this.Type        = [BattleActionType]::Physical
        # $this.Effect      = $Script:BaPhysicalCalc
        $this.MpCost      = 0
        $this.EffectValue = 90
        $this.Chance      = 0.8
    }
}

Class BAAxeThrow : BattleAction {
    BAAxeThrow() : base() {
        $this.Name        = 'Axe Throw'
        $this.Description = 'Don''t let one hit you on the way out.'
        $this.Type        = [BattleActionType]::Physical
        # $this.Effect      = $Script:BaPhysicalCalc
        $this.MpCost      = 0
        $this.EffectValue = 180
        $this.Chance      = 0.3
    }
}

Class BAKnifeStab : BattleAction {
    BAKnifeStab() : base() {
        $this.Name        = 'Knife Stab'
        $this.Description = 'Just a little prick, right?'
        $this.Type        = [BattleActionType]::Physical
        # $this.Effect      = $Script:BaPhysicalCalc
        $this.MpCost      = 0
        $this.EffectValue = 40
        $this.Chance      = 0.9
    }
}

Class BAKnifeThrow : BattleAction {
    BAKnifeThrow() : base() {
        $this.Name        = 'Knife Throw'
        $this.Description = 'Like throwing darts, but cooler.'
        $this.Type        = [BattleActionType]::Physical
        # $this.Effect      = $Script:BaPhysicalCalc
        $this.MpCost      = 0
        $this.EffectValue = 80
        $this.Chance      = 0.3
    }
}

Class BAClubSwing : BattleAction {
    BAClubSwing() : base() {
        $this.Name        = 'Club Swing'
        $this.Description = 'Me Ooga. Me swing-um big-um stick.'
        $this.Type        = [BattleActionType]::Physical
        # $this.Effect      = $Script:BaPhysicalCalc
        $this.MpCost      = 0
        $this.EffectValue = 70
        $this.Chance      = 0.7
    }
}

Class BAHomerunHit : BattleAction {
    BAHomerunHit() : base() {
        $this.Name        = 'Homerun Hit'
        $this.Description = 'Swing, batter... SWING!'
        $this.Type        = [BattleActionType]::Physical
        # $this.Effect      = $Script:BaPhysicalCalc
        $this.MpCost      = 0
        $this.EffectValue = 200
        $this.Chance      = 0.1
    }
}

Class BAFlamePunch : BattleAction {
    BAFlamePunch() : base() {
        $this.Name        = 'Flame Punch'
        $this.Description = 'Flaming fists of fury.'
        $this.Type        = [BattleActionType]::ElementalFire
        # $this.Effect      = $Script:BaElementalFireCalc
        $this.MpCost      = 5
        $this.EffectValue = 75
        $this.Chance      = 1.0
    }
}

Class BAFlameKick : BattleAction {
    BAFlameKick() : base() {
        $this.Name        = 'Flame Kick'
        $this.Description = 'I got channed heat on my heels.'
        $this.Type        = [BattleActionType]::ElementalFire
        # $this.Effect      = $Script:BaElementalFireCalc
        $this.MpCost      = 5
        $this.EffectValue = 85
        $this.Chance      = 0.9
    }
}

Class BAFireball : BattleAction {
    BAFireball() : base() {
        $this.Name        = 'Fireball'
        $this.Description = 'That''s a spicy meatball!'
        $this.Type        = [BattleActionType]::ElementalFire
        # $this.Effect      = $Script:BaElementalFireCalc
        $this.MpCost      = 7
        $this.EffectValue = 80
        $this.Chance      = 0.75
    }
}

Class BAMortarToss : BattleAction {
    BAMortarToss() : base() {
        $this.Name        = 'Mortar Toss'
        $this.Description = 'An esploozshun of firez.'
        $this.Type        = [BattleActionType]::ElementalFire
        # $this.Effect      = $Script:BaElementalFireCalc
        $this.MpCost      = 9
        $this.EffectValue = 100
        $this.Chance      = 0.7
    }
}

Class BAIKill : BattleAction {
    BAIKill() : base() {
        $this.Name        = 'IKill'
        $this.Description = 'Insta death'
        $this.Type        = [BattleActionType]::ElementalFire
        # $this.Effect      = $Script:BaElementalFireCalc
        $this.MpCost      = 0
        $this.EffectValue = 50000
        $this.Chance      = 1.0
    }
}

Class BABlazeBurst : BattleAction {
    BABlazeBurst() : base() {
        $this.Name        = 'Blaze Burst'
        $this.Description = 'Like an arc flash, only worse.'
        $this.Type        = [BattleActionType]::ElementalFire
        # $this.Effect      = $Script:BaElementalFireCalc
        $this.MpCost      = 10
        $this.EffectValue = 80
        $this.Chance      = 0.8
    }
}

Class BAFlamethrower : BattleAction {
    BAFlamethrower() : base() {
        $this.Name        = 'Flamethrower'
        $this.Description = 'Our inspiration was Elon.'
        $this.Type        = [BattleActionType]::ElementalFire
        # $this.Effect      = $Script:BaElementalFireCalc
        $this.MpCost      = 10
        $this.EffectValue = 90
        $this.Chance      = 0.7
    }
}

Class BAEmberSlash : BattleAction {
    BAEmberSlash() : base() {
        $this.Name        = 'Ember Slash'
        $this.Description = 'At least the wound is cauterized.'
        $this.Type        = [BattleActionType]::ElementalFire
        # $this.Effect      = $Script:BaElementalFireCalc
        $this.MpCost      = 5
        $this.EffectValue = 80
        $this.Chance      = 0.9
    }
}

Class BAPyroblast : BattleAction {
    BAPyroblast() : base() {
        $this.Name        = 'Pyroblast'
        $this.Description = 'Fireworks never looked so good.'
        $this.Type        = [BattleActionType]::ElementalFire
        # $this.Effect      = $Script:BaElementalFireCalc
        $this.MpCost      = 15
        $this.EffectValue = 110
        $this.Chance      = 0.6
    }
}

Class BAAshenNova : BattleAction {
    BAAshenNova() : base() {
        $this.Name        = 'Ashen Nova'
        $this.Description = 'Reminds me of Pompeii. Only worse.'
        $this.Type        = [BattleActionType]::ElementalFire
        # $this.Effect      = $Script:BaElementalFireCalc
        $this.MpCost      = 50
        $this.EffectValue = 250
        $this.Chance      = 0.5
    }
}

Class BAIncenerate : BattleAction {
    BAIncenerate() : base() {
        $this.Name        = 'Incenerate'
        $this.Description = 'Kill it with fire, they said.'
        $this.Type        = [BattleActionType]::ElementalFire
        # $this.Effect      = $Script:BaElementalFireCalc
        $this.MpCost      = 20
        $this.EffectValue = 120
        $this.Chance      = 0.7
    }
}

Class BACinderStorm : BattleAction {
    BACinderStorm() : base() {
        $this.Name        = 'Cinder Storm'
        $this.Description = 'Hot coal hail. Yum.'
        $this.Type        = [BattleActionType]::ElementalFire
        # $this.Effect      = $Script:BaElementalFireCalc
        $this.MpCost      = 5
        $this.EffectValue = 60
        $this.Chance      = 0.9
    }
}

Class BALavaSurge : BattleAction {
    BALavaSurge() : base() {
        $this.Name        = 'Lava Surge'
        $this.Description = 'It''s like a surge of love, only the molten kind.'
        $this.Type        = [BattleActionType]::ElementalFire
        # $this.Effect      = $Script:BaElementalFireCalc
        $this.MpCost      = 15
        $this.EffectValue = 100
        $this.Chance      = 1.0
    }
}

Class BAFireCataclysm : BattleAction {
    BAFireCataclysm() : base() {
        $this.Name        = "$($Script:BATAdornmentCharTable[[BattleActionType]::ElementalFire]) Cataclysm"
        $this.Description = 'Firey death rains upon you.'
        $this.Type        = [BattleActionType]::ElementalFire
        # $this.Effect      = $Script:BaElementalFireCalc
        $this.MpCost      = 50
        $this.EffectValue = 250
        $this.Chance      = 0.5
    }
}

Class BAIcePunch : BattleAction {
    BAIcePunch() : base() {
        $this.Name        = 'Ice Punch'
        $this.Description = 'Frigid AND stiff.'
        $this.Type        = [BattleActionType]::ElementalIce
        # $this.Effect      = $Script:BaElementalIceCalc
        $this.MpCost      = 5
        $this.EffectValue = 80
        $this.Chance      = 0.9
    }
}

Class BAFrostKick : BattleAction {
    BAFrostKick() : base() {
        $this.Name        = 'Frost Kick'
        $this.Description = 'Ice on the knee. It''s a thing.'
        $this.Type        = [BattleActionType]::ElementalIce
        # $this.Effect      = $Script:BaElementalIceCalc
        $this.MpCost      = 5
        $this.EffectValue = 80
        $this.Chance      = 0.9
    }
}

Class BAIcicleStrike : BattleAction {
    BAIcicleStrike() : base() {
        $this.Name        = 'Icicle Strike'
        $this.Description = 'When they''re this big, who needs a sword?'
        $this.Type        = [BattleActionType]::ElementalIce
        # $this.Effect      = $Script:BaElementalIceCalc
        $this.MpCost      = 5
        $this.EffectValue = 80
        $this.Chance      = 0.9
    }
}

Class BAGlacialSpike : BattleAction {
    BAGlacialSpike() : base() {
        $this.Name        = 'Glacial Spike'
        $this.Description = 'Global warming helped me make this one.'
        $this.Type        = [BattleActionType]::ElementalIce
        # $this.Effect      = $Script:BaElementalIceCalc
        $this.MpCost      = 5
        $this.EffectValue = 80
        $this.Chance      = 0.9
    }
}

Class BAChillSlash : BattleAction {
    BAChillSlash() : base() {
        $this.Name        = 'Chill Slash'
        $this.Description = 'Let''s all cool down, yeah?'
        $this.Type        = [BattleActionType]::ElementalIce
        # $this.Effect      = $Script:BaElementalIceCalc
        $this.MpCost      = 5
        $this.EffectValue = 80
        $this.Chance      = 0.9
    }
}

Class BAIceBolt : BattleAction {
    BAIceBolt() : base() {
        $this.Name        = 'Ice Bolt'
        $this.Description = 'Not the kind of bolt you secure things with.'
        $this.Type        = [BattleActionType]::ElementalIce
        # $this.Effect      = $Script:BaElementalIceCalc
        $this.MpCost      = 5
        $this.EffectValue = 80
        $this.Chance      = 0.9
    }
}

Class BAArcticBlast : BattleAction {
    BAArcticBlast() : base() {
        $this.Name        = 'Arctic Blast'
        $this.Description = 'Oh you won''t be long for gettin'' froshbit, now!'
        $this.Type        = [BattleActionType]::ElementalIce
        # $this.Effect      = $Script:BaElementalIceCalc
        $this.MpCost      = 5
        $this.EffectValue = 80
        $this.Chance      = 0.9
    }
}

Class BAFrostWave : BattleAction {
    BAFrostWave() : base() {
        $this.Name        = 'Frost Wave'
        $this.Description = 'Ride the wave, dude.'
        $this.Type        = [BattleActionType]::ElementalIce
        # $this.Effect      = $Script:BaElementalIceCalc
        $this.MpCost      = 15
        $this.EffectValue = 100
        $this.Chance      = 1.0
    }
}

Class BAArcticFury : BattleAction {
    BAArcticFury() : base() {
        $this.Name        = 'Arctic Fury'
        $this.Description = 'An ass whooping is a dish best served cold.'
        $this.Type        = [BattleActionType]::ElementalIce
        # $this.Effect      = $Script:BaElementalIceCalc
        $this.MpCost      = 50
        $this.EffectValue = 250
        $this.Chance      = 0.5
    }
}

Class BAFrozenSpear : BattleAction {
    BAFrozenSpear() : base() {
        $this.Name        = 'Frozen Spear'
        $this.Description = 'I found this spear in a fridge.'
        $this.Type        = [BattleActionType]::ElementalIce
        # $this.Effect      = $Script:BaElementalIceCalc
        $this.MpCost      = 15
        $this.EffectValue = 100
        $this.Chance      = 1.0
    }
}

Class BAHailstorm : BattleAction {
    BAHailstorm() : base() {
        $this.Name        = 'Hailstorm'
        $this.Description = 'A common cause of insurace claims.'
        $this.Type        = [BattleActionType]::ElementalIce
        # $this.Effect      = $Script:BaElementalIceCalc
        $this.MpCost      = 50
        $this.EffectValue = 250
        $this.Chance      = 0.5
    }
}

Class BAIcefallSlam : BattleAction {
    BAIcefallSlam() : base() {
        $this.Name        = 'Icefall Slam'
        $this.Description = 'Not avoiding the avalanche is a bad idea.'
        $this.Type        = [BattleActionType]::ElementalIce
        # $this.Effect      = $Script:BaElementalIceCalc
        $this.MpCost      = 15
        $this.EffectValue = 100
        $this.Chance      = 1.0
    }
}

Class BAIceCataclysm : BattleAction {
    BAIceCataclysm() : base() {
        $this.Name        = "$($Script:BATAdornmentCharTable[[BattleActionType]::ElementalIce]) Cataclysm"
        $this.Description = 'Icy death rains down upon you.'
        $this.Type        = [BattleActionType]::ElementalIce
        # $this.Effect      = $Script:BaElementalIceCalc
        $this.MpCost      = 50
        $this.EffectValue = 250
        $this.Chance      = 0.5
    }
}

Class BAAquaJet : BattleAction {
    BAAquaJet() : base() {
        $this.Name        = 'Aqua Jet'
        $this.Description = 'A Boeing 737 made entirely of water.'
        $this.Type        = [BattleActionType]::ElementalWater
        # $this.Effect      = $Script:BaElementalWaterCalc
        $this.MpCost      = 5
        $this.EffectValue = 80
        $this.Chance      = 0.9
    }
}

Class BATidalSurge : BattleAction {
    BATidalSurge() : base() {
        $this.Name        = 'Tidal Surge'
        $this.Description = 'They ebb, they flow, they attac.'
        $this.Type        = [BattleActionType]::ElementalWater
        # $this.Effect      = $Script:BaElementalWaterCalc
        $this.MpCost      = 5
        $this.EffectValue = 80
        $this.Chance      = 0.9
    }
}

Class BAWaterWhip : BattleAction {
    BAWaterWhip() : base() {
        $this.Name        = 'Water Whip'
        $this.Description = 'Indiana Jones''s least favorite whip.'
        $this.Type        = [BattleActionType]::ElementalWater
        # $this.Effect      = $Script:BaElementalWaterCalc
        $this.MpCost      = 5
        $this.EffectValue = 80
        $this.Chance      = 0.9
    }
}

Class BAMistStrike : BattleAction {
    BAMistStrike() : base() {
        $this.Name        = 'Mist Strike'
        $this.Description = 'Was it a cat I saw? Was I tac a ti saw?'
        $this.Type        = [BattleActionType]::ElementalWater
        # $this.Effect      = $Script:BaElementalWaterCalc
        $this.MpCost      = 15
        $this.EffectValue = 100
        $this.Chance      = 1.0
    }
}

Class BAHydroSlash : BattleAction {
    BAHydroSlash() : base() {
        $this.Name        = 'Hydro Slash'
        $this.Description = 'A moistened bint lobbed this scimitar at me.'
        $this.Type        = [BattleActionType]::ElementalWater
        # $this.Effect      = $Script:BaElementalWaterCalc
        $this.MpCost      = 15
        $this.EffectValue = 100
        $this.Chance      = 1.0
    }
}

Class BAWavePunch : BattleAction {
    BAWavePunch() : base() {
        $this.Name        = 'Wave Punch'
        $this.Description = 'The latest Hawaiian Punch flavor. Swelling aftertaste.'
        $this.Type        = [BattleActionType]::ElementalWater
        # $this.Effect      = $Script:BaElementalWaterCalc
        $this.MpCost      = 15
        $this.EffectValue = 100
        $this.Chance      = 1.0
    }
}

Class BAAquaticBolt : BattleAction {
    BAAquaticBolt() : base() {
        $this.Name        = 'Aquatic Bolt'
        $this.Description = 'Some watery things to pelt your neighbor with.'
        $this.Type        = [BattleActionType]::ElementalWater
        # $this.Effect      = $Script:BaElementalWaterCalc
        $this.MpCost      = 50
        $this.EffectValue = 250
        $this.Chance      = 0.5
    }
}

Class BAAquaSphere : BattleAction {
    BAAquaSphere() : base() {
        $this.Name        = 'Aqua Sphere'
        $this.Description = 'Listen to ''Barbie Girl'' all day long. Enjoy.'
        $this.Type        = [BattleActionType]::ElementalWater
        # $this.Effect      = $Script:BaElementalWaterCalc
        $this.MpCost      = 50
        $this.EffectValue = 250
        $this.Chance      = 0.5
    }
}

Class BATidalCrush : BattleAction {
    BATidalCrush() : base() {
        $this.Name        = 'Tidal Crush'
        $this.Description = 'Your high school crush came to kill you, in water form.'
        $this.Type        = [BattleActionType]::ElementalWater
        # $this.Effect      = $Script:BaElementalWaterCalc
        $this.MpCost      = 50
        $this.EffectValue = 250
        $this.Chance      = 0.5
    }
}

Class BATsunami : BattleAction {
    BATsunami() : base() {
        $this.Name        = 'Tsunami'
        $this.Description = 'WAVES!'
        $this.Type        = [BattleActionType]::ElementalWater
        # $this.Effect      = $Script:BaElementalWaterCalc
        $this.MpCost      = 100
        $this.EffectValue = 500
        $this.Chance      = 0.1
    }
}

Class BASeafoamBolt : BattleAction {
    BASeafoamBolt() : base() {
        $this.Name        = 'Seafoam Bolt'
        $this.Description = 'Sometimes I see these white bubbles on the shore.'
        $this.Type        = [BattleActionType]::ElementalWater
        # $this.Effect      = $Script:BaElementalWaterCalc
        $this.MpCost      = 100
        $this.EffectValue = 500
        $this.Chance      = 0.1
    }
}

Class BATyphoon : BattleAction {
    BATyphoon() : base() {
        $this.Name        = 'Typhoon'
        $this.Description = 'Not to be confused with the infamous Tie Foon.'
        $this.Type        = [BattleActionType]::ElementalWater
        # $this.Effect      = $Script:BaElementalWaterCalc
        $this.MpCost      = 200
        $this.EffectValue = 1000
        $this.Chance      = 0.1
    }
}

Class BARaindance : BattleAction {
    BARaindance() : base() {
        $this.Name        = 'Raindance'
        $this.Description = 'Like Riverdance, only shit.'
        $this.Type        = [BattleActionType]::ElementalWater
        # $this.Effect      = $Script:BaElementalWaterCalc
        $this.MpCost      = 200
        $this.EffectValue = 1000
        $this.Chance      = 0.1
    }
}

Class BAWateryGrave : BattleAction {
    BAWateryGrave() : base() {
        $this.Name        = 'Watery Grave'
        $this.Description = 'Davey Jones is holed up here.'
        $this.Type        = [BattleActionType]::ElementalWater
        # $this.Effect      = $Script:BaElementalWaterCalc
        $this.MpCost      = 200
        $this.EffectValue = 1000
        $this.Chance      = 0.1
    }
}

Class BATempest : BattleAction {
    BATempest() : base() {
        $this.Name        = 'Tempest'
        $this.Description = 'If it were a tempest of love, would you feel any different?'
        $this.Type        = [BattleActionType]::ElementalWater
        # $this.Effect      = $Script:BaElementalWaterCalc
        $this.MpCost      = 400
        $this.EffectValue = 2000
        $this.Chance      = 0.1
    }
}

Class BAWaterCataclysm : BattleAction {
    BAWaterCataclysm() : base() {
        $this.Name        = "$($Script:BATAdornmentCharTable[[BattleActionType]::ElementalWater]) Cataclysm"
        $this.Description = 'Watery death rains down upon you.'
        $this.Type        = [BattleActionType]::ElementalWater
        # $this.Effect      = $Script:BaElementalWaterCalc
        $this.MpCost      = 400
        $this.EffectValue = 2000
        $this.Chance      = 0.1
    }
}

Class BATerraStrike : BattleAction {
    BATerraStrike() : base() {
        $this.Name        = 'Terra Strike'
        $this.Description = 'Sticks and stones can break your bones.'
        $this.Type        = [BattleActionType]::ElementalEarth
        # $this.Effect      = $Script:BaElementalEarthCalc
        $this.MpCost      = 50
        $this.EffectValue = 250
        $this.Chance      = 0.5
    }
}

Class BAQuakeFist : BattleAction {
    BAQuakeFist() : base() {
        $this.Name        = 'Quake Fist'
        $this.Description = 'Two nerds get in a fight at QuakeCon.'
        $this.Type        = [BattleActionType]::ElementalEarth
        # $this.Effect      = $Script:BaElementalEarthCalc
        $this.MpCost      = 100
        $this.EffectValue = 500
        $this.Chance      = 0.1
    }
}

Class BABoulderBash : BattleAction {
    BABoulderBash() : base() {
        $this.Name        = 'Boulder Bash'
        $this.Description = 'We played Resident Evil 5 to the end.'
        $this.Type        = [BattleActionType]::ElementalEarth
        # $this.Effect      = $Script:BaElementalEarthCalc
        $this.MpCost      = 100
        $this.EffectValue = 500
        $this.Chance      = 0.1
    }
}

Class BATremor : BattleAction {
    BATremor() : base() {
        $this.Name        = 'Tremor'
        $this.Description = 'Does more damage than those Kevin Bacon movies.'
        $this.Type        = [BattleActionType]::ElementalEarth
        # $this.Effect      = $Script:BaElementalEarthCalc
        $this.MpCost      = 200
        $this.EffectValue = 1000
        $this.Chance      = 0.1
    }
}

Class BAGraniteDust : BattleAction {
    BAGraniteDust() : base() {
        $this.Name        = 'Granite Dust'
        $this.Description = 'There''s blood on the ground before you know it.'
        $this.Type        = [BattleActionType]::ElementalEarth
        # $this.Effect      = $Script:BaElementalEarthCalc
        $this.MpCost      = 200
        $this.EffectValue = 1000
        $this.Chance      = 0.1
    }
}

Class BARockslide : BattleAction {
    BARockslide() : base() {
        $this.Name        = 'Rockslide'
        $this.Description = 'Fallin'' rocks, fallin'' rocks, fallin'' rocks.'
        $this.Type        = [BattleActionType]::ElementalEarth
        # $this.Effect      = $Script:BaElementalEarthCalc
        $this.MpCost      = 200
        $this.EffectValue = 1000
        $this.Chance      = 0.1
    }
}

Class BASinkhole : BattleAction {
    BASinkhole() : base() {
        $this.Name        = 'Sinkhole'
        $this.Description = 'Tumbling down the rabbit hole.'
        $this.Type        = [BattleActionType]::ElementalEarth
        # $this.Effect      = $Script:BaElementalEarthCalc
        $this.MpCost      = 400
        $this.EffectValue = 2000
        $this.Chance      = 0.1
    }
}

Class BAGeoFence : BattleAction {
    BAGeoFence() : base() {
        $this.Name        = 'Geo Fence'
        $this.Description = 'Get off my lawn!'
        $this.Type        = [BattleActionType]::ElementalEarth
        # $this.Effect      = $Script:BaElementalEarthCalc
        $this.MpCost      = 400
        $this.EffectValue = 2000
        $this.Chance      = 0.1
    }
}

Class BAEarthCataclysm : BattleAction {
    BAEarthCataclysm() : base() {
        $this.Name        = "$($Script:BATAdornmentCharTable[[BattleActionType]::ElementalEarth]) Cataclysm"
        $this.Description = 'A rocky death rains down on you.'
        $this.Type        = [BattleActionType]::ElementalEarth
        # $this.Effect      = $Script:BaElementalEarthCalc
        $this.MpCost      = 400
        $this.EffectValue = 2000
        $this.Chance      = 0.1
    }
}

Class BAGaleStrike : BattleAction {
    BAGaleStrike() : base() {
        $this.Name        = 'Gale Strike'
        $this.Description = 'The wind can hurt you.'
        $this.Type        = [BattleActionType]::ElementalWind
        # $this.Effect      = $Script:BaElementalWindCalc
        $this.MpCost      = 50
        $this.EffectValue = 250
        $this.Chance      = 0.5
    }
}

Class BAZephyrSlash : BattleAction {
    BAZephyrSlash() : base() {
        $this.Name        = 'Zephyr Slash'
        $this.Description = 'What the hell is a zephyr, anyway?'
        $this.Type        = [BattleActionType]::ElementalWind
        # $this.Effect      = $Script:BaElementalWindCalc
        $this.MpCost      = 100
        $this.EffectValue = 500
        $this.Chance      = 0.1
    }
}

Class BABreezeBlade : BattleAction {
    BABreezeBlade() : base() {
        $this.Name        = 'Breeze Blade'
        $this.Description = 'Easy, breezy, bleedy, dying guy.'
        $this.Type        = [BattleActionType]::ElementalWind
        # $this.Effect      = $Script:BaElementalWindCalc
        $this.MpCost      = 100
        $this.EffectValue = 500
        $this.Chance      = 0.1
    }
}

Class BAThunderClap : BattleAction {
    BAThunderClap() : base() {
        $this.Name        = 'Thunder Clap'
        $this.Description = 'Sometimes an euphemism, this time a threat.'
        $this.Type        = [BattleActionType]::ElementalWind
        # $this.Effect      = $Script:BaElementalWindCalc
        $this.MpCost      = 100
        $this.EffectValue = 500
        $this.Chance      = 0.1
    }
}

Class BASkywardCut : BattleAction {
    BASkywardCut() : base() {
        $this.Name        = 'Skyward Cut'
        $this.Description = 'Remember to always cut away from yourself.'
        $this.Type        = [BattleActionType]::ElementalWind
        # $this.Effect      = $Script:BaElementalWindCalc
        $this.MpCost      = 100
        $this.EffectValue = 500
        $this.Chance      = 0.1
    }
}

Class BAGrandFlash : BattleAction {
    BAGrandFlash() : base() {
        $this.Name        = 'Grand Flash'
        $this.Description = 'Right when the lightning strikes.'
        $this.Type        = [BattleActionType]::ElementalWind
        # $this.Effect      = $Script:BaElementalWindCalc
        $this.MpCost      = 200
        $this.EffectValue = 1000
        $this.Chance      = 0.1
    }
}

Class BACyclone : BattleAction {
    BACyclone() : base() {
        $this.Name        = 'Cyclone'
        $this.Description = 'Something about moving all night long.'
        $this.Type        = [BattleActionType]::ElementalWind
        # $this.Effect      = $Script:BaElementalWindCalc
        $this.MpCost      = 200
        $this.EffectValue = 1000
        $this.Chance      = 0.1
    }
}

Class BALightningBolt : BattleAction {
    BALightningBolt() : base() {
        $this.Name        = 'Lightning Bolt'
        $this.Description = 'These look cool from a distance.'
        $this.Type        = [BattleActionType]::ElementalWind
        # $this.Effect      = $Script:BaElementalWindCalc
        $this.MpCost      = 200
        $this.EffectValue = 1000
        $this.Chance      = 0.1
    }
}

Class BAGaleflash : BattleAction {
    BAGaleflash() : base() {
        $this.Name        = 'Galeflash'
        $this.Description = 'The lightning rode on the wind.'
        $this.Type        = [BattleActionType]::ElementalWind
        # $this.Effect      = $Script:BaElementalWindCalc
        $this.MpCost      = 200
        $this.EffectValue = 1000
        $this.Chance      = 0.1
    }
}

Class BABreezyWind : BattleAction {
    BABreezyWind() : base() {
        $this.Name        = 'Breezy Wind'
        $this.Description = 'So brisk it''ll carry her bonnet off.'
        $this.Type        = [BattleActionType]::ElementalWind
        # $this.Effect      = $Script:BaElementalWindCalc
        $this.MpCost      = 200
        $this.EffectValue = 1000
        $this.Chance      = 0.1
    }
}

Class BALeafShield : BattleAction {
    BALeafShield() : base() {
        $this.Name        = 'Leaf Shield'
        $this.Description = 'Are you sure this''ll work?'
        $this.Type        = [BattleActionType]::ElementalWind
        # $this.Effect      = $Script:BaElementalWindCalc
        $this.MpCost      = 200
        $this.EffectValue = 1000
        $this.Chance      = 0.1
    }
}

Class BAWindCataclysm : BattleAction {
    BAWindCataclysm() : base() {
        $this.Name        = "$($Script:BATAdornmentCharTable[[BattleActionType]::ElementalWind]) Cataclysm"
        $this.Description = 'Windy death rains down upon you.'
        $this.Type        = [BattleActionType]::ElementalWind
        # $this.Effect      = $Script:BaElementalWindCalc
        $this.MpCost      = 300
        $this.EffectValue = 1500
        $this.Chance      = 0.1
    }
}

Class BARadiance : BattleAction {
    BARadiance() : base() {
        $this.Name        = 'Radiance'
        $this.Description = 'All teh brights.'
        $this.Type        = [BattleActionType]::ElementalLight
        # $this.Effect      = $Script:BaElementalLightCalc
        $this.MpCost      = 100
        $this.EffectValue = 500
        $this.Chance      = 0.1
    }
}

Class BAHolyNova : BattleAction {
    BAHolyNova() : base() {
        $this.Name        = 'Holy Nova'
        $this.Description = 'More Bible than you can handle.'
        $this.Type        = [BattleActionType]::ElementalLight
        # $this.Effect      = {}
        $this.MpCost      = 200
        $this.EffectValue = 1000
        $this.Chance      = 0.1
    }
}

Class BADivineBeam : BattleAction {
    BADivineBeam() : base() {
        $this.Name        = 'Divine Beam'
        $this.Description = 'Got Jesus?'
        $this.Type        = [BattleActionType]::ElementalLight
        # $this.Effect      = {}
        $this.MpCost      = 300
        $this.EffectValue = 1500
        $this.Chance      = 0.1
    }
}

Class BAPrismShock : BattleAction {
    BAPrismShock() : base() {
        $this.Name        = 'Prism Shock'
        $this.Description = 'The pretty rainbow of death.'
        $this.Type        = [BattleActionType]::ElementalLight
        # $this.Effect      = {}
        $this.MpCost      = 300
        $this.EffectValue = 1500
        $this.Chance      = 0.1
    }
}

Class BAHaloStrike : BattleAction {
    BAHaloStrike() : base() {
        $this.Name        = 'Halo Strike'
        $this.Description = 'These surprisingly hurt.'
        $this.Type        = [BattleActionType]::ElementalLight
        # $this.Effect      = {}
        $this.MpCost      = 300
        $this.EffectValue = 1500
        $this.Chance      = 0.1
    }
}

Class BALightbringer : BattleAction {
    BALightbringer() : base() {
        $this.Name        = 'Lightbringer'
        $this.Description = 'Bring the party!'
        $this.Type        = [BattleActionType]::ElementalLight
        # $this.Effect      = {}
        $this.MpCost      = 300
        $this.EffectValue = 1500
        $this.Chance      = 0.1
    }
}

Class BASacredPulse : BattleAction {
    BASacredPulse() : base() {
        $this.Name        = 'Sacred Pulse'
        $this.Description = 'The defunct newsletter of the Catholic Church.'
        $this.Type        = [BattleActionType]::ElementalLight
        # $this.Effect      = {}
        $this.MpCost      = 300
        $this.EffectValue = 1500
        $this.Chance      = 0.1
    }
}

Class BADaybreaker : BattleAction {
    BADaybreaker() : base() {
        $this.Name        = 'Daybreaker'
        $this.Description = 'Some statue in Skyrim gave me this.'
        $this.Type        = [BattleActionType]::ElementalLight
        # $this.Effect      = {}
        $this.MpCost      = 300
        $this.EffectValue = 1500
        $this.Chance      = 0.1
    }
}

Class BAAngelicHymn : BattleAction {
    BAAngelicHymn() : base() {
        $this.Name        = 'Angelic Hymn'
        $this.Description = 'This is how I sound when I sing Britney Spears.'
        $this.Type        = [BattleActionType]::ElementalLight
        # $this.Effect      = {}
        $this.MpCost      = 300
        $this.EffectValue = 1500
        $this.Chance      = 0.1
    }
}

Class BABrilliance : BattleAction { 
    BABrilliance() : base() {
        $this.Name        = 'Brilliance'
        $this.Description = 'How I feel when I look at myself in the mirror.'
        $this.Type        = [BattleActionType]::ElementalLight
        # $this.Effect      = {}
        $this.MpCost      = 300
        $this.EffectValue = 1500
        $this.Chance      = 0.1
    }
}

Class BASunfire : BattleAction {
    BASunfire() : base() {
        $this.Name        = 'Sunfire'
        $this.Description = 'Scorched Earth, mofo.'
        $this.Type        = [BattleActionType]::ElementalLight
        # $this.Effect      = {}
        $this.MpCost      = 400
        $this.EffectValue = 2000
        $this.Chance      = 0.1
    }
}

Class BALightCataclysm : BattleAction {
    BALightCataclysm() : base() {
        $this.Name        = "$($Script:BATAdornmentCharTable[[BattleActionType]::ElementalLight]) Cataclysm"
        $this.Description = 'Holy death rains down upon you.'
        $this.Type        = [BattleActionType]::ElementalLight
        # $this.Effect      = {}
        $this.MpCost      = 500
        $this.EffectValue = 2500
        $this.Chance      = 0.1
    }
}

###############################################################################
#
# BATTLE ENTITY
#
# AN AGGREGATE OF MULTIPLE CLASSES. INTENDED TO DESCRIBE AN ENTITY THAT COULD
# PARTICIPATE IN A BATTLE SITUATION.
#
# NOTABLE PROPERTIES HERE ARE AS FOLLOWS:
#
#  STATS - A HASTABLE [STATID], [BATTLEENTITYPROPERTY]
#  ACTIONLISTING - A HASHTABLE [ACTIONSLOT], [BATTLEACTION]
#  ACTIONMARBLEBAG - A LIST OF FIXED SIZE (10) TO DETMINE ACTION CHANGE LAYOUT
#
###############################################################################
Class BattleEntity {
    [String]$Name
    [Boolean]$CanAct
    [Hashtable]$Stats
    [Hashtable]$ActionListing
    [ScriptBlock]$SpoilsEffect
    [ActionSlot[]]$ActionMarbleBag
    [ConsoleColor24]$NameDrawColor
    [BattleActionType]$Affinity

    BattleEntity() {
        $this.Name            = ''
        $this.CanAct          = $true
        $this.Stats           = @{}
        $this.ActionListing   = @{}
        $this.SpoilsEffect    = $null
        $this.ActionMarbleBag = $null
        $this.NameDrawColor   = [CCTextDefault24]::new()
        $this.Affinity        = [BattleActionType]::None
    }

    [Void]Update() {
        Foreach($a in $this.Stats.Values) {
            $a.Update()
        }
    }
}

###############################################################################
#
# ENEMY BATTLE ENTITY
#
# AN ENTITY THAT IS NOT THE PLAYER THAT CAN BE ENCOUNTERED IN A BATTLE 
# SCENARIO.
#
###############################################################################
Class EnemyBattleEntity : BattleEntity {
    [EnemyEntityImage]$Image
    [Int]$SpoilsGold
    [MapTileObject[]]$SpoilsItems

    EnemyBattleEntity() {
        $this.Image = $null
        $this.SpoilsGold = 0
        $this.SpoilsItems = @()
        $this.SpoilsEffect = {
            Param(
                [Player]$Player,
                [EnemyBattleEntity]$Opponent
            )

            $Script:TheBattleStatusMessageWindow.WriteSpoilsMessage($Opponent)
            $Script:TheBattleStatusMessageWindow.Draw()
            $Player.CurrentGold += $Opponent.SpoilsGold
            If($Opponent.SpoilsItems.Length -GT 0) {
                [String]$ItemNames = ($Opponent.SpoilsItems | Select-Object -ExpandProperty 'Name') -JOIN ', '
                
                $Script:TheBattleStatusMessageWindow.WriteItemsFoundMessage($ItemNames)
                $Script:TheBattleStatusMessageWindow.Draw()
                Foreach($a in $Opponent.SpoilsItems) {
                    $Player.Inventory.Add($a) | Out-Null
                }
            }
        }
    }
}

###############################################################################
#
# PLAYER
#
# A SPECIALIZATION OF BATTLE ENTITY THAT REPRESENTS THE PLAYER.
#
###############################################################################
Class Player : BattleEntity {
    Static [ConsoleColor24]$AsideColor    = [CCAppleIndigoLight24]::new()
    Static [ConsoleColor24]$GoldDrawColor = [CCAppleYellowLight24]::new()

    [Int]$CurrentGold
    [ATCoordinates]$MapCoordinates
    [List[MapTileObject]]$Inventory
    [List[String]]$TargetOfFilter
    [PlayerActionInventory]$ActionInventory

    Player() : base() {
        $this.CurrentGold     = 0
        $this.MapCoordinates  = [ATCoordinates]::new(0, 0)
        $this.Inventory       = [List[MapTileObject]]::new()
        $this.TargetOfFilter  = [List[String]]::new()
        $this.ActionInventory = [PlayerActionInventory]::new()
    }

    [Boolean]IsItemInInventory(
        [String]$ItemName
    ) {
        Foreach($a in $this.Inventory) {
            If($a.Name -IEQ $ItemName) {
                Return $true
            }
        }

        Return $false
    }

    [MapTileObject]GetItemReference(
        [String]$ItemName
    ) {
        Foreach($a in $this.Inventory) {
            If($a.Name -IEQ $ItemName) {
                Return $a
            }
        }

        Return $null
    }

    [ItemRemovalStatus]RemoveInventoryItemByName(
        [String]$ItemName
    ) {
        $c = 0

        Foreach($a in $this.Inventory) {
            If($a.Name -IEQ $ItemName) {
                If($a.KeyItem -EQ $true) {
                    Return [ItemRemovalStatus]::FailKeyItem
                }
                $this.Inventory.RemoveAt($c)

                Return [ItemRemovalStatus]::Success
            }
            $c++
        }

        Return [ItemRemovalStatus]::FailGeneral
    }

    [ItemRemovalStatus]RemoveInventoryItemByIndex(
        [Int]$Index
    ) {
        [MapTileObject]$a = $null

        Try {
            $a = $this.Inventory[$Index]
        } Catch {
            Return [ItemRemovalStatus]::FailGeneral
        }
        If($a.KeyItem -EQ $true) {
            Return [ItemRemovalStatus]::FailKeyItem
        }
        $this.Inventory.RemoveAt($Index)

        Return [ItemRemovalStatus]::Success
    }

    [Void]MapMoveSouth() {
        If($Script:CurrentMap.GetTileAtPlayerCoordinates().Exits[[MapTile]::TileExitSouth] -EQ $true) {
            If($Script:CurrentMap.BoundaryWrap -EQ $true) {
                $a = $Script:CurrentMap.MapHeight - 1
                $b = $this.MapCoordinates.Row + 1
                $c = $a % $b

                If($c -EQ $a) {
                    $this.MapCoordinates.Row = 0
                } Else {
                    $this.MapCoordinates.Row++
                }
                $Script:TheSceneWindow.UpdateCurrentImage($Script:CurrentMap.GetTileAtPlayerCoordinates().BackgroundImage)
                $Script:TheCommandWindow.UpdateCommandHistory($true)
                $Script:CurrentMap.GetTileAtPlayerCoordinates().BattleStep()

                Return
            } Else {
                $a = $Script:CurrentMap.MapHeight - 1
                $b = $this.MapCoordinates.Row + 1
                $c = $a % $b

                If($c -EQ $a) {
                    $Script:TheCommandWindow.UpdateCommandHistory($true)
                    $Script:TheMessageWindow.WriteInvisibleWallEncounteredMessage()
                } Else {
                    $this.MapCoordinates.Row++
                    $Script:TheSceneWindow.UpdateCurrentImage($Script:CurrentMap.GetTileAtPlayerCoordinates().BackgroundImage)
                    $Script:TheCommandWindow.UpdateCommandHistory($true)
                    $Script:CurrentMap.GetTileAtPlayerCoordinates().BattleStep()

                    Return
                }
            }
        } Else {
            $Script:TheCommandWindow.UpdateCommandHistory($true)
            $Script:TheMessageWindow.WriteYouShallNotPassMessage()

            Return
        }
    }

    [Void]MapMoveNorth() {
        If($Script:CurrentMap.GetTileAtPlayerCoordinates().Exits[[MapTile]::TileExitNorth] -EQ $true) {
            If($Script:CurrentMap.BoundaryWrap -EQ $true) {
                $a = 0
                $b = $this.MapCoordinates.Row - 1

                If($b -LT $a) {
                    $this.MapCoordinates.Row = $Script:CurrentMap.MapHeight - 1
                } Else {
                    $this.MapCoordinates.Row--
                }
                $Script:TheSceneWindow.UpdateCurrentImage($Script:CurrentMap.GetTileAtPlayerCoordinates().BackgroundImage)
                $Script:TheCommandWindow.UpdateCommandHistory($true)
                $Script:CurrentMap.GetTileAtPlayerCoordinates().BattleStep()

                Return
            } Else {
                $a = 0
                $b = $this.MapCoordinates.Row - 1

                If($b -LT $a) {
                    $Script:TheCommandWindow.UpdateCommandHistory($true)
                    $Script:TheMessageWindow.WriteInvisibleWallEncounteredMessage()
                } Else {
                    $this.MapCoordinates.Row--
                    $Script:TheSceneWindow.UpdateCurrentImage($Script:CurrentMap.GetTileAtPlayerCoordinates().BackgroundImage)
                    $Script:TheCommandWindow.UpdateCommandHistory($true)
                    $Script:CurrentMap.GetTileAtPlayerCoordinates().BattleStep()

                    Return
                }
            }
        } Else {
            $Script:TheCommandWindow.UpdateCommandHistory($true)
            $Script:TheMessageWindow.WriteYouShallNotPassMessage()

            Return
        }
    }

    [Void]MapMoveEast() {
        If($Script:CurrentMap.GetTileAtPlayerCoordinates().Exits[[MapTile]::TileExitEast] -EQ $true) {
            If($Script:CurrentMap.BoundaryWrap -EQ $true) {
                $a = $Script:CurrentMap.MapWidth - 1
                $b = $this.MapCoordinates.Column + 1
                $c = $a % $b

                If($c -EQ $a) {
                    $this.MapCoordinates.Column = 0
                } Else {
                    $this.MapCoordinates.Column++
                }
                $Script:TheSceneWindow.UpdateCurrentImage($Script:CurrentMap.GetTileAtPlayerCoordinates().BackgroundImage)
                $Script:TheCommandWindow.UpdateCommandHistory($true)
                $Script:CurrentMap.GetTileAtPlayerCoordinates().BattleStep()

                Return
            } Else {
                $a = $Script:CurrentMap.MapWidth - 1
                $b = $this.MapCoordinates.Column + 1
                $c = $a % $b

                If($c -EQ $a) {
                    $Script:TheCommandWindow.UpdateCommandHistory($true)
                    $Script:TheMessageWindow.WriteInvisibleWallEncounteredMessage()
                } Else {
                    $this.MapCoordinates.Column++
                    $Script:TheSceneWindow.UpdateCurrentImage($Script:CurrentMap.GetTileAtPlayerCoordinates().BackgroundImage)
                    $Script:TheCommandWindow.UpdateCommandHistory($true)
                    $Script:CurrentMap.GetTileAtPlayerCoordinates().BattleStep()

                    Return
                }
            }
        } Else {
            $Script:TheCommandWindow.UpdateCommandHistory($true)
            $Script:TheMessageWindow.WriteYouShallNotPassMessage()

            Return
        }
    }

    [Void]MapMoveWest() {
        If($Script:CurrentMap.GetTileAtPlayerCoordinates().Exits[[MapTile]::TileExitWest] -EQ $true) {
            If($Script:CurrentMap.BoundaryWrap -EQ $true) {
                $a = 0
                $b = $this.MapCoordinates.Column - 1

                If($b -LT $a) {
                    $this.MapCoordinates.Column = $Script:CurrentMap.MapWidth - 1
                } Else {
                    $this.MapCoordinates.Column--
                }
                $Script:TheSceneWindow.UpdateCurrentImage($Script:CurrentMap.GetTileAtPlayerCoordinates().BackgroundImage)
                $Script:TheCommandWindow.UpdateCommandHistory($true)
                $Script:CurrentMap.GetTileAtPlayerCoordinates().BattleStep()

                Return
            } Else {
                $a = 0
                $b = $this.MapCoordinates.Column - 1

                If($b -LT $a) {
                    $Script:TheCommandWindow.UpdateCommandHistory($true)
                    $Script:TheMessageWindow.WriteInvisibleWallEncounteredMessage()
                } Else {
                    $this.MapCoordinates.Column--
                    $Script:TheSceneWindow.UpdateCurrentImage($Script:CurrentMap.GetTileAtPlayerCoordinates().BackgroundImage)
                    $Script:TheCommandWindow.UpdateCommandHistory($true)
                    $Script:CurrentMap.GetTileAtPlayerCoordinates().BattleStep()

                    Return
                }
            }
        } Else {
            $Script:TheCommandWindow.UpdateCommandHistory($true)
            $Script:TheMessageWindow.WriteYouShallNotPassMessage()

            Return
        }
    }

    [Boolean]ValidateSourceInFilter(
        [String]$SourceItemClass
    ) {
        Return ($SourceItemClass -IN $this.TargetOfFilter)
    }
}

###############################################################################
#
# PLAYER ITEM INVENTORY
#
# A FOCAL POINT FOR THE PLAYER'S ITEM INVENTORY.
#
###############################################################################
Class PlayerItemInventory {
    [List[MapTileObject]]$Listing

    [Boolean]IsItemInInventory(
        [String]$ItemName
    ) {
        Foreach($a in $this.Listing) {
            If($a.Name -IEQ $ItemName) {
                Return $true
            }
        }

        Return $false
    }

    [MapTileObject]GetItemReference(
        [String]$ItemName
    ) {
        Foreach($a in $this.Inventory) {
            If($a.Name -IEQ $ItemName) {
                Return $a
            }
        }

        Return $null
    }

    [ItemRemovalStatus]RemoveInventoryItemByName(
        [String]$ItemName
    ) {
        [Int]$c = 0

        Foreach($a in $this.Inventory) {
            If($a.Name -IEQ $ItemName) {
                If($a.KeyItem -EQ $true) {
                    Return [ItemRemovalStatus]::FailKeyItem
                }
                $this.Listing.RemoveAt($c)

                Return [ItemRemovalStatus]::Success
            }
            $c++
        }

        Return [ItemRemovalStatus]::FailGeneral
    }

    [ItemRemovalStatus]RemoveInventoryItemByIndex(
        [Int]$Index
    ) {
        [MapTileObject]$a = $null

        Try {
            $a = $this.Listing[$Index]
        } Catch {
            Return [ItemRemovalStatus]::FailGeneral
        }
        If($a.KeyItem -EQ $true) {
            Return [ItemRemovalStatus]::FailKeyItem
        }
        $this.Listing.RemoveAt($Index)

        Return [ItemRemovalStatus]::Success
    }
}

###############################################################################
#
# PLAYER ACTION INVENTORY
#
# A FOCAL POINT FOR THE PLAYER'S BATTLE ACTION INVENTORY.
#
###############################################################################
Class PlayerActionInventory {
    [List[BattleAction]]$Listing = [List[BattleAction]]::new()

    [Boolean]IsActionInInventory(
        [String]$ActionName
    ) {
        Foreach($a in $this.Listing) {
            If($a.Name -IEQ $ActionName) {
                Return $true
            }
        }

        Return $false
    }

    [BattleAction]GetActionReference(
        [String]$ActionName
    ) {
        Foreach($a in $this.Listing) {
            If($a.Name -IEQ $ActionName) {
                Return $a
            }
        }

        Return $null
    }

    [ActionInvRemovalStatus]RemoveActionByName(
        [String]$ActionName
    ) {
        [Int]$c = 0

        Foreach($a in $this.Listing) {
            If($a.Name -IEQ $ActionName) {
                $this.Listing.RemoveAt($c)

                Return [ActionInvRemovalStatus]::Success
            }
            $c++
        }

        Return [ActionInvRemovalStatus]::Fail
    }

    [ActionInvRemovalStatus]RemoveActionByIndex(
        [Int]$Index
    ) {
        [BattleAction]$a = $null

        Try {
            $a = $this.Listing[$Index]
        } Catch {
            Return [ActionInvRemovalStatus]::Fail
        }
        $this.Listing.RemoveAt($Index)

        Return [ActionInvRemovalStatus]::Success
    }

    [Boolean]Add(
        [BattleAction]$ActionToAdd
    ) {
        [Boolean]$ActionAlreadyListed = $this.IsActionInInventory($ActionToAdd.Name)

        If($ActionAlreadyListed -EQ $true) {
            Return $false
        }
        # $this.Listing.Add([BattleAction]::new($ActionToAdd))
        $this.Listing.Add($ActionToAdd)

        Return $true
    }
}

###############################################################################
#
# ENEMY ENTITY IMAGE
#
# A COMPOSITION OF AT SCENE IMAGE STRING INTENDED TO BE USED WITH AN ENEMY
# ENTITY. THIS ISN'T AN "IMAGE" PER-SE, RATHER A LARGE ARRAY OF ANSI
# TERMINATED STRINGS THAT COALESCE INTO AN IMAGE.
#
###############################################################################
Class EnemyEntityImage {
    Static [Int]$Width  = 37
    Static [Int]$Height = 15

    [ATSceneImageString[,]]$Image

    EnemyEntityImage() {
        $this.Image = New-Object 'ATSceneImageString[,]' ([Int32]([SceneImage]::Height)), ([Int32]([SceneImage]::Width))
    }

    # THIS CTOR LIKELY ISN'T USED
    # EnemyEntityImage(
    #     [ATSceneImageString[,]]$Image
    # ) {
    #     $this.Image = $Image
    # }

    [Void]CreateImageATString([ATBackgroundColor24[]]$ImageColorMap) {
        For($r = 0; $r -LT [EnemyEntityImage]::Height; $r++) {
            For($c = 0; $c -LT [EnemyEntityImage]::Width; $c++) {
                $rf                 = ($r * [EnemyEntityImage]::Width) + $c
                $this.Image[$r, $c] = [ATSceneImageString]::new(
                    $ImageColorMap[$rf],
                    [ATCoordinates]::new(([BattleEnemyImageWindow]::ImageDrawRowOffset + $r), ([BattleEnemyImageWindow]::ImageDrawColumnOffset + $c))
                )
            }
        }
    }

    [String]ToAnsiControlSequenceString() {
        [String]$a = ''

        For($r = 0; $r -LT [EnemyEntityImage]::Height; $r++) {
            For($c = 0; $c -LT [EnemyEntityImage]::Width; $c++) {
                $a += $this.Image[$r, $c].ToAnsiControlSequenceString()
            }
        }

        Return $a
    }
}

###############################################################################
#
# EEI EMPTY
#
# A SYMBOLIC REPRESENTATION OF AN EMPTY ENEMY IMAGE.
#
###############################################################################
Class EEIEmpty : EnemyEntityImage {
    EEIEmpty() : base() {}

    [String]ToAnsiControlSequenceString() {
        Return ''
    }
}

###############################################################################
#
# EEI INTERNAL BASE
#
# AN EXPRESSION OF THE ENEMY ENTITY IMAGE THAT ADDS A COLOR MAP. THIS IS THE
# BASE FOR PRACTICAL APPLICATIONS.
#
###############################################################################
Class EEIInternalBase : EnemyEntityImage {
    [ATBackgroundColor24[]]$ColorMap

    EEIInternalBase() : base() {
        $this.ColorMap = New-Object 'ATBackgroundColor24[]' ([Int32](([Int32]([SceneImage]::Width)) * ([Int32]([SceneImage]::Height))))
    }
}

###############################################################################
#
# EEI SPECIALIZATIONS
#
# THESE ARE SPECIALIZATIONS OF EEI INTERNAL BASE THAT REPRESENT ACTUAL "IMAGES"
# THAT WOULD BE DRAWN IN THE BATTLE WINDOW. THE NAMES OF THE CLASSES ARE
# SELF-EVIDENT.
#
###############################################################################
Class EEIBat : EEIInternalBase {
    EEIBat() : base() {
        $this.ColorMap[0]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[1]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[2]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[3]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[4]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[5]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[6]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[7]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[8]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[9]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[10]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[11]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[12]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[13]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[14]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[15]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[16]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[17]  = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[18]  = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[19]  = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[20]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[21]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[22]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[23]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[24]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[25]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[26]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[27]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[28]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[29]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[30]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[31]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[32]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[33]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[34]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[35]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[36]  = [ATBackgroundColor24None]::new() # End Row 0
        $this.ColorMap[37]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[38]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[39]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[40]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[41]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[42]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[43]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[44]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[45]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[46]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[47]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[48]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[49]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[50]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[51]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[52]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[53]  = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[54]  = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[55]  = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[56]  = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[57]  = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[58]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[59]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[60]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[61]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[62]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[63]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[64]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[65]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[66]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[67]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[68]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[69]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[70]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[71]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[72]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[73]  = [ATBackgroundColor24None]::new() # End Row 1
        $this.ColorMap[74]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[75]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[76]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[77]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[78]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[79]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[80]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[81]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[82]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[83]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[84]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[85]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[86]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[87]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[88]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[89]  = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[90]  = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[91]  = [CCAppleRedDark24]::new()
        $this.ColorMap[92]  = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[93]  = [CCAppleRedDark24]::new()
        $this.ColorMap[94]  = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[95]  = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[96]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[97]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[98]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[99]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[100] = [ATBackgroundColor24None]::new()
        $this.ColorMap[101] = [ATBackgroundColor24None]::new()
        $this.ColorMap[102] = [ATBackgroundColor24None]::new()
        $this.ColorMap[103] = [ATBackgroundColor24None]::new()
        $this.ColorMap[104] = [ATBackgroundColor24None]::new()
        $this.ColorMap[105] = [ATBackgroundColor24None]::new()
        $this.ColorMap[106] = [ATBackgroundColor24None]::new()
        $this.ColorMap[107] = [ATBackgroundColor24None]::new()
        $this.ColorMap[108] = [ATBackgroundColor24None]::new()
        $this.ColorMap[109] = [ATBackgroundColor24None]::new()
        $this.ColorMap[110] = [ATBackgroundColor24None]::new() # End Row 2
        $this.ColorMap[111] = [ATBackgroundColor24None]::new()
        $this.ColorMap[112] = [ATBackgroundColor24None]::new()
        $this.ColorMap[113] = [ATBackgroundColor24None]::new()
        $this.ColorMap[114] = [ATBackgroundColor24None]::new()
        $this.ColorMap[115] = [ATBackgroundColor24None]::new()
        $this.ColorMap[116] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[117] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[118] = [ATBackgroundColor24None]::new()
        $this.ColorMap[119] = [ATBackgroundColor24None]::new()
        $this.ColorMap[120] = [ATBackgroundColor24None]::new()
        $this.ColorMap[121] = [ATBackgroundColor24None]::new()
        $this.ColorMap[122] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[123] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[124] = [ATBackgroundColor24None]::new()
        $this.ColorMap[125] = [ATBackgroundColor24None]::new()
        $this.ColorMap[126] = [ATBackgroundColor24None]::new()
        $this.ColorMap[127] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[128] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[129] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[130] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[131] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[132] = [ATBackgroundColor24None]::new()
        $this.ColorMap[133] = [ATBackgroundColor24None]::new()
        $this.ColorMap[134] = [ATBackgroundColor24None]::new()
        $this.ColorMap[135] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[136] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[137] = [ATBackgroundColor24None]::new()
        $this.ColorMap[138] = [ATBackgroundColor24None]::new()
        $this.ColorMap[139] = [ATBackgroundColor24None]::new()
        $this.ColorMap[140] = [ATBackgroundColor24None]::new()
        $this.ColorMap[141] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[142] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[143] = [ATBackgroundColor24None]::new()
        $this.ColorMap[144] = [ATBackgroundColor24None]::new()
        $this.ColorMap[145] = [ATBackgroundColor24None]::new()
        $this.ColorMap[146] = [ATBackgroundColor24None]::new()
        $this.ColorMap[147] = [ATBackgroundColor24None]::new() # End Row 3
        $this.ColorMap[148] = [ATBackgroundColor24None]::new()
        $this.ColorMap[149] = [ATBackgroundColor24None]::new()
        $this.ColorMap[150] = [ATBackgroundColor24None]::new()
        $this.ColorMap[151] = [ATBackgroundColor24None]::new()
        $this.ColorMap[152] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[153] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[154] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[155] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[156] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[157] = [ATBackgroundColor24None]::new()
        $this.ColorMap[158] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[159] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[160] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[161] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[162] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[163] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[164] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[165] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[166] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[167] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[168] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[169] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[170] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[171] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[172] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[173] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[174] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[175] = [ATBackgroundColor24None]::new()
        $this.ColorMap[176] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[177] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[178] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[179] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[180] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[181] = [ATBackgroundColor24None]::new()
        $this.ColorMap[182] = [ATBackgroundColor24None]::new()
        $this.ColorMap[183] = [ATBackgroundColor24None]::new()
        $this.ColorMap[184] = [ATBackgroundColor24None]::new() # End Row 4
        $this.ColorMap[185] = [ATBackgroundColor24None]::new()
        $this.ColorMap[186] = [ATBackgroundColor24None]::new()
        $this.ColorMap[187] = [ATBackgroundColor24None]::new()
        $this.ColorMap[188] = [ATBackgroundColor24None]::new()
        $this.ColorMap[189] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[190] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[191] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[192] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[193] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[194] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[195] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[196] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[197] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[198] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[199] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[200] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[201] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[202] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[203] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[204] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[205] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[206] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[207] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[208] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[209] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[210] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[211] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[212] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[213] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[214] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[215] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[216] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[217] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[218] = [ATBackgroundColor24None]::new()
        $this.ColorMap[219] = [ATBackgroundColor24None]::new()
        $this.ColorMap[220] = [ATBackgroundColor24None]::new()
        $this.ColorMap[221] = [ATBackgroundColor24None]::new() # End Row 5
        $this.ColorMap[222] = [ATBackgroundColor24None]::new()
        $this.ColorMap[223] = [ATBackgroundColor24None]::new()
        $this.ColorMap[224] = [ATBackgroundColor24None]::new()
        $this.ColorMap[225] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[226] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[227] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[228] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[229] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[230] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[231] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[232] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[233] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[234] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[235] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[236] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[237] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[238] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[239] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[240] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[241] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[242] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[243] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[244] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[245] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[246] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[247] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[248] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[249] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[250] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[251] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[252] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[253] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[254] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[255] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[256] = [ATBackgroundColor24None]::new()
        $this.ColorMap[257] = [ATBackgroundColor24None]::new()
        $this.ColorMap[258] = [ATBackgroundColor24None]::new() # End Row 6
        $this.ColorMap[259] = [ATBackgroundColor24None]::new()
        $this.ColorMap[260] = [ATBackgroundColor24None]::new()
        $this.ColorMap[261] = [ATBackgroundColor24None]::new()
        $this.ColorMap[262] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[263] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[264] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[265] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[266] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[267] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[268] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[269] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[270] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[271] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[272] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[273] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[274] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[275] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[276] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[277] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[278] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[279] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[280] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[281] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[282] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[283] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[284] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[285] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[286] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[287] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[288] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[289] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[290] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[291] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[292] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[293] = [ATBackgroundColor24None]::new()
        $this.ColorMap[294] = [ATBackgroundColor24None]::new()
        $this.ColorMap[295] = [ATBackgroundColor24None]::new() # End Row 7
        $this.ColorMap[296] = [ATBackgroundColor24None]::new()
        $this.ColorMap[297] = [ATBackgroundColor24None]::new()
        $this.ColorMap[298] = [ATBackgroundColor24None]::new()
        $this.ColorMap[299] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[300] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[301] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[302] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[303] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[304] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[305] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[306] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[307] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[308] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[309] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[310] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[311] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[312] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[313] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[314] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[315] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[316] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[317] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[318] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[319] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[320] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[321] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[322] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[323] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[324] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[325] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[326] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[327] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[328] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[329] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[330] = [ATBackgroundColor24None]::new()
        $this.ColorMap[331] = [ATBackgroundColor24None]::new()
        $this.ColorMap[332] = [ATBackgroundColor24None]::new() # End Row 8
        $this.ColorMap[333] = [ATBackgroundColor24None]::new()
        $this.ColorMap[334] = [ATBackgroundColor24None]::new()
        $this.ColorMap[335] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[336] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[337] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[338] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[339] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[340] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[341] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[342] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[343] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[344] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[345] = [ATBackgroundColor24None]::new()
        $this.ColorMap[346] = [ATBackgroundColor24None]::new()
        $this.ColorMap[347] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[348] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[349] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[350] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[351] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[352] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[353] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[354] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[355] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[356] = [ATBackgroundColor24None]::new()
        $this.ColorMap[357] = [ATBackgroundColor24None]::new()
        $this.ColorMap[358] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[359] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[360] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[361] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[362] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[363] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[364] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[365] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[366] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[367] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[368] = [ATBackgroundColor24None]::new()
        $this.ColorMap[369] = [ATBackgroundColor24None]::new() # End Row 9
        $this.ColorMap[370] = [ATBackgroundColor24None]::new()
        $this.ColorMap[371] = [ATBackgroundColor24None]::new()
        $this.ColorMap[372] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[373] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[374] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[375] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[376] = [ATBackgroundColor24None]::new()
        $this.ColorMap[377] = [ATBackgroundColor24None]::new()
        $this.ColorMap[378] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[379] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[380] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[381] = [ATBackgroundColor24None]::new()
        $this.ColorMap[382] = [ATBackgroundColor24None]::new()
        $this.ColorMap[383] = [ATBackgroundColor24None]::new()
        $this.ColorMap[384] = [ATBackgroundColor24None]::new()
        $this.ColorMap[385] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[386] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[387] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[388] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[389] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[390] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[391] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[392] = [ATBackgroundColor24None]::new()
        $this.ColorMap[393] = [ATBackgroundColor24None]::new()
        $this.ColorMap[394] = [ATBackgroundColor24None]::new()
        $this.ColorMap[395] = [ATBackgroundColor24None]::new()
        $this.ColorMap[396] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[397] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[398] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[399] = [ATBackgroundColor24None]::new()
        $this.ColorMap[400] = [ATBackgroundColor24None]::new()
        $this.ColorMap[401] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[402] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[403] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[404] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[405] = [ATBackgroundColor24None]::new()
        $this.ColorMap[406] = [ATBackgroundColor24None]::new() # End Row 10
        $this.ColorMap[407] = [ATBackgroundColor24None]::new()
        $this.ColorMap[408] = [ATBackgroundColor24None]::new()
        $this.ColorMap[409] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[410] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[411] = [ATBackgroundColor24None]::new()
        $this.ColorMap[412] = [ATBackgroundColor24None]::new()
        $this.ColorMap[413] = [ATBackgroundColor24None]::new()
        $this.ColorMap[414] = [ATBackgroundColor24None]::new()
        $this.ColorMap[415] = [ATBackgroundColor24None]::new()
        $this.ColorMap[416] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[417] = [ATBackgroundColor24None]::new()
        $this.ColorMap[418] = [ATBackgroundColor24None]::new()
        $this.ColorMap[419] = [ATBackgroundColor24None]::new()
        $this.ColorMap[420] = [CCAppleOrangeDark24]::new()
        $this.ColorMap[421] = [ATBackgroundColor24None]::new()
        $this.ColorMap[422] = [ATBackgroundColor24None]::new()
        $this.ColorMap[423] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[424] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[425] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[426] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[427] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[428] = [ATBackgroundColor24None]::new()
        $this.ColorMap[429] = [ATBackgroundColor24None]::new()
        $this.ColorMap[430] = [CCAppleOrangeDark24]::new()
        $this.ColorMap[431] = [ATBackgroundColor24None]::new()
        $this.ColorMap[432] = [ATBackgroundColor24None]::new()
        $this.ColorMap[433] = [ATBackgroundColor24None]::new()
        $this.ColorMap[434] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[435] = [ATBackgroundColor24None]::new()
        $this.ColorMap[436] = [ATBackgroundColor24None]::new()
        $this.ColorMap[437] = [ATBackgroundColor24None]::new()
        $this.ColorMap[438] = [ATBackgroundColor24None]::new()
        $this.ColorMap[439] = [ATBackgroundColor24None]::new()
        $this.ColorMap[440] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[441] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[442] = [ATBackgroundColor24None]::new()
        $this.ColorMap[443] = [ATBackgroundColor24None]::new() # End Row 11
        $this.ColorMap[444] = [ATBackgroundColor24None]::new()
        $this.ColorMap[445] = [ATBackgroundColor24None]::new()
        $this.ColorMap[446] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[447] = [ATBackgroundColor24None]::new()
        $this.ColorMap[448] = [ATBackgroundColor24None]::new()
        $this.ColorMap[449] = [ATBackgroundColor24None]::new()
        $this.ColorMap[450] = [ATBackgroundColor24None]::new()
        $this.ColorMap[451] = [ATBackgroundColor24None]::new()
        $this.ColorMap[452] = [ATBackgroundColor24None]::new()
        $this.ColorMap[453] = [ATBackgroundColor24None]::new()
        $this.ColorMap[454] = [ATBackgroundColor24None]::new()
        $this.ColorMap[455] = [ATBackgroundColor24None]::new()
        $this.ColorMap[456] = [ATBackgroundColor24None]::new()
        $this.ColorMap[457] = [ATBackgroundColor24None]::new()
        $this.ColorMap[458] = [CCAppleOrangeDark24]::new()
        $this.ColorMap[459] = [CCAppleOrangeDark24]::new()
        $this.ColorMap[460] = [ATBackgroundColor24None]::new()
        $this.ColorMap[461] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[462] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[463] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[464] = [ATBackgroundColor24None]::new()
        $this.ColorMap[465] = [CCAppleOrangeDark24]::new()
        $this.ColorMap[466] = [CCAppleOrangeDark24]::new()
        $this.ColorMap[467] = [ATBackgroundColor24None]::new()
        $this.ColorMap[468] = [ATBackgroundColor24None]::new()
        $this.ColorMap[469] = [ATBackgroundColor24None]::new()
        $this.ColorMap[470] = [ATBackgroundColor24None]::new()
        $this.ColorMap[471] = [ATBackgroundColor24None]::new()
        $this.ColorMap[472] = [ATBackgroundColor24None]::new()
        $this.ColorMap[473] = [ATBackgroundColor24None]::new()
        $this.ColorMap[474] = [ATBackgroundColor24None]::new()
        $this.ColorMap[475] = [ATBackgroundColor24None]::new()
        $this.ColorMap[476] = [ATBackgroundColor24None]::new()
        $this.ColorMap[477] = [ATBackgroundColor24None]::new()
        $this.ColorMap[478] = [CCAppleGrey3Dark24]::new()
        $this.ColorMap[479] = [ATBackgroundColor24None]::new()
        $this.ColorMap[480] = [ATBackgroundColor24None]::new() # End Row 12
        $this.ColorMap[481] = [ATBackgroundColor24None]::new()
        $this.ColorMap[482] = [ATBackgroundColor24None]::new()
        $this.ColorMap[483] = [ATBackgroundColor24None]::new()
        $this.ColorMap[484] = [ATBackgroundColor24None]::new()
        $this.ColorMap[485] = [ATBackgroundColor24None]::new()
        $this.ColorMap[486] = [ATBackgroundColor24None]::new()
        $this.ColorMap[487] = [ATBackgroundColor24None]::new()
        $this.ColorMap[488] = [ATBackgroundColor24None]::new()
        $this.ColorMap[489] = [ATBackgroundColor24None]::new()
        $this.ColorMap[490] = [ATBackgroundColor24None]::new()
        $this.ColorMap[491] = [ATBackgroundColor24None]::new()
        $this.ColorMap[492] = [ATBackgroundColor24None]::new()
        $this.ColorMap[493] = [ATBackgroundColor24None]::new()
        $this.ColorMap[494] = [CCAppleOrangeDark24]::new()
        $this.ColorMap[495] = [ATBackgroundColor24None]::new()
        $this.ColorMap[496] = [ATBackgroundColor24None]::new()
        $this.ColorMap[497] = [ATBackgroundColor24None]::new()
        $this.ColorMap[498] = [ATBackgroundColor24None]::new()
        $this.ColorMap[499] = [CCAppleGrey1Dark24]::new()
        $this.ColorMap[500] = [ATBackgroundColor24None]::new()
        $this.ColorMap[501] = [ATBackgroundColor24None]::new()
        $this.ColorMap[502] = [ATBackgroundColor24None]::new()
        $this.ColorMap[503] = [ATBackgroundColor24None]::new()
        $this.ColorMap[504] = [CCAppleOrangeDark24]::new()
        $this.ColorMap[505] = [ATBackgroundColor24None]::new()
        $this.ColorMap[506] = [ATBackgroundColor24None]::new()
        $this.ColorMap[507] = [ATBackgroundColor24None]::new()
        $this.ColorMap[508] = [ATBackgroundColor24None]::new()
        $this.ColorMap[509] = [ATBackgroundColor24None]::new()
        $this.ColorMap[510] = [ATBackgroundColor24None]::new()
        $this.ColorMap[511] = [ATBackgroundColor24None]::new()
        $this.ColorMap[512] = [ATBackgroundColor24None]::new()
        $this.ColorMap[513] = [ATBackgroundColor24None]::new()
        $this.ColorMap[514] = [ATBackgroundColor24None]::new()
        $this.ColorMap[515] = [ATBackgroundColor24None]::new()
        $this.ColorMap[516] = [ATBackgroundColor24None]::new()
        $this.ColorMap[517] = [ATBackgroundColor24None]::new() # End Row 13
        $this.ColorMap[518] = [ATBackgroundColor24None]::new()
        $this.ColorMap[519] = [ATBackgroundColor24None]::new()
        $this.ColorMap[520] = [ATBackgroundColor24None]::new()
        $this.ColorMap[521] = [ATBackgroundColor24None]::new()
        $this.ColorMap[522] = [ATBackgroundColor24None]::new()
        $this.ColorMap[523] = [ATBackgroundColor24None]::new()
        $this.ColorMap[524] = [ATBackgroundColor24None]::new()
        $this.ColorMap[525] = [ATBackgroundColor24None]::new()
        $this.ColorMap[526] = [ATBackgroundColor24None]::new()
        $this.ColorMap[527] = [ATBackgroundColor24None]::new()
        $this.ColorMap[528] = [ATBackgroundColor24None]::new()
        $this.ColorMap[529] = [ATBackgroundColor24None]::new()
        $this.ColorMap[530] = [ATBackgroundColor24None]::new()
        $this.ColorMap[531] = [ATBackgroundColor24None]::new()
        $this.ColorMap[532] = [ATBackgroundColor24None]::new()
        $this.ColorMap[533] = [ATBackgroundColor24None]::new()
        $this.ColorMap[534] = [ATBackgroundColor24None]::new()
        $this.ColorMap[535] = [ATBackgroundColor24None]::new()
        $this.ColorMap[536] = [ATBackgroundColor24None]::new()
        $this.ColorMap[537] = [ATBackgroundColor24None]::new()
        $this.ColorMap[538] = [ATBackgroundColor24None]::new()
        $this.ColorMap[539] = [ATBackgroundColor24None]::new()
        $this.ColorMap[540] = [ATBackgroundColor24None]::new()
        $this.ColorMap[541] = [ATBackgroundColor24None]::new()
        $this.ColorMap[542] = [ATBackgroundColor24None]::new()
        $this.ColorMap[543] = [ATBackgroundColor24None]::new()
        $this.ColorMap[544] = [ATBackgroundColor24None]::new()
        $this.ColorMap[545] = [ATBackgroundColor24None]::new()
        $this.ColorMap[546] = [ATBackgroundColor24None]::new()
        $this.ColorMap[547] = [ATBackgroundColor24None]::new()
        $this.ColorMap[548] = [ATBackgroundColor24None]::new()
        $this.ColorMap[549] = [ATBackgroundColor24None]::new()
        $this.ColorMap[550] = [ATBackgroundColor24None]::new()
        $this.ColorMap[551] = [ATBackgroundColor24None]::new()
        $this.ColorMap[552] = [ATBackgroundColor24None]::new()
        $this.ColorMap[553] = [ATBackgroundColor24None]::new()
        $this.ColorMap[554] = [ATBackgroundColor24None]::new() # End Row 14

        $this.CreateImageATString($this.ColorMap)
        $this.ColorMap = $null
    }
}

Class EEINightwing : EEIInternalBase {
    EEINightwing() : base() {
        $this.ColorMap[0]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[1]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[2]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[3]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[4]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[5]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[6]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[7]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[8]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[9]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[10]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[11]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[12]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[13]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[14]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[15]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[16]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[17]  = [CCAppleIndigoDark24]::new()
        $this.ColorMap[18]  = [CCAppleIndigoDark24]::new()
        $this.ColorMap[19]  = [CCAppleIndigoDark24]::new()
        $this.ColorMap[20]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[21]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[22]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[23]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[24]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[25]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[26]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[27]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[28]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[29]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[30]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[31]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[32]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[33]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[34]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[35]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[36]  = [ATBackgroundColor24None]::new() # End Row 0
        $this.ColorMap[37]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[38]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[39]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[40]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[41]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[42]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[43]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[44]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[45]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[46]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[47]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[48]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[49]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[50]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[51]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[52]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[53]  = [CCAppleIndigoDark24]::new()
        $this.ColorMap[54]  = [CCAppleIndigoDark24]::new()
        $this.ColorMap[55]  = [CCAppleIndigoDark24]::new()
        $this.ColorMap[56]  = [CCAppleIndigoDark24]::new()
        $this.ColorMap[57]  = [CCAppleIndigoDark24]::new()
        $this.ColorMap[58]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[59]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[60]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[61]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[62]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[63]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[64]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[65]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[66]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[67]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[68]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[69]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[70]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[71]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[72]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[73]  = [ATBackgroundColor24None]::new() # End Row 1
        $this.ColorMap[74]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[75]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[76]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[77]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[78]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[79]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[80]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[81]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[82]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[83]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[84]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[85]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[86]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[87]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[88]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[89]  = [CCAppleIndigoDark24]::new()
        $this.ColorMap[90]  = [CCAppleIndigoDark24]::new()
        $this.ColorMap[91]  = [CCAppleRedDark24]::new()
        $this.ColorMap[92]  = [CCAppleIndigoDark24]::new()
        $this.ColorMap[93]  = [CCAppleRedDark24]::new()
        $this.ColorMap[94]  = [CCAppleIndigoDark24]::new()
        $this.ColorMap[95]  = [CCAppleIndigoDark24]::new()
        $this.ColorMap[96]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[97]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[98]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[99]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[100] = [ATBackgroundColor24None]::new()
        $this.ColorMap[101] = [ATBackgroundColor24None]::new()
        $this.ColorMap[102] = [ATBackgroundColor24None]::new()
        $this.ColorMap[103] = [ATBackgroundColor24None]::new()
        $this.ColorMap[104] = [ATBackgroundColor24None]::new()
        $this.ColorMap[105] = [ATBackgroundColor24None]::new()
        $this.ColorMap[106] = [ATBackgroundColor24None]::new()
        $this.ColorMap[107] = [ATBackgroundColor24None]::new()
        $this.ColorMap[108] = [ATBackgroundColor24None]::new()
        $this.ColorMap[109] = [ATBackgroundColor24None]::new()
        $this.ColorMap[110] = [ATBackgroundColor24None]::new() # End Row 2
        $this.ColorMap[111] = [ATBackgroundColor24None]::new()
        $this.ColorMap[112] = [ATBackgroundColor24None]::new()
        $this.ColorMap[113] = [ATBackgroundColor24None]::new()
        $this.ColorMap[114] = [ATBackgroundColor24None]::new()
        $this.ColorMap[115] = [ATBackgroundColor24None]::new()
        $this.ColorMap[116] = [CCApplePurpleDark24]::new()
        $this.ColorMap[117] = [CCApplePurpleDark24]::new()
        $this.ColorMap[118] = [ATBackgroundColor24None]::new()
        $this.ColorMap[119] = [ATBackgroundColor24None]::new()
        $this.ColorMap[120] = [ATBackgroundColor24None]::new()
        $this.ColorMap[121] = [ATBackgroundColor24None]::new()
        $this.ColorMap[122] = [CCApplePurpleDark24]::new()
        $this.ColorMap[123] = [CCApplePurpleDark24]::new()
        $this.ColorMap[124] = [ATBackgroundColor24None]::new()
        $this.ColorMap[125] = [ATBackgroundColor24None]::new()
        $this.ColorMap[126] = [ATBackgroundColor24None]::new()
        $this.ColorMap[127] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[128] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[129] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[130] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[131] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[132] = [ATBackgroundColor24None]::new()
        $this.ColorMap[133] = [ATBackgroundColor24None]::new()
        $this.ColorMap[134] = [ATBackgroundColor24None]::new()
        $this.ColorMap[135] = [CCApplePurpleDark24]::new()
        $this.ColorMap[136] = [CCApplePurpleDark24]::new()
        $this.ColorMap[137] = [ATBackgroundColor24None]::new()
        $this.ColorMap[138] = [ATBackgroundColor24None]::new()
        $this.ColorMap[139] = [ATBackgroundColor24None]::new()
        $this.ColorMap[140] = [ATBackgroundColor24None]::new()
        $this.ColorMap[141] = [CCApplePurpleDark24]::new()
        $this.ColorMap[142] = [CCApplePurpleDark24]::new()
        $this.ColorMap[143] = [ATBackgroundColor24None]::new()
        $this.ColorMap[144] = [ATBackgroundColor24None]::new()
        $this.ColorMap[145] = [ATBackgroundColor24None]::new()
        $this.ColorMap[146] = [ATBackgroundColor24None]::new()
        $this.ColorMap[147] = [ATBackgroundColor24None]::new() # End Row 3
        $this.ColorMap[148] = [ATBackgroundColor24None]::new()
        $this.ColorMap[149] = [ATBackgroundColor24None]::new()
        $this.ColorMap[150] = [ATBackgroundColor24None]::new()
        $this.ColorMap[151] = [ATBackgroundColor24None]::new()
        $this.ColorMap[152] = [CCApplePurpleDark24]::new()
        $this.ColorMap[153] = [CCApplePurpleDark24]::new()
        $this.ColorMap[154] = [CCApplePurpleDark24]::new()
        $this.ColorMap[155] = [CCApplePurpleDark24]::new()
        $this.ColorMap[156] = [CCApplePurpleDark24]::new()
        $this.ColorMap[157] = [ATBackgroundColor24None]::new()
        $this.ColorMap[158] = [CCApplePurpleDark24]::new()
        $this.ColorMap[159] = [CCApplePurpleDark24]::new()
        $this.ColorMap[160] = [CCApplePurpleDark24]::new()
        $this.ColorMap[161] = [CCApplePurpleDark24]::new()
        $this.ColorMap[162] = [CCApplePurpleDark24]::new()
        $this.ColorMap[163] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[164] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[165] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[166] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[167] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[168] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[169] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[170] = [CCApplePurpleDark24]::new()
        $this.ColorMap[171] = [CCApplePurpleDark24]::new()
        $this.ColorMap[172] = [CCApplePurpleDark24]::new()
        $this.ColorMap[173] = [CCApplePurpleDark24]::new()
        $this.ColorMap[174] = [CCApplePurpleDark24]::new()
        $this.ColorMap[175] = [ATBackgroundColor24None]::new()
        $this.ColorMap[176] = [CCApplePurpleDark24]::new()
        $this.ColorMap[177] = [CCApplePurpleDark24]::new()
        $this.ColorMap[178] = [CCApplePurpleDark24]::new()
        $this.ColorMap[179] = [CCApplePurpleDark24]::new()
        $this.ColorMap[180] = [CCApplePurpleDark24]::new()
        $this.ColorMap[181] = [ATBackgroundColor24None]::new()
        $this.ColorMap[182] = [ATBackgroundColor24None]::new()
        $this.ColorMap[183] = [ATBackgroundColor24None]::new()
        $this.ColorMap[184] = [ATBackgroundColor24None]::new() # End Row 4
        $this.ColorMap[185] = [ATBackgroundColor24None]::new()
        $this.ColorMap[186] = [ATBackgroundColor24None]::new()
        $this.ColorMap[187] = [ATBackgroundColor24None]::new()
        $this.ColorMap[188] = [ATBackgroundColor24None]::new()
        $this.ColorMap[189] = [CCApplePurpleDark24]::new()
        $this.ColorMap[190] = [CCApplePurpleDark24]::new()
        $this.ColorMap[191] = [CCApplePurpleDark24]::new()
        $this.ColorMap[192] = [CCApplePurpleDark24]::new()
        $this.ColorMap[193] = [CCApplePurpleDark24]::new()
        $this.ColorMap[194] = [CCApplePurpleDark24]::new()
        $this.ColorMap[195] = [CCApplePurpleDark24]::new()
        $this.ColorMap[196] = [CCApplePurpleDark24]::new()
        $this.ColorMap[197] = [CCApplePurpleDark24]::new()
        $this.ColorMap[198] = [CCApplePurpleDark24]::new()
        $this.ColorMap[199] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[200] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[201] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[202] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[203] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[204] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[205] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[206] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[207] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[208] = [CCApplePurpleDark24]::new()
        $this.ColorMap[209] = [CCApplePurpleDark24]::new()
        $this.ColorMap[210] = [CCApplePurpleDark24]::new()
        $this.ColorMap[211] = [CCApplePurpleDark24]::new()
        $this.ColorMap[212] = [CCApplePurpleDark24]::new()
        $this.ColorMap[213] = [CCApplePurpleDark24]::new()
        $this.ColorMap[214] = [CCApplePurpleDark24]::new()
        $this.ColorMap[215] = [CCApplePurpleDark24]::new()
        $this.ColorMap[216] = [CCApplePurpleDark24]::new()
        $this.ColorMap[217] = [CCApplePurpleDark24]::new()
        $this.ColorMap[218] = [ATBackgroundColor24None]::new()
        $this.ColorMap[219] = [ATBackgroundColor24None]::new()
        $this.ColorMap[220] = [ATBackgroundColor24None]::new()
        $this.ColorMap[221] = [ATBackgroundColor24None]::new() # End Row 5
        $this.ColorMap[222] = [ATBackgroundColor24None]::new()
        $this.ColorMap[223] = [ATBackgroundColor24None]::new()
        $this.ColorMap[224] = [ATBackgroundColor24None]::new()
        $this.ColorMap[225] = [CCApplePurpleDark24]::new()
        $this.ColorMap[226] = [CCApplePurpleDark24]::new()
        $this.ColorMap[227] = [CCApplePurpleDark24]::new()
        $this.ColorMap[228] = [CCApplePurpleDark24]::new()
        $this.ColorMap[229] = [CCApplePurpleDark24]::new()
        $this.ColorMap[230] = [CCApplePurpleDark24]::new()
        $this.ColorMap[231] = [CCApplePurpleDark24]::new()
        $this.ColorMap[232] = [CCApplePurpleDark24]::new()
        $this.ColorMap[233] = [CCApplePurpleDark24]::new()
        $this.ColorMap[234] = [CCApplePurpleDark24]::new()
        $this.ColorMap[235] = [CCApplePurpleDark24]::new()
        $this.ColorMap[236] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[237] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[238] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[239] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[240] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[241] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[242] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[243] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[244] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[245] = [CCApplePurpleDark24]::new()
        $this.ColorMap[246] = [CCApplePurpleDark24]::new()
        $this.ColorMap[247] = [CCApplePurpleDark24]::new()
        $this.ColorMap[248] = [CCApplePurpleDark24]::new()
        $this.ColorMap[249] = [CCApplePurpleDark24]::new()
        $this.ColorMap[250] = [CCApplePurpleDark24]::new()
        $this.ColorMap[251] = [CCApplePurpleDark24]::new()
        $this.ColorMap[252] = [CCApplePurpleDark24]::new()
        $this.ColorMap[253] = [CCApplePurpleDark24]::new()
        $this.ColorMap[254] = [CCApplePurpleDark24]::new()
        $this.ColorMap[255] = [CCApplePurpleDark24]::new()
        $this.ColorMap[256] = [ATBackgroundColor24None]::new()
        $this.ColorMap[257] = [ATBackgroundColor24None]::new()
        $this.ColorMap[258] = [ATBackgroundColor24None]::new() # End Row 6
        $this.ColorMap[259] = [ATBackgroundColor24None]::new()
        $this.ColorMap[260] = [ATBackgroundColor24None]::new()
        $this.ColorMap[261] = [ATBackgroundColor24None]::new()
        $this.ColorMap[262] = [CCApplePurpleDark24]::new()
        $this.ColorMap[263] = [CCApplePurpleDark24]::new()
        $this.ColorMap[264] = [CCApplePurpleDark24]::new()
        $this.ColorMap[265] = [CCApplePurpleDark24]::new()
        $this.ColorMap[266] = [CCApplePurpleDark24]::new()
        $this.ColorMap[267] = [CCApplePurpleDark24]::new()
        $this.ColorMap[268] = [CCApplePurpleDark24]::new()
        $this.ColorMap[269] = [CCApplePurpleDark24]::new()
        $this.ColorMap[270] = [CCApplePurpleDark24]::new()
        $this.ColorMap[271] = [CCApplePurpleDark24]::new()
        $this.ColorMap[272] = [CCApplePurpleDark24]::new()
        $this.ColorMap[273] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[274] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[275] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[276] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[277] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[278] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[279] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[280] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[281] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[282] = [CCApplePurpleDark24]::new()
        $this.ColorMap[283] = [CCApplePurpleDark24]::new()
        $this.ColorMap[284] = [CCApplePurpleDark24]::new()
        $this.ColorMap[285] = [CCApplePurpleDark24]::new()
        $this.ColorMap[286] = [CCApplePurpleDark24]::new()
        $this.ColorMap[287] = [CCApplePurpleDark24]::new()
        $this.ColorMap[288] = [CCApplePurpleDark24]::new()
        $this.ColorMap[289] = [CCApplePurpleDark24]::new()
        $this.ColorMap[290] = [CCApplePurpleDark24]::new()
        $this.ColorMap[291] = [CCApplePurpleDark24]::new()
        $this.ColorMap[292] = [CCApplePurpleDark24]::new()
        $this.ColorMap[293] = [ATBackgroundColor24None]::new()
        $this.ColorMap[294] = [ATBackgroundColor24None]::new()
        $this.ColorMap[295] = [ATBackgroundColor24None]::new() # End Row 7
        $this.ColorMap[296] = [ATBackgroundColor24None]::new()
        $this.ColorMap[297] = [ATBackgroundColor24None]::new()
        $this.ColorMap[298] = [ATBackgroundColor24None]::new()
        $this.ColorMap[299] = [CCApplePurpleDark24]::new()
        $this.ColorMap[300] = [CCApplePurpleDark24]::new()
        $this.ColorMap[301] = [CCApplePurpleDark24]::new()
        $this.ColorMap[302] = [CCApplePurpleDark24]::new()
        $this.ColorMap[303] = [CCApplePurpleDark24]::new()
        $this.ColorMap[304] = [CCApplePurpleDark24]::new()
        $this.ColorMap[305] = [CCApplePurpleDark24]::new()
        $this.ColorMap[306] = [CCApplePurpleDark24]::new()
        $this.ColorMap[307] = [CCApplePurpleDark24]::new()
        $this.ColorMap[308] = [CCApplePurpleDark24]::new()
        $this.ColorMap[309] = [CCApplePurpleDark24]::new()
        $this.ColorMap[310] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[311] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[312] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[313] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[314] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[315] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[316] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[317] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[318] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[319] = [CCApplePurpleDark24]::new()
        $this.ColorMap[320] = [CCApplePurpleDark24]::new()
        $this.ColorMap[321] = [CCApplePurpleDark24]::new()
        $this.ColorMap[322] = [CCApplePurpleDark24]::new()
        $this.ColorMap[323] = [CCApplePurpleDark24]::new()
        $this.ColorMap[324] = [CCApplePurpleDark24]::new()
        $this.ColorMap[325] = [CCApplePurpleDark24]::new()
        $this.ColorMap[326] = [CCApplePurpleDark24]::new()
        $this.ColorMap[327] = [CCApplePurpleDark24]::new()
        $this.ColorMap[328] = [CCApplePurpleDark24]::new()
        $this.ColorMap[329] = [CCApplePurpleDark24]::new()
        $this.ColorMap[330] = [ATBackgroundColor24None]::new()
        $this.ColorMap[331] = [ATBackgroundColor24None]::new()
        $this.ColorMap[332] = [ATBackgroundColor24None]::new() # End Row 8
        $this.ColorMap[333] = [ATBackgroundColor24None]::new()
        $this.ColorMap[334] = [ATBackgroundColor24None]::new()
        $this.ColorMap[335] = [CCApplePurpleDark24]::new()
        $this.ColorMap[336] = [CCApplePurpleDark24]::new()
        $this.ColorMap[337] = [CCApplePurpleDark24]::new()
        $this.ColorMap[338] = [CCApplePurpleDark24]::new()
        $this.ColorMap[339] = [CCApplePurpleDark24]::new()
        $this.ColorMap[340] = [CCApplePurpleDark24]::new()
        $this.ColorMap[341] = [CCApplePurpleDark24]::new()
        $this.ColorMap[342] = [CCApplePurpleDark24]::new()
        $this.ColorMap[343] = [CCApplePurpleDark24]::new()
        $this.ColorMap[344] = [CCApplePurpleDark24]::new()
        $this.ColorMap[345] = [ATBackgroundColor24None]::new()
        $this.ColorMap[346] = [ATBackgroundColor24None]::new()
        $this.ColorMap[347] = [CCApplePurpleDark24]::new()
        $this.ColorMap[348] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[349] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[350] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[351] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[352] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[353] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[354] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[355] = [CCApplePurpleDark24]::new()
        $this.ColorMap[356] = [ATBackgroundColor24None]::new()
        $this.ColorMap[357] = [ATBackgroundColor24None]::new()
        $this.ColorMap[358] = [CCApplePurpleDark24]::new()
        $this.ColorMap[359] = [CCApplePurpleDark24]::new()
        $this.ColorMap[360] = [CCApplePurpleDark24]::new()
        $this.ColorMap[361] = [CCApplePurpleDark24]::new()
        $this.ColorMap[362] = [CCApplePurpleDark24]::new()
        $this.ColorMap[363] = [CCApplePurpleDark24]::new()
        $this.ColorMap[364] = [CCApplePurpleDark24]::new()
        $this.ColorMap[365] = [CCApplePurpleDark24]::new()
        $this.ColorMap[366] = [CCApplePurpleDark24]::new()
        $this.ColorMap[367] = [CCApplePurpleDark24]::new()
        $this.ColorMap[368] = [ATBackgroundColor24None]::new()
        $this.ColorMap[369] = [ATBackgroundColor24None]::new() # End Row 9
        $this.ColorMap[370] = [ATBackgroundColor24None]::new()
        $this.ColorMap[371] = [ATBackgroundColor24None]::new()
        $this.ColorMap[372] = [CCApplePurpleDark24]::new()
        $this.ColorMap[373] = [CCApplePurpleDark24]::new()
        $this.ColorMap[374] = [CCApplePurpleDark24]::new()
        $this.ColorMap[375] = [CCApplePurpleDark24]::new()
        $this.ColorMap[376] = [ATBackgroundColor24None]::new()
        $this.ColorMap[377] = [ATBackgroundColor24None]::new()
        $this.ColorMap[378] = [CCApplePurpleDark24]::new()
        $this.ColorMap[379] = [CCApplePurpleDark24]::new()
        $this.ColorMap[380] = [CCApplePurpleDark24]::new()
        $this.ColorMap[381] = [ATBackgroundColor24None]::new()
        $this.ColorMap[382] = [ATBackgroundColor24None]::new()
        $this.ColorMap[383] = [ATBackgroundColor24None]::new()
        $this.ColorMap[384] = [ATBackgroundColor24None]::new()
        $this.ColorMap[385] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[386] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[387] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[388] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[389] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[390] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[391] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[392] = [ATBackgroundColor24None]::new()
        $this.ColorMap[393] = [ATBackgroundColor24None]::new()
        $this.ColorMap[394] = [ATBackgroundColor24None]::new()
        $this.ColorMap[395] = [ATBackgroundColor24None]::new()
        $this.ColorMap[396] = [CCApplePurpleDark24]::new()
        $this.ColorMap[397] = [CCApplePurpleDark24]::new()
        $this.ColorMap[398] = [CCApplePurpleDark24]::new()
        $this.ColorMap[399] = [ATBackgroundColor24None]::new()
        $this.ColorMap[400] = [ATBackgroundColor24None]::new()
        $this.ColorMap[401] = [CCApplePurpleDark24]::new()
        $this.ColorMap[402] = [CCApplePurpleDark24]::new()
        $this.ColorMap[403] = [CCApplePurpleDark24]::new()
        $this.ColorMap[404] = [CCApplePurpleDark24]::new()
        $this.ColorMap[405] = [ATBackgroundColor24None]::new()
        $this.ColorMap[406] = [ATBackgroundColor24None]::new() # End Row 10
        $this.ColorMap[407] = [ATBackgroundColor24None]::new()
        $this.ColorMap[408] = [ATBackgroundColor24None]::new()
        $this.ColorMap[409] = [CCApplePurpleDark24]::new()
        $this.ColorMap[410] = [CCApplePurpleDark24]::new()
        $this.ColorMap[411] = [ATBackgroundColor24None]::new()
        $this.ColorMap[412] = [ATBackgroundColor24None]::new()
        $this.ColorMap[413] = [ATBackgroundColor24None]::new()
        $this.ColorMap[414] = [ATBackgroundColor24None]::new()
        $this.ColorMap[415] = [ATBackgroundColor24None]::new()
        $this.ColorMap[416] = [CCApplePurpleDark24]::new()
        $this.ColorMap[417] = [ATBackgroundColor24None]::new()
        $this.ColorMap[418] = [ATBackgroundColor24None]::new()
        $this.ColorMap[419] = [ATBackgroundColor24None]::new()
        $this.ColorMap[420] = [CCAppleOrangeDark24]::new()
        $this.ColorMap[421] = [ATBackgroundColor24None]::new()
        $this.ColorMap[422] = [ATBackgroundColor24None]::new()
        $this.ColorMap[423] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[424] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[425] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[426] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[427] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[428] = [ATBackgroundColor24None]::new()
        $this.ColorMap[429] = [ATBackgroundColor24None]::new()
        $this.ColorMap[430] = [CCAppleOrangeDark24]::new()
        $this.ColorMap[431] = [ATBackgroundColor24None]::new()
        $this.ColorMap[432] = [ATBackgroundColor24None]::new()
        $this.ColorMap[433] = [ATBackgroundColor24None]::new()
        $this.ColorMap[434] = [CCApplePurpleDark24]::new()
        $this.ColorMap[435] = [ATBackgroundColor24None]::new()
        $this.ColorMap[436] = [ATBackgroundColor24None]::new()
        $this.ColorMap[437] = [ATBackgroundColor24None]::new()
        $this.ColorMap[438] = [ATBackgroundColor24None]::new()
        $this.ColorMap[439] = [ATBackgroundColor24None]::new()
        $this.ColorMap[440] = [CCApplePurpleDark24]::new()
        $this.ColorMap[441] = [CCApplePurpleDark24]::new()
        $this.ColorMap[442] = [ATBackgroundColor24None]::new()
        $this.ColorMap[443] = [ATBackgroundColor24None]::new() # End Row 11
        $this.ColorMap[444] = [ATBackgroundColor24None]::new()
        $this.ColorMap[445] = [ATBackgroundColor24None]::new()
        $this.ColorMap[446] = [CCApplePurpleDark24]::new()
        $this.ColorMap[447] = [ATBackgroundColor24None]::new()
        $this.ColorMap[448] = [ATBackgroundColor24None]::new()
        $this.ColorMap[449] = [ATBackgroundColor24None]::new()
        $this.ColorMap[450] = [ATBackgroundColor24None]::new()
        $this.ColorMap[451] = [ATBackgroundColor24None]::new()
        $this.ColorMap[452] = [ATBackgroundColor24None]::new()
        $this.ColorMap[453] = [ATBackgroundColor24None]::new()
        $this.ColorMap[454] = [ATBackgroundColor24None]::new()
        $this.ColorMap[455] = [ATBackgroundColor24None]::new()
        $this.ColorMap[456] = [ATBackgroundColor24None]::new()
        $this.ColorMap[457] = [ATBackgroundColor24None]::new()
        $this.ColorMap[458] = [CCAppleOrangeDark24]::new()
        $this.ColorMap[459] = [CCAppleOrangeDark24]::new()
        $this.ColorMap[460] = [ATBackgroundColor24None]::new()
        $this.ColorMap[461] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[462] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[463] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[464] = [ATBackgroundColor24None]::new()
        $this.ColorMap[465] = [CCAppleOrangeDark24]::new()
        $this.ColorMap[466] = [CCAppleOrangeDark24]::new()
        $this.ColorMap[467] = [ATBackgroundColor24None]::new()
        $this.ColorMap[468] = [ATBackgroundColor24None]::new()
        $this.ColorMap[469] = [ATBackgroundColor24None]::new()
        $this.ColorMap[470] = [ATBackgroundColor24None]::new()
        $this.ColorMap[471] = [ATBackgroundColor24None]::new()
        $this.ColorMap[472] = [ATBackgroundColor24None]::new()
        $this.ColorMap[473] = [ATBackgroundColor24None]::new()
        $this.ColorMap[474] = [ATBackgroundColor24None]::new()
        $this.ColorMap[475] = [ATBackgroundColor24None]::new()
        $this.ColorMap[476] = [ATBackgroundColor24None]::new()
        $this.ColorMap[477] = [ATBackgroundColor24None]::new()
        $this.ColorMap[478] = [CCApplePurpleDark24]::new()
        $this.ColorMap[479] = [ATBackgroundColor24None]::new()
        $this.ColorMap[480] = [ATBackgroundColor24None]::new() # End Row 12
        $this.ColorMap[481] = [ATBackgroundColor24None]::new()
        $this.ColorMap[482] = [ATBackgroundColor24None]::new()
        $this.ColorMap[483] = [ATBackgroundColor24None]::new()
        $this.ColorMap[484] = [ATBackgroundColor24None]::new()
        $this.ColorMap[485] = [ATBackgroundColor24None]::new()
        $this.ColorMap[486] = [ATBackgroundColor24None]::new()
        $this.ColorMap[487] = [ATBackgroundColor24None]::new()
        $this.ColorMap[488] = [ATBackgroundColor24None]::new()
        $this.ColorMap[489] = [ATBackgroundColor24None]::new()
        $this.ColorMap[490] = [ATBackgroundColor24None]::new()
        $this.ColorMap[491] = [ATBackgroundColor24None]::new()
        $this.ColorMap[492] = [ATBackgroundColor24None]::new()
        $this.ColorMap[493] = [ATBackgroundColor24None]::new()
        $this.ColorMap[494] = [CCAppleOrangeDark24]::new()
        $this.ColorMap[495] = [ATBackgroundColor24None]::new()
        $this.ColorMap[496] = [ATBackgroundColor24None]::new()
        $this.ColorMap[497] = [ATBackgroundColor24None]::new()
        $this.ColorMap[498] = [ATBackgroundColor24None]::new()
        $this.ColorMap[499] = [CCAppleIndigoDark24]::new()
        $this.ColorMap[500] = [ATBackgroundColor24None]::new()
        $this.ColorMap[501] = [ATBackgroundColor24None]::new()
        $this.ColorMap[502] = [ATBackgroundColor24None]::new()
        $this.ColorMap[503] = [ATBackgroundColor24None]::new()
        $this.ColorMap[504] = [CCAppleOrangeDark24]::new()
        $this.ColorMap[505] = [ATBackgroundColor24None]::new()
        $this.ColorMap[506] = [ATBackgroundColor24None]::new()
        $this.ColorMap[507] = [ATBackgroundColor24None]::new()
        $this.ColorMap[508] = [ATBackgroundColor24None]::new()
        $this.ColorMap[509] = [ATBackgroundColor24None]::new()
        $this.ColorMap[510] = [ATBackgroundColor24None]::new()
        $this.ColorMap[511] = [ATBackgroundColor24None]::new()
        $this.ColorMap[512] = [ATBackgroundColor24None]::new()
        $this.ColorMap[513] = [ATBackgroundColor24None]::new()
        $this.ColorMap[514] = [ATBackgroundColor24None]::new()
        $this.ColorMap[515] = [ATBackgroundColor24None]::new()
        $this.ColorMap[516] = [ATBackgroundColor24None]::new()
        $this.ColorMap[517] = [ATBackgroundColor24None]::new() # End Row 13
        $this.ColorMap[518] = [ATBackgroundColor24None]::new()
        $this.ColorMap[519] = [ATBackgroundColor24None]::new()
        $this.ColorMap[520] = [ATBackgroundColor24None]::new()
        $this.ColorMap[521] = [ATBackgroundColor24None]::new()
        $this.ColorMap[522] = [ATBackgroundColor24None]::new()
        $this.ColorMap[523] = [ATBackgroundColor24None]::new()
        $this.ColorMap[524] = [ATBackgroundColor24None]::new()
        $this.ColorMap[525] = [ATBackgroundColor24None]::new()
        $this.ColorMap[526] = [ATBackgroundColor24None]::new()
        $this.ColorMap[527] = [ATBackgroundColor24None]::new()
        $this.ColorMap[528] = [ATBackgroundColor24None]::new()
        $this.ColorMap[529] = [ATBackgroundColor24None]::new()
        $this.ColorMap[530] = [ATBackgroundColor24None]::new()
        $this.ColorMap[531] = [ATBackgroundColor24None]::new()
        $this.ColorMap[532] = [ATBackgroundColor24None]::new()
        $this.ColorMap[533] = [ATBackgroundColor24None]::new()
        $this.ColorMap[534] = [ATBackgroundColor24None]::new()
        $this.ColorMap[535] = [ATBackgroundColor24None]::new()
        $this.ColorMap[536] = [ATBackgroundColor24None]::new()
        $this.ColorMap[537] = [ATBackgroundColor24None]::new()
        $this.ColorMap[538] = [ATBackgroundColor24None]::new()
        $this.ColorMap[539] = [ATBackgroundColor24None]::new()
        $this.ColorMap[540] = [ATBackgroundColor24None]::new()
        $this.ColorMap[541] = [ATBackgroundColor24None]::new()
        $this.ColorMap[542] = [ATBackgroundColor24None]::new()
        $this.ColorMap[543] = [ATBackgroundColor24None]::new()
        $this.ColorMap[544] = [ATBackgroundColor24None]::new()
        $this.ColorMap[545] = [ATBackgroundColor24None]::new()
        $this.ColorMap[546] = [ATBackgroundColor24None]::new()
        $this.ColorMap[547] = [ATBackgroundColor24None]::new()
        $this.ColorMap[548] = [ATBackgroundColor24None]::new()
        $this.ColorMap[549] = [ATBackgroundColor24None]::new()
        $this.ColorMap[550] = [ATBackgroundColor24None]::new()
        $this.ColorMap[551] = [ATBackgroundColor24None]::new()
        $this.ColorMap[552] = [ATBackgroundColor24None]::new()
        $this.ColorMap[553] = [ATBackgroundColor24None]::new()
        $this.ColorMap[554] = [ATBackgroundColor24None]::new() # End Row 14

        $this.CreateImageATString($this.ColorMap)
        $this.ColorMap = $null
    }
}

Class EEIWingblight : EEIInternalBase {
    EEIWingblight() : base() {
        $this.ColorMap[0]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[1]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[2]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[3]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[4]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[5]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[6]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[7]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[8]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[9]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[10]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[11]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[12]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[13]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[14]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[15]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[16]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[17]  = [CCApplePinkDark24]::new()
        $this.ColorMap[18]  = [CCApplePinkDark24]::new()
        $this.ColorMap[19]  = [CCApplePinkDark24]::new()
        $this.ColorMap[20]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[21]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[22]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[23]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[24]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[25]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[26]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[27]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[28]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[29]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[30]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[31]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[32]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[33]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[34]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[35]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[36]  = [ATBackgroundColor24None]::new() # End Row 0
        $this.ColorMap[37]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[38]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[39]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[40]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[41]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[42]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[43]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[44]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[45]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[46]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[47]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[48]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[49]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[50]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[51]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[52]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[53]  = [CCApplePinkDark24]::new()
        $this.ColorMap[54]  = [CCApplePinkDark24]::new()
        $this.ColorMap[55]  = [CCApplePinkDark24]::new()
        $this.ColorMap[56]  = [CCApplePinkDark24]::new()
        $this.ColorMap[57]  = [CCApplePinkDark24]::new()
        $this.ColorMap[58]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[59]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[60]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[61]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[62]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[63]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[64]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[65]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[66]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[67]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[68]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[69]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[70]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[71]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[72]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[73]  = [ATBackgroundColor24None]::new() # End Row 1
        $this.ColorMap[74]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[75]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[76]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[77]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[78]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[79]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[80]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[81]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[82]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[83]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[84]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[85]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[86]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[87]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[88]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[89]  = [CCApplePinkDark24]::new()
        $this.ColorMap[90]  = [CCApplePinkDark24]::new()
        $this.ColorMap[91]  = [CCAppleGrey6Light24]::new()
        $this.ColorMap[92]  = [CCApplePinkDark24]::new()
        $this.ColorMap[93]  = [CCAppleGrey6Light24]::new()
        $this.ColorMap[94]  = [CCApplePinkDark24]::new()
        $this.ColorMap[95]  = [CCApplePinkDark24]::new()
        $this.ColorMap[96]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[97]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[98]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[99]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[100] = [ATBackgroundColor24None]::new()
        $this.ColorMap[101] = [ATBackgroundColor24None]::new()
        $this.ColorMap[102] = [ATBackgroundColor24None]::new()
        $this.ColorMap[103] = [ATBackgroundColor24None]::new()
        $this.ColorMap[104] = [ATBackgroundColor24None]::new()
        $this.ColorMap[105] = [ATBackgroundColor24None]::new()
        $this.ColorMap[106] = [ATBackgroundColor24None]::new()
        $this.ColorMap[107] = [ATBackgroundColor24None]::new()
        $this.ColorMap[108] = [ATBackgroundColor24None]::new()
        $this.ColorMap[109] = [ATBackgroundColor24None]::new()
        $this.ColorMap[110] = [ATBackgroundColor24None]::new() # End Row 2
        $this.ColorMap[111] = [ATBackgroundColor24None]::new()
        $this.ColorMap[112] = [ATBackgroundColor24None]::new()
        $this.ColorMap[113] = [ATBackgroundColor24None]::new()
        $this.ColorMap[114] = [ATBackgroundColor24None]::new()
        $this.ColorMap[115] = [ATBackgroundColor24None]::new()
        $this.ColorMap[116] = [CCApplePurpleDark24]::new()
        $this.ColorMap[117] = [CCApplePurpleDark24]::new()
        $this.ColorMap[118] = [ATBackgroundColor24None]::new()
        $this.ColorMap[119] = [ATBackgroundColor24None]::new()
        $this.ColorMap[120] = [ATBackgroundColor24None]::new()
        $this.ColorMap[121] = [ATBackgroundColor24None]::new()
        $this.ColorMap[122] = [CCApplePurpleDark24]::new()
        $this.ColorMap[123] = [CCApplePurpleDark24]::new()
        $this.ColorMap[124] = [ATBackgroundColor24None]::new()
        $this.ColorMap[125] = [ATBackgroundColor24None]::new()
        $this.ColorMap[126] = [ATBackgroundColor24None]::new()
        $this.ColorMap[127] = [CCApplePinkDark24]::new()
        $this.ColorMap[128] = [CCApplePinkDark24]::new()
        $this.ColorMap[129] = [CCApplePinkDark24]::new()
        $this.ColorMap[130] = [CCApplePinkDark24]::new()
        $this.ColorMap[131] = [CCApplePinkDark24]::new()
        $this.ColorMap[132] = [ATBackgroundColor24None]::new()
        $this.ColorMap[133] = [ATBackgroundColor24None]::new()
        $this.ColorMap[134] = [ATBackgroundColor24None]::new()
        $this.ColorMap[135] = [CCApplePurpleDark24]::new()
        $this.ColorMap[136] = [CCApplePurpleDark24]::new()
        $this.ColorMap[137] = [ATBackgroundColor24None]::new()
        $this.ColorMap[138] = [ATBackgroundColor24None]::new()
        $this.ColorMap[139] = [ATBackgroundColor24None]::new()
        $this.ColorMap[140] = [ATBackgroundColor24None]::new()
        $this.ColorMap[141] = [CCApplePurpleDark24]::new()
        $this.ColorMap[142] = [CCApplePurpleDark24]::new()
        $this.ColorMap[143] = [ATBackgroundColor24None]::new()
        $this.ColorMap[144] = [ATBackgroundColor24None]::new()
        $this.ColorMap[145] = [ATBackgroundColor24None]::new()
        $this.ColorMap[146] = [ATBackgroundColor24None]::new()
        $this.ColorMap[147] = [ATBackgroundColor24None]::new() # End Row 3
        $this.ColorMap[148] = [ATBackgroundColor24None]::new()
        $this.ColorMap[149] = [ATBackgroundColor24None]::new()
        $this.ColorMap[150] = [ATBackgroundColor24None]::new()
        $this.ColorMap[151] = [ATBackgroundColor24None]::new()
        $this.ColorMap[152] = [CCApplePurpleDark24]::new()
        $this.ColorMap[153] = [CCApplePurpleDark24]::new()
        $this.ColorMap[154] = [CCApplePurpleDark24]::new()
        $this.ColorMap[155] = [CCApplePurpleDark24]::new()
        $this.ColorMap[156] = [CCApplePurpleDark24]::new()
        $this.ColorMap[157] = [ATBackgroundColor24None]::new()
        $this.ColorMap[158] = [CCApplePurpleDark24]::new()
        $this.ColorMap[159] = [CCApplePurpleDark24]::new()
        $this.ColorMap[160] = [CCApplePurpleDark24]::new()
        $this.ColorMap[161] = [CCApplePurpleDark24]::new()
        $this.ColorMap[162] = [CCApplePurpleDark24]::new()
        $this.ColorMap[163] = [CCApplePinkDark24]::new()
        $this.ColorMap[164] = [CCApplePinkDark24]::new()
        $this.ColorMap[165] = [CCApplePinkDark24]::new()
        $this.ColorMap[166] = [CCApplePinkDark24]::new()
        $this.ColorMap[167] = [CCApplePinkDark24]::new()
        $this.ColorMap[168] = [CCApplePinkDark24]::new()
        $this.ColorMap[169] = [CCApplePinkDark24]::new()
        $this.ColorMap[170] = [CCApplePurpleDark24]::new()
        $this.ColorMap[171] = [CCApplePurpleDark24]::new()
        $this.ColorMap[172] = [CCApplePurpleDark24]::new()
        $this.ColorMap[173] = [CCApplePurpleDark24]::new()
        $this.ColorMap[174] = [CCApplePurpleDark24]::new()
        $this.ColorMap[175] = [ATBackgroundColor24None]::new()
        $this.ColorMap[176] = [CCApplePurpleDark24]::new()
        $this.ColorMap[177] = [CCApplePurpleDark24]::new()
        $this.ColorMap[178] = [CCApplePurpleDark24]::new()
        $this.ColorMap[179] = [CCApplePurpleDark24]::new()
        $this.ColorMap[180] = [CCApplePurpleDark24]::new()
        $this.ColorMap[181] = [ATBackgroundColor24None]::new()
        $this.ColorMap[182] = [ATBackgroundColor24None]::new()
        $this.ColorMap[183] = [ATBackgroundColor24None]::new()
        $this.ColorMap[184] = [ATBackgroundColor24None]::new() # End Row 4
        $this.ColorMap[185] = [ATBackgroundColor24None]::new()
        $this.ColorMap[186] = [ATBackgroundColor24None]::new()
        $this.ColorMap[187] = [ATBackgroundColor24None]::new()
        $this.ColorMap[188] = [ATBackgroundColor24None]::new()
        $this.ColorMap[189] = [CCApplePurpleDark24]::new()
        $this.ColorMap[190] = [CCApplePurpleDark24]::new()
        $this.ColorMap[191] = [CCApplePurpleDark24]::new()
        $this.ColorMap[192] = [CCApplePurpleDark24]::new()
        $this.ColorMap[193] = [CCApplePurpleDark24]::new()
        $this.ColorMap[194] = [CCApplePurpleDark24]::new()
        $this.ColorMap[195] = [CCApplePurpleDark24]::new()
        $this.ColorMap[196] = [CCApplePurpleDark24]::new()
        $this.ColorMap[197] = [CCApplePurpleDark24]::new()
        $this.ColorMap[198] = [CCApplePurpleDark24]::new()
        $this.ColorMap[199] = [CCApplePinkDark24]::new()
        $this.ColorMap[200] = [CCApplePinkDark24]::new()
        $this.ColorMap[201] = [CCApplePinkDark24]::new()
        $this.ColorMap[202] = [CCApplePinkDark24]::new()
        $this.ColorMap[203] = [CCApplePinkDark24]::new()
        $this.ColorMap[204] = [CCApplePinkDark24]::new()
        $this.ColorMap[205] = [CCApplePinkDark24]::new()
        $this.ColorMap[206] = [CCApplePinkDark24]::new()
        $this.ColorMap[207] = [CCApplePinkDark24]::new()
        $this.ColorMap[208] = [CCApplePurpleDark24]::new()
        $this.ColorMap[209] = [CCApplePurpleDark24]::new()
        $this.ColorMap[210] = [CCApplePurpleDark24]::new()
        $this.ColorMap[211] = [CCApplePurpleDark24]::new()
        $this.ColorMap[212] = [CCApplePurpleDark24]::new()
        $this.ColorMap[213] = [CCApplePurpleDark24]::new()
        $this.ColorMap[214] = [CCApplePurpleDark24]::new()
        $this.ColorMap[215] = [CCApplePurpleDark24]::new()
        $this.ColorMap[216] = [CCApplePurpleDark24]::new()
        $this.ColorMap[217] = [CCApplePurpleDark24]::new()
        $this.ColorMap[218] = [ATBackgroundColor24None]::new()
        $this.ColorMap[219] = [ATBackgroundColor24None]::new()
        $this.ColorMap[220] = [ATBackgroundColor24None]::new()
        $this.ColorMap[221] = [ATBackgroundColor24None]::new() # End Row 5
        $this.ColorMap[222] = [ATBackgroundColor24None]::new()
        $this.ColorMap[223] = [ATBackgroundColor24None]::new()
        $this.ColorMap[224] = [ATBackgroundColor24None]::new()
        $this.ColorMap[225] = [CCApplePurpleDark24]::new()
        $this.ColorMap[226] = [CCApplePurpleDark24]::new()
        $this.ColorMap[227] = [CCApplePurpleDark24]::new()
        $this.ColorMap[228] = [CCApplePurpleDark24]::new()
        $this.ColorMap[229] = [CCApplePurpleDark24]::new()
        $this.ColorMap[230] = [CCApplePurpleDark24]::new()
        $this.ColorMap[231] = [CCApplePurpleDark24]::new()
        $this.ColorMap[232] = [CCApplePurpleDark24]::new()
        $this.ColorMap[233] = [CCApplePurpleDark24]::new()
        $this.ColorMap[234] = [CCApplePurpleDark24]::new()
        $this.ColorMap[235] = [CCApplePurpleDark24]::new()
        $this.ColorMap[236] = [CCApplePinkDark24]::new()
        $this.ColorMap[237] = [CCApplePinkDark24]::new()
        $this.ColorMap[238] = [CCApplePinkDark24]::new()
        $this.ColorMap[239] = [CCApplePinkDark24]::new()
        $this.ColorMap[240] = [CCApplePinkDark24]::new()
        $this.ColorMap[241] = [CCApplePinkDark24]::new()
        $this.ColorMap[242] = [CCApplePinkDark24]::new()
        $this.ColorMap[243] = [CCApplePinkDark24]::new()
        $this.ColorMap[244] = [CCApplePinkDark24]::new()
        $this.ColorMap[245] = [CCApplePurpleDark24]::new()
        $this.ColorMap[246] = [CCApplePurpleDark24]::new()
        $this.ColorMap[247] = [CCApplePurpleDark24]::new()
        $this.ColorMap[248] = [CCApplePurpleDark24]::new()
        $this.ColorMap[249] = [CCApplePurpleDark24]::new()
        $this.ColorMap[250] = [CCApplePurpleDark24]::new()
        $this.ColorMap[251] = [CCApplePurpleDark24]::new()
        $this.ColorMap[252] = [CCApplePurpleDark24]::new()
        $this.ColorMap[253] = [CCApplePurpleDark24]::new()
        $this.ColorMap[254] = [CCApplePurpleDark24]::new()
        $this.ColorMap[255] = [CCApplePurpleDark24]::new()
        $this.ColorMap[256] = [ATBackgroundColor24None]::new()
        $this.ColorMap[257] = [ATBackgroundColor24None]::new()
        $this.ColorMap[258] = [ATBackgroundColor24None]::new() # End Row 6
        $this.ColorMap[259] = [ATBackgroundColor24None]::new()
        $this.ColorMap[260] = [ATBackgroundColor24None]::new()
        $this.ColorMap[261] = [ATBackgroundColor24None]::new()
        $this.ColorMap[262] = [CCApplePurpleDark24]::new()
        $this.ColorMap[263] = [CCApplePurpleDark24]::new()
        $this.ColorMap[264] = [CCApplePurpleDark24]::new()
        $this.ColorMap[265] = [CCApplePurpleDark24]::new()
        $this.ColorMap[266] = [CCApplePurpleDark24]::new()
        $this.ColorMap[267] = [CCApplePurpleDark24]::new()
        $this.ColorMap[268] = [CCApplePurpleDark24]::new()
        $this.ColorMap[269] = [CCApplePurpleDark24]::new()
        $this.ColorMap[270] = [CCApplePurpleDark24]::new()
        $this.ColorMap[271] = [CCApplePurpleDark24]::new()
        $this.ColorMap[272] = [CCApplePurpleDark24]::new()
        $this.ColorMap[273] = [CCApplePinkDark24]::new()
        $this.ColorMap[274] = [CCApplePinkDark24]::new()
        $this.ColorMap[275] = [CCApplePinkDark24]::new()
        $this.ColorMap[276] = [CCApplePinkDark24]::new()
        $this.ColorMap[277] = [CCApplePinkDark24]::new()
        $this.ColorMap[278] = [CCApplePinkDark24]::new()
        $this.ColorMap[279] = [CCApplePinkDark24]::new()
        $this.ColorMap[280] = [CCApplePinkDark24]::new()
        $this.ColorMap[281] = [CCApplePinkDark24]::new()
        $this.ColorMap[282] = [CCApplePurpleDark24]::new()
        $this.ColorMap[283] = [CCApplePurpleDark24]::new()
        $this.ColorMap[284] = [CCApplePurpleDark24]::new()
        $this.ColorMap[285] = [CCApplePurpleDark24]::new()
        $this.ColorMap[286] = [CCApplePurpleDark24]::new()
        $this.ColorMap[287] = [CCApplePurpleDark24]::new()
        $this.ColorMap[288] = [CCApplePurpleDark24]::new()
        $this.ColorMap[289] = [CCApplePurpleDark24]::new()
        $this.ColorMap[290] = [CCApplePurpleDark24]::new()
        $this.ColorMap[291] = [CCApplePurpleDark24]::new()
        $this.ColorMap[292] = [CCApplePurpleDark24]::new()
        $this.ColorMap[293] = [ATBackgroundColor24None]::new()
        $this.ColorMap[294] = [ATBackgroundColor24None]::new()
        $this.ColorMap[295] = [ATBackgroundColor24None]::new() # End Row 7
        $this.ColorMap[296] = [ATBackgroundColor24None]::new()
        $this.ColorMap[297] = [ATBackgroundColor24None]::new()
        $this.ColorMap[298] = [ATBackgroundColor24None]::new()
        $this.ColorMap[299] = [CCApplePurpleDark24]::new()
        $this.ColorMap[300] = [CCApplePurpleDark24]::new()
        $this.ColorMap[301] = [CCApplePurpleDark24]::new()
        $this.ColorMap[302] = [CCApplePurpleDark24]::new()
        $this.ColorMap[303] = [CCApplePurpleDark24]::new()
        $this.ColorMap[304] = [CCApplePurpleDark24]::new()
        $this.ColorMap[305] = [CCApplePurpleDark24]::new()
        $this.ColorMap[306] = [CCApplePurpleDark24]::new()
        $this.ColorMap[307] = [CCApplePurpleDark24]::new()
        $this.ColorMap[308] = [CCApplePurpleDark24]::new()
        $this.ColorMap[309] = [CCApplePurpleDark24]::new()
        $this.ColorMap[310] = [CCApplePinkDark24]::new()
        $this.ColorMap[311] = [CCApplePinkDark24]::new()
        $this.ColorMap[312] = [CCApplePinkDark24]::new()
        $this.ColorMap[313] = [CCApplePinkDark24]::new()
        $this.ColorMap[314] = [CCApplePinkDark24]::new()
        $this.ColorMap[315] = [CCApplePinkDark24]::new()
        $this.ColorMap[316] = [CCApplePinkDark24]::new()
        $this.ColorMap[317] = [CCApplePinkDark24]::new()
        $this.ColorMap[318] = [CCApplePinkDark24]::new()
        $this.ColorMap[319] = [CCApplePurpleDark24]::new()
        $this.ColorMap[320] = [CCApplePurpleDark24]::new()
        $this.ColorMap[321] = [CCApplePurpleDark24]::new()
        $this.ColorMap[322] = [CCApplePurpleDark24]::new()
        $this.ColorMap[323] = [CCApplePurpleDark24]::new()
        $this.ColorMap[324] = [CCApplePurpleDark24]::new()
        $this.ColorMap[325] = [CCApplePurpleDark24]::new()
        $this.ColorMap[326] = [CCApplePurpleDark24]::new()
        $this.ColorMap[327] = [CCApplePurpleDark24]::new()
        $this.ColorMap[328] = [CCApplePurpleDark24]::new()
        $this.ColorMap[329] = [CCApplePurpleDark24]::new()
        $this.ColorMap[330] = [ATBackgroundColor24None]::new()
        $this.ColorMap[331] = [ATBackgroundColor24None]::new()
        $this.ColorMap[332] = [ATBackgroundColor24None]::new() # End Row 8
        $this.ColorMap[333] = [ATBackgroundColor24None]::new()
        $this.ColorMap[334] = [ATBackgroundColor24None]::new()
        $this.ColorMap[335] = [CCApplePurpleDark24]::new()
        $this.ColorMap[336] = [CCApplePurpleDark24]::new()
        $this.ColorMap[337] = [CCApplePurpleDark24]::new()
        $this.ColorMap[338] = [CCApplePurpleDark24]::new()
        $this.ColorMap[339] = [CCApplePurpleDark24]::new()
        $this.ColorMap[340] = [CCApplePurpleDark24]::new()
        $this.ColorMap[341] = [CCApplePurpleDark24]::new()
        $this.ColorMap[342] = [CCApplePurpleDark24]::new()
        $this.ColorMap[343] = [CCApplePurpleDark24]::new()
        $this.ColorMap[344] = [CCApplePurpleDark24]::new()
        $this.ColorMap[345] = [ATBackgroundColor24None]::new()
        $this.ColorMap[346] = [ATBackgroundColor24None]::new()
        $this.ColorMap[347] = [CCApplePurpleDark24]::new()
        $this.ColorMap[348] = [CCApplePinkDark24]::new()
        $this.ColorMap[349] = [CCApplePinkDark24]::new()
        $this.ColorMap[350] = [CCApplePinkDark24]::new()
        $this.ColorMap[351] = [CCApplePinkDark24]::new()
        $this.ColorMap[352] = [CCApplePinkDark24]::new()
        $this.ColorMap[353] = [CCApplePinkDark24]::new()
        $this.ColorMap[354] = [CCApplePinkDark24]::new()
        $this.ColorMap[355] = [CCApplePurpleDark24]::new()
        $this.ColorMap[356] = [ATBackgroundColor24None]::new()
        $this.ColorMap[357] = [ATBackgroundColor24None]::new()
        $this.ColorMap[358] = [CCApplePurpleDark24]::new()
        $this.ColorMap[359] = [CCApplePurpleDark24]::new()
        $this.ColorMap[360] = [CCApplePurpleDark24]::new()
        $this.ColorMap[361] = [CCApplePurpleDark24]::new()
        $this.ColorMap[362] = [CCApplePurpleDark24]::new()
        $this.ColorMap[363] = [CCApplePurpleDark24]::new()
        $this.ColorMap[364] = [CCApplePurpleDark24]::new()
        $this.ColorMap[365] = [CCApplePurpleDark24]::new()
        $this.ColorMap[366] = [CCApplePurpleDark24]::new()
        $this.ColorMap[367] = [CCApplePurpleDark24]::new()
        $this.ColorMap[368] = [ATBackgroundColor24None]::new()
        $this.ColorMap[369] = [ATBackgroundColor24None]::new() # End Row 9
        $this.ColorMap[370] = [ATBackgroundColor24None]::new()
        $this.ColorMap[371] = [ATBackgroundColor24None]::new()
        $this.ColorMap[372] = [CCApplePurpleDark24]::new()
        $this.ColorMap[373] = [CCApplePurpleDark24]::new()
        $this.ColorMap[374] = [CCApplePurpleDark24]::new()
        $this.ColorMap[375] = [CCApplePurpleDark24]::new()
        $this.ColorMap[376] = [ATBackgroundColor24None]::new()
        $this.ColorMap[377] = [ATBackgroundColor24None]::new()
        $this.ColorMap[378] = [CCApplePurpleDark24]::new()
        $this.ColorMap[379] = [CCApplePurpleDark24]::new()
        $this.ColorMap[380] = [CCApplePurpleDark24]::new()
        $this.ColorMap[381] = [ATBackgroundColor24None]::new()
        $this.ColorMap[382] = [ATBackgroundColor24None]::new()
        $this.ColorMap[383] = [ATBackgroundColor24None]::new()
        $this.ColorMap[384] = [ATBackgroundColor24None]::new()
        $this.ColorMap[385] = [CCApplePinkDark24]::new()
        $this.ColorMap[386] = [CCApplePinkDark24]::new()
        $this.ColorMap[387] = [CCApplePinkDark24]::new()
        $this.ColorMap[388] = [CCApplePinkDark24]::new()
        $this.ColorMap[389] = [CCApplePinkDark24]::new()
        $this.ColorMap[390] = [CCApplePinkDark24]::new()
        $this.ColorMap[391] = [CCApplePinkDark24]::new()
        $this.ColorMap[392] = [ATBackgroundColor24None]::new()
        $this.ColorMap[393] = [ATBackgroundColor24None]::new()
        $this.ColorMap[394] = [ATBackgroundColor24None]::new()
        $this.ColorMap[395] = [ATBackgroundColor24None]::new()
        $this.ColorMap[396] = [CCApplePurpleDark24]::new()
        $this.ColorMap[397] = [CCApplePurpleDark24]::new()
        $this.ColorMap[398] = [CCApplePurpleDark24]::new()
        $this.ColorMap[399] = [ATBackgroundColor24None]::new()
        $this.ColorMap[400] = [ATBackgroundColor24None]::new()
        $this.ColorMap[401] = [CCApplePurpleDark24]::new()
        $this.ColorMap[402] = [CCApplePurpleDark24]::new()
        $this.ColorMap[403] = [CCApplePurpleDark24]::new()
        $this.ColorMap[404] = [CCApplePurpleDark24]::new()
        $this.ColorMap[405] = [ATBackgroundColor24None]::new()
        $this.ColorMap[406] = [ATBackgroundColor24None]::new() # End Row 10
        $this.ColorMap[407] = [ATBackgroundColor24None]::new()
        $this.ColorMap[408] = [ATBackgroundColor24None]::new()
        $this.ColorMap[409] = [CCApplePurpleDark24]::new()
        $this.ColorMap[410] = [CCApplePurpleDark24]::new()
        $this.ColorMap[411] = [ATBackgroundColor24None]::new()
        $this.ColorMap[412] = [ATBackgroundColor24None]::new()
        $this.ColorMap[413] = [ATBackgroundColor24None]::new()
        $this.ColorMap[414] = [ATBackgroundColor24None]::new()
        $this.ColorMap[415] = [ATBackgroundColor24None]::new()
        $this.ColorMap[416] = [CCApplePurpleDark24]::new()
        $this.ColorMap[417] = [ATBackgroundColor24None]::new()
        $this.ColorMap[418] = [ATBackgroundColor24None]::new()
        $this.ColorMap[419] = [ATBackgroundColor24None]::new()
        $this.ColorMap[420] = [CCAppleOrangeDark24]::new()
        $this.ColorMap[421] = [ATBackgroundColor24None]::new()
        $this.ColorMap[422] = [ATBackgroundColor24None]::new()
        $this.ColorMap[423] = [CCApplePinkDark24]::new()
        $this.ColorMap[424] = [CCApplePinkDark24]::new()
        $this.ColorMap[425] = [CCApplePinkDark24]::new()
        $this.ColorMap[426] = [CCApplePinkDark24]::new()
        $this.ColorMap[427] = [CCApplePinkDark24]::new()
        $this.ColorMap[428] = [ATBackgroundColor24None]::new()
        $this.ColorMap[429] = [ATBackgroundColor24None]::new()
        $this.ColorMap[430] = [CCAppleOrangeDark24]::new()
        $this.ColorMap[431] = [ATBackgroundColor24None]::new()
        $this.ColorMap[432] = [ATBackgroundColor24None]::new()
        $this.ColorMap[433] = [ATBackgroundColor24None]::new()
        $this.ColorMap[434] = [CCApplePurpleDark24]::new()
        $this.ColorMap[435] = [ATBackgroundColor24None]::new()
        $this.ColorMap[436] = [ATBackgroundColor24None]::new()
        $this.ColorMap[437] = [ATBackgroundColor24None]::new()
        $this.ColorMap[438] = [ATBackgroundColor24None]::new()
        $this.ColorMap[439] = [ATBackgroundColor24None]::new()
        $this.ColorMap[440] = [CCApplePurpleDark24]::new()
        $this.ColorMap[441] = [CCApplePurpleDark24]::new()
        $this.ColorMap[442] = [ATBackgroundColor24None]::new()
        $this.ColorMap[443] = [ATBackgroundColor24None]::new() # End Row 11
        $this.ColorMap[444] = [ATBackgroundColor24None]::new()
        $this.ColorMap[445] = [ATBackgroundColor24None]::new()
        $this.ColorMap[446] = [CCApplePurpleDark24]::new()
        $this.ColorMap[447] = [ATBackgroundColor24None]::new()
        $this.ColorMap[448] = [ATBackgroundColor24None]::new()
        $this.ColorMap[449] = [ATBackgroundColor24None]::new()
        $this.ColorMap[450] = [ATBackgroundColor24None]::new()
        $this.ColorMap[451] = [ATBackgroundColor24None]::new()
        $this.ColorMap[452] = [ATBackgroundColor24None]::new()
        $this.ColorMap[453] = [ATBackgroundColor24None]::new()
        $this.ColorMap[454] = [ATBackgroundColor24None]::new()
        $this.ColorMap[455] = [ATBackgroundColor24None]::new()
        $this.ColorMap[456] = [ATBackgroundColor24None]::new()
        $this.ColorMap[457] = [ATBackgroundColor24None]::new()
        $this.ColorMap[458] = [CCAppleOrangeDark24]::new()
        $this.ColorMap[459] = [CCAppleOrangeDark24]::new()
        $this.ColorMap[460] = [ATBackgroundColor24None]::new()
        $this.ColorMap[461] = [CCApplePinkDark24]::new()
        $this.ColorMap[462] = [CCApplePinkDark24]::new()
        $this.ColorMap[463] = [CCApplePinkDark24]::new()
        $this.ColorMap[464] = [ATBackgroundColor24None]::new()
        $this.ColorMap[465] = [CCAppleOrangeDark24]::new()
        $this.ColorMap[466] = [CCAppleOrangeDark24]::new()
        $this.ColorMap[467] = [ATBackgroundColor24None]::new()
        $this.ColorMap[468] = [ATBackgroundColor24None]::new()
        $this.ColorMap[469] = [ATBackgroundColor24None]::new()
        $this.ColorMap[470] = [ATBackgroundColor24None]::new()
        $this.ColorMap[471] = [ATBackgroundColor24None]::new()
        $this.ColorMap[472] = [ATBackgroundColor24None]::new()
        $this.ColorMap[473] = [ATBackgroundColor24None]::new()
        $this.ColorMap[474] = [ATBackgroundColor24None]::new()
        $this.ColorMap[475] = [ATBackgroundColor24None]::new()
        $this.ColorMap[476] = [ATBackgroundColor24None]::new()
        $this.ColorMap[477] = [ATBackgroundColor24None]::new()
        $this.ColorMap[478] = [CCApplePurpleDark24]::new()
        $this.ColorMap[479] = [ATBackgroundColor24None]::new()
        $this.ColorMap[480] = [ATBackgroundColor24None]::new() # End Row 12
        $this.ColorMap[481] = [ATBackgroundColor24None]::new()
        $this.ColorMap[482] = [ATBackgroundColor24None]::new()
        $this.ColorMap[483] = [ATBackgroundColor24None]::new()
        $this.ColorMap[484] = [ATBackgroundColor24None]::new()
        $this.ColorMap[485] = [ATBackgroundColor24None]::new()
        $this.ColorMap[486] = [ATBackgroundColor24None]::new()
        $this.ColorMap[487] = [ATBackgroundColor24None]::new()
        $this.ColorMap[488] = [ATBackgroundColor24None]::new()
        $this.ColorMap[489] = [ATBackgroundColor24None]::new()
        $this.ColorMap[490] = [ATBackgroundColor24None]::new()
        $this.ColorMap[491] = [ATBackgroundColor24None]::new()
        $this.ColorMap[492] = [ATBackgroundColor24None]::new()
        $this.ColorMap[493] = [ATBackgroundColor24None]::new()
        $this.ColorMap[494] = [CCAppleOrangeDark24]::new()
        $this.ColorMap[495] = [ATBackgroundColor24None]::new()
        $this.ColorMap[496] = [ATBackgroundColor24None]::new()
        $this.ColorMap[497] = [ATBackgroundColor24None]::new()
        $this.ColorMap[498] = [ATBackgroundColor24None]::new()
        $this.ColorMap[499] = [CCApplePinkDark24]::new()
        $this.ColorMap[500] = [ATBackgroundColor24None]::new()
        $this.ColorMap[501] = [ATBackgroundColor24None]::new()
        $this.ColorMap[502] = [ATBackgroundColor24None]::new()
        $this.ColorMap[503] = [ATBackgroundColor24None]::new()
        $this.ColorMap[504] = [CCAppleOrangeDark24]::new()
        $this.ColorMap[505] = [ATBackgroundColor24None]::new()
        $this.ColorMap[506] = [ATBackgroundColor24None]::new()
        $this.ColorMap[507] = [ATBackgroundColor24None]::new()
        $this.ColorMap[508] = [ATBackgroundColor24None]::new()
        $this.ColorMap[509] = [ATBackgroundColor24None]::new()
        $this.ColorMap[510] = [ATBackgroundColor24None]::new()
        $this.ColorMap[511] = [ATBackgroundColor24None]::new()
        $this.ColorMap[512] = [ATBackgroundColor24None]::new()
        $this.ColorMap[513] = [ATBackgroundColor24None]::new()
        $this.ColorMap[514] = [ATBackgroundColor24None]::new()
        $this.ColorMap[515] = [ATBackgroundColor24None]::new()
        $this.ColorMap[516] = [ATBackgroundColor24None]::new()
        $this.ColorMap[517] = [ATBackgroundColor24None]::new() # End Row 13
        $this.ColorMap[518] = [ATBackgroundColor24None]::new()
        $this.ColorMap[519] = [ATBackgroundColor24None]::new()
        $this.ColorMap[520] = [ATBackgroundColor24None]::new()
        $this.ColorMap[521] = [ATBackgroundColor24None]::new()
        $this.ColorMap[522] = [ATBackgroundColor24None]::new()
        $this.ColorMap[523] = [ATBackgroundColor24None]::new()
        $this.ColorMap[524] = [ATBackgroundColor24None]::new()
        $this.ColorMap[525] = [ATBackgroundColor24None]::new()
        $this.ColorMap[526] = [ATBackgroundColor24None]::new()
        $this.ColorMap[527] = [ATBackgroundColor24None]::new()
        $this.ColorMap[528] = [ATBackgroundColor24None]::new()
        $this.ColorMap[529] = [ATBackgroundColor24None]::new()
        $this.ColorMap[530] = [ATBackgroundColor24None]::new()
        $this.ColorMap[531] = [ATBackgroundColor24None]::new()
        $this.ColorMap[532] = [ATBackgroundColor24None]::new()
        $this.ColorMap[533] = [ATBackgroundColor24None]::new()
        $this.ColorMap[534] = [ATBackgroundColor24None]::new()
        $this.ColorMap[535] = [ATBackgroundColor24None]::new()
        $this.ColorMap[536] = [ATBackgroundColor24None]::new()
        $this.ColorMap[537] = [ATBackgroundColor24None]::new()
        $this.ColorMap[538] = [ATBackgroundColor24None]::new()
        $this.ColorMap[539] = [ATBackgroundColor24None]::new()
        $this.ColorMap[540] = [ATBackgroundColor24None]::new()
        $this.ColorMap[541] = [ATBackgroundColor24None]::new()
        $this.ColorMap[542] = [ATBackgroundColor24None]::new()
        $this.ColorMap[543] = [ATBackgroundColor24None]::new()
        $this.ColorMap[544] = [ATBackgroundColor24None]::new()
        $this.ColorMap[545] = [ATBackgroundColor24None]::new()
        $this.ColorMap[546] = [ATBackgroundColor24None]::new()
        $this.ColorMap[547] = [ATBackgroundColor24None]::new()
        $this.ColorMap[548] = [ATBackgroundColor24None]::new()
        $this.ColorMap[549] = [ATBackgroundColor24None]::new()
        $this.ColorMap[550] = [ATBackgroundColor24None]::new()
        $this.ColorMap[551] = [ATBackgroundColor24None]::new()
        $this.ColorMap[552] = [ATBackgroundColor24None]::new()
        $this.ColorMap[553] = [ATBackgroundColor24None]::new()
        $this.ColorMap[554] = [ATBackgroundColor24None]::new() # End Row 14

        $this.CreateImageATString($this.ColorMap)
        $this.ColorMap = $null
    }
}

Class EEIDarkfang : EEIInternalBase {
    EEIDarkfang() : base() {
        $this.ColorMap[0]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[1]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[2]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[3]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[4]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[5]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[6]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[7]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[8]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[9]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[10]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[11]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[12]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[13]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[14]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[15]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[16]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[17]  = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[18]  = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[19]  = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[20]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[21]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[22]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[23]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[24]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[25]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[26]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[27]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[28]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[29]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[30]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[31]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[32]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[33]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[34]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[35]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[36]  = [ATBackgroundColor24None]::new() # End Row 0
        $this.ColorMap[37]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[38]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[39]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[40]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[41]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[42]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[43]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[44]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[45]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[46]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[47]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[48]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[49]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[50]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[51]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[52]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[53]  = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[54]  = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[55]  = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[56]  = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[57]  = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[58]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[59]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[60]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[61]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[62]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[63]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[64]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[65]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[66]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[67]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[68]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[69]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[70]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[71]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[72]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[73]  = [ATBackgroundColor24None]::new() # End Row 1
        $this.ColorMap[74]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[75]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[76]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[77]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[78]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[79]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[80]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[81]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[82]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[83]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[84]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[85]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[86]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[87]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[88]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[89]  = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[90]  = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[91]  = [CCAppleIndigoLight24]::new()
        $this.ColorMap[92]  = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[93]  = [CCAppleIndigoLight24]::new()
        $this.ColorMap[94]  = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[95]  = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[96]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[97]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[98]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[99]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[100] = [ATBackgroundColor24None]::new()
        $this.ColorMap[101] = [ATBackgroundColor24None]::new()
        $this.ColorMap[102] = [ATBackgroundColor24None]::new()
        $this.ColorMap[103] = [ATBackgroundColor24None]::new()
        $this.ColorMap[104] = [ATBackgroundColor24None]::new()
        $this.ColorMap[105] = [ATBackgroundColor24None]::new()
        $this.ColorMap[106] = [ATBackgroundColor24None]::new()
        $this.ColorMap[107] = [ATBackgroundColor24None]::new()
        $this.ColorMap[108] = [ATBackgroundColor24None]::new()
        $this.ColorMap[109] = [ATBackgroundColor24None]::new()
        $this.ColorMap[110] = [ATBackgroundColor24None]::new() # End Row 2
        $this.ColorMap[111] = [ATBackgroundColor24None]::new()
        $this.ColorMap[112] = [ATBackgroundColor24None]::new()
        $this.ColorMap[113] = [ATBackgroundColor24None]::new()
        $this.ColorMap[114] = [ATBackgroundColor24None]::new()
        $this.ColorMap[115] = [ATBackgroundColor24None]::new()
        $this.ColorMap[116] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[117] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[118] = [ATBackgroundColor24None]::new()
        $this.ColorMap[119] = [ATBackgroundColor24None]::new()
        $this.ColorMap[120] = [ATBackgroundColor24None]::new()
        $this.ColorMap[121] = [ATBackgroundColor24None]::new()
        $this.ColorMap[122] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[123] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[124] = [ATBackgroundColor24None]::new()
        $this.ColorMap[125] = [ATBackgroundColor24None]::new()
        $this.ColorMap[126] = [ATBackgroundColor24None]::new()
        $this.ColorMap[127] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[128] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[129] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[130] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[131] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[132] = [ATBackgroundColor24None]::new()
        $this.ColorMap[133] = [ATBackgroundColor24None]::new()
        $this.ColorMap[134] = [ATBackgroundColor24None]::new()
        $this.ColorMap[135] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[136] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[137] = [ATBackgroundColor24None]::new()
        $this.ColorMap[138] = [ATBackgroundColor24None]::new()
        $this.ColorMap[139] = [ATBackgroundColor24None]::new()
        $this.ColorMap[140] = [ATBackgroundColor24None]::new()
        $this.ColorMap[141] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[142] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[143] = [ATBackgroundColor24None]::new()
        $this.ColorMap[144] = [ATBackgroundColor24None]::new()
        $this.ColorMap[145] = [ATBackgroundColor24None]::new()
        $this.ColorMap[146] = [ATBackgroundColor24None]::new()
        $this.ColorMap[147] = [ATBackgroundColor24None]::new() # End Row 3
        $this.ColorMap[148] = [ATBackgroundColor24None]::new()
        $this.ColorMap[149] = [ATBackgroundColor24None]::new()
        $this.ColorMap[150] = [ATBackgroundColor24None]::new()
        $this.ColorMap[151] = [ATBackgroundColor24None]::new()
        $this.ColorMap[152] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[153] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[154] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[155] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[156] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[157] = [ATBackgroundColor24None]::new()
        $this.ColorMap[158] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[159] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[160] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[161] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[162] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[163] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[164] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[165] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[166] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[167] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[168] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[169] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[170] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[171] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[172] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[173] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[174] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[175] = [ATBackgroundColor24None]::new()
        $this.ColorMap[176] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[177] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[178] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[179] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[180] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[181] = [ATBackgroundColor24None]::new()
        $this.ColorMap[182] = [ATBackgroundColor24None]::new()
        $this.ColorMap[183] = [ATBackgroundColor24None]::new()
        $this.ColorMap[184] = [ATBackgroundColor24None]::new() # End Row 4
        $this.ColorMap[185] = [ATBackgroundColor24None]::new()
        $this.ColorMap[186] = [ATBackgroundColor24None]::new()
        $this.ColorMap[187] = [ATBackgroundColor24None]::new()
        $this.ColorMap[188] = [ATBackgroundColor24None]::new()
        $this.ColorMap[189] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[190] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[191] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[192] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[193] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[194] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[195] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[196] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[197] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[198] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[199] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[200] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[201] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[202] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[203] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[204] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[205] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[206] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[207] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[208] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[209] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[210] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[211] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[212] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[213] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[214] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[215] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[216] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[217] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[218] = [ATBackgroundColor24None]::new()
        $this.ColorMap[219] = [ATBackgroundColor24None]::new()
        $this.ColorMap[220] = [ATBackgroundColor24None]::new()
        $this.ColorMap[221] = [ATBackgroundColor24None]::new() # End Row 5
        $this.ColorMap[222] = [ATBackgroundColor24None]::new()
        $this.ColorMap[223] = [ATBackgroundColor24None]::new()
        $this.ColorMap[224] = [ATBackgroundColor24None]::new()
        $this.ColorMap[225] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[226] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[227] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[228] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[229] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[230] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[231] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[232] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[233] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[234] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[235] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[236] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[237] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[238] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[239] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[240] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[241] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[242] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[243] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[244] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[245] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[246] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[247] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[248] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[249] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[250] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[251] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[252] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[253] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[254] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[255] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[256] = [ATBackgroundColor24None]::new()
        $this.ColorMap[257] = [ATBackgroundColor24None]::new()
        $this.ColorMap[258] = [ATBackgroundColor24None]::new() # End Row 6
        $this.ColorMap[259] = [ATBackgroundColor24None]::new()
        $this.ColorMap[260] = [ATBackgroundColor24None]::new()
        $this.ColorMap[261] = [ATBackgroundColor24None]::new()
        $this.ColorMap[262] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[263] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[264] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[265] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[266] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[267] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[268] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[269] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[270] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[271] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[272] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[273] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[274] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[275] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[276] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[277] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[278] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[279] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[280] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[281] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[282] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[283] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[284] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[285] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[286] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[287] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[288] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[289] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[290] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[291] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[292] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[293] = [ATBackgroundColor24None]::new()
        $this.ColorMap[294] = [ATBackgroundColor24None]::new()
        $this.ColorMap[295] = [ATBackgroundColor24None]::new() # End Row 7
        $this.ColorMap[296] = [ATBackgroundColor24None]::new()
        $this.ColorMap[297] = [ATBackgroundColor24None]::new()
        $this.ColorMap[298] = [ATBackgroundColor24None]::new()
        $this.ColorMap[299] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[300] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[301] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[302] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[303] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[304] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[305] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[306] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[307] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[308] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[309] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[310] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[311] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[312] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[313] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[314] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[315] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[316] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[317] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[318] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[319] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[320] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[321] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[322] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[323] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[324] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[325] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[326] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[327] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[328] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[329] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[330] = [ATBackgroundColor24None]::new()
        $this.ColorMap[331] = [ATBackgroundColor24None]::new()
        $this.ColorMap[332] = [ATBackgroundColor24None]::new() # End Row 8
        $this.ColorMap[333] = [ATBackgroundColor24None]::new()
        $this.ColorMap[334] = [ATBackgroundColor24None]::new()
        $this.ColorMap[335] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[336] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[337] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[338] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[339] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[340] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[341] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[342] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[343] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[344] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[345] = [ATBackgroundColor24None]::new()
        $this.ColorMap[346] = [ATBackgroundColor24None]::new()
        $this.ColorMap[347] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[348] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[349] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[350] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[351] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[352] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[353] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[354] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[355] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[356] = [ATBackgroundColor24None]::new()
        $this.ColorMap[357] = [ATBackgroundColor24None]::new()
        $this.ColorMap[358] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[359] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[360] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[361] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[362] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[363] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[364] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[365] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[366] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[367] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[368] = [ATBackgroundColor24None]::new()
        $this.ColorMap[369] = [ATBackgroundColor24None]::new() # End Row 9
        $this.ColorMap[370] = [ATBackgroundColor24None]::new()
        $this.ColorMap[371] = [ATBackgroundColor24None]::new()
        $this.ColorMap[372] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[373] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[374] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[375] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[376] = [ATBackgroundColor24None]::new()
        $this.ColorMap[377] = [ATBackgroundColor24None]::new()
        $this.ColorMap[378] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[379] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[380] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[381] = [ATBackgroundColor24None]::new()
        $this.ColorMap[382] = [ATBackgroundColor24None]::new()
        $this.ColorMap[383] = [ATBackgroundColor24None]::new()
        $this.ColorMap[384] = [ATBackgroundColor24None]::new()
        $this.ColorMap[385] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[386] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[387] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[388] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[389] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[390] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[391] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[392] = [ATBackgroundColor24None]::new()
        $this.ColorMap[393] = [ATBackgroundColor24None]::new()
        $this.ColorMap[394] = [ATBackgroundColor24None]::new()
        $this.ColorMap[395] = [ATBackgroundColor24None]::new()
        $this.ColorMap[396] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[397] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[398] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[399] = [ATBackgroundColor24None]::new()
        $this.ColorMap[400] = [ATBackgroundColor24None]::new()
        $this.ColorMap[401] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[402] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[403] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[404] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[405] = [ATBackgroundColor24None]::new()
        $this.ColorMap[406] = [ATBackgroundColor24None]::new() # End Row 10
        $this.ColorMap[407] = [ATBackgroundColor24None]::new()
        $this.ColorMap[408] = [ATBackgroundColor24None]::new()
        $this.ColorMap[409] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[410] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[411] = [ATBackgroundColor24None]::new()
        $this.ColorMap[412] = [ATBackgroundColor24None]::new()
        $this.ColorMap[413] = [ATBackgroundColor24None]::new()
        $this.ColorMap[414] = [ATBackgroundColor24None]::new()
        $this.ColorMap[415] = [ATBackgroundColor24None]::new()
        $this.ColorMap[416] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[417] = [ATBackgroundColor24None]::new()
        $this.ColorMap[418] = [ATBackgroundColor24None]::new()
        $this.ColorMap[419] = [ATBackgroundColor24None]::new()
        $this.ColorMap[420] = [CCAppleRedDark24]::new()
        $this.ColorMap[421] = [ATBackgroundColor24None]::new()
        $this.ColorMap[422] = [ATBackgroundColor24None]::new()
        $this.ColorMap[423] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[424] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[425] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[426] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[427] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[428] = [ATBackgroundColor24None]::new()
        $this.ColorMap[429] = [ATBackgroundColor24None]::new()
        $this.ColorMap[430] = [CCAppleRedDark24]::new()
        $this.ColorMap[431] = [ATBackgroundColor24None]::new()
        $this.ColorMap[432] = [ATBackgroundColor24None]::new()
        $this.ColorMap[433] = [ATBackgroundColor24None]::new()
        $this.ColorMap[434] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[435] = [ATBackgroundColor24None]::new()
        $this.ColorMap[436] = [ATBackgroundColor24None]::new()
        $this.ColorMap[437] = [ATBackgroundColor24None]::new()
        $this.ColorMap[438] = [ATBackgroundColor24None]::new()
        $this.ColorMap[439] = [ATBackgroundColor24None]::new()
        $this.ColorMap[440] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[441] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[442] = [ATBackgroundColor24None]::new()
        $this.ColorMap[443] = [ATBackgroundColor24None]::new() # End Row 11
        $this.ColorMap[444] = [ATBackgroundColor24None]::new()
        $this.ColorMap[445] = [ATBackgroundColor24None]::new()
        $this.ColorMap[446] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[447] = [ATBackgroundColor24None]::new()
        $this.ColorMap[448] = [ATBackgroundColor24None]::new()
        $this.ColorMap[449] = [ATBackgroundColor24None]::new()
        $this.ColorMap[450] = [ATBackgroundColor24None]::new()
        $this.ColorMap[451] = [ATBackgroundColor24None]::new()
        $this.ColorMap[452] = [ATBackgroundColor24None]::new()
        $this.ColorMap[453] = [ATBackgroundColor24None]::new()
        $this.ColorMap[454] = [ATBackgroundColor24None]::new()
        $this.ColorMap[455] = [ATBackgroundColor24None]::new()
        $this.ColorMap[456] = [ATBackgroundColor24None]::new()
        $this.ColorMap[457] = [ATBackgroundColor24None]::new()
        $this.ColorMap[458] = [CCAppleRedDark24]::new()
        $this.ColorMap[459] = [CCAppleRedDark24]::new()
        $this.ColorMap[460] = [ATBackgroundColor24None]::new()
        $this.ColorMap[461] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[462] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[463] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[464] = [ATBackgroundColor24None]::new()
        $this.ColorMap[465] = [CCAppleRedDark24]::new()
        $this.ColorMap[466] = [CCAppleRedDark24]::new()
        $this.ColorMap[467] = [ATBackgroundColor24None]::new()
        $this.ColorMap[468] = [ATBackgroundColor24None]::new()
        $this.ColorMap[469] = [ATBackgroundColor24None]::new()
        $this.ColorMap[470] = [ATBackgroundColor24None]::new()
        $this.ColorMap[471] = [ATBackgroundColor24None]::new()
        $this.ColorMap[472] = [ATBackgroundColor24None]::new()
        $this.ColorMap[473] = [ATBackgroundColor24None]::new()
        $this.ColorMap[474] = [ATBackgroundColor24None]::new()
        $this.ColorMap[475] = [ATBackgroundColor24None]::new()
        $this.ColorMap[476] = [ATBackgroundColor24None]::new()
        $this.ColorMap[477] = [ATBackgroundColor24None]::new()
        $this.ColorMap[478] = [CCAppleGrey4Dark24]::new()
        $this.ColorMap[479] = [ATBackgroundColor24None]::new()
        $this.ColorMap[480] = [ATBackgroundColor24None]::new() # End Row 12
        $this.ColorMap[481] = [ATBackgroundColor24None]::new()
        $this.ColorMap[482] = [ATBackgroundColor24None]::new()
        $this.ColorMap[483] = [ATBackgroundColor24None]::new()
        $this.ColorMap[484] = [ATBackgroundColor24None]::new()
        $this.ColorMap[485] = [ATBackgroundColor24None]::new()
        $this.ColorMap[486] = [ATBackgroundColor24None]::new()
        $this.ColorMap[487] = [ATBackgroundColor24None]::new()
        $this.ColorMap[488] = [ATBackgroundColor24None]::new()
        $this.ColorMap[489] = [ATBackgroundColor24None]::new()
        $this.ColorMap[490] = [ATBackgroundColor24None]::new()
        $this.ColorMap[491] = [ATBackgroundColor24None]::new()
        $this.ColorMap[492] = [ATBackgroundColor24None]::new()
        $this.ColorMap[493] = [ATBackgroundColor24None]::new()
        $this.ColorMap[494] = [CCAppleRedDark24]::new()
        $this.ColorMap[495] = [ATBackgroundColor24None]::new()
        $this.ColorMap[496] = [ATBackgroundColor24None]::new()
        $this.ColorMap[497] = [ATBackgroundColor24None]::new()
        $this.ColorMap[498] = [ATBackgroundColor24None]::new()
        $this.ColorMap[499] = [CCAppleGrey6Dark24]::new()
        $this.ColorMap[500] = [ATBackgroundColor24None]::new()
        $this.ColorMap[501] = [ATBackgroundColor24None]::new()
        $this.ColorMap[502] = [ATBackgroundColor24None]::new()
        $this.ColorMap[503] = [ATBackgroundColor24None]::new()
        $this.ColorMap[504] = [CCAppleRedDark24]::new()
        $this.ColorMap[505] = [ATBackgroundColor24None]::new()
        $this.ColorMap[506] = [ATBackgroundColor24None]::new()
        $this.ColorMap[507] = [ATBackgroundColor24None]::new()
        $this.ColorMap[508] = [ATBackgroundColor24None]::new()
        $this.ColorMap[509] = [ATBackgroundColor24None]::new()
        $this.ColorMap[510] = [ATBackgroundColor24None]::new()
        $this.ColorMap[511] = [ATBackgroundColor24None]::new()
        $this.ColorMap[512] = [ATBackgroundColor24None]::new()
        $this.ColorMap[513] = [ATBackgroundColor24None]::new()
        $this.ColorMap[514] = [ATBackgroundColor24None]::new()
        $this.ColorMap[515] = [ATBackgroundColor24None]::new()
        $this.ColorMap[516] = [ATBackgroundColor24None]::new()
        $this.ColorMap[517] = [ATBackgroundColor24None]::new() # End Row 13
        $this.ColorMap[518] = [ATBackgroundColor24None]::new()
        $this.ColorMap[519] = [ATBackgroundColor24None]::new()
        $this.ColorMap[520] = [ATBackgroundColor24None]::new()
        $this.ColorMap[521] = [ATBackgroundColor24None]::new()
        $this.ColorMap[522] = [ATBackgroundColor24None]::new()
        $this.ColorMap[523] = [ATBackgroundColor24None]::new()
        $this.ColorMap[524] = [ATBackgroundColor24None]::new()
        $this.ColorMap[525] = [ATBackgroundColor24None]::new()
        $this.ColorMap[526] = [ATBackgroundColor24None]::new()
        $this.ColorMap[527] = [ATBackgroundColor24None]::new()
        $this.ColorMap[528] = [ATBackgroundColor24None]::new()
        $this.ColorMap[529] = [ATBackgroundColor24None]::new()
        $this.ColorMap[530] = [ATBackgroundColor24None]::new()
        $this.ColorMap[531] = [ATBackgroundColor24None]::new()
        $this.ColorMap[532] = [ATBackgroundColor24None]::new()
        $this.ColorMap[533] = [ATBackgroundColor24None]::new()
        $this.ColorMap[534] = [ATBackgroundColor24None]::new()
        $this.ColorMap[535] = [ATBackgroundColor24None]::new()
        $this.ColorMap[536] = [ATBackgroundColor24None]::new()
        $this.ColorMap[537] = [ATBackgroundColor24None]::new()
        $this.ColorMap[538] = [ATBackgroundColor24None]::new()
        $this.ColorMap[539] = [ATBackgroundColor24None]::new()
        $this.ColorMap[540] = [ATBackgroundColor24None]::new()
        $this.ColorMap[541] = [ATBackgroundColor24None]::new()
        $this.ColorMap[542] = [ATBackgroundColor24None]::new()
        $this.ColorMap[543] = [ATBackgroundColor24None]::new()
        $this.ColorMap[544] = [ATBackgroundColor24None]::new()
        $this.ColorMap[545] = [ATBackgroundColor24None]::new()
        $this.ColorMap[546] = [ATBackgroundColor24None]::new()
        $this.ColorMap[547] = [ATBackgroundColor24None]::new()
        $this.ColorMap[548] = [ATBackgroundColor24None]::new()
        $this.ColorMap[549] = [ATBackgroundColor24None]::new()
        $this.ColorMap[550] = [ATBackgroundColor24None]::new()
        $this.ColorMap[551] = [ATBackgroundColor24None]::new()
        $this.ColorMap[552] = [ATBackgroundColor24None]::new()
        $this.ColorMap[553] = [ATBackgroundColor24None]::new()
        $this.ColorMap[554] = [ATBackgroundColor24None]::new() # End Row 14

        $this.CreateImageATString($this.ColorMap)
        $this.ColorMap = $null
    }
}

Class EEINocturna : EEIInternalBase {
    EEINocturna() : base() {
        $this.ColorMap[0]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[1]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[2]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[3]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[4]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[5]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[6]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[7]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[8]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[9]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[10]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[11]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[12]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[13]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[14]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[15]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[16]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[17]  = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[18]  = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[19]  = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[20]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[21]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[22]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[23]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[24]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[25]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[26]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[27]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[28]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[29]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[30]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[31]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[32]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[33]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[34]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[35]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[36]  = [ATBackgroundColor24None]::new() # End Row 0
        $this.ColorMap[37]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[38]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[39]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[40]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[41]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[42]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[43]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[44]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[45]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[46]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[47]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[48]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[49]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[50]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[51]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[52]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[53]  = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[54]  = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[55]  = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[56]  = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[57]  = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[58]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[59]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[60]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[61]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[62]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[63]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[64]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[65]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[66]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[67]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[68]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[69]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[70]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[71]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[72]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[73]  = [ATBackgroundColor24None]::new() # End Row 1
        $this.ColorMap[74]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[75]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[76]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[77]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[78]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[79]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[80]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[81]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[82]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[83]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[84]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[85]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[86]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[87]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[88]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[89]  = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[90]  = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[91]  = [CCAppleVPinkADark24]::new()
        $this.ColorMap[92]  = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[93]  = [CCAppleVPinkADark24]::new()
        $this.ColorMap[94]  = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[95]  = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[96]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[97]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[98]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[99]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[100] = [ATBackgroundColor24None]::new()
        $this.ColorMap[101] = [ATBackgroundColor24None]::new()
        $this.ColorMap[102] = [ATBackgroundColor24None]::new()
        $this.ColorMap[103] = [ATBackgroundColor24None]::new()
        $this.ColorMap[104] = [ATBackgroundColor24None]::new()
        $this.ColorMap[105] = [ATBackgroundColor24None]::new()
        $this.ColorMap[106] = [ATBackgroundColor24None]::new()
        $this.ColorMap[107] = [ATBackgroundColor24None]::new()
        $this.ColorMap[108] = [ATBackgroundColor24None]::new()
        $this.ColorMap[109] = [ATBackgroundColor24None]::new()
        $this.ColorMap[110] = [ATBackgroundColor24None]::new() # End Row 2
        $this.ColorMap[111] = [ATBackgroundColor24None]::new()
        $this.ColorMap[112] = [ATBackgroundColor24None]::new()
        $this.ColorMap[113] = [ATBackgroundColor24None]::new()
        $this.ColorMap[114] = [ATBackgroundColor24None]::new()
        $this.ColorMap[115] = [ATBackgroundColor24None]::new()
        $this.ColorMap[116] = [CCAppleVMintALight24]::new()
        $this.ColorMap[117] = [CCAppleVMintALight24]::new()
        $this.ColorMap[118] = [ATBackgroundColor24None]::new()
        $this.ColorMap[119] = [ATBackgroundColor24None]::new()
        $this.ColorMap[120] = [ATBackgroundColor24None]::new()
        $this.ColorMap[121] = [ATBackgroundColor24None]::new()
        $this.ColorMap[122] = [CCAppleVMintALight24]::new()
        $this.ColorMap[123] = [CCAppleVMintALight24]::new()
        $this.ColorMap[124] = [ATBackgroundColor24None]::new()
        $this.ColorMap[125] = [ATBackgroundColor24None]::new()
        $this.ColorMap[126] = [ATBackgroundColor24None]::new()
        $this.ColorMap[127] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[128] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[129] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[130] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[131] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[132] = [ATBackgroundColor24None]::new()
        $this.ColorMap[133] = [ATBackgroundColor24None]::new()
        $this.ColorMap[134] = [ATBackgroundColor24None]::new()
        $this.ColorMap[135] = [CCAppleVMintALight24]::new()
        $this.ColorMap[136] = [CCAppleVMintALight24]::new()
        $this.ColorMap[137] = [ATBackgroundColor24None]::new()
        $this.ColorMap[138] = [ATBackgroundColor24None]::new()
        $this.ColorMap[139] = [ATBackgroundColor24None]::new()
        $this.ColorMap[140] = [ATBackgroundColor24None]::new()
        $this.ColorMap[141] = [CCAppleVMintALight24]::new()
        $this.ColorMap[142] = [CCAppleVMintALight24]::new()
        $this.ColorMap[143] = [ATBackgroundColor24None]::new()
        $this.ColorMap[144] = [ATBackgroundColor24None]::new()
        $this.ColorMap[145] = [ATBackgroundColor24None]::new()
        $this.ColorMap[146] = [ATBackgroundColor24None]::new()
        $this.ColorMap[147] = [ATBackgroundColor24None]::new() # End Row 3
        $this.ColorMap[148] = [ATBackgroundColor24None]::new()
        $this.ColorMap[149] = [ATBackgroundColor24None]::new()
        $this.ColorMap[150] = [ATBackgroundColor24None]::new()
        $this.ColorMap[151] = [ATBackgroundColor24None]::new()
        $this.ColorMap[152] = [CCAppleVMintALight24]::new()
        $this.ColorMap[153] = [CCAppleVMintALight24]::new()
        $this.ColorMap[154] = [CCAppleVMintALight24]::new()
        $this.ColorMap[155] = [CCAppleVMintALight24]::new()
        $this.ColorMap[156] = [CCAppleVMintALight24]::new()
        $this.ColorMap[157] = [ATBackgroundColor24None]::new()
        $this.ColorMap[158] = [CCAppleVMintALight24]::new()
        $this.ColorMap[159] = [CCAppleVMintALight24]::new()
        $this.ColorMap[160] = [CCAppleVMintALight24]::new()
        $this.ColorMap[161] = [CCAppleVMintALight24]::new()
        $this.ColorMap[162] = [CCAppleVMintALight24]::new()
        $this.ColorMap[163] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[164] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[165] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[166] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[167] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[168] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[169] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[170] = [CCAppleVMintALight24]::new()
        $this.ColorMap[171] = [CCAppleVMintALight24]::new()
        $this.ColorMap[172] = [CCAppleVMintALight24]::new()
        $this.ColorMap[173] = [CCAppleVMintALight24]::new()
        $this.ColorMap[174] = [CCAppleVMintALight24]::new()
        $this.ColorMap[175] = [ATBackgroundColor24None]::new()
        $this.ColorMap[176] = [CCAppleVMintALight24]::new()
        $this.ColorMap[177] = [CCAppleVMintALight24]::new()
        $this.ColorMap[178] = [CCAppleVMintALight24]::new()
        $this.ColorMap[179] = [CCAppleVMintALight24]::new()
        $this.ColorMap[180] = [CCAppleVMintALight24]::new()
        $this.ColorMap[181] = [ATBackgroundColor24None]::new()
        $this.ColorMap[182] = [ATBackgroundColor24None]::new()
        $this.ColorMap[183] = [ATBackgroundColor24None]::new()
        $this.ColorMap[184] = [ATBackgroundColor24None]::new() # End Row 4
        $this.ColorMap[185] = [ATBackgroundColor24None]::new()
        $this.ColorMap[186] = [ATBackgroundColor24None]::new()
        $this.ColorMap[187] = [ATBackgroundColor24None]::new()
        $this.ColorMap[188] = [ATBackgroundColor24None]::new()
        $this.ColorMap[189] = [CCAppleVMintALight24]::new()
        $this.ColorMap[190] = [CCAppleVMintALight24]::new()
        $this.ColorMap[191] = [CCAppleVMintALight24]::new()
        $this.ColorMap[192] = [CCAppleVMintALight24]::new()
        $this.ColorMap[193] = [CCAppleVMintALight24]::new()
        $this.ColorMap[194] = [CCAppleVMintALight24]::new()
        $this.ColorMap[195] = [CCAppleVMintALight24]::new()
        $this.ColorMap[196] = [CCAppleVMintALight24]::new()
        $this.ColorMap[197] = [CCAppleVMintALight24]::new()
        $this.ColorMap[198] = [CCAppleVMintALight24]::new()
        $this.ColorMap[199] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[200] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[201] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[202] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[203] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[204] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[205] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[206] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[207] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[208] = [CCAppleVMintALight24]::new()
        $this.ColorMap[209] = [CCAppleVMintALight24]::new()
        $this.ColorMap[210] = [CCAppleVMintALight24]::new()
        $this.ColorMap[211] = [CCAppleVMintALight24]::new()
        $this.ColorMap[212] = [CCAppleVMintALight24]::new()
        $this.ColorMap[213] = [CCAppleVMintALight24]::new()
        $this.ColorMap[214] = [CCAppleVMintALight24]::new()
        $this.ColorMap[215] = [CCAppleVMintALight24]::new()
        $this.ColorMap[216] = [CCAppleVMintALight24]::new()
        $this.ColorMap[217] = [CCAppleVMintALight24]::new()
        $this.ColorMap[218] = [ATBackgroundColor24None]::new()
        $this.ColorMap[219] = [ATBackgroundColor24None]::new()
        $this.ColorMap[220] = [ATBackgroundColor24None]::new()
        $this.ColorMap[221] = [ATBackgroundColor24None]::new() # End Row 5
        $this.ColorMap[222] = [ATBackgroundColor24None]::new()
        $this.ColorMap[223] = [ATBackgroundColor24None]::new()
        $this.ColorMap[224] = [ATBackgroundColor24None]::new()
        $this.ColorMap[225] = [CCAppleVMintALight24]::new()
        $this.ColorMap[226] = [CCAppleVMintALight24]::new()
        $this.ColorMap[227] = [CCAppleVMintALight24]::new()
        $this.ColorMap[228] = [CCAppleVMintALight24]::new()
        $this.ColorMap[229] = [CCAppleVMintALight24]::new()
        $this.ColorMap[230] = [CCAppleVMintALight24]::new()
        $this.ColorMap[231] = [CCAppleVMintALight24]::new()
        $this.ColorMap[232] = [CCAppleVMintALight24]::new()
        $this.ColorMap[233] = [CCAppleVMintALight24]::new()
        $this.ColorMap[234] = [CCAppleVMintALight24]::new()
        $this.ColorMap[235] = [CCAppleVMintALight24]::new()
        $this.ColorMap[236] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[237] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[238] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[239] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[240] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[241] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[242] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[243] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[244] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[245] = [CCAppleVMintALight24]::new()
        $this.ColorMap[246] = [CCAppleVMintALight24]::new()
        $this.ColorMap[247] = [CCAppleVMintALight24]::new()
        $this.ColorMap[248] = [CCAppleVMintALight24]::new()
        $this.ColorMap[249] = [CCAppleVMintALight24]::new()
        $this.ColorMap[250] = [CCAppleVMintALight24]::new()
        $this.ColorMap[251] = [CCAppleVMintALight24]::new()
        $this.ColorMap[252] = [CCAppleVMintALight24]::new()
        $this.ColorMap[253] = [CCAppleVMintALight24]::new()
        $this.ColorMap[254] = [CCAppleVMintALight24]::new()
        $this.ColorMap[255] = [CCAppleVMintALight24]::new()
        $this.ColorMap[256] = [ATBackgroundColor24None]::new()
        $this.ColorMap[257] = [ATBackgroundColor24None]::new()
        $this.ColorMap[258] = [ATBackgroundColor24None]::new() # End Row 6
        $this.ColorMap[259] = [ATBackgroundColor24None]::new()
        $this.ColorMap[260] = [ATBackgroundColor24None]::new()
        $this.ColorMap[261] = [ATBackgroundColor24None]::new()
        $this.ColorMap[262] = [CCAppleVMintALight24]::new()
        $this.ColorMap[263] = [CCAppleVMintALight24]::new()
        $this.ColorMap[264] = [CCAppleVMintALight24]::new()
        $this.ColorMap[265] = [CCAppleVMintALight24]::new()
        $this.ColorMap[266] = [CCAppleVMintALight24]::new()
        $this.ColorMap[267] = [CCAppleVMintALight24]::new()
        $this.ColorMap[268] = [CCAppleVMintALight24]::new()
        $this.ColorMap[269] = [CCAppleVMintALight24]::new()
        $this.ColorMap[270] = [CCAppleVMintALight24]::new()
        $this.ColorMap[271] = [CCAppleVMintALight24]::new()
        $this.ColorMap[272] = [CCAppleVMintALight24]::new()
        $this.ColorMap[273] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[274] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[275] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[276] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[277] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[278] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[279] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[280] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[281] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[282] = [CCAppleVMintALight24]::new()
        $this.ColorMap[283] = [CCAppleVMintALight24]::new()
        $this.ColorMap[284] = [CCAppleVMintALight24]::new()
        $this.ColorMap[285] = [CCAppleVMintALight24]::new()
        $this.ColorMap[286] = [CCAppleVMintALight24]::new()
        $this.ColorMap[287] = [CCAppleVMintALight24]::new()
        $this.ColorMap[288] = [CCAppleVMintALight24]::new()
        $this.ColorMap[289] = [CCAppleVMintALight24]::new()
        $this.ColorMap[290] = [CCAppleVMintALight24]::new()
        $this.ColorMap[291] = [CCAppleVMintALight24]::new()
        $this.ColorMap[292] = [CCAppleVMintALight24]::new()
        $this.ColorMap[293] = [ATBackgroundColor24None]::new()
        $this.ColorMap[294] = [ATBackgroundColor24None]::new()
        $this.ColorMap[295] = [ATBackgroundColor24None]::new() # End Row 7
        $this.ColorMap[296] = [ATBackgroundColor24None]::new()
        $this.ColorMap[297] = [ATBackgroundColor24None]::new()
        $this.ColorMap[298] = [ATBackgroundColor24None]::new()
        $this.ColorMap[299] = [CCAppleVMintALight24]::new()
        $this.ColorMap[300] = [CCAppleVMintALight24]::new()
        $this.ColorMap[301] = [CCAppleVMintALight24]::new()
        $this.ColorMap[302] = [CCAppleVMintALight24]::new()
        $this.ColorMap[303] = [CCAppleVMintALight24]::new()
        $this.ColorMap[304] = [CCAppleVMintALight24]::new()
        $this.ColorMap[305] = [CCAppleVMintALight24]::new()
        $this.ColorMap[306] = [CCAppleVMintALight24]::new()
        $this.ColorMap[307] = [CCAppleVMintALight24]::new()
        $this.ColorMap[308] = [CCAppleVMintALight24]::new()
        $this.ColorMap[309] = [CCAppleVMintALight24]::new()
        $this.ColorMap[310] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[311] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[312] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[313] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[314] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[315] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[316] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[317] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[318] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[319] = [CCAppleVMintALight24]::new()
        $this.ColorMap[320] = [CCAppleVMintALight24]::new()
        $this.ColorMap[321] = [CCAppleVMintALight24]::new()
        $this.ColorMap[322] = [CCAppleVMintALight24]::new()
        $this.ColorMap[323] = [CCAppleVMintALight24]::new()
        $this.ColorMap[324] = [CCAppleVMintALight24]::new()
        $this.ColorMap[325] = [CCAppleVMintALight24]::new()
        $this.ColorMap[326] = [CCAppleVMintALight24]::new()
        $this.ColorMap[327] = [CCAppleVMintALight24]::new()
        $this.ColorMap[328] = [CCAppleVMintALight24]::new()
        $this.ColorMap[329] = [CCAppleVMintALight24]::new()
        $this.ColorMap[330] = [ATBackgroundColor24None]::new()
        $this.ColorMap[331] = [ATBackgroundColor24None]::new()
        $this.ColorMap[332] = [ATBackgroundColor24None]::new() # End Row 8
        $this.ColorMap[333] = [ATBackgroundColor24None]::new()
        $this.ColorMap[334] = [ATBackgroundColor24None]::new()
        $this.ColorMap[335] = [CCAppleVMintALight24]::new()
        $this.ColorMap[336] = [CCAppleVMintALight24]::new()
        $this.ColorMap[337] = [CCAppleVMintALight24]::new()
        $this.ColorMap[338] = [CCAppleVMintALight24]::new()
        $this.ColorMap[339] = [CCAppleVMintALight24]::new()
        $this.ColorMap[340] = [CCAppleVMintALight24]::new()
        $this.ColorMap[341] = [CCAppleVMintALight24]::new()
        $this.ColorMap[342] = [CCAppleVMintALight24]::new()
        $this.ColorMap[343] = [CCAppleVMintALight24]::new()
        $this.ColorMap[344] = [CCAppleVMintALight24]::new()
        $this.ColorMap[345] = [ATBackgroundColor24None]::new()
        $this.ColorMap[346] = [ATBackgroundColor24None]::new()
        $this.ColorMap[347] = [CCAppleVMintALight24]::new()
        $this.ColorMap[348] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[349] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[350] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[351] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[352] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[353] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[354] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[355] = [CCAppleVMintALight24]::new()
        $this.ColorMap[356] = [ATBackgroundColor24None]::new()
        $this.ColorMap[357] = [ATBackgroundColor24None]::new()
        $this.ColorMap[358] = [CCAppleVMintALight24]::new()
        $this.ColorMap[359] = [CCAppleVMintALight24]::new()
        $this.ColorMap[360] = [CCAppleVMintALight24]::new()
        $this.ColorMap[361] = [CCAppleVMintALight24]::new()
        $this.ColorMap[362] = [CCAppleVMintALight24]::new()
        $this.ColorMap[363] = [CCAppleVMintALight24]::new()
        $this.ColorMap[364] = [CCAppleVMintALight24]::new()
        $this.ColorMap[365] = [CCAppleVMintALight24]::new()
        $this.ColorMap[366] = [CCAppleVMintALight24]::new()
        $this.ColorMap[367] = [CCAppleVMintALight24]::new()
        $this.ColorMap[368] = [ATBackgroundColor24None]::new()
        $this.ColorMap[369] = [ATBackgroundColor24None]::new() # End Row 9
        $this.ColorMap[370] = [ATBackgroundColor24None]::new()
        $this.ColorMap[371] = [ATBackgroundColor24None]::new()
        $this.ColorMap[372] = [CCAppleVMintALight24]::new()
        $this.ColorMap[373] = [CCAppleVMintALight24]::new()
        $this.ColorMap[374] = [CCAppleVMintALight24]::new()
        $this.ColorMap[375] = [CCAppleVMintALight24]::new()
        $this.ColorMap[376] = [ATBackgroundColor24None]::new()
        $this.ColorMap[377] = [ATBackgroundColor24None]::new()
        $this.ColorMap[378] = [CCAppleVMintALight24]::new()
        $this.ColorMap[379] = [CCAppleVMintALight24]::new()
        $this.ColorMap[380] = [CCAppleVMintALight24]::new()
        $this.ColorMap[381] = [ATBackgroundColor24None]::new()
        $this.ColorMap[382] = [ATBackgroundColor24None]::new()
        $this.ColorMap[383] = [ATBackgroundColor24None]::new()
        $this.ColorMap[384] = [ATBackgroundColor24None]::new()
        $this.ColorMap[385] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[386] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[387] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[388] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[389] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[390] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[391] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[392] = [ATBackgroundColor24None]::new()
        $this.ColorMap[393] = [ATBackgroundColor24None]::new()
        $this.ColorMap[394] = [ATBackgroundColor24None]::new()
        $this.ColorMap[395] = [ATBackgroundColor24None]::new()
        $this.ColorMap[396] = [CCAppleVMintALight24]::new()
        $this.ColorMap[397] = [CCAppleVMintALight24]::new()
        $this.ColorMap[398] = [CCAppleVMintALight24]::new()
        $this.ColorMap[399] = [ATBackgroundColor24None]::new()
        $this.ColorMap[400] = [ATBackgroundColor24None]::new()
        $this.ColorMap[401] = [CCAppleVMintALight24]::new()
        $this.ColorMap[402] = [CCAppleVMintALight24]::new()
        $this.ColorMap[403] = [CCAppleVMintALight24]::new()
        $this.ColorMap[404] = [CCAppleVMintALight24]::new()
        $this.ColorMap[405] = [ATBackgroundColor24None]::new()
        $this.ColorMap[406] = [ATBackgroundColor24None]::new() # End Row 10
        $this.ColorMap[407] = [ATBackgroundColor24None]::new()
        $this.ColorMap[408] = [ATBackgroundColor24None]::new()
        $this.ColorMap[409] = [CCAppleVMintALight24]::new()
        $this.ColorMap[410] = [CCAppleVMintALight24]::new()
        $this.ColorMap[411] = [ATBackgroundColor24None]::new()
        $this.ColorMap[412] = [ATBackgroundColor24None]::new()
        $this.ColorMap[413] = [ATBackgroundColor24None]::new()
        $this.ColorMap[414] = [ATBackgroundColor24None]::new()
        $this.ColorMap[415] = [ATBackgroundColor24None]::new()
        $this.ColorMap[416] = [CCAppleVMintALight24]::new()
        $this.ColorMap[417] = [ATBackgroundColor24None]::new()
        $this.ColorMap[418] = [ATBackgroundColor24None]::new()
        $this.ColorMap[419] = [ATBackgroundColor24None]::new()
        $this.ColorMap[420] = [CCAppleVGreyALight24]::new()
        $this.ColorMap[421] = [ATBackgroundColor24None]::new()
        $this.ColorMap[422] = [ATBackgroundColor24None]::new()
        $this.ColorMap[423] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[424] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[425] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[426] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[427] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[428] = [ATBackgroundColor24None]::new()
        $this.ColorMap[429] = [ATBackgroundColor24None]::new()
        $this.ColorMap[430] = [CCAppleVGreyALight24]::new()
        $this.ColorMap[431] = [ATBackgroundColor24None]::new()
        $this.ColorMap[432] = [ATBackgroundColor24None]::new()
        $this.ColorMap[433] = [ATBackgroundColor24None]::new()
        $this.ColorMap[434] = [CCAppleVMintALight24]::new()
        $this.ColorMap[435] = [ATBackgroundColor24None]::new()
        $this.ColorMap[436] = [ATBackgroundColor24None]::new()
        $this.ColorMap[437] = [ATBackgroundColor24None]::new()
        $this.ColorMap[438] = [ATBackgroundColor24None]::new()
        $this.ColorMap[439] = [ATBackgroundColor24None]::new()
        $this.ColorMap[440] = [CCAppleVMintALight24]::new()
        $this.ColorMap[441] = [CCAppleVMintALight24]::new()
        $this.ColorMap[442] = [ATBackgroundColor24None]::new()
        $this.ColorMap[443] = [ATBackgroundColor24None]::new() # End Row 11
        $this.ColorMap[444] = [ATBackgroundColor24None]::new()
        $this.ColorMap[445] = [ATBackgroundColor24None]::new()
        $this.ColorMap[446] = [CCAppleVMintALight24]::new()
        $this.ColorMap[447] = [ATBackgroundColor24None]::new()
        $this.ColorMap[448] = [ATBackgroundColor24None]::new()
        $this.ColorMap[449] = [ATBackgroundColor24None]::new()
        $this.ColorMap[450] = [ATBackgroundColor24None]::new()
        $this.ColorMap[451] = [ATBackgroundColor24None]::new()
        $this.ColorMap[452] = [ATBackgroundColor24None]::new()
        $this.ColorMap[453] = [ATBackgroundColor24None]::new()
        $this.ColorMap[454] = [ATBackgroundColor24None]::new()
        $this.ColorMap[455] = [ATBackgroundColor24None]::new()
        $this.ColorMap[456] = [ATBackgroundColor24None]::new()
        $this.ColorMap[457] = [ATBackgroundColor24None]::new()
        $this.ColorMap[458] = [CCAppleVGreyALight24]::new()
        $this.ColorMap[459] = [CCAppleVGreyALight24]::new()
        $this.ColorMap[460] = [ATBackgroundColor24None]::new()
        $this.ColorMap[461] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[462] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[463] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[464] = [ATBackgroundColor24None]::new()
        $this.ColorMap[465] = [CCAppleVGreyALight24]::new()
        $this.ColorMap[466] = [CCAppleVGreyALight24]::new()
        $this.ColorMap[467] = [ATBackgroundColor24None]::new()
        $this.ColorMap[468] = [ATBackgroundColor24None]::new()
        $this.ColorMap[469] = [ATBackgroundColor24None]::new()
        $this.ColorMap[470] = [ATBackgroundColor24None]::new()
        $this.ColorMap[471] = [ATBackgroundColor24None]::new()
        $this.ColorMap[472] = [ATBackgroundColor24None]::new()
        $this.ColorMap[473] = [ATBackgroundColor24None]::new()
        $this.ColorMap[474] = [ATBackgroundColor24None]::new()
        $this.ColorMap[475] = [ATBackgroundColor24None]::new()
        $this.ColorMap[476] = [ATBackgroundColor24None]::new()
        $this.ColorMap[477] = [ATBackgroundColor24None]::new()
        $this.ColorMap[478] = [CCAppleVMintALight24]::new()
        $this.ColorMap[479] = [ATBackgroundColor24None]::new()
        $this.ColorMap[480] = [ATBackgroundColor24None]::new() # End Row 12
        $this.ColorMap[481] = [ATBackgroundColor24None]::new()
        $this.ColorMap[482] = [ATBackgroundColor24None]::new()
        $this.ColorMap[483] = [ATBackgroundColor24None]::new()
        $this.ColorMap[484] = [ATBackgroundColor24None]::new()
        $this.ColorMap[485] = [ATBackgroundColor24None]::new()
        $this.ColorMap[486] = [ATBackgroundColor24None]::new()
        $this.ColorMap[487] = [ATBackgroundColor24None]::new()
        $this.ColorMap[488] = [ATBackgroundColor24None]::new()
        $this.ColorMap[489] = [ATBackgroundColor24None]::new()
        $this.ColorMap[490] = [ATBackgroundColor24None]::new()
        $this.ColorMap[491] = [ATBackgroundColor24None]::new()
        $this.ColorMap[492] = [ATBackgroundColor24None]::new()
        $this.ColorMap[493] = [ATBackgroundColor24None]::new()
        $this.ColorMap[494] = [CCAppleVGreyALight24]::new()
        $this.ColorMap[495] = [ATBackgroundColor24None]::new()
        $this.ColorMap[496] = [ATBackgroundColor24None]::new()
        $this.ColorMap[497] = [ATBackgroundColor24None]::new()
        $this.ColorMap[498] = [ATBackgroundColor24None]::new()
        $this.ColorMap[499] = [CCAppleVPurpleALight24]::new()
        $this.ColorMap[500] = [ATBackgroundColor24None]::new()
        $this.ColorMap[501] = [ATBackgroundColor24None]::new()
        $this.ColorMap[502] = [ATBackgroundColor24None]::new()
        $this.ColorMap[503] = [ATBackgroundColor24None]::new()
        $this.ColorMap[504] = [CCAppleVGreyALight24]::new()
        $this.ColorMap[505] = [ATBackgroundColor24None]::new()
        $this.ColorMap[506] = [ATBackgroundColor24None]::new()
        $this.ColorMap[507] = [ATBackgroundColor24None]::new()
        $this.ColorMap[508] = [ATBackgroundColor24None]::new()
        $this.ColorMap[509] = [ATBackgroundColor24None]::new()
        $this.ColorMap[510] = [ATBackgroundColor24None]::new()
        $this.ColorMap[511] = [ATBackgroundColor24None]::new()
        $this.ColorMap[512] = [ATBackgroundColor24None]::new()
        $this.ColorMap[513] = [ATBackgroundColor24None]::new()
        $this.ColorMap[514] = [ATBackgroundColor24None]::new()
        $this.ColorMap[515] = [ATBackgroundColor24None]::new()
        $this.ColorMap[516] = [ATBackgroundColor24None]::new()
        $this.ColorMap[517] = [ATBackgroundColor24None]::new() # End Row 13
        $this.ColorMap[518] = [ATBackgroundColor24None]::new()
        $this.ColorMap[519] = [ATBackgroundColor24None]::new()
        $this.ColorMap[520] = [ATBackgroundColor24None]::new()
        $this.ColorMap[521] = [ATBackgroundColor24None]::new()
        $this.ColorMap[522] = [ATBackgroundColor24None]::new()
        $this.ColorMap[523] = [ATBackgroundColor24None]::new()
        $this.ColorMap[524] = [ATBackgroundColor24None]::new()
        $this.ColorMap[525] = [ATBackgroundColor24None]::new()
        $this.ColorMap[526] = [ATBackgroundColor24None]::new()
        $this.ColorMap[527] = [ATBackgroundColor24None]::new()
        $this.ColorMap[528] = [ATBackgroundColor24None]::new()
        $this.ColorMap[529] = [ATBackgroundColor24None]::new()
        $this.ColorMap[530] = [ATBackgroundColor24None]::new()
        $this.ColorMap[531] = [ATBackgroundColor24None]::new()
        $this.ColorMap[532] = [ATBackgroundColor24None]::new()
        $this.ColorMap[533] = [ATBackgroundColor24None]::new()
        $this.ColorMap[534] = [ATBackgroundColor24None]::new()
        $this.ColorMap[535] = [ATBackgroundColor24None]::new()
        $this.ColorMap[536] = [ATBackgroundColor24None]::new()
        $this.ColorMap[537] = [ATBackgroundColor24None]::new()
        $this.ColorMap[538] = [ATBackgroundColor24None]::new()
        $this.ColorMap[539] = [ATBackgroundColor24None]::new()
        $this.ColorMap[540] = [ATBackgroundColor24None]::new()
        $this.ColorMap[541] = [ATBackgroundColor24None]::new()
        $this.ColorMap[542] = [ATBackgroundColor24None]::new()
        $this.ColorMap[543] = [ATBackgroundColor24None]::new()
        $this.ColorMap[544] = [ATBackgroundColor24None]::new()
        $this.ColorMap[545] = [ATBackgroundColor24None]::new()
        $this.ColorMap[546] = [ATBackgroundColor24None]::new()
        $this.ColorMap[547] = [ATBackgroundColor24None]::new()
        $this.ColorMap[548] = [ATBackgroundColor24None]::new()
        $this.ColorMap[549] = [ATBackgroundColor24None]::new()
        $this.ColorMap[550] = [ATBackgroundColor24None]::new()
        $this.ColorMap[551] = [ATBackgroundColor24None]::new()
        $this.ColorMap[552] = [ATBackgroundColor24None]::new()
        $this.ColorMap[553] = [ATBackgroundColor24None]::new()
        $this.ColorMap[554] = [ATBackgroundColor24None]::new() # End Row 14

        $this.CreateImageATString($this.ColorMap)
        $this.ColorMap = $null
    }
}

Class EEIBloodswoop : EEIInternalBase {
    EEIBloodswoop() : base() {
        $this.ColorMap[0]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[1]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[2]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[3]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[4]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[5]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[6]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[7]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[8]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[9]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[10]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[11]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[12]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[13]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[14]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[15]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[16]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[17]  = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[18]  = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[19]  = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[20]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[21]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[22]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[23]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[24]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[25]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[26]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[27]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[28]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[29]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[30]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[31]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[32]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[33]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[34]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[35]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[36]  = [ATBackgroundColor24None]::new() # End Row 0
        $this.ColorMap[37]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[38]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[39]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[40]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[41]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[42]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[43]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[44]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[45]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[46]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[47]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[48]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[49]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[50]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[51]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[52]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[53]  = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[54]  = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[55]  = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[56]  = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[57]  = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[58]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[59]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[60]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[61]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[62]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[63]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[64]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[65]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[66]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[67]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[68]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[69]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[70]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[71]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[72]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[73]  = [ATBackgroundColor24None]::new() # End Row 1
        $this.ColorMap[74]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[75]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[76]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[77]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[78]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[79]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[80]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[81]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[82]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[83]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[84]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[85]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[86]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[87]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[88]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[89]  = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[90]  = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[91]  = [CCAppleVYellowADark24]::new()
        $this.ColorMap[92]  = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[93]  = [CCAppleVYellowADark24]::new()
        $this.ColorMap[94]  = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[95]  = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[96]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[97]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[98]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[99]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[100] = [ATBackgroundColor24None]::new()
        $this.ColorMap[101] = [ATBackgroundColor24None]::new()
        $this.ColorMap[102] = [ATBackgroundColor24None]::new()
        $this.ColorMap[103] = [ATBackgroundColor24None]::new()
        $this.ColorMap[104] = [ATBackgroundColor24None]::new()
        $this.ColorMap[105] = [ATBackgroundColor24None]::new()
        $this.ColorMap[106] = [ATBackgroundColor24None]::new()
        $this.ColorMap[107] = [ATBackgroundColor24None]::new()
        $this.ColorMap[108] = [ATBackgroundColor24None]::new()
        $this.ColorMap[109] = [ATBackgroundColor24None]::new()
        $this.ColorMap[110] = [ATBackgroundColor24None]::new() # End Row 2
        $this.ColorMap[111] = [ATBackgroundColor24None]::new()
        $this.ColorMap[112] = [ATBackgroundColor24None]::new()
        $this.ColorMap[113] = [ATBackgroundColor24None]::new()
        $this.ColorMap[114] = [ATBackgroundColor24None]::new()
        $this.ColorMap[115] = [ATBackgroundColor24None]::new()
        $this.ColorMap[116] = [CCAppleVRedLight24]::new()
        $this.ColorMap[117] = [CCAppleVRedLight24]::new()
        $this.ColorMap[118] = [ATBackgroundColor24None]::new()
        $this.ColorMap[119] = [ATBackgroundColor24None]::new()
        $this.ColorMap[120] = [ATBackgroundColor24None]::new()
        $this.ColorMap[121] = [ATBackgroundColor24None]::new()
        $this.ColorMap[122] = [CCAppleVRedLight24]::new()
        $this.ColorMap[123] = [CCAppleVRedLight24]::new()
        $this.ColorMap[124] = [ATBackgroundColor24None]::new()
        $this.ColorMap[125] = [ATBackgroundColor24None]::new()
        $this.ColorMap[126] = [ATBackgroundColor24None]::new()
        $this.ColorMap[127] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[128] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[129] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[130] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[131] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[132] = [ATBackgroundColor24None]::new()
        $this.ColorMap[133] = [ATBackgroundColor24None]::new()
        $this.ColorMap[134] = [ATBackgroundColor24None]::new()
        $this.ColorMap[135] = [CCAppleVRedLight24]::new()
        $this.ColorMap[136] = [CCAppleVRedLight24]::new()
        $this.ColorMap[137] = [ATBackgroundColor24None]::new()
        $this.ColorMap[138] = [ATBackgroundColor24None]::new()
        $this.ColorMap[139] = [ATBackgroundColor24None]::new()
        $this.ColorMap[140] = [ATBackgroundColor24None]::new()
        $this.ColorMap[141] = [CCAppleVRedLight24]::new()
        $this.ColorMap[142] = [CCAppleVRedLight24]::new()
        $this.ColorMap[143] = [ATBackgroundColor24None]::new()
        $this.ColorMap[144] = [ATBackgroundColor24None]::new()
        $this.ColorMap[145] = [ATBackgroundColor24None]::new()
        $this.ColorMap[146] = [ATBackgroundColor24None]::new()
        $this.ColorMap[147] = [ATBackgroundColor24None]::new() # End Row 3
        $this.ColorMap[148] = [ATBackgroundColor24None]::new()
        $this.ColorMap[149] = [ATBackgroundColor24None]::new()
        $this.ColorMap[150] = [ATBackgroundColor24None]::new()
        $this.ColorMap[151] = [ATBackgroundColor24None]::new()
        $this.ColorMap[152] = [CCAppleVRedLight24]::new()
        $this.ColorMap[153] = [CCAppleVRedLight24]::new()
        $this.ColorMap[154] = [CCAppleVRedLight24]::new()
        $this.ColorMap[155] = [CCAppleVRedLight24]::new()
        $this.ColorMap[156] = [CCAppleVRedLight24]::new()
        $this.ColorMap[157] = [ATBackgroundColor24None]::new()
        $this.ColorMap[158] = [CCAppleVRedLight24]::new()
        $this.ColorMap[159] = [CCAppleVRedLight24]::new()
        $this.ColorMap[160] = [CCAppleVRedLight24]::new()
        $this.ColorMap[161] = [CCAppleVRedLight24]::new()
        $this.ColorMap[162] = [CCAppleVRedLight24]::new()
        $this.ColorMap[163] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[164] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[165] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[166] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[167] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[168] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[169] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[170] = [CCAppleVRedLight24]::new()
        $this.ColorMap[171] = [CCAppleVRedLight24]::new()
        $this.ColorMap[172] = [CCAppleVRedLight24]::new()
        $this.ColorMap[173] = [CCAppleVRedLight24]::new()
        $this.ColorMap[174] = [CCAppleVRedLight24]::new()
        $this.ColorMap[175] = [ATBackgroundColor24None]::new()
        $this.ColorMap[176] = [CCAppleVRedLight24]::new()
        $this.ColorMap[177] = [CCAppleVRedLight24]::new()
        $this.ColorMap[178] = [CCAppleVRedLight24]::new()
        $this.ColorMap[179] = [CCAppleVRedLight24]::new()
        $this.ColorMap[180] = [CCAppleVRedLight24]::new()
        $this.ColorMap[181] = [ATBackgroundColor24None]::new()
        $this.ColorMap[182] = [ATBackgroundColor24None]::new()
        $this.ColorMap[183] = [ATBackgroundColor24None]::new()
        $this.ColorMap[184] = [ATBackgroundColor24None]::new() # End Row 4
        $this.ColorMap[185] = [ATBackgroundColor24None]::new()
        $this.ColorMap[186] = [ATBackgroundColor24None]::new()
        $this.ColorMap[187] = [ATBackgroundColor24None]::new()
        $this.ColorMap[188] = [ATBackgroundColor24None]::new()
        $this.ColorMap[189] = [CCAppleVRedLight24]::new()
        $this.ColorMap[190] = [CCAppleVRedLight24]::new()
        $this.ColorMap[191] = [CCAppleVRedLight24]::new()
        $this.ColorMap[192] = [CCAppleVRedLight24]::new()
        $this.ColorMap[193] = [CCAppleVRedLight24]::new()
        $this.ColorMap[194] = [CCAppleVRedLight24]::new()
        $this.ColorMap[195] = [CCAppleVRedLight24]::new()
        $this.ColorMap[196] = [CCAppleVRedLight24]::new()
        $this.ColorMap[197] = [CCAppleVRedLight24]::new()
        $this.ColorMap[198] = [CCAppleVRedLight24]::new()
        $this.ColorMap[199] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[200] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[201] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[202] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[203] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[204] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[205] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[206] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[207] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[208] = [CCAppleVRedLight24]::new()
        $this.ColorMap[209] = [CCAppleVRedLight24]::new()
        $this.ColorMap[210] = [CCAppleVRedLight24]::new()
        $this.ColorMap[211] = [CCAppleVRedLight24]::new()
        $this.ColorMap[212] = [CCAppleVRedLight24]::new()
        $this.ColorMap[213] = [CCAppleVRedLight24]::new()
        $this.ColorMap[214] = [CCAppleVRedLight24]::new()
        $this.ColorMap[215] = [CCAppleVRedLight24]::new()
        $this.ColorMap[216] = [CCAppleVRedLight24]::new()
        $this.ColorMap[217] = [CCAppleVRedLight24]::new()
        $this.ColorMap[218] = [ATBackgroundColor24None]::new()
        $this.ColorMap[219] = [ATBackgroundColor24None]::new()
        $this.ColorMap[220] = [ATBackgroundColor24None]::new()
        $this.ColorMap[221] = [ATBackgroundColor24None]::new() # End Row 5
        $this.ColorMap[222] = [ATBackgroundColor24None]::new()
        $this.ColorMap[223] = [ATBackgroundColor24None]::new()
        $this.ColorMap[224] = [ATBackgroundColor24None]::new()
        $this.ColorMap[225] = [CCAppleVRedLight24]::new()
        $this.ColorMap[226] = [CCAppleVRedLight24]::new()
        $this.ColorMap[227] = [CCAppleVRedLight24]::new()
        $this.ColorMap[228] = [CCAppleVRedLight24]::new()
        $this.ColorMap[229] = [CCAppleVRedLight24]::new()
        $this.ColorMap[230] = [CCAppleVRedLight24]::new()
        $this.ColorMap[231] = [CCAppleVRedLight24]::new()
        $this.ColorMap[232] = [CCAppleVRedLight24]::new()
        $this.ColorMap[233] = [CCAppleVRedLight24]::new()
        $this.ColorMap[234] = [CCAppleVRedLight24]::new()
        $this.ColorMap[235] = [CCAppleVRedLight24]::new()
        $this.ColorMap[236] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[237] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[238] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[239] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[240] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[241] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[242] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[243] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[244] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[245] = [CCAppleVRedLight24]::new()
        $this.ColorMap[246] = [CCAppleVRedLight24]::new()
        $this.ColorMap[247] = [CCAppleVRedLight24]::new()
        $this.ColorMap[248] = [CCAppleVRedLight24]::new()
        $this.ColorMap[249] = [CCAppleVRedLight24]::new()
        $this.ColorMap[250] = [CCAppleVRedLight24]::new()
        $this.ColorMap[251] = [CCAppleVRedLight24]::new()
        $this.ColorMap[252] = [CCAppleVRedLight24]::new()
        $this.ColorMap[253] = [CCAppleVRedLight24]::new()
        $this.ColorMap[254] = [CCAppleVRedLight24]::new()
        $this.ColorMap[255] = [CCAppleVRedLight24]::new()
        $this.ColorMap[256] = [ATBackgroundColor24None]::new()
        $this.ColorMap[257] = [ATBackgroundColor24None]::new()
        $this.ColorMap[258] = [ATBackgroundColor24None]::new() # End Row 6
        $this.ColorMap[259] = [ATBackgroundColor24None]::new()
        $this.ColorMap[260] = [ATBackgroundColor24None]::new()
        $this.ColorMap[261] = [ATBackgroundColor24None]::new()
        $this.ColorMap[262] = [CCAppleVRedLight24]::new()
        $this.ColorMap[263] = [CCAppleVRedLight24]::new()
        $this.ColorMap[264] = [CCAppleVRedLight24]::new()
        $this.ColorMap[265] = [CCAppleVRedLight24]::new()
        $this.ColorMap[266] = [CCAppleVRedLight24]::new()
        $this.ColorMap[267] = [CCAppleVRedLight24]::new()
        $this.ColorMap[268] = [CCAppleVRedLight24]::new()
        $this.ColorMap[269] = [CCAppleVRedLight24]::new()
        $this.ColorMap[270] = [CCAppleVRedLight24]::new()
        $this.ColorMap[271] = [CCAppleVRedLight24]::new()
        $this.ColorMap[272] = [CCAppleVRedLight24]::new()
        $this.ColorMap[273] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[274] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[275] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[276] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[277] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[278] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[279] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[280] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[281] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[282] = [CCAppleVRedLight24]::new()
        $this.ColorMap[283] = [CCAppleVRedLight24]::new()
        $this.ColorMap[284] = [CCAppleVRedLight24]::new()
        $this.ColorMap[285] = [CCAppleVRedLight24]::new()
        $this.ColorMap[286] = [CCAppleVRedLight24]::new()
        $this.ColorMap[287] = [CCAppleVRedLight24]::new()
        $this.ColorMap[288] = [CCAppleVRedLight24]::new()
        $this.ColorMap[289] = [CCAppleVRedLight24]::new()
        $this.ColorMap[290] = [CCAppleVRedLight24]::new()
        $this.ColorMap[291] = [CCAppleVRedLight24]::new()
        $this.ColorMap[292] = [CCAppleVRedLight24]::new()
        $this.ColorMap[293] = [ATBackgroundColor24None]::new()
        $this.ColorMap[294] = [ATBackgroundColor24None]::new()
        $this.ColorMap[295] = [ATBackgroundColor24None]::new() # End Row 7
        $this.ColorMap[296] = [ATBackgroundColor24None]::new()
        $this.ColorMap[297] = [ATBackgroundColor24None]::new()
        $this.ColorMap[298] = [ATBackgroundColor24None]::new()
        $this.ColorMap[299] = [CCAppleVRedLight24]::new()
        $this.ColorMap[300] = [CCAppleVRedLight24]::new()
        $this.ColorMap[301] = [CCAppleVRedLight24]::new()
        $this.ColorMap[302] = [CCAppleVRedLight24]::new()
        $this.ColorMap[303] = [CCAppleVRedLight24]::new()
        $this.ColorMap[304] = [CCAppleVRedLight24]::new()
        $this.ColorMap[305] = [CCAppleVRedLight24]::new()
        $this.ColorMap[306] = [CCAppleVRedLight24]::new()
        $this.ColorMap[307] = [CCAppleVRedLight24]::new()
        $this.ColorMap[308] = [CCAppleVRedLight24]::new()
        $this.ColorMap[309] = [CCAppleVRedLight24]::new()
        $this.ColorMap[310] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[311] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[312] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[313] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[314] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[315] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[316] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[317] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[318] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[319] = [CCAppleVRedLight24]::new()
        $this.ColorMap[320] = [CCAppleVRedLight24]::new()
        $this.ColorMap[321] = [CCAppleVRedLight24]::new()
        $this.ColorMap[322] = [CCAppleVRedLight24]::new()
        $this.ColorMap[323] = [CCAppleVRedLight24]::new()
        $this.ColorMap[324] = [CCAppleVRedLight24]::new()
        $this.ColorMap[325] = [CCAppleVRedLight24]::new()
        $this.ColorMap[326] = [CCAppleVRedLight24]::new()
        $this.ColorMap[327] = [CCAppleVRedLight24]::new()
        $this.ColorMap[328] = [CCAppleVRedLight24]::new()
        $this.ColorMap[329] = [CCAppleVRedLight24]::new()
        $this.ColorMap[330] = [ATBackgroundColor24None]::new()
        $this.ColorMap[331] = [ATBackgroundColor24None]::new()
        $this.ColorMap[332] = [ATBackgroundColor24None]::new() # End Row 8
        $this.ColorMap[333] = [ATBackgroundColor24None]::new()
        $this.ColorMap[334] = [ATBackgroundColor24None]::new()
        $this.ColorMap[335] = [CCAppleVRedLight24]::new()
        $this.ColorMap[336] = [CCAppleVRedLight24]::new()
        $this.ColorMap[337] = [CCAppleVRedLight24]::new()
        $this.ColorMap[338] = [CCAppleVRedLight24]::new()
        $this.ColorMap[339] = [CCAppleVRedLight24]::new()
        $this.ColorMap[340] = [CCAppleVRedLight24]::new()
        $this.ColorMap[341] = [CCAppleVRedLight24]::new()
        $this.ColorMap[342] = [CCAppleVRedLight24]::new()
        $this.ColorMap[343] = [CCAppleVRedLight24]::new()
        $this.ColorMap[344] = [CCAppleVRedLight24]::new()
        $this.ColorMap[345] = [ATBackgroundColor24None]::new()
        $this.ColorMap[346] = [ATBackgroundColor24None]::new()
        $this.ColorMap[347] = [CCAppleVRedLight24]::new()
        $this.ColorMap[348] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[349] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[350] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[351] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[352] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[353] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[354] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[355] = [CCAppleVRedLight24]::new()
        $this.ColorMap[356] = [ATBackgroundColor24None]::new()
        $this.ColorMap[357] = [ATBackgroundColor24None]::new()
        $this.ColorMap[358] = [CCAppleVRedLight24]::new()
        $this.ColorMap[359] = [CCAppleVRedLight24]::new()
        $this.ColorMap[360] = [CCAppleVRedLight24]::new()
        $this.ColorMap[361] = [CCAppleVRedLight24]::new()
        $this.ColorMap[362] = [CCAppleVRedLight24]::new()
        $this.ColorMap[363] = [CCAppleVRedLight24]::new()
        $this.ColorMap[364] = [CCAppleVRedLight24]::new()
        $this.ColorMap[365] = [CCAppleVRedLight24]::new()
        $this.ColorMap[366] = [CCAppleVRedLight24]::new()
        $this.ColorMap[367] = [CCAppleVRedLight24]::new()
        $this.ColorMap[368] = [ATBackgroundColor24None]::new()
        $this.ColorMap[369] = [ATBackgroundColor24None]::new() # End Row 9
        $this.ColorMap[370] = [ATBackgroundColor24None]::new()
        $this.ColorMap[371] = [ATBackgroundColor24None]::new()
        $this.ColorMap[372] = [CCAppleVRedLight24]::new()
        $this.ColorMap[373] = [CCAppleVRedLight24]::new()
        $this.ColorMap[374] = [CCAppleVRedLight24]::new()
        $this.ColorMap[375] = [CCAppleVRedLight24]::new()
        $this.ColorMap[376] = [ATBackgroundColor24None]::new()
        $this.ColorMap[377] = [ATBackgroundColor24None]::new()
        $this.ColorMap[378] = [CCAppleVRedLight24]::new()
        $this.ColorMap[379] = [CCAppleVRedLight24]::new()
        $this.ColorMap[380] = [CCAppleVRedLight24]::new()
        $this.ColorMap[381] = [ATBackgroundColor24None]::new()
        $this.ColorMap[382] = [ATBackgroundColor24None]::new()
        $this.ColorMap[383] = [ATBackgroundColor24None]::new()
        $this.ColorMap[384] = [ATBackgroundColor24None]::new()
        $this.ColorMap[385] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[386] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[387] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[388] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[389] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[390] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[391] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[392] = [ATBackgroundColor24None]::new()
        $this.ColorMap[393] = [ATBackgroundColor24None]::new()
        $this.ColorMap[394] = [ATBackgroundColor24None]::new()
        $this.ColorMap[395] = [ATBackgroundColor24None]::new()
        $this.ColorMap[396] = [CCAppleVRedLight24]::new()
        $this.ColorMap[397] = [CCAppleVRedLight24]::new()
        $this.ColorMap[398] = [CCAppleVRedLight24]::new()
        $this.ColorMap[399] = [ATBackgroundColor24None]::new()
        $this.ColorMap[400] = [ATBackgroundColor24None]::new()
        $this.ColorMap[401] = [CCAppleVRedLight24]::new()
        $this.ColorMap[402] = [CCAppleVRedLight24]::new()
        $this.ColorMap[403] = [CCAppleVRedLight24]::new()
        $this.ColorMap[404] = [CCAppleVRedLight24]::new()
        $this.ColorMap[405] = [ATBackgroundColor24None]::new()
        $this.ColorMap[406] = [ATBackgroundColor24None]::new() # End Row 10
        $this.ColorMap[407] = [ATBackgroundColor24None]::new()
        $this.ColorMap[408] = [ATBackgroundColor24None]::new()
        $this.ColorMap[409] = [CCAppleVRedLight24]::new()
        $this.ColorMap[410] = [CCAppleVRedLight24]::new()
        $this.ColorMap[411] = [ATBackgroundColor24None]::new()
        $this.ColorMap[412] = [ATBackgroundColor24None]::new()
        $this.ColorMap[413] = [ATBackgroundColor24None]::new()
        $this.ColorMap[414] = [ATBackgroundColor24None]::new()
        $this.ColorMap[415] = [ATBackgroundColor24None]::new()
        $this.ColorMap[416] = [CCAppleVRedLight24]::new()
        $this.ColorMap[417] = [ATBackgroundColor24None]::new()
        $this.ColorMap[418] = [ATBackgroundColor24None]::new()
        $this.ColorMap[419] = [ATBackgroundColor24None]::new()
        $this.ColorMap[420] = [CCAppleVRedALight24]::new()
        $this.ColorMap[421] = [ATBackgroundColor24None]::new()
        $this.ColorMap[422] = [ATBackgroundColor24None]::new()
        $this.ColorMap[423] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[424] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[425] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[426] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[427] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[428] = [ATBackgroundColor24None]::new()
        $this.ColorMap[429] = [ATBackgroundColor24None]::new()
        $this.ColorMap[430] = [CCAppleVRedALight24]::new()
        $this.ColorMap[431] = [ATBackgroundColor24None]::new()
        $this.ColorMap[432] = [ATBackgroundColor24None]::new()
        $this.ColorMap[433] = [ATBackgroundColor24None]::new()
        $this.ColorMap[434] = [CCAppleVRedLight24]::new()
        $this.ColorMap[435] = [ATBackgroundColor24None]::new()
        $this.ColorMap[436] = [ATBackgroundColor24None]::new()
        $this.ColorMap[437] = [ATBackgroundColor24None]::new()
        $this.ColorMap[438] = [ATBackgroundColor24None]::new()
        $this.ColorMap[439] = [ATBackgroundColor24None]::new()
        $this.ColorMap[440] = [CCAppleVRedLight24]::new()
        $this.ColorMap[441] = [CCAppleVRedLight24]::new()
        $this.ColorMap[442] = [ATBackgroundColor24None]::new()
        $this.ColorMap[443] = [ATBackgroundColor24None]::new() # End Row 11
        $this.ColorMap[444] = [ATBackgroundColor24None]::new()
        $this.ColorMap[445] = [ATBackgroundColor24None]::new()
        $this.ColorMap[446] = [CCAppleVRedLight24]::new()
        $this.ColorMap[447] = [ATBackgroundColor24None]::new()
        $this.ColorMap[448] = [ATBackgroundColor24None]::new()
        $this.ColorMap[449] = [ATBackgroundColor24None]::new()
        $this.ColorMap[450] = [ATBackgroundColor24None]::new()
        $this.ColorMap[451] = [ATBackgroundColor24None]::new()
        $this.ColorMap[452] = [ATBackgroundColor24None]::new()
        $this.ColorMap[453] = [ATBackgroundColor24None]::new()
        $this.ColorMap[454] = [ATBackgroundColor24None]::new()
        $this.ColorMap[455] = [ATBackgroundColor24None]::new()
        $this.ColorMap[456] = [ATBackgroundColor24None]::new()
        $this.ColorMap[457] = [ATBackgroundColor24None]::new()
        $this.ColorMap[458] = [CCAppleVRedALight24]::new()
        $this.ColorMap[459] = [CCAppleVRedALight24]::new()
        $this.ColorMap[460] = [ATBackgroundColor24None]::new()
        $this.ColorMap[461] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[462] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[463] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[464] = [ATBackgroundColor24None]::new()
        $this.ColorMap[465] = [CCAppleVRedALight24]::new()
        $this.ColorMap[466] = [CCAppleVRedALight24]::new()
        $this.ColorMap[467] = [ATBackgroundColor24None]::new()
        $this.ColorMap[468] = [ATBackgroundColor24None]::new()
        $this.ColorMap[469] = [ATBackgroundColor24None]::new()
        $this.ColorMap[470] = [ATBackgroundColor24None]::new()
        $this.ColorMap[471] = [ATBackgroundColor24None]::new()
        $this.ColorMap[472] = [ATBackgroundColor24None]::new()
        $this.ColorMap[473] = [ATBackgroundColor24None]::new()
        $this.ColorMap[474] = [ATBackgroundColor24None]::new()
        $this.ColorMap[475] = [ATBackgroundColor24None]::new()
        $this.ColorMap[476] = [ATBackgroundColor24None]::new()
        $this.ColorMap[477] = [ATBackgroundColor24None]::new()
        $this.ColorMap[478] = [CCAppleVRedLight24]::new()
        $this.ColorMap[479] = [ATBackgroundColor24None]::new()
        $this.ColorMap[480] = [ATBackgroundColor24None]::new() # End Row 12
        $this.ColorMap[481] = [ATBackgroundColor24None]::new()
        $this.ColorMap[482] = [ATBackgroundColor24None]::new()
        $this.ColorMap[483] = [ATBackgroundColor24None]::new()
        $this.ColorMap[484] = [ATBackgroundColor24None]::new()
        $this.ColorMap[485] = [ATBackgroundColor24None]::new()
        $this.ColorMap[486] = [ATBackgroundColor24None]::new()
        $this.ColorMap[487] = [ATBackgroundColor24None]::new()
        $this.ColorMap[488] = [ATBackgroundColor24None]::new()
        $this.ColorMap[489] = [ATBackgroundColor24None]::new()
        $this.ColorMap[490] = [ATBackgroundColor24None]::new()
        $this.ColorMap[491] = [ATBackgroundColor24None]::new()
        $this.ColorMap[492] = [ATBackgroundColor24None]::new()
        $this.ColorMap[493] = [ATBackgroundColor24None]::new()
        $this.ColorMap[494] = [CCAppleVRedALight24]::new()
        $this.ColorMap[495] = [ATBackgroundColor24None]::new()
        $this.ColorMap[496] = [ATBackgroundColor24None]::new()
        $this.ColorMap[497] = [ATBackgroundColor24None]::new()
        $this.ColorMap[498] = [ATBackgroundColor24None]::new()
        $this.ColorMap[499] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[500] = [ATBackgroundColor24None]::new()
        $this.ColorMap[501] = [ATBackgroundColor24None]::new()
        $this.ColorMap[502] = [ATBackgroundColor24None]::new()
        $this.ColorMap[503] = [ATBackgroundColor24None]::new()
        $this.ColorMap[504] = [CCAppleVRedALight24]::new()
        $this.ColorMap[505] = [ATBackgroundColor24None]::new()
        $this.ColorMap[506] = [ATBackgroundColor24None]::new()
        $this.ColorMap[507] = [ATBackgroundColor24None]::new()
        $this.ColorMap[508] = [ATBackgroundColor24None]::new()
        $this.ColorMap[509] = [ATBackgroundColor24None]::new()
        $this.ColorMap[510] = [ATBackgroundColor24None]::new()
        $this.ColorMap[511] = [ATBackgroundColor24None]::new()
        $this.ColorMap[512] = [ATBackgroundColor24None]::new()
        $this.ColorMap[513] = [ATBackgroundColor24None]::new()
        $this.ColorMap[514] = [ATBackgroundColor24None]::new()
        $this.ColorMap[515] = [ATBackgroundColor24None]::new()
        $this.ColorMap[516] = [ATBackgroundColor24None]::new()
        $this.ColorMap[517] = [ATBackgroundColor24None]::new() # End Row 13
        $this.ColorMap[518] = [ATBackgroundColor24None]::new()
        $this.ColorMap[519] = [ATBackgroundColor24None]::new()
        $this.ColorMap[520] = [ATBackgroundColor24None]::new()
        $this.ColorMap[521] = [ATBackgroundColor24None]::new()
        $this.ColorMap[522] = [ATBackgroundColor24None]::new()
        $this.ColorMap[523] = [ATBackgroundColor24None]::new()
        $this.ColorMap[524] = [ATBackgroundColor24None]::new()
        $this.ColorMap[525] = [ATBackgroundColor24None]::new()
        $this.ColorMap[526] = [ATBackgroundColor24None]::new()
        $this.ColorMap[527] = [ATBackgroundColor24None]::new()
        $this.ColorMap[528] = [ATBackgroundColor24None]::new()
        $this.ColorMap[529] = [ATBackgroundColor24None]::new()
        $this.ColorMap[530] = [ATBackgroundColor24None]::new()
        $this.ColorMap[531] = [ATBackgroundColor24None]::new()
        $this.ColorMap[532] = [ATBackgroundColor24None]::new()
        $this.ColorMap[533] = [ATBackgroundColor24None]::new()
        $this.ColorMap[534] = [ATBackgroundColor24None]::new()
        $this.ColorMap[535] = [ATBackgroundColor24None]::new()
        $this.ColorMap[536] = [ATBackgroundColor24None]::new()
        $this.ColorMap[537] = [ATBackgroundColor24None]::new()
        $this.ColorMap[538] = [ATBackgroundColor24None]::new()
        $this.ColorMap[539] = [ATBackgroundColor24None]::new()
        $this.ColorMap[540] = [ATBackgroundColor24None]::new()
        $this.ColorMap[541] = [ATBackgroundColor24None]::new()
        $this.ColorMap[542] = [ATBackgroundColor24None]::new()
        $this.ColorMap[543] = [ATBackgroundColor24None]::new()
        $this.ColorMap[544] = [ATBackgroundColor24None]::new()
        $this.ColorMap[545] = [ATBackgroundColor24None]::new()
        $this.ColorMap[546] = [ATBackgroundColor24None]::new()
        $this.ColorMap[547] = [ATBackgroundColor24None]::new()
        $this.ColorMap[548] = [ATBackgroundColor24None]::new()
        $this.ColorMap[549] = [ATBackgroundColor24None]::new()
        $this.ColorMap[550] = [ATBackgroundColor24None]::new()
        $this.ColorMap[551] = [ATBackgroundColor24None]::new()
        $this.ColorMap[552] = [ATBackgroundColor24None]::new()
        $this.ColorMap[553] = [ATBackgroundColor24None]::new()
        $this.ColorMap[554] = [ATBackgroundColor24None]::new() # End Row 14

        $this.CreateImageATString($this.ColorMap)
        $this.ColorMap = $null
    }
}

Class EEIDuskbane : EEIInternalBase {
    EEIDuskbane() : base() {
        $this.ColorMap[0]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[1]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[2]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[3]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[4]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[5]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[6]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[7]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[8]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[9]   = [ATBackgroundColor24None]::new()
        $this.ColorMap[10]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[11]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[12]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[13]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[14]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[15]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[16]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[17]  = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[18]  = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[19]  = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[20]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[21]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[22]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[23]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[24]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[25]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[26]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[27]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[28]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[29]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[30]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[31]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[32]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[33]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[34]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[35]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[36]  = [ATBackgroundColor24None]::new() # End Row 0
        $this.ColorMap[37]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[38]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[39]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[40]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[41]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[42]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[43]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[44]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[45]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[46]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[47]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[48]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[49]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[50]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[51]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[52]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[53]  = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[54]  = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[55]  = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[56]  = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[57]  = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[58]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[59]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[60]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[61]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[62]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[63]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[64]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[65]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[66]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[67]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[68]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[69]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[70]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[71]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[72]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[73]  = [ATBackgroundColor24None]::new() # End Row 1
        $this.ColorMap[74]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[75]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[76]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[77]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[78]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[79]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[80]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[81]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[82]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[83]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[84]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[85]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[86]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[87]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[88]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[89]  = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[90]  = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[91]  = [CCAppleVYellowADark24]::new()
        $this.ColorMap[92]  = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[93]  = [CCAppleVYellowADark24]::new()
        $this.ColorMap[94]  = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[95]  = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[96]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[97]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[98]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[99]  = [ATBackgroundColor24None]::new()
        $this.ColorMap[100] = [ATBackgroundColor24None]::new()
        $this.ColorMap[101] = [ATBackgroundColor24None]::new()
        $this.ColorMap[102] = [ATBackgroundColor24None]::new()
        $this.ColorMap[103] = [ATBackgroundColor24None]::new()
        $this.ColorMap[104] = [ATBackgroundColor24None]::new()
        $this.ColorMap[105] = [ATBackgroundColor24None]::new()
        $this.ColorMap[106] = [ATBackgroundColor24None]::new()
        $this.ColorMap[107] = [ATBackgroundColor24None]::new()
        $this.ColorMap[108] = [ATBackgroundColor24None]::new()
        $this.ColorMap[109] = [ATBackgroundColor24None]::new()
        $this.ColorMap[110] = [ATBackgroundColor24None]::new() # End Row 2
        $this.ColorMap[111] = [ATBackgroundColor24None]::new()
        $this.ColorMap[112] = [ATBackgroundColor24None]::new()
        $this.ColorMap[113] = [ATBackgroundColor24None]::new()
        $this.ColorMap[114] = [ATBackgroundColor24None]::new()
        $this.ColorMap[115] = [ATBackgroundColor24None]::new()
        $this.ColorMap[116] = [CCAppleVRedLight24]::new()
        $this.ColorMap[117] = [CCAppleVRedLight24]::new()
        $this.ColorMap[118] = [ATBackgroundColor24None]::new()
        $this.ColorMap[119] = [ATBackgroundColor24None]::new()
        $this.ColorMap[120] = [ATBackgroundColor24None]::new()
        $this.ColorMap[121] = [ATBackgroundColor24None]::new()
        $this.ColorMap[122] = [CCAppleVRedLight24]::new()
        $this.ColorMap[123] = [CCAppleVRedLight24]::new()
        $this.ColorMap[124] = [ATBackgroundColor24None]::new()
        $this.ColorMap[125] = [ATBackgroundColor24None]::new()
        $this.ColorMap[126] = [ATBackgroundColor24None]::new()
        $this.ColorMap[127] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[128] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[129] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[130] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[131] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[132] = [ATBackgroundColor24None]::new()
        $this.ColorMap[133] = [ATBackgroundColor24None]::new()
        $this.ColorMap[134] = [ATBackgroundColor24None]::new()
        $this.ColorMap[135] = [CCAppleVRedLight24]::new()
        $this.ColorMap[136] = [CCAppleVRedLight24]::new()
        $this.ColorMap[137] = [ATBackgroundColor24None]::new()
        $this.ColorMap[138] = [ATBackgroundColor24None]::new()
        $this.ColorMap[139] = [ATBackgroundColor24None]::new()
        $this.ColorMap[140] = [ATBackgroundColor24None]::new()
        $this.ColorMap[141] = [CCAppleVRedLight24]::new()
        $this.ColorMap[142] = [CCAppleVRedLight24]::new()
        $this.ColorMap[143] = [ATBackgroundColor24None]::new()
        $this.ColorMap[144] = [ATBackgroundColor24None]::new()
        $this.ColorMap[145] = [ATBackgroundColor24None]::new()
        $this.ColorMap[146] = [ATBackgroundColor24None]::new()
        $this.ColorMap[147] = [ATBackgroundColor24None]::new() # End Row 3
        $this.ColorMap[148] = [ATBackgroundColor24None]::new()
        $this.ColorMap[149] = [ATBackgroundColor24None]::new()
        $this.ColorMap[150] = [ATBackgroundColor24None]::new()
        $this.ColorMap[151] = [ATBackgroundColor24None]::new()
        $this.ColorMap[152] = [CCAppleVRedLight24]::new()
        $this.ColorMap[153] = [CCAppleVRedLight24]::new()
        $this.ColorMap[154] = [CCAppleVRedLight24]::new()
        $this.ColorMap[155] = [CCAppleVRedLight24]::new()
        $this.ColorMap[156] = [CCAppleVRedLight24]::new()
        $this.ColorMap[157] = [ATBackgroundColor24None]::new()
        $this.ColorMap[158] = [CCAppleVRedLight24]::new()
        $this.ColorMap[159] = [CCAppleVRedLight24]::new()
        $this.ColorMap[160] = [CCAppleVRedLight24]::new()
        $this.ColorMap[161] = [CCAppleVRedLight24]::new()
        $this.ColorMap[162] = [CCAppleVRedLight24]::new()
        $this.ColorMap[163] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[164] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[165] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[166] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[167] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[168] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[169] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[170] = [CCAppleVRedLight24]::new()
        $this.ColorMap[171] = [CCAppleVRedLight24]::new()
        $this.ColorMap[172] = [CCAppleVRedLight24]::new()
        $this.ColorMap[173] = [CCAppleVRedLight24]::new()
        $this.ColorMap[174] = [CCAppleVRedLight24]::new()
        $this.ColorMap[175] = [ATBackgroundColor24None]::new()
        $this.ColorMap[176] = [CCAppleVRedLight24]::new()
        $this.ColorMap[177] = [CCAppleVRedLight24]::new()
        $this.ColorMap[178] = [CCAppleVRedLight24]::new()
        $this.ColorMap[179] = [CCAppleVRedLight24]::new()
        $this.ColorMap[180] = [CCAppleVRedLight24]::new()
        $this.ColorMap[181] = [ATBackgroundColor24None]::new()
        $this.ColorMap[182] = [ATBackgroundColor24None]::new()
        $this.ColorMap[183] = [ATBackgroundColor24None]::new()
        $this.ColorMap[184] = [ATBackgroundColor24None]::new() # End Row 4
        $this.ColorMap[185] = [ATBackgroundColor24None]::new()
        $this.ColorMap[186] = [ATBackgroundColor24None]::new()
        $this.ColorMap[187] = [ATBackgroundColor24None]::new()
        $this.ColorMap[188] = [ATBackgroundColor24None]::new()
        $this.ColorMap[189] = [CCAppleVRedLight24]::new()
        $this.ColorMap[190] = [CCAppleVRedLight24]::new()
        $this.ColorMap[191] = [CCAppleVRedLight24]::new()
        $this.ColorMap[192] = [CCAppleVRedLight24]::new()
        $this.ColorMap[193] = [CCAppleVRedLight24]::new()
        $this.ColorMap[194] = [CCAppleVRedLight24]::new()
        $this.ColorMap[195] = [CCAppleVRedLight24]::new()
        $this.ColorMap[196] = [CCAppleVRedLight24]::new()
        $this.ColorMap[197] = [CCAppleVRedLight24]::new()
        $this.ColorMap[198] = [CCAppleVRedLight24]::new()
        $this.ColorMap[199] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[200] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[201] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[202] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[203] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[204] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[205] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[206] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[207] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[208] = [CCAppleVRedLight24]::new()
        $this.ColorMap[209] = [CCAppleVRedLight24]::new()
        $this.ColorMap[210] = [CCAppleVRedLight24]::new()
        $this.ColorMap[211] = [CCAppleVRedLight24]::new()
        $this.ColorMap[212] = [CCAppleVRedLight24]::new()
        $this.ColorMap[213] = [CCAppleVRedLight24]::new()
        $this.ColorMap[214] = [CCAppleVRedLight24]::new()
        $this.ColorMap[215] = [CCAppleVRedLight24]::new()
        $this.ColorMap[216] = [CCAppleVRedLight24]::new()
        $this.ColorMap[217] = [CCAppleVRedLight24]::new()
        $this.ColorMap[218] = [ATBackgroundColor24None]::new()
        $this.ColorMap[219] = [ATBackgroundColor24None]::new()
        $this.ColorMap[220] = [ATBackgroundColor24None]::new()
        $this.ColorMap[221] = [ATBackgroundColor24None]::new() # End Row 5
        $this.ColorMap[222] = [ATBackgroundColor24None]::new()
        $this.ColorMap[223] = [ATBackgroundColor24None]::new()
        $this.ColorMap[224] = [ATBackgroundColor24None]::new()
        $this.ColorMap[225] = [CCAppleVRedLight24]::new()
        $this.ColorMap[226] = [CCAppleVRedLight24]::new()
        $this.ColorMap[227] = [CCAppleVRedLight24]::new()
        $this.ColorMap[228] = [CCAppleVRedLight24]::new()
        $this.ColorMap[229] = [CCAppleVRedLight24]::new()
        $this.ColorMap[230] = [CCAppleVRedLight24]::new()
        $this.ColorMap[231] = [CCAppleVRedLight24]::new()
        $this.ColorMap[232] = [CCAppleVRedLight24]::new()
        $this.ColorMap[233] = [CCAppleVRedLight24]::new()
        $this.ColorMap[234] = [CCAppleVRedLight24]::new()
        $this.ColorMap[235] = [CCAppleVRedLight24]::new()
        $this.ColorMap[236] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[237] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[238] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[239] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[240] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[241] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[242] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[243] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[244] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[245] = [CCAppleVRedLight24]::new()
        $this.ColorMap[246] = [CCAppleVRedLight24]::new()
        $this.ColorMap[247] = [CCAppleVRedLight24]::new()
        $this.ColorMap[248] = [CCAppleVRedLight24]::new()
        $this.ColorMap[249] = [CCAppleVRedLight24]::new()
        $this.ColorMap[250] = [CCAppleVRedLight24]::new()
        $this.ColorMap[251] = [CCAppleVRedLight24]::new()
        $this.ColorMap[252] = [CCAppleVRedLight24]::new()
        $this.ColorMap[253] = [CCAppleVRedLight24]::new()
        $this.ColorMap[254] = [CCAppleVRedLight24]::new()
        $this.ColorMap[255] = [CCAppleVRedLight24]::new()
        $this.ColorMap[256] = [ATBackgroundColor24None]::new()
        $this.ColorMap[257] = [ATBackgroundColor24None]::new()
        $this.ColorMap[258] = [ATBackgroundColor24None]::new() # End Row 6
        $this.ColorMap[259] = [ATBackgroundColor24None]::new()
        $this.ColorMap[260] = [ATBackgroundColor24None]::new()
        $this.ColorMap[261] = [ATBackgroundColor24None]::new()
        $this.ColorMap[262] = [CCAppleVRedLight24]::new()
        $this.ColorMap[263] = [CCAppleVRedLight24]::new()
        $this.ColorMap[264] = [CCAppleVRedLight24]::new()
        $this.ColorMap[265] = [CCAppleVRedLight24]::new()
        $this.ColorMap[266] = [CCAppleVRedLight24]::new()
        $this.ColorMap[267] = [CCAppleVRedLight24]::new()
        $this.ColorMap[268] = [CCAppleVRedLight24]::new()
        $this.ColorMap[269] = [CCAppleVRedLight24]::new()
        $this.ColorMap[270] = [CCAppleVRedLight24]::new()
        $this.ColorMap[271] = [CCAppleVRedLight24]::new()
        $this.ColorMap[272] = [CCAppleVRedLight24]::new()
        $this.ColorMap[273] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[274] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[275] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[276] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[277] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[278] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[279] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[280] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[281] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[282] = [CCAppleVRedLight24]::new()
        $this.ColorMap[283] = [CCAppleVRedLight24]::new()
        $this.ColorMap[284] = [CCAppleVRedLight24]::new()
        $this.ColorMap[285] = [CCAppleVRedLight24]::new()
        $this.ColorMap[286] = [CCAppleVRedLight24]::new()
        $this.ColorMap[287] = [CCAppleVRedLight24]::new()
        $this.ColorMap[288] = [CCAppleVRedLight24]::new()
        $this.ColorMap[289] = [CCAppleVRedLight24]::new()
        $this.ColorMap[290] = [CCAppleVRedLight24]::new()
        $this.ColorMap[291] = [CCAppleVRedLight24]::new()
        $this.ColorMap[292] = [CCAppleVRedLight24]::new()
        $this.ColorMap[293] = [ATBackgroundColor24None]::new()
        $this.ColorMap[294] = [ATBackgroundColor24None]::new()
        $this.ColorMap[295] = [ATBackgroundColor24None]::new() # End Row 7
        $this.ColorMap[296] = [ATBackgroundColor24None]::new()
        $this.ColorMap[297] = [ATBackgroundColor24None]::new()
        $this.ColorMap[298] = [ATBackgroundColor24None]::new()
        $this.ColorMap[299] = [CCAppleVRedLight24]::new()
        $this.ColorMap[300] = [CCAppleVRedLight24]::new()
        $this.ColorMap[301] = [CCAppleVRedLight24]::new()
        $this.ColorMap[302] = [CCAppleVRedLight24]::new()
        $this.ColorMap[303] = [CCAppleVRedLight24]::new()
        $this.ColorMap[304] = [CCAppleVRedLight24]::new()
        $this.ColorMap[305] = [CCAppleVRedLight24]::new()
        $this.ColorMap[306] = [CCAppleVRedLight24]::new()
        $this.ColorMap[307] = [CCAppleVRedLight24]::new()
        $this.ColorMap[308] = [CCAppleVRedLight24]::new()
        $this.ColorMap[309] = [CCAppleVRedLight24]::new()
        $this.ColorMap[310] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[311] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[312] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[313] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[314] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[315] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[316] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[317] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[318] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[319] = [CCAppleVRedLight24]::new()
        $this.ColorMap[320] = [CCAppleVRedLight24]::new()
        $this.ColorMap[321] = [CCAppleVRedLight24]::new()
        $this.ColorMap[322] = [CCAppleVRedLight24]::new()
        $this.ColorMap[323] = [CCAppleVRedLight24]::new()
        $this.ColorMap[324] = [CCAppleVRedLight24]::new()
        $this.ColorMap[325] = [CCAppleVRedLight24]::new()
        $this.ColorMap[326] = [CCAppleVRedLight24]::new()
        $this.ColorMap[327] = [CCAppleVRedLight24]::new()
        $this.ColorMap[328] = [CCAppleVRedLight24]::new()
        $this.ColorMap[329] = [CCAppleVRedLight24]::new()
        $this.ColorMap[330] = [ATBackgroundColor24None]::new()
        $this.ColorMap[331] = [ATBackgroundColor24None]::new()
        $this.ColorMap[332] = [ATBackgroundColor24None]::new() # End Row 8
        $this.ColorMap[333] = [ATBackgroundColor24None]::new()
        $this.ColorMap[334] = [ATBackgroundColor24None]::new()
        $this.ColorMap[335] = [CCAppleVRedLight24]::new()
        $this.ColorMap[336] = [CCAppleVRedLight24]::new()
        $this.ColorMap[337] = [CCAppleVRedLight24]::new()
        $this.ColorMap[338] = [CCAppleVRedLight24]::new()
        $this.ColorMap[339] = [CCAppleVRedLight24]::new()
        $this.ColorMap[340] = [CCAppleVRedLight24]::new()
        $this.ColorMap[341] = [CCAppleVRedLight24]::new()
        $this.ColorMap[342] = [CCAppleVRedLight24]::new()
        $this.ColorMap[343] = [CCAppleVRedLight24]::new()
        $this.ColorMap[344] = [CCAppleVRedLight24]::new()
        $this.ColorMap[345] = [ATBackgroundColor24None]::new()
        $this.ColorMap[346] = [ATBackgroundColor24None]::new()
        $this.ColorMap[347] = [CCAppleVRedLight24]::new()
        $this.ColorMap[348] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[349] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[350] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[351] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[352] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[353] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[354] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[355] = [CCAppleVRedLight24]::new()
        $this.ColorMap[356] = [ATBackgroundColor24None]::new()
        $this.ColorMap[357] = [ATBackgroundColor24None]::new()
        $this.ColorMap[358] = [CCAppleVRedLight24]::new()
        $this.ColorMap[359] = [CCAppleVRedLight24]::new()
        $this.ColorMap[360] = [CCAppleVRedLight24]::new()
        $this.ColorMap[361] = [CCAppleVRedLight24]::new()
        $this.ColorMap[362] = [CCAppleVRedLight24]::new()
        $this.ColorMap[363] = [CCAppleVRedLight24]::new()
        $this.ColorMap[364] = [CCAppleVRedLight24]::new()
        $this.ColorMap[365] = [CCAppleVRedLight24]::new()
        $this.ColorMap[366] = [CCAppleVRedLight24]::new()
        $this.ColorMap[367] = [CCAppleVRedLight24]::new()
        $this.ColorMap[368] = [ATBackgroundColor24None]::new()
        $this.ColorMap[369] = [ATBackgroundColor24None]::new() # End Row 9
        $this.ColorMap[370] = [ATBackgroundColor24None]::new()
        $this.ColorMap[371] = [ATBackgroundColor24None]::new()
        $this.ColorMap[372] = [CCAppleVRedLight24]::new()
        $this.ColorMap[373] = [CCAppleVRedLight24]::new()
        $this.ColorMap[374] = [CCAppleVRedLight24]::new()
        $this.ColorMap[375] = [CCAppleVRedLight24]::new()
        $this.ColorMap[376] = [ATBackgroundColor24None]::new()
        $this.ColorMap[377] = [ATBackgroundColor24None]::new()
        $this.ColorMap[378] = [CCAppleVRedLight24]::new()
        $this.ColorMap[379] = [CCAppleVRedLight24]::new()
        $this.ColorMap[380] = [CCAppleVRedLight24]::new()
        $this.ColorMap[381] = [ATBackgroundColor24None]::new()
        $this.ColorMap[382] = [ATBackgroundColor24None]::new()
        $this.ColorMap[383] = [ATBackgroundColor24None]::new()
        $this.ColorMap[384] = [ATBackgroundColor24None]::new()
        $this.ColorMap[385] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[386] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[387] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[388] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[389] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[390] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[391] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[392] = [ATBackgroundColor24None]::new()
        $this.ColorMap[393] = [ATBackgroundColor24None]::new()
        $this.ColorMap[394] = [ATBackgroundColor24None]::new()
        $this.ColorMap[395] = [ATBackgroundColor24None]::new()
        $this.ColorMap[396] = [CCAppleVRedLight24]::new()
        $this.ColorMap[397] = [CCAppleVRedLight24]::new()
        $this.ColorMap[398] = [CCAppleVRedLight24]::new()
        $this.ColorMap[399] = [ATBackgroundColor24None]::new()
        $this.ColorMap[400] = [ATBackgroundColor24None]::new()
        $this.ColorMap[401] = [CCAppleVRedLight24]::new()
        $this.ColorMap[402] = [CCAppleVRedLight24]::new()
        $this.ColorMap[403] = [CCAppleVRedLight24]::new()
        $this.ColorMap[404] = [CCAppleVRedLight24]::new()
        $this.ColorMap[405] = [ATBackgroundColor24None]::new()
        $this.ColorMap[406] = [ATBackgroundColor24None]::new() # End Row 10
        $this.ColorMap[407] = [ATBackgroundColor24None]::new()
        $this.ColorMap[408] = [ATBackgroundColor24None]::new()
        $this.ColorMap[409] = [CCAppleVRedLight24]::new()
        $this.ColorMap[410] = [CCAppleVRedLight24]::new()
        $this.ColorMap[411] = [ATBackgroundColor24None]::new()
        $this.ColorMap[412] = [ATBackgroundColor24None]::new()
        $this.ColorMap[413] = [ATBackgroundColor24None]::new()
        $this.ColorMap[414] = [ATBackgroundColor24None]::new()
        $this.ColorMap[415] = [ATBackgroundColor24None]::new()
        $this.ColorMap[416] = [CCAppleVRedLight24]::new()
        $this.ColorMap[417] = [ATBackgroundColor24None]::new()
        $this.ColorMap[418] = [ATBackgroundColor24None]::new()
        $this.ColorMap[419] = [ATBackgroundColor24None]::new()
        $this.ColorMap[420] = [CCAppleVRedALight24]::new()
        $this.ColorMap[421] = [ATBackgroundColor24None]::new()
        $this.ColorMap[422] = [ATBackgroundColor24None]::new()
        $this.ColorMap[423] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[424] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[425] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[426] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[427] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[428] = [ATBackgroundColor24None]::new()
        $this.ColorMap[429] = [ATBackgroundColor24None]::new()
        $this.ColorMap[430] = [CCAppleVRedALight24]::new()
        $this.ColorMap[431] = [ATBackgroundColor24None]::new()
        $this.ColorMap[432] = [ATBackgroundColor24None]::new()
        $this.ColorMap[433] = [ATBackgroundColor24None]::new()
        $this.ColorMap[434] = [CCAppleVRedLight24]::new()
        $this.ColorMap[435] = [ATBackgroundColor24None]::new()
        $this.ColorMap[436] = [ATBackgroundColor24None]::new()
        $this.ColorMap[437] = [ATBackgroundColor24None]::new()
        $this.ColorMap[438] = [ATBackgroundColor24None]::new()
        $this.ColorMap[439] = [ATBackgroundColor24None]::new()
        $this.ColorMap[440] = [CCAppleVRedLight24]::new()
        $this.ColorMap[441] = [CCAppleVRedLight24]::new()
        $this.ColorMap[442] = [ATBackgroundColor24None]::new()
        $this.ColorMap[443] = [ATBackgroundColor24None]::new() # End Row 11
        $this.ColorMap[444] = [ATBackgroundColor24None]::new()
        $this.ColorMap[445] = [ATBackgroundColor24None]::new()
        $this.ColorMap[446] = [CCAppleVRedLight24]::new()
        $this.ColorMap[447] = [ATBackgroundColor24None]::new()
        $this.ColorMap[448] = [ATBackgroundColor24None]::new()
        $this.ColorMap[449] = [ATBackgroundColor24None]::new()
        $this.ColorMap[450] = [ATBackgroundColor24None]::new()
        $this.ColorMap[451] = [ATBackgroundColor24None]::new()
        $this.ColorMap[452] = [ATBackgroundColor24None]::new()
        $this.ColorMap[453] = [ATBackgroundColor24None]::new()
        $this.ColorMap[454] = [ATBackgroundColor24None]::new()
        $this.ColorMap[455] = [ATBackgroundColor24None]::new()
        $this.ColorMap[456] = [ATBackgroundColor24None]::new()
        $this.ColorMap[457] = [ATBackgroundColor24None]::new()
        $this.ColorMap[458] = [CCAppleVRedALight24]::new()
        $this.ColorMap[459] = [CCAppleVRedALight24]::new()
        $this.ColorMap[460] = [ATBackgroundColor24None]::new()
        $this.ColorMap[461] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[462] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[463] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[464] = [ATBackgroundColor24None]::new()
        $this.ColorMap[465] = [CCAppleVRedALight24]::new()
        $this.ColorMap[466] = [CCAppleVRedALight24]::new()
        $this.ColorMap[467] = [ATBackgroundColor24None]::new()
        $this.ColorMap[468] = [ATBackgroundColor24None]::new()
        $this.ColorMap[469] = [ATBackgroundColor24None]::new()
        $this.ColorMap[470] = [ATBackgroundColor24None]::new()
        $this.ColorMap[471] = [ATBackgroundColor24None]::new()
        $this.ColorMap[472] = [ATBackgroundColor24None]::new()
        $this.ColorMap[473] = [ATBackgroundColor24None]::new()
        $this.ColorMap[474] = [ATBackgroundColor24None]::new()
        $this.ColorMap[475] = [ATBackgroundColor24None]::new()
        $this.ColorMap[476] = [ATBackgroundColor24None]::new()
        $this.ColorMap[477] = [ATBackgroundColor24None]::new()
        $this.ColorMap[478] = [CCAppleVRedLight24]::new()
        $this.ColorMap[479] = [ATBackgroundColor24None]::new()
        $this.ColorMap[480] = [ATBackgroundColor24None]::new() # End Row 12
        $this.ColorMap[481] = [ATBackgroundColor24None]::new()
        $this.ColorMap[482] = [ATBackgroundColor24None]::new()
        $this.ColorMap[483] = [ATBackgroundColor24None]::new()
        $this.ColorMap[484] = [ATBackgroundColor24None]::new()
        $this.ColorMap[485] = [ATBackgroundColor24None]::new()
        $this.ColorMap[486] = [ATBackgroundColor24None]::new()
        $this.ColorMap[487] = [ATBackgroundColor24None]::new()
        $this.ColorMap[488] = [ATBackgroundColor24None]::new()
        $this.ColorMap[489] = [ATBackgroundColor24None]::new()
        $this.ColorMap[490] = [ATBackgroundColor24None]::new()
        $this.ColorMap[491] = [ATBackgroundColor24None]::new()
        $this.ColorMap[492] = [ATBackgroundColor24None]::new()
        $this.ColorMap[493] = [ATBackgroundColor24None]::new()
        $this.ColorMap[494] = [CCAppleVRedALight24]::new()
        $this.ColorMap[495] = [ATBackgroundColor24None]::new()
        $this.ColorMap[496] = [ATBackgroundColor24None]::new()
        $this.ColorMap[497] = [ATBackgroundColor24None]::new()
        $this.ColorMap[498] = [ATBackgroundColor24None]::new()
        $this.ColorMap[499] = [CCAppleNOrangeALight24]::new()
        $this.ColorMap[500] = [ATBackgroundColor24None]::new()
        $this.ColorMap[501] = [ATBackgroundColor24None]::new()
        $this.ColorMap[502] = [ATBackgroundColor24None]::new()
        $this.ColorMap[503] = [ATBackgroundColor24None]::new()
        $this.ColorMap[504] = [CCAppleVRedALight24]::new()
        $this.ColorMap[505] = [ATBackgroundColor24None]::new()
        $this.ColorMap[506] = [ATBackgroundColor24None]::new()
        $this.ColorMap[507] = [ATBackgroundColor24None]::new()
        $this.ColorMap[508] = [ATBackgroundColor24None]::new()
        $this.ColorMap[509] = [ATBackgroundColor24None]::new()
        $this.ColorMap[510] = [ATBackgroundColor24None]::new()
        $this.ColorMap[511] = [ATBackgroundColor24None]::new()
        $this.ColorMap[512] = [ATBackgroundColor24None]::new()
        $this.ColorMap[513] = [ATBackgroundColor24None]::new()
        $this.ColorMap[514] = [ATBackgroundColor24None]::new()
        $this.ColorMap[515] = [ATBackgroundColor24None]::new()
        $this.ColorMap[516] = [ATBackgroundColor24None]::new()
        $this.ColorMap[517] = [ATBackgroundColor24None]::new() # End Row 13
        $this.ColorMap[518] = [ATBackgroundColor24None]::new()
        $this.ColorMap[519] = [ATBackgroundColor24None]::new()
        $this.ColorMap[520] = [ATBackgroundColor24None]::new()
        $this.ColorMap[521] = [ATBackgroundColor24None]::new()
        $this.ColorMap[522] = [ATBackgroundColor24None]::new()
        $this.ColorMap[523] = [ATBackgroundColor24None]::new()
        $this.ColorMap[524] = [ATBackgroundColor24None]::new()
        $this.ColorMap[525] = [ATBackgroundColor24None]::new()
        $this.ColorMap[526] = [ATBackgroundColor24None]::new()
        $this.ColorMap[527] = [ATBackgroundColor24None]::new()
        $this.ColorMap[528] = [ATBackgroundColor24None]::new()
        $this.ColorMap[529] = [ATBackgroundColor24None]::new()
        $this.ColorMap[530] = [ATBackgroundColor24None]::new()
        $this.ColorMap[531] = [ATBackgroundColor24None]::new()
        $this.ColorMap[532] = [ATBackgroundColor24None]::new()
        $this.ColorMap[533] = [ATBackgroundColor24None]::new()
        $this.ColorMap[534] = [ATBackgroundColor24None]::new()
        $this.ColorMap[535] = [ATBackgroundColor24None]::new()
        $this.ColorMap[536] = [ATBackgroundColor24None]::new()
        $this.ColorMap[537] = [ATBackgroundColor24None]::new()
        $this.ColorMap[538] = [ATBackgroundColor24None]::new()
        $this.ColorMap[539] = [ATBackgroundColor24None]::new()
        $this.ColorMap[540] = [ATBackgroundColor24None]::new()
        $this.ColorMap[541] = [ATBackgroundColor24None]::new()
        $this.ColorMap[542] = [ATBackgroundColor24None]::new()
        $this.ColorMap[543] = [ATBackgroundColor24None]::new()
        $this.ColorMap[544] = [ATBackgroundColor24None]::new()
        $this.ColorMap[545] = [ATBackgroundColor24None]::new()
        $this.ColorMap[546] = [ATBackgroundColor24None]::new()
        $this.ColorMap[547] = [ATBackgroundColor24None]::new()
        $this.ColorMap[548] = [ATBackgroundColor24None]::new()
        $this.ColorMap[549] = [ATBackgroundColor24None]::new()
        $this.ColorMap[550] = [ATBackgroundColor24None]::new()
        $this.ColorMap[551] = [ATBackgroundColor24None]::new()
        $this.ColorMap[552] = [ATBackgroundColor24None]::new()
        $this.ColorMap[553] = [ATBackgroundColor24None]::new()
        $this.ColorMap[554] = [ATBackgroundColor24None]::new() # End Row 14

        $this.CreateImageATString($this.ColorMap)
        $this.ColorMap = $null
    }
}

###############################################################################
#
# EE SPECIALIZATIONS
#
# THESE REPRESENT ACTUAL ENEMIES IN THE GAME THAT THE PLAYER COULD FIGHT 
# AGAINST. AS WITH OTHER COLLECTIONS, THE NAMES ARE SELF-DOCUMENTING.
#
###############################################################################
Class EEBat : EnemyBattleEntity {
    EEBat() : base() {
        $this.Name  = 'Bat'
        $this.Stats = @{
            [StatId]::HitPoints = [BattleEntityProperty]@{
                Base                = 500
                BasePre             = 0
                BaseAugmentValue    = 0
                Max                 = 500
                MaxPre              = 0
                MaxAugmentValue     = 0
                AugmentTurnDuration = 0
                BaseAugmentActive   = $false
                MaxAugmentActive    = $false
                State               = [StatNumberState]::Normal
                ValidateFunction    = {
                    Param(
                        [BattleEntityProperty]$Self
                    )
                    
                    Switch($Self.Base) {
                        { $_ -GT ($Self.Max * [BattleEntityProperty]::StatNumThresholdCaution) } {
                            $Self.State = [StatNumberState]::Normal
                        }
    
                        { ($_ -GT ($Self.Max * [BattleEntityProperty]::StatNumThresholdDanger)) -AND ($_ -LT ($Self.Max * [BattleEntityProperty]::StatNumThresholdCaution)) } {
                            $Self.State = [StatNumberState]::Caution
                        }
    
                        { $_ -LT ($Self.Max * [BattleEntityProperty]::StatNumThresholdDanger) } {
                            $Self.State = [StatNumberState]::Danger
                        }
                    }
                }
            }
            [StatId]::MagicPoints = [BattleEntityProperty]@{
                Base                = 50
                BasePre             = 0
                BaseAugmentValue    = 0
                Max                 = 50
                MaxPre              = 0
                MaxAugmentValue     = 0
                AugmentTurnDuration = 0
                BaseAugmentActive   = $false
                MaxAugmentActive    = $false
                State               = [StatNumberState]::Normal
                ValidateFunction    = {
                    Param(
                        [BattleEntityProperty]$Self
                    )
                    
                    Switch($Self.Base) {
                        { $_ -GT ($Self.Max * [BattleEntityProperty]::StatNumThresholdCaution) } {
                            $Self.State = [StatNumberState]::Normal
                        }
    
                        { ($_ -GT ($Self.Max * [BattleEntityProperty]::StatNumThresholdDanger)) -AND ($_ -LT ($Self.Max * [BattleEntityProperty]::StatNumThresholdCaution)) } {
                            $Self.State = [StatNumberState]::Caution
                        }
    
                        { $_ -LT ($Self.Max * [BattleEntityProperty]::StatNumThresholdDanger) } {
                            $Self.State = [StatNumberState]::Danger
                        }
                    }
                }
            }
            [StatId]::Attack = [BattleEntityProperty]@{
                Base                = 12
                BasePre             = 0
                BaseAugmentValue    = 0
                Max                 = 12
                MaxPre              = 0
                MaxAugmentValue     = 0
                AugmentTurnDuration = 0
                BaseAugmentActive   = $false
                MaxAugmentActive    = $false
                State               = [StatNumberState]::Normal
                ValidateFunction    = {
                    Param(
                        [BattleEntityProperty]$Self
                    )
                    
                    Return $Self.Base
                }
            }
            [StatId]::Defense = [BattleEntityProperty]@{
                Base                = 16
                BasePre             = 0
                BaseAugmentValue    = 0
                Max                 = 16
                MaxPre              = 0
                MaxAugmentValue     = 0
                AugmentTurnDuration = 0
                BaseAugmentActive   = $false
                MaxAugmentActive    = $false
                State               = [StatNumberState]::Normal
                ValidateFunction    = {
                    Param(
                        [BattleEntityProperty]$Self
                    )
                    
                    Return
                }
            }
            [StatId]::MagicAttack = [BattleEntityProperty]@{
                Base                = 6
                BasePre             = 0
                BaseAugmentValue    = 0
                Max                 = 6
                MaxPre              = 0
                MaxAugmentValue     = 0
                AugmentTurnDuration = 0
                BaseAugmentActive   = $false
                MaxAugmentActive    = $false
                State               = [StatNumberState]::Normal
                ValidateFunction    = {
                    Param(
                        [BattleEntityProperty]$Self
                    )
                    
                    Return
                }
            }
            [StatId]::MagicDefense = [BattleEntityProperty]@{
                Base                = 4
                BasePre             = 0
                BaseAugmentValue    = 0
                Max                 = 4
                MaxPre              = 0
                MaxAugmentValue     = 0
                AugmentTurnDuration = 0
                BaseAugmentActive   = $false
                MaxAugmentActive    = $false
                State               = [StatNumberState]::Normal
                ValidateFunction    = {
                    Param(
                        [BattleEntityProperty]$Self
                    )
                    
                    Return
                }
            }
            [StatId]::Speed = [BattleEntityProperty]@{
                Base                = 9
                BasePre             = 0
                BaseAugmentValue    = 0
                Max                 = 9
                MaxPre              = 0
                MaxAugmentValue     = 0
                AugmentTurnDuration = 0
                BaseAugmentActive   = $false
                MaxAugmentActive    = $false
                State               = [StatNumberState]::Normal
                ValidateFunction    = {
                    Param(
                        [BattleEntityProperty]$Self
                    )
                    
                    Return
                }
            }
            [StatId]::Luck = [BattleEntityProperty]@{
                Base                = 5
                BasePre             = 0
                BaseAugmentValue    = 0
                Max                 = 5
                MaxPre              = 0
                MaxAugmentValue     = 0
                AugmentTurnDuration = 0
                BaseAugmentActive   = $false
                MaxAugmentActive    = $false
                State               = [StatNumberState]::Normal
                ValidateFunction    = {
                    Param(
                        [BattleEntityProperty]$Self
                    )
                    
                    Return
                }
            }
            [StatId]::Accuracy = [BattleEntityProperty]@{
                Base                = 9
                BasePre             = 0
                BaseAugmentValue    = 0
                Max                 = 9
                MaxPre              = 0
                MaxAugmentValue     = 0
                AugmentTurnDuration = 0
                BaseAugmentActive   = $false
                MaxAugmentActive    = $false
                State               = [StatNumberState]::Normal
                ValidateFunction    = {
                    Param(
                        [BattleEntityProperty]$Self
                    )
                    
                    Return
                }
            }
        }
        $this.ActionListing = @{
            [ActionSlot]::A = [BAPunch]::new()
            [ActionSlot]::B = [BAScratch]::new()
            [ActionSlot]::C = $null
            [ActionSlot]::D = $null
        }
        $this.ActionMarbleBag = @([ActionSlot]::A, [ActionSlot]::A, [ActionSlot]::A, [ActionSlot]::A, [ActionSlot]::A, [ActionSlot]::B, [ActionSlot]::B, [ActionSlot]::B, [ActionSlot]::B, [ActionSlot]::B)
        $this.Affinity        = [BattleActionType]::ElementalIce
        $this.Image           = $Script:EeiBat
        $this.SpoilsGold      = 50
        $this.SpoilsItems     = @(
            [MTOMilk]::new()
        )
    }
}


Class EENightwing : EEBat {
    EENightwing() : base() {
        $this.Name  = 'Nightwing'
        $this.Image = [EEINightwing]::new()
    }
}

Class EEWingblight : EEBat {
    EEWingblight() : base() {
        $this.Name        = 'Wingblight'
        $this.Image       = $Script:EeiWingblight
        $this.SpoilsItems = @()
    }
}

Class EEDarkfang : EEBat {
    EEDarkfang() : base() {
        $this.Name        = 'Darkfang'
        $this.Image       = $Script:EeiDarkfang
        $this.SpoilsItems = @()
    }
}

Class EENocturna : EEBat {
    EENocturna() : base() {
        $this.Name        = 'Nocturna'
        $this.Image       = $Script:EeiNocturna
        $this.SpoilsItems = @()
    }
}

Class EEBloodswoop : EEBat {
    EEBloodswoop() : base() {
        $this.Name  = 'Bloodswoop'
        $this.Image = $Script:EeiBloodswoop
    }
}

Class EEDuskbane : EEBat {
    EEDuskbane() : base() {
        $this.Name        = 'Duskbane'
        $this.Image       = $Script:EeiDuskbane
        $this.SpoilsItems = @()
    }
}





###############################################################################
#
# MAP SUPPORT
#
# CLASSES THAT COALESCE INTO MAP FUNCTIONALITY.
#
###############################################################################

###############################################################################
#
# SCENE IMAGE
#
# DEFINES AN "IMAGE" THAT'S SHOWN ON THE NAVIGATION SCREEN. THIS LOOKS A LOT
# LIKE AN ENEMY IMAGE, JUST WITH DIFFERENT DIMENSIONS. SPECIALIZATIONS OF THIS
# ARE CREATED USING A SIMILAR PATTERN AS WELL.
#
###############################################################################
Class SceneImage {
    Static [Int]$Width  = 48
    Static [Int]$Height = 18

    [ATSceneImageString[,]]$Image

    SceneImage() {
        $this.Image = New-Object 'ATSceneImageString[,]' ([Int32]([SceneImage]::Height)), ([Int32]([SceneImage]::Width))
    }

    SceneImage(
        [ATSceneImageString[,]]$Image
    ) {
        $this.Image = $Image
    }

    [Void]CreateSceneImageATString([ATBackgroundColor24[]]$ImageColorMap) {
        For($r = 0; $r -LT [SceneImage]::Height; $r++) {
            For($c = 0; $c -LT [SceneImage]::Width; $c++) {
                $rf                 = ($r * [SceneImage]::Width) + $c
                $this.Image[$r, $c] = [ATSceneImageString]::new(
                    $ImageColorMap[$rf],
                    [ATCoordinates]::new(([SceneWindow]::ImageDrawRowOffset + $r), ([SceneWindow]::ImageDrawColumnOffset + $c))
                )
            }
        }
    }

    [String]ToAnsiControlSequenceString() {
        [String]$a = ''

        For($r = 0; $r -LT [SceneImage]::Height; $r++) {
            For($c = 0; $c -LT [SceneImage]::Width; $c++) {
                $a += $this.Image[$r, $c].ToAnsiControlSequenceString()
            }
        }

        Return $a
    }
}

###############################################################################
#
# SI EMPTY
#
# A SYMBOLIC HOLDER FOR AN EMPTY SCENE IMAGE. THIS WOULD RARELY BE USED.
#
###############################################################################
Class SIEmpty : SceneImage {
    SIEmpty() : base() {}

    [String]ToAnsiControlSequenceString() {
        Return ''
    }
}

###############################################################################
#
# SI INTERNAL BASE
#
# A SPECIALIZATION OF SCENE IMAGE THAT ADDS COLOR MAP DATA.
#
###############################################################################
Class SIInternalBase : SceneImage {
    [ATBackgroundColor24[]]$ColorMap

    SIInternalBase() : base() {
        $this.ColorMap = New-Object 'ATBackgroundColor24[]' ([Int32](([Int32]([SceneImage]::Width)) * ([Int32]([SceneImage]::Height))))
    }

    SIInternalBase(
        [String]$JsonConfigPath
    ) : base() {
        Write-Progress `
            -Activity 'Creating Scene Images' `
            -Id 2 `
            -CurrentOperation "Creating $([System.IO.Path]::GetFileNameWithoutExtension($JsonConfigPath))" `
            -PercentComplete (($Script:SceneImagesLoaded / $Script:SceneImagesToLoad) * 100)

        [Hashtable]$JsonData = @{}
        $this.ColorMap = New-Object 'ATBackgroundColor24[]' ([Int32](([Int32]([SceneImage]::Width)) * ([Int32]([SceneImage]::Height))))

        If($(Test-Path $JsonConfigPath) -EQ $true) {
            $JsonData = Get-Content -Raw $JsonConfigPath | ConvertFrom-Json -AsHashtable

            # THIS JSON DATA WOULD CONTAIN ONLY ONE ELEMENT CALLED COLORDATA WHICH IS A SINGLE ARRAY
            # THAT CONTAINS EITHER A STRING, WHICH WOULD BE MAPPED TO A SPECIFIC COLOR DEFINED ABOVE,
            # OR AN ARRAY OF R, G, B VALUES WHICH WOULD CREATE A CUSTOM COLOR.
            [Int]$A = 0
            Foreach($B in $JsonData['ColorData']) {
                If($B -IS [String]) {
                    [String]$C = [String]::Format("CC{0}24", $B)
                    $this.ColorMap[$A] = New-Object "$($C)"
                } Elseif($B -IS [Array]) {
                    $this.ColorMap[$A] = [ATBackgroundColor24]::new([ConsoleColor24]::new($B[0], $B[1], $B[2]))
                }
                $A++
            }

            $this.CreateSceneImageATString($this.ColorMap)
            $this.ColorMap = $null

            $Script:SceneImagesLoaded++
            Write-Progress `
                -Activity 'Creating Scene Images' `
                -Id 2 `
                -CurrentOperation "Creating $([System.IO.Path]::GetFileNameWithoutExtension($JsonConfigPath))" `
                -PercentComplete (($Script:SceneImagesLoaded / $Script:SceneImagesToLoad) * 100)
        }
    }
}

###############################################################################
#
# SI RANDOM NOISE
#
# A SPECIALIZATION OF SCENE IMAGE THAT GENERATES RANDOM NOISE PER CELL.
#
###############################################################################
Class SIRandomNoise : SceneImage {
    [ATBackgroundColor24[]]$ColorMap

    SIRandomNoise() : base() {
        $this.ColorMap = New-Object 'ATBackgroundColor24[]' ([Int32](([Int32]([SceneImage]::Width)) * ([Int32]([SceneImage]::Height))))
        For($a = 0; $a -LT $this.ColorMap.Count; $a++) {
            $this.ColorMap[$a] = [CCRandom24]::new()
        }
        $this.CreateSceneImageATString($this.ColorMap)
        $this.ColorMap = $null
    }
}

###############################################################################
#
# SI MAP IMAGES
#
# THE FOLLOWING COLLECTION OF CLASSES ARE SCENERY "IMAGES" THAT ARE USED ON THE
# NAVIGATION SCREEN. THE NAMES ARE SELF-DOCUMENTING, AND THE PATTERN HERE IS
# THE SAME AS THE ENEMY IMAGES (HISTORICALLY, THESE WERE FIRST).
#
###############################################################################
Class SIFieldNorthRoad : SIInternalBase {
    SIFieldNorthRoad() : base("$(Get-Location)\Image Data\SIFieldNorthRoadNew.json") {}
}

Class SIFieldPlainsNoRoad : SIInternalBase {
    SIFieldPlainsNoRoad() : base("$(Get-Location)\Image Data\SIFieldPlainsNoRoad.json") {}
}

Class SIFieldPlainsRoadNorth : SIInternalBase {
    SIFieldPlainsRoadNorth() : base("$(Get-Location)\Image Data\SIFieldPlainsRoadNorth.json") {}
}

Class SIFieldPlainsRoadSouth : SIInternalBase {
    SIFieldPlainsRoadSouth() : base("$(Get-Location)\Image Data\SIFieldPlainsRoadSouth.json") {}
}

Class SIFieldPlainsRoadEast : SIInternalBase {
    SIFieldPlainsRoadEast() : base("$(Get-Location)\Image Data\SIFieldPlainsRoadEast.json") {}
}

Class SIFieldPlainsRoadWest : SIInternalBase {
    SIFieldPlainsRoadWest() : base("$(Get-Location)\Image Data\SIFieldPlainsRoadWest.json") {}
}

Class SIFieldPlainsRoadEastWest : SIInternalBase {
    SIFieldPlainsRoadEastWest() : base("$(Get-Location)\Image Data\SIFieldPlainsRoadEastWest.json") {}
}

Class SIFieldPlainsRoadNorthEast : SIInternalBase {
    SIFieldPlainsRoadNorthEast() : base("$(Get-Location)\Image Data\SIFieldPlainsRoadNorthEast.json") {}
}

Class SIFieldPlainsRoadNorthWest : SIInternalBase {
    SIFieldPlainsRoadNorthWest() : base("$(Get-Location)\Image Data\SIFieldPlainsRoadNorthWest.json") {}
}

Class SIFieldPlainsRoadNorthSouth : SIInternalBase {
    SIFieldPlainsRoadNorthSouth() : base("$(Get-Location)\Image Data\SIFieldPlainsRoadNorthSouth.json") {}
}

Class SIFieldPlainsRoadNorthSouthEast : SIInternalBase {
    SIFieldPlainsRoadNorthSouthEast() : base("$(Get-Location)\Image Data\SIFieldPlainsRoadNorthSouthEast.json") {}
}

Class SIFieldPlainsRoadNorthSouthEastWest : SIInternalBase {
    SIFieldPlainsRoadNorthSouthEastWest() : base("$(Get-Location)\Image Data\SIFieldPlainsRoadNorthSouthEastWest.json") {}
}

Class SIFieldPlainsRoadNorthSouthWest : SIInternalBase {
    SIFieldPlainsRoadNorthSouthWest() : base("$(Get-Location)\Image Data\SIFieldPlainsRoadNorthSouthWest.json") {}
}

Class SIFieldNorthEastRoad : SIInternalBase {
    SIFieldNorthEastRoad() : base("$(Get-Location)\Image Data\SIFieldNorthEastRoadNew.json") {}
}

Class SIRiverRoadSample : SIInternalBase {
    SIRiverRoadSample() : base("$(Get-Location)\Image Data\SIRiverRoadSample.json") {}
}

Class SIRiverRoadEWNSSample : SIInternalBase {
    SIRiverRoadEWNSSample() : base("$(Get-Location)\Image Data\SIRiverRoadEWNSSample.json") {}
}

Class SIRiverRoadEWSSSample : SIInternalBase {
    SIRiverRoadEWSSSample() : base("$(Get-Location)\Image Data\SIRiverRoadEWSSSample.json") {}
}

Class SIRiverOnEastAtNorth : SIInternalBase {
    SIRiverOnEastAtNorth() : base("$(Get-Location)\Image Data\SIRiverOnEastAtNorth.json") {}
}

Class SIRiverOnEastAtSouth : SIInternalBase {
    SIRiverOnEastAtSouth() : base("$(Get-Location)\Image Data\SIRiverOnEastAtSouth.json") {}
}

Class SIRiverOnEastWestAtNorth : SIInternalBase {
    SIRiverOnEastWestAtNorth() : base("$(Get-Location)\Image Data\SIRiverOnEastWestAtNorth.json") {}
}

Class SIRiverOnEastWestAtNorthSouth : SIInternalBase {
    SIRiverOnEastWestAtNorthSouth() : base("$(Get-Location)\Image Data\SIRiverOnEastWestAtNorthSouth.json") {}
}

Class SIRiverOnEastWestNorthSouthAtEast : SIInternalBase {
    SIRiverOnEastWestNorthSouthAtEast() : base("$(Get-Location)\Image Data\SIRiverOnEastWestNorthSouthAtEast.json") {}
}

Class SIRiverOnEastWestNorthSouthAtEastWest : SIInternalBase {
    SIRiverOnEastWestNorthSouthAtEastWest() : base("$(Get-Location)\Image Data\SIRiverOnEastWestNorthSouthAtEastWest.json") {}
}

Class SIRiverOnEastWestNorthSouthAtEastWestSouth : SIInternalBase {
    SIRiverOnEastWestNorthSouthAtEastWestSouth() : base("$(Get-Location)\Image Data\SIRiverOnEastWestNorthSouthAtEastWestSouth.json") {}
}

Class SIRiverOnEastWestNorthSouthAtWest : SIInternalBase {
    SIRiverOnEastWestNorthSouthAtWest() : base("$(Get-Location)\Image Data\SIRiverOnEastWestNorthSouthAtWest.json") {}
}

Class SIRiverOnNorthEastAtNorth : SIInternalBase {
    SIRiverOnNorthEastAtNorth() : base("$(Get-Location)\Image Data\SIRiverOnNorthEastAtNorth.json") {}
}

Class SIRiverOnNorthSouthAtEast : SIInternalBase {
    SIRiverOnNorthSouthAtEast() : base("$(Get-Location)\Image Data\SIRiverOnNorthSouthAtEast.json") {}
}

Class SIRiverOnNorthSouthAtWest : SIInternalBase {
    SIRiverOnNorthSouthAtWest() : base("$(Get-Location)\Image Data\SIRiverOnNorthSouthAtWest.json") {}
}

Class SIRiverOnNorthSouthEastAtEast : SIInternalBase {
    SIRiverOnNorthSouthEastAtEast() : base("$(Get-Location)\Image Data\SIRiverOnNorthSouthEastAtEast.json") {}
}

Class SIRiverOnNorthSouthEastAtNorth : SIInternalBase {
    SIRiverOnNorthSouthEastAtNorth() : base("$(Get-Location)\Image Data\SIRiverOnNorthSouthEastAtNorth.json") {}
}

Class SIRiverOnSouthAtEast : SIInternalBase {
    SIRiverOnSouthAtEast() : base("$(Get-Location)\Image Data\SIRiverOnSouthAtEast.json") {}
}

Class SIRiverOnSouthEastAtSouthEast : SIInternalBase {
    SIRiverOnSouthEastAtSouthEast() : base("$(Get-Location)\Image Data\SIRiverOnSouthEastAtSouthEast.json") {}
}

Class SIRiverOnWestAtNorth : SIInternalBase {
    SIRiverOnWestAtNorth() : base("$(Get-Location)\Image Data\SIRiverOnWestAtNorth.json") {}
}

Class SIRiverOnWestAtSouth : SIInternalBase {
    SIRiverOnWestAtSouth() : base("$(Get-Location)\Image Data\SIRiverOnWestAtSouth.json") {}
}

Class SIRiverOnWestEastAtSouth : SIInternalBase {
    SIRiverOnWestEastAtSouth() : base("$(Get-Location)\Image Data\SIRiverOnWestEastAtSouth.json") {}
}

Class SIRiverOnWestNorthAtNorth : SIInternalBase {
    SIRiverOnWestNorthAtNorth() : base("$(Get-Location)\Image Data\SIRiverOnWestNorthAtNorth.json") {}
}

Class SIRiverOnWestNorthSouthAtNorth : SIInternalBase {
    SIRiverOnWestNorthSouthAtNorth() : base("$(Get-Location)\Image Data\SIRiverOnWestNorthSouthAtNorth.json") {}
}






###############################################################################
#
# MAP TILE OBJECT
#
# DESPITE THE NAME, THIS REPRESENTS AN OBJECT THAT THE PLAYER CAN INTERACT WITH
# EITHER DIRECTLY ON THE MAP OR BY OWNING IT IN THEIR ITEM INVENTORY. THESE ARE
# ALSO THE ITEMS THAT ARE GIVEN TO THE PLAYER AS SPOILS WHEN DEFEATING CERTAIN
# ENEMIES.
#
# IT'S WORTH MENTIONING THE TARGETOFFILTER PROPERTY.
#
###############################################################################
Class MapTileObject {
    [String]$Name
    [String]$MapObjName
    [ScriptBlock]$Effect
    [Boolean]$CanAddToInventory
    [String]$ExamineString
    [List[String]]$TargetOfFilter
    [ScriptBlock]$BaseEffectCall
    [String]$PlayerEffectString
    [Boolean]$KeyItem

    MapTileObject() {
        $this.Name               = ''
        $this.MapObjName         = ''
        $this.Effect             = {}
        $this.CanAddToInventory  = $false
        $this.ExamineString      = ''
        $this.TargetOfFilter     = @()
        $this.PlayerEffectString = ''
        $this.KeyItem            = $false
        $this.BaseEffectCall     = {
            Param(
                [ValidateNotNullOrEmpty()]
                [String]$a0
            )

            Return $this.ValidateSourceInFilter($a0)
        }
    }

    [Boolean]ValidateSourceInFilter([String]$SourceItemClass) {
        Return ($SourceItemClass -IN $this.TargetOfFilter)
    }
}

###############################################################################
#
# MAP TILE
#
# A "PLACE" ON A MAP. ANY GIVEN COORDINATE PAIR VALUE RELATES TO A SINGLE MAP 
# TILE. MAP TILE NAVIGATION IS RESTRICTED TO CARDINAL DIRECTIONS, CONSEQUENTLY
# SOME DIRECTIONS ARE "EXITABLE" WHILE OTHERS AREN'T. MAP TILES HAVE A SINGLE
# "IMAGE" THAT IS DRAWN ON THE NAVIGATION SCREEN IN THE SCENE IMAGE WINDOW.
# MAP TILES CAN CONTAIN ZERO OR MORE MAP TILE OBJECTS THAT CAN BE INTERACTED
# WITH, EITHER BY EXAMINATION, AUGMENTATION, OR COLLECTION. EVERY MAP TILE
# OBJECT CAN BE EXAMINED, WHILE ONLY SELECT ONES CAN BE AUGMENTED OR COLLECTED.
# THIS IS DETERMINED BY A "TARGET OF" FILTER, WHICH IS DESCRIBED AT THE MAP
# TILE OBJECT DEFINITION.
#
# MAP TILES ALSO PLAY AN INTEGRAL PART OF THE COMBAT SYSTEM AS THEY SERVE AS 
# THE ENTRY POINT FOR THE COMBAT SUB-PROGRAM. THIS IS FACILITATED BY HAVING
# EACH TILE SPECIFIY THE FOLLOWING: IS BATTLE ALLOWED ON THIS TILE, WHAT IS
# THE EFFECTIVE ENCOUNTER RATE (OR CHANCE OF ENTERING A COMBAT SITUATION; THIS
# IS DETERMINED WHEN THE TILE IS CREATED AND DOESN'T CHANGE OVER TIME; IT 
# PROBABLY SHOULD! :)), AND A "REGION CODE" WHICH MAPS TO A HASHTABLE THAT
# CONTAINS ARRAYS THAT MAP TO REGION CODES. THESE ARRAYS SPECIFY WHICH KINDS OF
# ENEMIES CAN BE ENCOUNTERED IN THIS REGION.
#
###############################################################################
Class MapTile {
    Static [Int]$TileExitNorth = 0
    Static [Int]$TileExitSouth = 1
    Static [Int]$TileExitEast  = 2
    Static [Int]$TileExitWest  = 3

    [SceneImage]$BackgroundImage
    [List[MapTileObject]]$ObjectListing
    [Boolean[]]$Exits
    [Boolean]$BattleAllowed
    [Double]$EncounterRate
    [Int]$RegionCode

    MapTile() {
        $this.BackgroundImage = [SIEmpty]::new()
        $this.ObjectListing   = [List[MapTileObject]]::new()
        $this.Exits = @(
            $false,
            $false,
            $false,
            $false
        )
        $this.BattleAllowed = $false
        $this.EncounterRate = 0.5
        $this.RegionCode    = 0
    }

    MapTile(
        [SceneImage]$BackgroundImage,
        [MapTileObject[]]$ObjectListing,
        [Boolean[]]$Exits
    ) {
        $this.BackgroundImage = $BackgroundImage
        $this.ObjectListing   = [List[MapTileObject]]::new()
        $this.Exits           = $Exits
        $this.BattleAllowed   = $false
        $this.EncounterRate   = 0.5
        $this.RegionCode      = 0
        Foreach($a In $ObjectListing) {
            $this.ObjectListing.Add($a) | Out-Null
        }
    }

    MapTile(
        [SceneImage]$BackgroundImage,
        [MapTileObject[]]$ObjectListing,
        [Boolean[]]$Exits,
        [Boolean]$BattleAllowed,
        [Double]$EncounterRate,
        [Int]$RegionCode
    ) {
        $this.BackgroundImage = $BackgroundImage
        $this.ObjectListing   = [List[MapTileObject]]::new()
        $this.Exits           = $Exits
        $this.BattleAllowed   = $BattleAllowed
        $this.EncounterRate   = $EncounterRate
        $this.RegionCode      = $RegionCode
        Foreach($a in $ObjectListing) {
            $this.ObjectListing.Add($a) | Out-Null
        }
    }

    MapTile(
        [Hashtable]$JsonData
    ) {
        $this.BackgroundImage = $Script:TheSceneImages[$JsonData['BackgroundImage']]
        $this.Exits           = $JsonData['Exits']
        $this.BattleAllowed   = $JsonData['BattleAllowed']
        $this.EncounterRate   = $JsonData['EncounterRate']
        $this.RegionCode      = $JsonData['RegionCode']
        $this.ObjectListing   = [List[MapTileObject]]::new()

        Foreach($A in $JsonData['ObjectListing']) {
            $this.ObjectListing.Add($(New-Object -TypeName $A)) | Out-Null
        }
    }

    [Boolean]IsItemInTile([String]$ItemName) {
        Foreach($a in $this.ObjectListing) {
            If($a.Name -IEQ $ItemName) {
                Return $true
            }
        }

        Return $false
    }

    [MapTileObject]GetItemReference([String]$ItemName) {
        Foreach($a in $this.ObjectListing) {
            If($a.Name -IEQ $ItemName) {
                Return $a
            }
        }

        Return $null
    }

    [Void]BattleStep() {
        If($this.BattleAllowed -EQ $true) {
            [Double]$BattleChance = Get-Random -Minimum 0.0 -Maximum 1.0
            If($BattleChance -GT $this.EncounterRate) {
                $Script:TheCurrentEnemy = New-Object -TypeName $($Script:BattleEncounterRegionTable[$this.RegionCode] | Get-Random)
                $Script:TheBufferManager.CopyActiveToBufferAWithWipe()
                $Script:ThePreviousGlobalGameState = $Script:TheGlobalGameState
                $Script:TheGlobalGameState         = [GameStatePrimary]::BattleScreen
            }
        }
    }
}





###############################################################################
#
# MAP
#
###############################################################################
Class Map {
    [Int]$MapWidth
    [Int]$MapHeight
    [String]$Name
    [Boolean]$BoundaryWrap
    [MapTile[,]]$Tiles

    Map() {
        $this.MapWidth     = 0
        $this.MapHeight    = 0
        $this.Name         = ''
        $this.BoundaryWrap = $false

        # THIS LINE PRESENTS A PROBLEM WITH SPLATTING SINCE IT EVIDENTLY GETS CALLED BEFORE
        # ANY OF THE SPLATTED VALUES ARE APPLIED TO THE OBJECT.
        $this.Tiles        = New-Object 'MapTile[,]' $this.MapHeight, $this.MapWidth
    }

    Map(
        [String]$Name,
        [Int]$MapWidth,
        [Int]$MapHeight,
        [Boolean]$BoundaryWrap
    ) {
        $this.Name         = $Name
        $this.MapWidth     = $MapWidth
        $this.MapHeight    = $MapHeight
        $this.BoundaryWrap = $BoundaryWrap
        $this.Tiles        = New-Object 'MapTile[,]' $this.MapHeight, $this.MapWidth
    }

    Map(
        [String]$JsonConfigPath
    ) {
        [Hashtable]$JsonData = @{}

        If($(Test-Path $JsonConfigPath) -EQ $true) {
            $JsonData = Get-Content -Raw $JsonConfigPath | ConvertFrom-Json -AsHashtable
        }

        $this.Name         = $JsonData['MapName']
        $this.MapWidth     = $JsonData['MapWidth']
        $this.MapHeight    = $JsonData['MapHeight']
        $this.BoundaryWrap = $JsonData['BoundaryWrap']
        $this.Tiles        = New-Object 'MapTile[,]' $this.MapHeight, $this.MapWidth

        For([Int]$Y = 0; $Y -LT $this.MapHeight; $Y++) {
            For([Int]$X = 0; $X -LT $this.MapWidth; $X++) {
                # [Hashtable]$A = $JsonData['Tiles'][$Y][$X]
                $this.Tiles[$Y, $X] = [MapTile]::new($JsonData['Tiles'][$Y][$X])
            }
        }
    }

    [Void]CreateMapTiles() {
        If($this.MapWidth -GT 0 -AND $this.MapHeight -GT 0) {
            $this.Tiles = New-Object 'MapTile[,]' $this.MapHeight, $this.MapWidth
        }
    }

    [MapTile]GetTileAtPlayerCoordinates() {
        Return $this.Tiles[$Script:ThePlayer.MapCoordinates.Row, $Script:ThePlayer.MapCoordinates.Column]
    }
}





###############################################################################
#
# BATTLE EQUIPMENT CLASS
#
# THE BASE CLASS FOR ITEMS INTENDED TO BE USED AS EQUIPMENT FOR THE PLAYER.
#
# INSTEAD OF USING ENUMERATIONS FOR THE DIFFERENT KINDS OF EQUIPMENT, I'LL
# BE USING DIFFERENT BASE CLASSES.
#
###############################################################################
Class BattleEquipment : MapTileObject {    
    [Int]$PurchasePrice
    [Int]$SellPrice
    [Hashtable]$TargetStats
    [Hashtable]$RequiredStats

    BattleEquipment() : base() {
        $this.PurchasePrice = 0
        $this.SellPrice     = 0
        $this.TargetStats   = @{}
        $this.RequiredStats = @{}
    }
}

Class BEWeapon : BattleEquipment {}

Class BEHelmet : BattleEquipment {}

Class BEArmor : BattleEquipment {}

Class BEPauldron : BattleEquipment {}

Class BEGauntlets : BattleEquipment {}

Class BEGreaves : BattleEquipment {}

Class BEBoots : BattleEquipment {}

Class BEJewelry : BattleEquipment {}

Class BECape : BattleEquipment {}





###############################################################################
#
# BATTLE EQUIPMENT - WEAPON SPECIALIZATIONS
#
###############################################################################

Class BERustyDagger : BEWeapon {
    BERustyDagger() : base() {
        $this.Name               = 'Rusty Dagger'
        $this.MapObjName         = 'rustydagger'
        $this.PurchasePrice      = 50
        $this.SellPrice          = 25
        $this.TargetStats        = @{
            [StatId]::Attack = 5
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 0
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A somewhat dull and rusted dagger.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BEWoodenClub : BEWeapon {
    BEWoodenClub() : base() {
        $this.Name               = 'Wooden Club'
        $this.MapObjName         = 'woodenclub'
        $this.PurchasePrice      = 70
        $this.SellPrice          = 35
        $this.TargetStats        = @{
            [StatId]::Attack = 7
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 0
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A sturdy club made of wood.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BEShortBow : BEWeapon {
    BEShortBow() : base() {
        $this.Name               = 'Short Bow'
        $this.MapObjName         = 'shortbow'
        $this.PurchasePrice      = 100
        $this.SellPrice          = 50
        $this.TargetStats        = @{
            [StatId]::Attack = 8
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 3
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A simple short bow, good for beginners.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BEBronzeSword : BEWeapon {
    BEBronzeSword() : base() {
        $this.Name               = 'Bronze Sword'
        $this.MapObjName         = 'bronzesword'
        $this.PurchasePrice      = 150
        $this.SellPrice          = 75
        $this.TargetStats        = @{
            [StatId]::Attack = 10
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 5
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A basic sword forged from bronze.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BETrainingSpear : BEWeapon {
    BETrainingSpear() : base() {
        $this.Name               = 'Training Spear'
        $this.MapObjName         = 'trainingspear'
        $this.PurchasePrice      = 120
        $this.SellPrice          = 60
        $this.TargetStats        = @{
            [StatId]::Attack = 9
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 4
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A spear used for training purposes.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BEWornGauntlets : BEWeapon {
    BEWornGauntlets() : base() {
        $this.Name               = 'Worn Gauntlets'
        $this.MapObjName         = 'worngauntlets'
        $this.PurchasePrice      = 80
        $this.SellPrice          = 40
        $this.TargetStats        = @{
            [StatId]::Attack = 6
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 0
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Old, worn gauntlets that offer minimal protection and striking power.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BESimpleStaff : BEWeapon {
    BESimpleStaff() : base() {
        $this.Name               = 'Simple Staff'
        $this.MapObjName         = 'simplestaff'
        $this.PurchasePrice      = 200
        $this.SellPrice          = 100
        $this.TargetStats        = @{
            [StatId]::Attack = 12 # Staves might also boost MagicAttack, consider adding to TargetStats
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 5
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A basic wooden staff, sometimes used by mages.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BEIronAxe : BEWeapon {
    BEIronAxe() : base() {
        $this.Name               = 'Iron Axe'
        $this.MapObjName         = 'ironaxe'
        $this.PurchasePrice      = 300
        $this.SellPrice          = 150
        $this.TargetStats        = @{
            [StatId]::Attack = 15
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 8
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A hefty axe made of iron.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BELeatherWhip : BEWeapon {
    BELeatherWhip() : base() {
        $this.Name               = 'Leather Whip'
        $this.MapObjName         = 'leatherwhip'
        $this.PurchasePrice      = 250
        $this.SellPrice          = 125
        $this.TargetStats        = @{
            [StatId]::Attack = 13
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 6
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A whip made of tough leather.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BEPointyStick : BEWeapon {
    BEPointyStick() : base() {
        $this.Name               = 'Pointy Stick'
        $this.MapObjName         = 'pointystick'
        $this.PurchasePrice      = 30
        $this.SellPrice          = 15
        $this.TargetStats        = @{
            [StatId]::Attack = 4
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 0
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'It''s a stick, and it''s pointy. Surprisingly effective.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BESteelDagger : BEWeapon {
    BESteelDagger() : base() {
        $this.Name               = 'Steel Dagger'
        $this.MapObjName         = 'steeldagger'
        $this.PurchasePrice      = 600
        $this.SellPrice          = 300
        $this.TargetStats        = @{
            [StatId]::Attack = 22
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 10
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A sharp dagger forged from steel.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BESpikedMace : BEWeapon {
    BESpikedMace() : base() {
        $this.Name               = 'Spiked Mace'
        $this.MapObjName         = 'spikedmace'
        $this.PurchasePrice      = 750
        $this.SellPrice          = 375
        $this.TargetStats        = @{
            [StatId]::Attack = 25
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 12
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A mace with dangerous-looking spikes.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BEHuntersBow : BEWeapon { # Apostrophe removed for class name
    BEHuntersBow() : base() {
        $this.Name               = 'Hunter''s Bow'
        $this.MapObjName         = 'huntersbow'
        $this.PurchasePrice      = 900
        $this.SellPrice          = 450
        $this.TargetStats        = @{
            [StatId]::Attack = 28
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 14
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A bow favored by skilled hunters.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BEIronSword : BEWeapon {
    BEIronSword() : base() {
        $this.Name               = 'Iron Sword'
        $this.MapObjName         = 'ironsword'
        $this.PurchasePrice      = 1200
        $this.SellPrice          = 600
        $this.TargetStats        = @{
            [StatId]::Attack = 30
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 15
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A reliable sword made of iron.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BESoldiersSpear : BEWeapon {
    BESoldiersSpear() : base() {
        $this.Name               = 'Soldier''s Spear'
        $this.MapObjName         = 'soldiersspear'
        $this.PurchasePrice      = 1000
        $this.SellPrice          = 500
        $this.TargetStats        = @{
            [StatId]::Attack = 29
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 14
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Standard issue spear for soldiers.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BEReinforcedGauntlets : BEWeapon {
    BEReinforcedGauntlets() : base() {
        $this.Name               = 'Reinforced Gauntlets'
        $this.MapObjName         = 'reinforcedgauntlets'
        $this.PurchasePrice      = 700
        $this.SellPrice          = 350
        $this.TargetStats        = @{
            [StatId]::Attack = 24
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 11
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets reinforced with metal plates.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BEAdeptsStaff : BEWeapon {
    BEAdeptsStaff() : base() {
        $this.Name               = 'Adept''s Staff'
        $this.MapObjName         = 'adeptsstaff'
        $this.PurchasePrice      = 1500
        $this.SellPrice          = 750
        $this.TargetStats        = @{
            [StatId]::Attack      = 35
            [StatId]::MagicAttack = 10
        }
        $this.RequiredStats      = @{
            [StatId]::Attack      = 18
            [StatId]::MagicAttack = 5
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A staff wielded by an adept magic user.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power :: +$($this.TargetStats[[StatId]::MagicAttack]) Magic Attack"
    }
}

Class BEBattleAxe : BEWeapon {
    BEBattleAxe() : base() {
        $this.Name               = 'Battle Axe'
        $this.MapObjName         = 'battleaxe'
        $this.PurchasePrice      = 2000
        $this.SellPrice          = 1000
        $this.TargetStats        = @{
            [StatId]::Attack = 40
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 20
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A large axe designed for combat.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BEChainWhip : BEWeapon {
    BEChainWhip() : base() {
        $this.Name               = 'Chain Whip'
        $this.MapObjName         = 'chainwhip'
        $this.PurchasePrice      = 1800
        $this.SellPrice          = 900
        $this.TargetStats        = @{
            [StatId]::Attack = 38
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 19
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A whip made of interlocking metal chains.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BEBroadsword : BEWeapon {
    BEBroadsword() : base() {
        $this.Name               = 'Broadsword'
        $this.MapObjName         = 'broadsword'
        $this.PurchasePrice      = 2200
        $this.SellPrice          = 1100
        $this.TargetStats        = @{
            [StatId]::Attack = 45
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 22
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A wide-bladed sword, effective for slashing.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BEAssassinsBlade : BEWeapon {
    BEAssassinsBlade() : base() {
        $this.Name               = 'Assassin''s Blade'
        $this.MapObjName         = 'assassinsblade'
        $this.PurchasePrice      = 3000
        $this.SellPrice          = 1500
        $this.TargetStats        = @{
            [StatId]::Attack = 55
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 25
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A blade designed for swift and silent takedowns.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BEWarHammer : BEWeapon {
    BEWarHammer() : base() {
        $this.Name               = 'War Hammer'
        $this.MapObjName         = 'warhammer'
        $this.PurchasePrice      = 4000
        $this.SellPrice          = 2000
        $this.TargetStats        = @{
            [StatId]::Attack = 65
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 30
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A heavy hammer built for crushing armor.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BEElvenBow : BEWeapon {
    BEElvenBow() : base() {
        $this.Name               = 'Elven Bow'
        $this.MapObjName         = 'elvenbow'
        $this.PurchasePrice      = 5000
        $this.SellPrice          = 2500
        $this.TargetStats        = @{
            [StatId]::Attack = 60
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 28
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An elegantly crafted bow of elven make.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BEKnightsSword : BEWeapon {
    BEKnightsSword() : base() {
        $this.Name               = 'Knight''s Sword'
        $this.MapObjName         = 'knightssword'
        $this.PurchasePrice      = 6000
        $this.SellPrice          = 3000
        $this.TargetStats        = @{
            [StatId]::Attack = 70
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 35
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A noble sword befitting a knight.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BELancersPike : BEWeapon {
    BELancersPike() : base() {
        $this.Name               = 'Lancer''s Pike'
        $this.MapObjName         = 'lancerspike'
        $this.PurchasePrice      = 5500
        $this.SellPrice          = 2750
        $this.TargetStats        = @{
            [StatId]::Attack = 68
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 32
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A long pike used by mounted lancers.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BETigerClaws : BEWeapon {
    BETigerClaws() : base() {
        $this.Name               = 'Tiger Claws'
        $this.MapObjName         = 'tigerclaws'
        $this.PurchasePrice      = 3500
        $this.SellPrice          = 1750
        $this.TargetStats        = @{
            [StatId]::Attack = 58
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 26
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Sharp claws that mimic a tiger''s ferocity.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BESorcerersRod : BEWeapon {
    BESorcerersRod() : base() {
        $this.Name               = 'Sorcerer''s Rod'
        $this.MapObjName         = 'sorcerersrod'
        $this.PurchasePrice      = 7000
        $this.SellPrice          = 3500
        $this.TargetStats        = @{
            [StatId]::Attack      = 75
            [StatId]::MagicAttack = 25
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 38
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A rod imbued with potent sorcery.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power :: +$($this.TargetStats[[StatId]::MagicAttack]) Magic Power"
    }
}

Class BEDwarvenGreataxe : BEWeapon {
    BEDwarvenGreataxe() : base() {
        $this.Name               = 'Dwarven Greataxe'
        $this.MapObjName         = 'dwarvengreataxe'
        $this.PurchasePrice      = 8000
        $this.SellPrice          = 4000
        $this.TargetStats        = @{
            [StatId]::Attack = 85
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 42
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A masterfully crafted greataxe of dwarven origin.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BEThornedVineWhip : BEWeapon {
    BEThornedVineWhip() : base() {
        $this.Name               = 'Thorned Vine Whip'
        $this.MapObjName         = 'thornedvinewhip'
        $this.PurchasePrice      = 6500
        $this.SellPrice          = 3250
        $this.TargetStats        = @{
            [StatId]::Attack = 72
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 36
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A whip made from a thorny vine, surprisingly resilient.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BEFlamberge : BEWeapon {
    BEFlamberge() : base() {
        $this.Name               = 'Flamberge'
        $this.MapObjName         = 'flamberge'
        $this.PurchasePrice      = 9000
        $this.SellPrice          = 4500
        $this.TargetStats        = @{
            [StatId]::Attack = 90
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 45
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A two-handed sword with a distinctive wave-bladed design.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BEShadowfangDirk : BEWeapon {
    BEShadowfangDirk() : base() {
        $this.Name               = 'Shadowfang Dirk'
        $this.MapObjName         = 'shadowfangdirk'
        $this.PurchasePrice      = 12000
        $this.SellPrice          = 6000
        $this.TargetStats        = @{
            [StatId]::Attack = 95
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 50
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A dirk that seems to absorb light, favored by rogues.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BETitansMaul : BEWeapon {
    BETitansMaul() : base() {
        $this.Name               = 'Titan''s Maul'
        $this.MapObjName         = 'titansmaul'
        $this.PurchasePrice      = 15000
        $this.SellPrice          = 7500
        $this.TargetStats        = @{
            [StatId]::Attack = 110
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 55
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A maul of immense size and weight, as if made for a titan.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BEGriffinsTalonBow : BEWeapon {
    BEGriffinsTalonBow() : base() {
        $this.Name               = 'Griffin''s Talon Bow'
        $this.MapObjName         = 'griffinstalonbow'
        $this.PurchasePrice      = 18000
        $this.SellPrice          = 9000
        $this.TargetStats        = @{
            [StatId]::Attack = 105
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 52
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A bow adorned with griffin talons, known for its accuracy.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BEPaladinsBlade : BEWeapon {
    BEPaladinsBlade() : base() {
        $this.Name               = 'Paladin''s Blade'
        $this.MapObjName         = 'paladinsblade'
        $this.PurchasePrice      = 25000
        $this.SellPrice          = 12500
        $this.TargetStats        = @{
            [StatId]::Attack = 120
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 60
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A sacred blade wielded by champions of justice.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BEDragoonLance : BEWeapon {
    BEDragoonLance() : base() {
        $this.Name               = 'Dragoon Lance'
        $this.MapObjName         = 'dragoonlance'
        $this.PurchasePrice      = 22000
        $this.SellPrice          = 11000
        $this.TargetStats        = @{
            [StatId]::Attack = 115
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 58
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A lance designed for aerial combat, used by dragoons.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BEWyvernKnuckles : BEWeapon {
    BEWyvernKnuckles() : base() {
        $this.Name               = 'Wyvern Knuckles'
        $this.MapObjName         = 'wyvernknuckles'
        $this.PurchasePrice      = 16000
        $this.SellPrice          = 8000
        $this.TargetStats        = @{
            [StatId]::Attack = 100
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 50
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Knuckles crafted from wyvern scales, delivering powerful blows.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BEArchmagesStaff : BEWeapon {
    BEArchmagesStaff() : base() {
        $this.Name               = 'Archmage''s Staff'
        $this.MapObjName         = 'archmagesstaff'
        $this.PurchasePrice      = 30000
        $this.SellPrice          = 15000
        $this.TargetStats        = @{
            [StatId]::Attack      = 130
            [StatId]::MagicAttack = 90
        }
        $this.RequiredStats      = @{
            [StatId]::Attack      = 65
            [StatId]::MagicAttack = 70
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'The staff of a powerful archmage, crackling with energy.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power :: +$($this.TargetStats[[StatId]::MagicAttack]) Magic Power"
    }
}

Class BEExecutionersAxe : BEWeapon {
    BEExecutionersAxe() : base() {
        $this.Name               = 'Executioner''s Axe'
        $this.MapObjName         = 'executionersaxe'
        $this.PurchasePrice      = 40000
        $this.SellPrice          = 20000
        $this.TargetStats        = @{
            [StatId]::Attack = 145
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 72
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A grim axe designed for a single, decisive blow.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BEScourgeOfTheSands : BEWeapon {
    BEScourgeOfTheSands() : base() {
        $this.Name               = 'Scourge of the Sands'
        $this.MapObjName         = 'scourgeofthesands'
        $this.PurchasePrice      = 35000
        $this.SellPrice          = 17500
        $this.TargetStats        = @{
            [StatId]::Attack = 135
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 68
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A weapon feared in desert lands, capable of stirring sandstorms.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BEMasamune : BEWeapon {
    BEMasamune() : base() {
        $this.Name               = 'Masamune'
        $this.MapObjName         = 'masamune'
        $this.PurchasePrice      = 50000
        $this.SellPrice          = 25000
        $this.TargetStats        = @{
            [StatId]::Attack = 150
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 75
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A legendary katana of unparalleled sharpness.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BESoulReaver : BEWeapon {
    BESoulReaver() : base() {
        $this.Name               = 'Soul Reaver'
        $this.MapObjName         = 'soulreaver'
        $this.PurchasePrice      = 70000
        $this.SellPrice          = 35000
        $this.TargetStats        = @{
            [StatId]::Attack = 160
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 80
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A terrifying blade said to consume the souls of its victims.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BEEarthshaker : BEWeapon {
    BEEarthshaker() : base() {
        $this.Name               = 'Earthshaker'
        $this.MapObjName         = 'earthshaker'
        $this.PurchasePrice      = 90000
        $this.SellPrice          = 45000
        $this.TargetStats        = @{
            [StatId]::Attack = 180
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 90
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A mighty weapon capable of causing tremors with each strike.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BECelestialBow : BEWeapon {
    BECelestialBow() : base() {
        $this.Name               = 'Celestial Bow'
        $this.MapObjName         = 'celestialbow'
        $this.PurchasePrice      = 120000
        $this.SellPrice          = 60000
        $this.TargetStats        = @{
            [StatId]::Attack = 170
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 85
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A bow blessed by the stars, firing arrows of pure light.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BEExcalibur : BEWeapon {
    BEExcalibur() : base() {
        $this.Name               = 'Excalibur'
        $this.MapObjName         = 'excalibur'
        $this.PurchasePrice      = 150000
        $this.SellPrice          = 75000
        $this.TargetStats        = @{
            [StatId]::Attack = 200
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 100
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'The legendary sword of kings, radiating immense power.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BEGungnir : BEWeapon {
    BEGungnir() : base() {
        $this.Name               = 'Gungnir'
        $this.MapObjName         = 'gungnir'
        $this.PurchasePrice      = 130000
        $this.SellPrice          = 65000
        $this.TargetStats        = @{
            [StatId]::Attack = 190
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 95
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A mythical spear that never misses its mark.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BEKaiserKnuckles : BEWeapon {
    BEKaiserKnuckles() : base() {
        $this.Name               = 'Kaiser Knuckles'
        $this.MapObjName         = 'kaiserknuckles'
        $this.PurchasePrice      = 100000
        $this.SellPrice          = 50000
        $this.TargetStats        = @{
            [StatId]::Attack = 175
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 88
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Powerful knuckles fit for an emperor, capable of shattering defenses.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BEStaffOfTheCosmos : BEWeapon {
    BEStaffOfTheCosmos() : base() {
        $this.Name               = 'Staff of the Cosmos'
        $this.MapObjName         = 'staffofthecosmos'
        $this.PurchasePrice      = 180000
        $this.SellPrice          = 90000
        $this.TargetStats        = @{
            [StatId]::Attack      = 220
            [StatId]::MagicAttack = 150
        }
        $this.RequiredStats      = @{
            [StatId]::Attack      = 110
            [StatId]::MagicAttack = 90
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A staff that channels the very power of the cosmos.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BERagnarok : BEWeapon {
    BERagnarok() : base() {
        $this.Name               = 'Ragnarok'
        $this.MapObjName         = 'ragnarok'
        $this.PurchasePrice      = 200000
        $this.SellPrice          = 100000
        $this.TargetStats        = @{
            [StatId]::Attack = 240
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 120
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A sword prophesied to bring about the end of the world, or at least your enemies.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BEVampireKiller : BEWeapon {
    BEVampireKiller() : base() {
        $this.Name               = 'Vampire Killer'
        $this.MapObjName         = 'vampirekiller'
        $this.PurchasePrice      = 160000
        $this.SellPrice          = 80000
        $this.TargetStats        = @{
            [StatId]::Attack = 210
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 105
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A sacred whip, bane of the undead and creatures of the night.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}

Class BEMuramasa : BEWeapon {
    BEMuramasa() : base() {
        $this.Name               = 'Muramasa'
        $this.MapObjName         = 'muramasa'
        $this.PurchasePrice      = 250000
        $this.SellPrice          = 125000
        $this.TargetStats        = @{
            [StatId]::Attack = 250
        }
        $this.RequiredStats      = @{
            [StatId]::Attack = 125
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A cursed blade of incredible sharpness, thirsting for battle.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Attack]) Attack Power"
    }
}





###############################################################################
#
# BATTLE EQUIPMENT - HELMET SPECIALIZATIONS
#
###############################################################################

Class BELeatherCap : BEHelmet {
    BELeatherCap() : base() {
        $this.Name               = 'Leather Cap'
        $this.MapObjName         = 'leathercap'
        $this.PurchasePrice      = 60
        $this.SellPrice          = 30
        $this.TargetStats        = @{
            [StatId]::Defense = 3
            [StatId]::MagicDefense = 1
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 0
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A simple cap made of treated leather.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEClothHood : BEHelmet {
    BEClothHood() : base() {
        $this.Name               = 'Cloth Hood'
        $this.MapObjName         = 'clothhood'
        $this.PurchasePrice      = 55
        $this.SellPrice          = 27
        $this.TargetStats        = @{
            [StatId]::Defense = 1
            [StatId]::MagicDefense = 4
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 0
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A light hood offering minimal physical protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEIronHelm : BEHelmet {
    BEIronHelm() : base() {
        $this.Name               = 'Iron Helm'
        $this.MapObjName         = 'ironhelm'
        $this.PurchasePrice      = 180
        $this.SellPrice          = 90
        $this.TargetStats        = @{
            [StatId]::Defense = 8
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 5
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A basic iron helmet.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEBronzeCirclet : BEHelmet {
    BEBronzeCirclet() : base() {
        $this.Name               = 'Bronze Circlet'
        $this.MapObjName         = 'bronzecirclet'
        $this.PurchasePrice      = 120
        $this.SellPrice          = 60
        $this.TargetStats        = @{
            [StatId]::Defense = 2
            [StatId]::MagicDefense = 6
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 3
            [StatId]::MagicDefense = 3
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A simple bronze circlet, often used by apprentices.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEStuddedLeatherCap : BEHelmet {
    BEStuddedLeatherCap() : base() {
        $this.Name               = 'Studded Leather Cap'
        $this.MapObjName         = 'studdedleathercap'
        $this.PurchasePrice      = 250
        $this.SellPrice          = 125
        $this.TargetStats        = @{
            [StatId]::Defense = 6
            [StatId]::MagicDefense = 2
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 4
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A leather cap reinforced with metal studs.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEChainCoif : BEHelmet {
    BEChainCoif() : base() {
        $this.Name               = 'Chain Coif'
        $this.MapObjName         = 'chaincoif'
        $this.PurchasePrice      = 350
        $this.SellPrice          = 175
        $this.TargetStats        = @{
            [StatId]::Defense = 10
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 7
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A hood made of interlocking metal rings.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BESteelHelm : BEHelmet {
    BESteelHelm() : base() {
        $this.Name               = 'Steel Helm'
        $this.MapObjName         = 'steelhelm'
        $this.PurchasePrice      = 500
        $this.SellPrice          = 250
        $this.TargetStats        = @{
            [StatId]::Defense = 15
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 10
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A sturdy helmet forged from steel.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BESilverCirclet : BEHelmet {
    BESilverCirclet() : base() {
        $this.Name               = 'Silver Circlet'
        $this.MapObjName         = 'silvercirclet'
        $this.PurchasePrice      = 450
        $this.SellPrice          = 225
        $this.TargetStats        = @{
            [StatId]::Defense = 4
            [StatId]::MagicDefense = 12
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 5
            [StatId]::MagicDefense = 6
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A circlet made of polished silver, favored by mages.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEPlateHelm : BEHelmet {
    BEPlateHelm() : base() {
        $this.Name               = 'Plate Helm'
        $this.MapObjName         = 'platehelm'
        $this.PurchasePrice      = 700
        $this.SellPrice          = 350
        $this.TargetStats        = @{
            [StatId]::Defense = 20
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 15
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A heavy helmet offering significant physical protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEWizardHat : BEHelmet {
    BEWizardHat() : base() {
        $this.Name               = 'Wizard Hat'
        $this.MapObjName         = 'wizardhat'
        $this.PurchasePrice      = 650
        $this.SellPrice          = 325
        $this.TargetStats        = @{
            [StatId]::Defense = 2
            [StatId]::MagicDefense = 18
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 3
            [StatId]::MagicDefense = 9
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A tall, pointed hat often worn by wizards.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEDwarvenHelm : BEHelmet {
    BEDwarvenHelm() : base() {
        $this.Name               = 'Dwarven Helm'
        $this.MapObjName         = 'dwarvenhelm'
        $this.PurchasePrice      = 900
        $this.SellPrice          = 450
        $this.TargetStats        = @{
            [StatId]::Defense = 25
            [StatId]::MagicDefense = 5
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 18
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A sturdy, often horned, helmet crafted by dwarves.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEElvenHood : BEHelmet {
    BEElvenHood() : base() {
        $this.Name               = 'Elven Hood'
        $this.MapObjName         = 'elvenhood'
        $this.PurchasePrice      = 850
        $this.SellPrice          = 425
        $this.TargetStats        = @{
            [StatId]::Defense = 5
            [StatId]::MagicDefense = 22
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 5
            [StatId]::MagicDefense = 11
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A light, finely woven hood of elven design.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGoldenCirclet : BEHelmet {
    BEGoldenCirclet() : base() {
        $this.Name               = 'Golden Circlet'
        $this.MapObjName         = 'goldencirclet'
        $this.PurchasePrice      = 1100
        $this.SellPrice          = 550
        $this.TargetStats        = @{
            [StatId]::Defense = 8
            [StatId]::MagicDefense = 28
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 8
            [StatId]::MagicDefense = 14
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A circlet made of pure gold, shimmering with magical energy.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEFullPlateHelm : BEHelmet {
    BEFullPlateHelm() : base() {
        $this.Name               = 'Full Plate Helm'
        $this.MapObjName         = 'fullplatehelm'
        $this.PurchasePrice      = 1300
        $this.SellPrice          = 650
        $this.TargetStats        = @{
            [StatId]::Defense = 30
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 22
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A complete helmet covering the entire head and face.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BESilkenHood : BEHelmet {
    BESilkenHood() : base() {
        $this.Name               = 'Silken Hood'
        $this.MapObjName         = 'silkenhood'
        $this.PurchasePrice      = 1000
        $this.SellPrice          = 500
        $this.TargetStats        = @{
            [StatId]::Defense = 3
            [StatId]::MagicDefense = 35
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 4
            [StatId]::MagicDefense = 17
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A hood made of fine silk, surprisingly resistant to magic.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEVikingHelm : BEHelmet {
    BEVikingHelm() : base() {
        $this.Name               = 'Viking Helm'
        $this.MapObjName         = 'vikinghelm'
        $this.PurchasePrice      = 1500
        $this.SellPrice          = 750
        $this.TargetStats        = @{
            [StatId]::Defense = 35
            [StatId]::MagicDefense = 8
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 25
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A horned helmet, perfect for raiding.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEArchmageCirclet : BEHelmet {
    BEArchmageCirclet() : base() {
        $this.Name               = 'Archmage Circlet'
        $this.MapObjName         = 'archmagecirclet'
        $this.PurchasePrice      = 1800
        $this.SellPrice          = 900
        $this.TargetStats        = @{
            [StatId]::Defense = 10
            [StatId]::MagicDefense = 40
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 10
            [StatId]::MagicDefense = 20
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A powerful circlet worn by archmages.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEKnightHelm : BEHelmet {
    BEKnightHelm() : base() {
        $this.Name               = 'Knight Helm'
        $this.MapObjName         = 'knighthelm'
        $this.PurchasePrice      = 2000
        $this.SellPrice          = 1000
        $this.TargetStats        = @{
            [StatId]::Defense = 40
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 28
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A polished helm fit for a knight.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEAssassinHood : BEHelmet {
    BEAssassinHood() : base() {
        $this.Name               = 'Assassin Hood'
        $this.MapObjName         = 'assassinhood'
        $this.PurchasePrice      = 1700
        $this.SellPrice          = 850
        $this.TargetStats        = @{
            [StatId]::Defense = 8
            [StatId]::MagicDefense = 32
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 8
            [StatId]::MagicDefense = 16
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A dark hood that helps conceal the wearer.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEDragonScaleHelm : BEHelmet {
    BEDragonScaleHelm() : base() {
        $this.Name               = 'Dragon Scale Helm'
        $this.MapObjName         = 'dragonscalehelm'
        $this.PurchasePrice      = 2500
        $this.SellPrice          = 1250
        $this.TargetStats        = @{
            [StatId]::Defense = 45
            [StatId]::MagicDefense = 10
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 30
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm crafted from the tough scales of a dragon.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEPhoenixFeatherCirclet : BEHelmet {
    BEPhoenixFeatherCirclet() : base() {
        $this.Name               = 'Phoenix Feather Circlet'
        $this.MapObjName         = 'phoenixfeathercirclet'
        $this.PurchasePrice      = 2800
        $this.SellPrice          = 1400
        $this.TargetStats        = @{
            [StatId]::Defense = 12
            [StatId]::MagicDefense = 48
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 12
            [StatId]::MagicDefense = 24
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A circlet adorned with phoenix feathers, humming with restorative magic.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BETitanHelm : BEHelmet {
    BETitanHelm() : base() {
        $this.Name               = 'Titan Helm'
        $this.MapObjName         = 'titanhelm'
        $this.PurchasePrice      = 3200
        $this.SellPrice          = 1600
        $this.TargetStats        = @{
            [StatId]::Defense = 50
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 35
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A massive helm, seemingly forged for a giant.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEShadowSilkHood : BEHelmet {
    BEShadowSilkHood() : base() {
        $this.Name               = 'Shadow Silk Hood'
        $this.MapObjName         = 'shadowsilkhood'
        $this.PurchasePrice      = 3000
        $this.SellPrice          = 1500
        $this.TargetStats        = @{
            [StatId]::Defense = 10
            [StatId]::MagicDefense = 45
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 10
            [StatId]::MagicDefense = 22
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A hood woven from threads of pure shadow.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEKingHelm : BEHelmet {
    BEKingHelm() : base() {
        $this.Name               = 'King Helm'
        $this.MapObjName         = 'kinghelm'
        $this.PurchasePrice      = 4000
        $this.SellPrice          = 2000
        $this.TargetStats        = @{
            [StatId]::Defense = 55
            [StatId]::MagicDefense = 15
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 38
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A majestic helm fit for a king.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEStarweaveCirclet : BEHelmet {
    BEStarweaveCirclet() : base() {
        $this.Name               = 'Starweave Circlet'
        $this.MapObjName         = 'starweavecirclet'
        $this.PurchasePrice      = 4500
        $this.SellPrice          = 2250
        $this.TargetStats        = @{
            [StatId]::Defense = 15
            [StatId]::MagicDefense = 55
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 15
            [StatId]::MagicDefense = 28
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A circlet woven from starlight, granting celestial protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEChaosHelm : BEHelmet {
    BEChaosHelm() : base() {
        $this.Name               = 'Chaos Helm'
        $this.MapObjName         = 'chaoshelm'
        $this.PurchasePrice      = 5000
        $this.SellPrice          = 2500
        $this.TargetStats        = @{
            [StatId]::Defense = 60
            [StatId]::MagicDefense = 20
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 40
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm pulsating with chaotic energy.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEHolyHood : BEHelmet {
    BEHolyHood() : base() {
        $this.Name               = 'Holy Hood'
        $this.MapObjName         = 'holyhood'
        $this.PurchasePrice      = 4800
        $this.SellPrice          = 2400
        $this.TargetStats        = @{
            [StatId]::Defense = 18
            [StatId]::MagicDefense = 50
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 18
            [StatId]::MagicDefense = 25
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A hood blessed with divine protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEAncientHelm : BEHelmet {
    BEAncientHelm() : base() {
        $this.Name               = 'Ancient Helm'
        $this.MapObjName         = 'ancienthelm'
        $this.PurchasePrice      = 6000
        $this.SellPrice          = 3000
        $this.TargetStats        = @{
            [StatId]::Defense = 65
            [StatId]::MagicDefense = 25
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 45
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm from a forgotten era, surprisingly durable.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEArcaneCirclet : BEHelmet {
    BEArcaneCirclet() : base() {
        $this.Name               = 'Arcane Circlet'
        $this.MapObjName         = 'arcanecirclet'
        $this.PurchasePrice      = 6500
        $this.SellPrice          = 3250
        $this.TargetStats        = @{
            [StatId]::Defense = 20
            [StatId]::MagicDefense = 60
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 20
            [StatId]::MagicDefense = 30
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A circlet humming with raw arcane power.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEBarbarianHelm : BEHelmet {
    BEBarbarianHelm() : base() {
        $this.Name               = 'Barbarian Helm'
        $this.MapObjName         = 'barbarianhelm'
        $this.PurchasePrice      = 7000
        $this.SellPrice          = 3500
        $this.TargetStats        = @{
            [StatId]::Defense = 70
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 50
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A brutal-looking helm, favored by fierce warriors.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEWitchHood : BEHelmet {
    BEWitchHood() : base() {
        $this.Name               = 'Witch Hood'
        $this.MapObjName         = 'witchhood'
        $this.PurchasePrice      = 6800
        $this.SellPrice          = 3400
        $this.TargetStats        = @{
            [StatId]::Defense = 15
            [StatId]::MagicDefense = 65
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 15
            [StatId]::MagicDefense = 32
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A dark hood often worn by witches.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGuardianHelm : BEHelmet {
    BEGuardianHelm() : base() {
        $this.Name               = 'Guardian Helm'
        $this.MapObjName         = 'guardianhelm'
        $this.PurchasePrice      = 8000
        $this.SellPrice          = 4000
        $this.TargetStats        = @{
            [StatId]::Defense = 75
            [StatId]::MagicDefense = 30
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 55
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm worn by protectors, radiating a sense of safety.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEProphetCirclet : BEHelmet {
    BEProphetCirclet() : base() {
        $this.Name               = 'Prophet Circlet'
        $this.MapObjName         = 'prophetcirclet'
        $this.PurchasePrice      = 8500
        $this.SellPrice          = 4250
        $this.TargetStats        = @{
            [StatId]::Defense = 25
            [StatId]::MagicDefense = 70
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 25
            [StatId]::MagicDefense = 35
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A circlet said to grant glimpses of the future.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEWarLordHelm : BEHelmet {
    BEWarLordHelm() : base() {
        $this.Name               = 'War Lord Helm'
        $this.MapObjName         = 'warlordhelm'
        $this.PurchasePrice      = 9000
        $this.SellPrice          = 4500
        $this.TargetStats        = @{
            [StatId]::Defense = 80
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 60
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A fearsome helm worn by great war leaders.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEWraithHood : BEHelmet {
    BEWraithHood() : base() {
        $this.Name               = 'Wraith Hood'
        $this.MapObjName         = 'wraithhood'
        $this.PurchasePrice      = 8800
        $this.SellPrice          = 4400
        $this.TargetStats        = @{
            [StatId]::Defense = 22
            [StatId]::MagicDefense = 75
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 22
            [StatId]::MagicDefense = 38
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A spectral hood that seems to drain the warmth from the air.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEChampionHelm : BEHelmet {
    BEChampionHelm() : base() {
        $this.Name               = 'Champion Helm'
        $this.MapObjName         = 'championhelm'
        $this.PurchasePrice      = 10000
        $this.SellPrice          = 5000
        $this.TargetStats        = @{
            [StatId]::Defense = 85
            [StatId]::MagicDefense = 35
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 65
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm worn by undefeated champions.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BECelestialCirclet : BEHelmet {
    BECelestialCirclet() : base() {
        $this.Name               = 'Celestial Circlet'
        $this.MapObjName         = 'celestialcirclet'
        $this.PurchasePrice      = 11000
        $this.SellPrice          = 5500
        $this.TargetStats        = @{
            [StatId]::Defense = 30
            [StatId]::MagicDefense = 80
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 30
            [StatId]::MagicDefense = 40
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A circlet blessed by celestial beings.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEDoomHelm : BEHelmet {
    BEDoomHelm() : base() {
        $this.Name               = 'Doom Helm'
        $this.MapObjName         = 'doomhelm'
        $this.PurchasePrice      = 12000
        $this.SellPrice          = 6000
        $this.TargetStats        = @{
            [StatId]::Defense = 90
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 70
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A cursed helm that brings despair to enemies.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEVampireHood : BEHelmet {
    BEVampireHood() : base() {
        $this.Name               = 'Vampire Hood'
        $this.MapObjName         = 'vampirehood'
        $this.PurchasePrice      = 11500
        $this.SellPrice          = 5750
        $this.TargetStats        = @{
            [StatId]::Defense = 28
            [StatId]::MagicDefense = 85
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 28
            [StatId]::MagicDefense = 42
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A hood favored by vampires, offering protection against holy magic.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGladiatorHelm : BEHelmet {
    BEGladiatorHelm() : base() {
        $this.Name               = 'Gladiator Helm'
        $this.MapObjName         = 'gladiatorhelm'
        $this.PurchasePrice      = 13000
        $this.SellPrice          = 6500
        $this.TargetStats        = @{
            [StatId]::Defense = 95
            [StatId]::MagicDefense = 40
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 75
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm worn by gladiators, scarred from countless battles.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGrandmasterCirclet : BEHelmet {
    BEGrandmasterCirclet() : base() {
        $this.Name               = 'Grandmaster Circlet'
        $this.MapObjName         = 'grandmastercirclet'
        $this.PurchasePrice      = 14000
        $this.SellPrice          = 7000
        $this.TargetStats        = @{
            [StatId]::Defense = 35
            [StatId]::MagicDefense = 90
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 35
            [StatId]::MagicDefense = 45
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A circlet worn by the most powerful magic users.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEImperialHelm : BEHelmet {
    BEImperialHelm() : base() {
        $this.Name               = 'Imperial Helm'
        $this.MapObjName         = 'imperialhelm'
        $this.PurchasePrice      = 15000
        $this.SellPrice          = 7500
        $this.TargetStats        = @{
            [StatId]::Defense = 100
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 80
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm worn by the emperor''s elite guard.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BESorcererHood : BEHelmet {
    BESorcererHood() : base() {
        $this.Name               = 'Sorcerer Hood'
        $this.MapObjName         = 'sorcererhood'
        $this.PurchasePrice      = 14500
        $this.SellPrice          = 7250
        $this.TargetStats        = @{
            [StatId]::Defense = 32
            [StatId]::MagicDefense = 95
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 32
            [StatId]::MagicDefense = 48
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A hood that enhances magical abilities.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEAbyssalHelm : BEHelmet {
    BEAbyssalHelm() : base() {
        $this.Name               = 'Abyssal Helm'
        $this.MapObjName         = 'abyssalhelm'
        $this.PurchasePrice      = 16000
        $this.SellPrice          = 8000
        $this.TargetStats        = @{
            [StatId]::Defense = 105
            [StatId]::MagicDefense = 45
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 85
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm forged in the depths of the abyss.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEArchdruidCirclet : BEHelmet {
    BEArchdruidCirclet() : base() {
        $this.Name               = 'Archdruid Circlet'
        $this.MapObjName         = 'archdruidcirclet'
        $this.PurchasePrice      = 17000
        $this.SellPrice          = 8500
        $this.TargetStats        = @{
            [StatId]::Defense = 40
            [StatId]::MagicDefense = 100
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 40
            [StatId]::MagicDefense = 50
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A circlet woven from living vines, connected to nature''s power.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEBloodHelm : BEHelmet {
    BEBloodHelm() : base() {
        $this.Name               = 'Blood Helm'
        $this.MapObjName         = 'bloodhelm'
        $this.PurchasePrice      = 18000
        $this.SellPrice          = 9000
        $this.TargetStats        = @{
            [StatId]::Defense = 110
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 90
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm stained crimson, said to be quenched in blood.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEFrostweaveHood : BEHelmet {
    BEFrostweaveHood() : base() {
        $this.Name               = 'Frostweave Hood'
        $this.MapObjName         = 'frostweavehood'
        $this.PurchasePrice      = 17500
        $this.SellPrice          = 8750
        $this.TargetStats        = @{
            [StatId]::Defense = 38
            [StatId]::MagicDefense = 105
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 38
            [StatId]::MagicDefense = 52
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A hood woven from icy threads, offering protection against fire.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEThunderHelm : BEHelmet {
    BEThunderHelm() : base() {
        $this.Name               = 'Thunder Helm'
        $this.MapObjName         = 'thunderhelm'
        $this.PurchasePrice      = 19000
        $this.SellPrice          = 9500
        $this.TargetStats        = @{
            [StatId]::Defense = 115
            [StatId]::MagicDefense = 50
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 95
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm crackling with electrical energy.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEVoidCirclet : BEHelmet {
    BEVoidCirclet() : base() {
        $this.Name               = 'Void Circlet'
        $this.MapObjName         = 'voidcirclet'
        $this.PurchasePrice      = 20000
        $this.SellPrice          = 10000
        $this.TargetStats        = @{
            [StatId]::Defense = 45
            [StatId]::MagicDefense = 110
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 45
            [StatId]::MagicDefense = 55
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A circlet that seems to absorb all light around it.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEInfernoHelm : BEHelmet {
    BEInfernoHelm() : base() {
        $this.Name               = 'Inferno Helm'
        $this.MapObjName         = 'infernohelm'
        $this.PurchasePrice      = 21000
        $this.SellPrice          = 10500
        $this.TargetStats        = @{
            [StatId]::Defense = 120
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 100
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm radiating intense heat.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEStormcallerHood : BEHelmet {
    BEStormcallerHood() : base() {
        $this.Name               = 'Stormcaller Hood'
        $this.MapObjName         = 'stormcallerhood'
        $this.PurchasePrice      = 20500
        $this.SellPrice          = 10250
        $this.TargetStats        = @{
            [StatId]::Defense = 42
            [StatId]::MagicDefense = 115
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 42
            [StatId]::MagicDefense = 58
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A hood that seems to whisper with the sound of wind and rain.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEAdamantHelm : BEHelmet {
    BEAdamantHelm() : base() {
        $this.Name               = 'Adamant Helm'
        $this.MapObjName         = 'adamanthelm'
        $this.PurchasePrice      = 22000
        $this.SellPrice          = 11000
        $this.TargetStats        = @{
            [StatId]::Defense = 125
            [StatId]::MagicDefense = 55
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 105
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm forged from nearly unbreakable adamant.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEDivineCirclet : BEHelmet {
    BEDivineCirclet() : base() {
        $this.Name               = 'Divine Circlet'
        $this.MapObjName         = 'divinecirclet'
        $this.PurchasePrice      = 23000
        $this.SellPrice          = 11500
        $this.TargetStats        = @{
            [StatId]::Defense = 50
            [StatId]::MagicDefense = 120
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 50
            [StatId]::MagicDefense = 60
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A circlet radiating holy light.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEWarlordPlate : BEHelmet {
    BEWarlordPlate() : base() {
        $this.Name               = 'Warlord Plate'
        $this.MapObjName         = 'warlordplate'
        $this.PurchasePrice      = 24000
        $this.SellPrice          = 12000
        $this.TargetStats        = @{
            [StatId]::Defense = 130
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 110
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Heavy plate armor for the head, designed for maximum defense.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEAbjurationHood : BEHelmet {
    BEAbjurationHood() : base() {
        $this.Name               = 'Abjuration Hood'
        $this.MapObjName         = 'abjurationhood'
        $this.PurchasePrice      = 23500
        $this.SellPrice          = 11750
        $this.TargetStats        = @{
            [StatId]::Defense = 48
            [StatId]::MagicDefense = 125
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 48
            [StatId]::MagicDefense = 62
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A hood enchanted to ward off magical attacks.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEChaosPlate : BEHelmet {
    BEChaosPlate() : base() {
        $this.Name               = 'Chaos Plate'
        $this.MapObjName         = 'chaosplate'
        $this.PurchasePrice      = 25000
        $this.SellPrice          = 12500
        $this.TargetStats        = @{
            [StatId]::Defense = 135
            [StatId]::MagicDefense = 60
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 115
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Plate armor infused with chaotic power.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEArchonCirclet : BEHelmet {
    BEArchonCirclet() : base() {
        $this.Name               = 'Archon Circlet'
        $this.MapObjName         = 'archoncirclet'
        $this.PurchasePrice      = 26000
        $this.SellPrice          = 13000
        $this.TargetStats        = @{
            [StatId]::Defense = 55
            [StatId]::MagicDefense = 130
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 55
            [StatId]::MagicDefense = 65
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A circlet of immense power, once worn by an archon.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEDragonboneHelm : BEHelmet {
    BEDragonboneHelm() : base() {
        $this.Name               = 'Dragonbone Helm'
        $this.MapObjName         = 'dragonbonehelm'
        $this.PurchasePrice      = 27000
        $this.SellPrice          = 13500
        $this.TargetStats        = @{
            [StatId]::Defense = 140
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 120
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm crafted from the bones of a dragon.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEFrostbiteHood : BEHelmet {
    BEFrostbiteHood() : base() {
        $this.Name               = 'Frostbite Hood'
        $this.MapObjName         = 'frostbitehood'
        $this.PurchasePrice      = 26500
        $this.SellPrice          = 13250
        $this.TargetStats        = @{
            [StatId]::Defense = 52
            [StatId]::MagicDefense = 135
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 52
            [StatId]::MagicDefense = 68
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A hood that emanates a chilling aura.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEThunderclapHelm : BEHelmet {
    BEThunderclapHelm() : base() {
        $this.Name               = 'Thunderclap Helm'
        $this.MapObjName         = 'thunderclaphelm'
        $this.PurchasePrice      = 28000
        $this.SellPrice          = 14000
        $this.TargetStats        = @{
            [StatId]::Defense = 145
            [StatId]::MagicDefense = 65
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 125
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm that resonates with the power of a thunderstorm.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEAstralCirclet : BEHelmet {
    BEAstralCirclet() : base() {
        $this.Name               = 'Astral Circlet'
        $this.MapObjName         = 'astralcirclet'
        $this.PurchasePrice      = 29000
        $this.SellPrice          = 14500
        $this.TargetStats        = @{
            [StatId]::Defense = 60
            [StatId]::MagicDefense = 140
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 60
            [StatId]::MagicDefense = 70
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A circlet that seems to hold the essence of the stars.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEInfernalHelm : BEHelmet {
    BEInfernalHelm() : base() {
        $this.Name               = 'Infernal Helm'
        $this.MapObjName         = 'infernalhelm'
        $this.PurchasePrice      = 30000
        $this.SellPrice          = 15000
        $this.TargetStats        = @{
            [StatId]::Defense = 150
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 130
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm forged in the deepest pits of the inferno.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEZephyrHood : BEHelmet {
    BEZephyrHood() : base() {
        $this.Name               = 'Zephyr Hood'
        $this.MapObjName         = 'zephyrhood'
        $this.PurchasePrice      = 29500
        $this.SellPrice          = 14750
        $this.TargetStats        = @{
            [StatId]::Defense = 58
            [StatId]::MagicDefense = 145
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 58
            [StatId]::MagicDefense = 72
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A hood as light as air, offering swift protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEVanguardHelm : BEHelmet {
    BEVanguardHelm() : base() {
        $this.Name               = 'Vanguard Helm'
        $this.MapObjName         = 'vanguardhelm'
        $this.PurchasePrice      = 31000
        $this.SellPrice          = 15500
        $this.TargetStats        = @{
            [StatId]::Defense = 155
            [StatId]::MagicDefense = 70
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 135
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm worn by the leaders of the vanguard.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEOracleCirclet : BEHelmet {
    BEOracleCirclet() : base() {
        $this.Name               = 'Oracle Circlet'
        $this.MapObjName         = 'oraclecirclet'
        $this.PurchasePrice      = 32000
        $this.SellPrice          = 16000
        $this.TargetStats        = @{
            [StatId]::Defense = 65
            [StatId]::MagicDefense = 150
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 65
            [StatId]::MagicDefense = 75
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A circlet that hums with prophetic visions.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEColossusHelm : BEHelmet {
    BEColossusHelm() : base() {
        $this.Name               = 'Colossus Helm'
        $this.MapObjName         = 'colossushelm'
        $this.PurchasePrice      = 33000
        $this.SellPrice          = 16500
        $this.TargetStats        = @{
            [StatId]::Defense = 160
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 140
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm of immense size and strength.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEWhisperwindHood : BEHelmet {
    BEWhisperwindHood() : base() {
        $this.Name               = 'Whisperwind Hood'
        $this.MapObjName         = 'whisperwindhood'
        $this.PurchasePrice      = 32500
        $this.SellPrice          = 16250
        $this.TargetStats        = @{
            [StatId]::Defense = 62
            [StatId]::MagicDefense = 155
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 62
            [StatId]::MagicDefense = 78
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A hood that carries the whispers of the wind.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEBloodmoonHelm : BEHelmet {
    BEBloodmoonHelm() : base() {
        $this.Name               = 'Bloodmoon Helm'
        $this.MapObjName         = 'bloodmoonhelm'
        $this.PurchasePrice      = 34000
        $this.SellPrice          = 17000
        $this.TargetStats        = @{
            [StatId]::Defense = 165
            [StatId]::MagicDefense = 75
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 145
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm that glows faintly under the bloodmoon.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BESunstoneCirclet : BEHelmet {
    BESunstoneCirclet() : base() {
        $this.Name               = 'Sunstone Circlet'
        $this.MapObjName         = 'sunstonecirclet'
        $this.PurchasePrice      = 35000
        $this.SellPrice          = 17500
        $this.TargetStats        = @{
            [StatId]::Defense = 70
            [StatId]::MagicDefense = 160
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 70
            [StatId]::MagicDefense = 80
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A circlet embedded with a sunstone, radiating warmth and light.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEVoidwalkerHelm : BEHelmet {
    BEVoidwalkerHelm() : base() {
        $this.Name               = 'Voidwalker Helm'
        $this.MapObjName         = 'voidwalkerhelm'
        $this.PurchasePrice      = 36000
        $this.SellPrice          = 18000
        $this.TargetStats        = @{
            [StatId]::Defense = 170
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 150
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm that seems to phase in and out of reality.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEFrostlordHood : BEHelmet {
    BEFrostlordHood() : base() {
        $this.Name               = 'Frostlord Hood'
        $this.MapObjName         = 'frostlordhood'
        $this.PurchasePrice      = 35500
        $this.SellPrice          = 17750
        $this.TargetStats        = @{
            [StatId]::Defense = 68
            [StatId]::MagicDefense = 165
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 68
            [StatId]::MagicDefense = 82
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A hood fit for a lord of frost and ice.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEStormkingHelm : BEHelmet {
    BEStormkingHelm() : base() {
        $this.Name               = 'Stormking Helm'
        $this.MapObjName         = 'stormkinghelm'
        $this.PurchasePrice      = 37000
        $this.SellPrice          = 18500
        $this.TargetStats        = @{
            [StatId]::Defense = 175
            [StatId]::MagicDefense = 80
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 155
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm that commands the very storms.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEStarlightCirclet : BEHelmet {
    BEStarlightCirclet() : base() {
        $this.Name               = 'Starlight Circlet'
        $this.MapObjName         = 'starlightcirclet'
        $this.PurchasePrice      = 38000
        $this.SellPrice          = 19000
        $this.TargetStats        = @{
            [StatId]::Defense = 75
            [StatId]::MagicDefense = 170
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 75
            [StatId]::MagicDefense = 85
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A circlet that captures the light of distant stars.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEHellfireHelm : BEHelmet {
    BEHellfireHelm() : base() {
        $this.Name               = 'Hellfire Helm'
        $this.MapObjName         = 'hellfirehelm'
        $this.PurchasePrice      = 39000
        $this.SellPrice          = 19500
        $this.TargetStats        = @{
            [StatId]::Defense = 180
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 160
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm burning with the fires of hell.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEWindrunnerHood : BEHelmet {
    BEWindrunnerHood() : base() {
        $this.Name               = 'Windrunner Hood'
        $this.MapObjName         = 'windrunnerhood'
        $this.PurchasePrice      = 38500
        $this.SellPrice          = 19250
        $this.TargetStats        = @{
            [StatId]::Defense = 72
            [StatId]::MagicDefense = 175
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 72
            [StatId]::MagicDefense = 88
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A hood that grants the wearer incredible speed.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEImmortalHelm : BEHelmet {
    BEImmortalHelm() : base() {
        $this.Name               = 'Immortal Helm'
        $this.MapObjName         = 'immortalhelm'
        $this.PurchasePrice      = 40000
        $this.SellPrice          = 20000
        $this.TargetStats        = @{
            [StatId]::Defense = 185
            [StatId]::MagicDefense = 85
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 165
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm said to grant immortality to its wearer.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BECosmicCirclet : BEHelmet {
    BECosmicCirclet() : base() {
        $this.Name               = 'Cosmic Circlet'
        $this.MapObjName         = 'cosmiccirclet'
        $this.PurchasePrice      = 41000
        $this.SellPrice          = 20500
        $this.TargetStats        = @{
            [StatId]::Defense = 80
            [StatId]::MagicDefense = 180
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 80
            [StatId]::MagicDefense = 90
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A circlet that hums with the energy of the cosmos.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEApocalypseHelm : BEHelmet {
    BEApocalypseHelm() : base() {
        $this.Name               = 'Apocalypse Helm'
        $this.MapObjName         = 'apocalypsehelm'
        $this.PurchasePrice      = 42000
        $this.SellPrice          = 21000
        $this.TargetStats        = @{
            [StatId]::Defense = 190
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 170
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm foretelling the end times.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEAbyssalHood : BEHelmet {
    BEAbyssalHood() : base() {
        $this.Name               = 'Abyssal Hood'
        $this.MapObjName         = 'abyssalhood'
        $this.PurchasePrice      = 41500
        $this.SellPrice          = 20750
        $this.TargetStats        = @{
            [StatId]::Defense = 78
            [StatId]::MagicDefense = 185
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 78
            [StatId]::MagicDefense = 92
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A hood that whispers secrets from the abyss.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEHeavenlyHelm : BEHelmet {
    BEHeavenlyHelm() : base() {
        $this.Name               = 'Heavenly Helm'
        $this.MapObjName         = 'heavenlyhelm'
        $this.PurchasePrice      = 43000
        $this.SellPrice          = 21500
        $this.TargetStats        = @{
            [StatId]::Defense = 195
            [StatId]::MagicDefense = 90
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 175
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm blessed by the heavens.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEArchangelCirclet : BEHelmet {
    BEArchangelCirclet() : base() {
        $this.Name               = 'Archangel Circlet'
        $this.MapObjName         = 'archangelcirclet'
        $this.PurchasePrice      = 44000
        $this.SellPrice          = 22000
        $this.TargetStats        = @{
            [StatId]::Defense = 85
            [StatId]::MagicDefense = 190
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 85
            [StatId]::MagicDefense = 95
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A circlet radiating the power of an archangel.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEWorldbreakerHelm : BEHelmet {
    BEWorldbreakerHelm() : base() {
        $this.Name               = 'Worldbreaker Helm'
        $this.MapObjName         = 'worldbreakerhelm'
        $this.PurchasePrice      = 45000
        $this.SellPrice          = 22500
        $this.TargetStats        = @{
            [StatId]::Defense = 200
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 180
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm said to be capable of shattering worlds.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEStarfallHood : BEHelmet {
    BEStarfallHood() : base() {
        $this.Name               = 'Starfall Hood'
        $this.MapObjName         = 'starfallhood'
        $this.PurchasePrice      = 44500
        $this.SellPrice          = 22250
        $this.TargetStats        = @{
            [StatId]::Defense = 82
            [StatId]::MagicDefense = 195
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 82
            [StatId]::MagicDefense = 98
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A hood that seems to draw power from falling stars.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGodkingHelm : BEHelmet {
    BEGodkingHelm() : base() {
        $this.Name               = 'Godking Helm'
        $this.MapObjName         = 'godkinghelm'
        $this.PurchasePrice      = 46000
        $this.SellPrice          = 23000
        $this.TargetStats        = @{
            [StatId]::Defense = 205
            [StatId]::MagicDefense = 95
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 185
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm fit for a god-king.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BECreatorCirclet : BEHelmet {
    BECreatorCirclet() : base() {
        $this.Name               = 'Creator Circlet'
        $this.MapObjName         = 'creatorcirclet'
        $this.PurchasePrice      = 47000
        $this.SellPrice          = 23500
        $this.TargetStats        = @{
            [StatId]::Defense = 90
            [StatId]::MagicDefense = 200
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 90
            [StatId]::MagicDefense = 100
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A circlet said to hold the power of creation.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEVoidheartHelm : BEHelmet {
    BEVoidheartHelm() : base() {
        $this.Name               = 'Voidheart Helm'
        $this.MapObjName         = 'voidhearthelm'
        $this.PurchasePrice      = 48000
        $this.SellPrice          = 24000
        $this.TargetStats        = @{
            [StatId]::Defense = 210
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 190
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm that seems to draw power from the void itself.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEFrostfireHood : BEHelmet {
    BEFrostfireHood() : base() {
        $this.Name               = 'Frostfire Hood'
        $this.MapObjName         = 'frostfirehood'
        $this.PurchasePrice      = 47500
        $this.SellPrice          = 23750
        $this.TargetStats        = @{
            [StatId]::Defense = 88
            [StatId]::MagicDefense = 205
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 88
            [StatId]::MagicDefense = 102
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A hood that crackles with both frost and fire.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEThunderstrikeHelm : BEHelmet {
    BEThunderstrikeHelm() : base() {
        $this.Name               = 'Thunderstrike Helm'
        $this.MapObjName         = 'thunderstrikehelm'
        $this.PurchasePrice      = 49000
        $this.SellPrice          = 24500
        $this.TargetStats        = @{
            [StatId]::Defense = 215
            [StatId]::MagicDefense = 100
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 195
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm that calls down lightning upon enemies.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEWorldshaperCirclet : BEHelmet {
    BEWorldshaperCirclet() : base() {
        $this.Name               = 'Worldshaper Circlet'
        $this.MapObjName         = 'worldshapercirclet'
        $this.PurchasePrice      = 50000
        $this.SellPrice          = 25000
        $this.TargetStats        = @{
            [StatId]::Defense = 95
            [StatId]::MagicDefense = 210
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 95
            [StatId]::MagicDefense = 105
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A circlet said to have shaped the world itself.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEAbyssalPlate : BEHelmet {
    BEAbyssalPlate() : base() {
        $this.Name               = 'Abyssal Plate'
        $this.MapObjName         = 'abyssalplate'
        $this.PurchasePrice      = 51000
        $this.SellPrice          = 25500
        $this.TargetStats        = @{
            [StatId]::Defense = 220
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 200
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Plate armor from the deepest abyss, cold and dark.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEStarcallerHood : BEHelmet {
    BEStarcallerHood() : base() {
        $this.Name               = 'Starcaller Hood'
        $this.MapObjName         = 'starcallerhood'
        $this.PurchasePrice      = 50500
        $this.SellPrice          = 25250
        $this.TargetStats        = @{
            [StatId]::Defense = 92
            [StatId]::MagicDefense = 215
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 92
            [StatId]::MagicDefense = 108
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A hood that allows the wearer to call upon the power of stars.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGodslayerHelm : BEHelmet {
    BEGodslayerHelm() : base() {
        $this.Name               = 'Godslayer Helm'
        $this.MapObjName         = 'godslayerhelm'
        $this.PurchasePrice      = 52000
        $this.SellPrice          = 26000
        $this.TargetStats        = @{
            [StatId]::Defense = 225
            [StatId]::MagicDefense = 105
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 205
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm worn by those who dare challenge deities.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEUniverseCirclet : BEHelmet {
    BEUniverseCirclet() : base() {
        $this.Name               = 'Universe Circlet'
        $this.MapObjName         = 'universecirclet'
        $this.PurchasePrice      = 53000
        $this.SellPrice          = 26500
        $this.TargetStats        = @{
            [StatId]::Defense = 100
            [StatId]::MagicDefense = 220
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 100
            [StatId]::MagicDefense = 110
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A circlet containing a miniature universe within.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEChaosLordHelm : BEHelmet {
    BEChaosLordHelm() : base() {
        $this.Name               = 'Chaos Lord Helm'
        $this.MapObjName         = 'chaoslordhelm'
        $this.PurchasePrice      = 54000
        $this.SellPrice          = 27000
        $this.TargetStats        = @{
            [StatId]::Defense = 230
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 210
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm fit for a lord of chaos.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEFrostmourneHood : BEHelmet {
    BEFrostmourneHood() : base() {
        $this.Name               = 'Frostmourne Hood'
        $this.MapObjName         = 'frostmournehood'
        $this.PurchasePrice      = 53500
        $this.SellPrice          = 26750
        $this.TargetStats        = @{
            [StatId]::Defense = 98
            [StatId]::MagicDefense = 225
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 98
            [StatId]::MagicDefense = 112
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A hood as cold as death itself.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEThundergodHelm : BEHelmet {
    BEThundergodHelm() : base() {
        $this.Name               = 'Thundergod Helm'
        $this.MapObjName         = 'thundergodhelm'
        $this.PurchasePrice      = 55000
        $this.SellPrice          = 27500
        $this.TargetStats        = @{
            [StatId]::Defense = 235
            [StatId]::MagicDefense = 110
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 215
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm imbued with the power of a thunder god.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEVoidlordCirclet : BEHelmet {
    BEVoidlordCirclet() : base() {
        $this.Name               = 'Voidlord Circlet'
        $this.MapObjName         = 'voidlordcirclet'
        $this.PurchasePrice      = 56000
        $this.SellPrice          = 28000
        $this.TargetStats        = @{
            [StatId]::Defense = 105
            [StatId]::MagicDefense = 230
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 105
            [StatId]::MagicDefense = 115
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A circlet fit for a lord of the void.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEInfernalPlate : BEHelmet {
    BEInfernalPlate() : base() {
        $this.Name               = 'Infernal Plate'
        $this.MapObjName         = 'infernalplate'
        $this.PurchasePrice      = 57000
        $this.SellPrice          = 28500
        $this.TargetStats        = @{
            [StatId]::Defense = 240
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 220
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Plate armor burning with infernal energy.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEWindlordHood : BEHelmet {
    BEWindlordHood() : base() {
        $this.Name               = 'Windlord Hood'
        $this.MapObjName         = 'windlordhood'
        $this.PurchasePrice      = 56500
        $this.SellPrice          = 28250
        $this.TargetStats        = @{
            [StatId]::Defense = 102
            [StatId]::MagicDefense = 235
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 102
            [StatId]::MagicDefense = 118
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A hood fit for a lord of the winds.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEImmortalPlate : BEHelmet {
    BEImmortalPlate() : base() {
        $this.Name               = 'Immortal Plate'
        $this.MapObjName         = 'immortalplate'
        $this.PurchasePrice      = 58000
        $this.SellPrice          = 29000
        $this.TargetStats        = @{
            [StatId]::Defense = 245
            [StatId]::MagicDefense = 115
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 225
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Plate armor that seems impervious to damage.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BECosmicHood : BEHelmet {
    BECosmicHood() : base() {
        $this.Name               = 'Cosmic Hood'
        $this.MapObjName         = 'cosmichood'
        $this.PurchasePrice      = 58500
        $this.SellPrice          = 29250
        $this.TargetStats        = @{
            [StatId]::Defense = 108
            [StatId]::MagicDefense = 240
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 108
            [StatId]::MagicDefense = 120
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A hood woven from cosmic dust.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEApocalypsePlate : BEHelmet {
    BEApocalypsePlate() : base() {
        $this.Name               = 'Apocalypse Plate'
        $this.MapObjName         = 'apocalypseplate'
        $this.PurchasePrice      = 59000
        $this.SellPrice          = 29500
        $this.TargetStats        = @{
            [StatId]::Defense = 250
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 230
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Plate armor that heralds the apocalypse.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEHeavenlyHood : BEHelmet {
    BEHeavenlyHood() : base() {
        $this.Name               = 'Heavenly Hood'
        $this.MapObjName         = 'heavenlyhood'
        $this.PurchasePrice      = 59500
        $this.SellPrice          = 29750
        $this.TargetStats        = @{
            [StatId]::Defense = 112
            [StatId]::MagicDefense = 245
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 112
            [StatId]::MagicDefense = 122
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A hood woven from divine threads.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEArchangelHelm : BEHelmet {
    BEArchangelHelm() : base() {
        $this.Name               = 'Archangel Helm'
        $this.MapObjName         = 'archangelhelm'
        $this.PurchasePrice      = 60000
        $this.SellPrice          = 30000
        $this.TargetStats        = @{
            [StatId]::Defense = 255
            [StatId]::MagicDefense = 120
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 235
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm radiating the power of an archangel.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEWorldeaterHelm : BEHelmet {
    BEWorldeaterHelm() : base() {
        $this.Name               = 'Worldeater Helm'
        $this.MapObjName         = 'worldeaterhelm'
        $this.PurchasePrice      = 61000
        $this.SellPrice          = 30500
        $this.TargetStats        = @{
            [StatId]::Defense = 260
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 240
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm said to devour worlds.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEStarforgedCirclet : BEHelmet {
    BEStarforgedCirclet() : base() {
        $this.Name               = 'Starforged Circlet'
        $this.MapObjName         = 'starforgedcirclet'
        $this.PurchasePrice      = 61500
        $this.SellPrice          = 30750
        $this.TargetStats        = @{
            [StatId]::Defense = 118
            [StatId]::MagicDefense = 250
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 118
            [StatId]::MagicDefense = 125
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A circlet forged from the heart of a star.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGodkillerHelm : BEHelmet {
    BEGodkillerHelm() : base() {
        $this.Name               = 'Godkiller Helm'
        $this.MapObjName         = 'godkillerhelm'
        $this.PurchasePrice      = 62000
        $this.SellPrice          = 31000
        $this.TargetStats        = @{
            [StatId]::Defense = 265
            [StatId]::MagicDefense = 125
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 245
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm designed to slay gods.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEUniverseHood : BEHelmet {
    BEUniverseHood() : base() {
        $this.Name               = 'Universe Hood'
        $this.MapObjName         = 'universehood'
        $this.PurchasePrice      = 62500
        $this.SellPrice          = 31250
        $this.TargetStats        = @{
            [StatId]::Defense = 122
            [StatId]::MagicDefense = 255
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 122
            [StatId]::MagicDefense = 128
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A hood that seems to contain the vastness of the universe.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEChaosbringerHelm : BEHelmet {
    BEChaosbringerHelm() : base() {
        $this.Name               = 'Chaosbringer Helm'
        $this.MapObjName         = 'chaosbringerhelm'
        $this.PurchasePrice      = 63000
        $this.SellPrice          = 31500
        $this.TargetStats        = @{
            [StatId]::Defense = 270
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 250
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm that brings chaos wherever it goes.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEFrostfallHelm : BEHelmet {
    BEFrostfallHelm() : base() {
        $this.Name               = 'Frostfall Helm'
        $this.MapObjName         = 'frostfallhelm'
        $this.PurchasePrice      = 63500
        $this.SellPrice          = 31750
        $this.TargetStats        = @{
            [StatId]::Defense = 128
            [StatId]::MagicDefense = 260
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 128
            [StatId]::MagicDefense = 130
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm that brings the chill of winter.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEThunderstrikePlate : BEHelmet {
    BEThunderstrikePlate() : base() {
        $this.Name               = 'Thunderstrike Plate'
        $this.MapObjName         = 'thunderstrikeplate'
        $this.PurchasePrice      = 64000
        $this.SellPrice          = 32000
        $this.TargetStats        = @{
            [StatId]::Defense = 275
            [StatId]::MagicDefense = 130
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 255
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Plate armor that channels the power of thunder.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEWorldshaperHood : BEHelmet {
    BEWorldshaperHood() : base() {
        $this.Name               = 'Worldshaper Hood'
        $this.MapObjName         = 'worldshaperhood'
        $this.PurchasePrice      = 64500
        $this.SellPrice          = 32250
        $this.TargetStats        = @{
            [StatId]::Defense = 132
            [StatId]::MagicDefense = 265
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 132
            [StatId]::MagicDefense = 132
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A hood said to have been worn by those who shaped the world.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEAbyssalLordHelm : BEHelmet {
    BEAbyssalLordHelm() : base() {
        $this.Name               = 'Abyssal Lord Helm'
        $this.MapObjName         = 'abyssallordhelm'
        $this.PurchasePrice      = 65000
        $this.SellPrice          = 32500
        $this.TargetStats        = @{
            [StatId]::Defense = 280
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 260
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm fit for a lord of the abyss.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEStarcallerCirclet : BEHelmet {
    BEStarcallerCirclet() : base() {
        $this.Name               = 'Starcaller Circlet'
        $this.MapObjName         = 'starcallercirclet'
        $this.PurchasePrice      = 65500
        $this.SellPrice          = 32750
        $this.TargetStats        = @{
            [StatId]::Defense = 138
            [StatId]::MagicDefense = 270
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 138
            [StatId]::MagicDefense = 135
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A circlet that allows the wearer to call upon the power of stars.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGodkingPlate : BEHelmet {
    BEGodkingPlate() : base() {
        $this.Name               = 'Godking Plate'
        $this.MapObjName         = 'godkingplate'
        $this.PurchasePrice      = 66000
        $this.SellPrice          = 33000
        $this.TargetStats        = @{
            [StatId]::Defense = 285
            [StatId]::MagicDefense = 135
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 265
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Plate armor fit for a god-king.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BECreatorHood : BEHelmet {
    BECreatorHood() : base() {
        $this.Name               = 'Creator Hood'
        $this.MapObjName         = 'creatorhood'
        $this.PurchasePrice      = 66500
        $this.SellPrice          = 33250
        $this.TargetStats        = @{
            [StatId]::Defense = 142
            [StatId]::MagicDefense = 275
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 142
            [StatId]::MagicDefense = 138
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A hood woven from the threads of creation.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEVoidheartPlate : BEHelmet {
    BEVoidheartPlate() : base() {
        $this.Name               = 'Voidheart Plate'
        $this.MapObjName         = 'voidheartplate'
        $this.PurchasePrice      = 67000
        $this.SellPrice          = 33500
        $this.TargetStats        = @{
            [StatId]::Defense = 290
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 270
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Plate armor drawing power from the void.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEFrostfireHelm : BEHelmet {
    BEFrostfireHelm() : base() {
        $this.Name               = 'Frostfire Helm'
        $this.MapObjName         = 'frostfirehelm'
        $this.PurchasePrice      = 67500
        $this.SellPrice          = 33750
        $this.TargetStats        = @{
            [StatId]::Defense = 148
            [StatId]::MagicDefense = 280
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 148
            [StatId]::MagicDefense = 140
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm crackling with both frost and fire.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEThundergodPlate : BEHelmet {
    BEThundergodPlate() : base() {
        $this.Name               = 'Thundergod Plate'
        $this.MapObjName         = 'thundergodplate'
        $this.PurchasePrice      = 68000
        $this.SellPrice          = 34000
        $this.TargetStats        = @{
            [StatId]::Defense = 295
            [StatId]::MagicDefense = 140
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 275
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Plate armor imbued with the power of a thunder god.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEUniversePlate : BEHelmet {
    BEUniversePlate() : base() {
        $this.Name               = 'Universe Plate'
        $this.MapObjName         = 'universeplate'
        $this.PurchasePrice      = 68500
        $this.SellPrice          = 34250
        $this.TargetStats        = @{
            [StatId]::Defense = 152
            [StatId]::MagicDefense = 285
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 152
            [StatId]::MagicDefense = 142
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Plate armor containing a miniature universe within.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEApocalypseHood : BEHelmet {
    BEApocalypseHood() : base() {
        $this.Name               = 'Apocalypse Hood'
        $this.MapObjName         = 'apocalypsehood'
        $this.PurchasePrice      = 69000
        $this.SellPrice          = 34500
        $this.TargetStats        = @{
            [StatId]::Defense = 158
            [StatId]::MagicDefense = 290
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 158
            [StatId]::MagicDefense = 145
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A hood that whispers of the apocalypse.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEHeavenlyPlate : BEHelmet {
    BEHeavenlyPlate() : base() {
        $this.Name               = 'Heavenly Plate'
        $this.MapObjName         = 'heavenlyplate'
        $this.PurchasePrice      = 69500
        $this.SellPrice          = 34750
        $this.TargetStats        = @{
            [StatId]::Defense = 300
            [StatId]::MagicDefense = 145
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 280
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Plate armor blessed by the heavens.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEWorldeaterPlate : BEHelmet {
    BEWorldeaterPlate() : base() {
        $this.Name               = 'Worldeater Plate'
        $this.MapObjName         = 'worldeaterplate'
        $this.PurchasePrice      = 71000
        $this.SellPrice          = 35500
        $this.TargetStats        = @{
            [StatId]::Defense = 310
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 290
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Plate armor said to devour worlds.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEStarforgedHood : BEHelmet {
    BEStarforgedHood() : base() {
        $this.Name               = 'Starforged Hood'
        $this.MapObjName         = 'starforgedhood'
        $this.PurchasePrice      = 71500
        $this.SellPrice          = 35750
        $this.TargetStats        = @{
            [StatId]::Defense = 162
            [StatId]::MagicDefense = 295
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 162
            [StatId]::MagicDefense = 148
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A hood woven from the essence of stars.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGodkillerPlate : BEHelmet {
    BEGodkillerPlate() : base() {
        $this.Name               = 'Godkiller Plate'
        $this.MapObjName         = 'godkillerplate'
        $this.PurchasePrice      = 72000
        $this.SellPrice          = 36000
        $this.TargetStats        = @{
            [StatId]::Defense = 315
            [StatId]::MagicDefense = 155
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 295
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Plate armor designed to slay gods.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEUniverseHelm : BEHelmet {
    BEUniverseHelm() : base() {
        $this.Name               = 'Universe Helm'
        $this.MapObjName         = 'universehelm'
        $this.PurchasePrice      = 72500
        $this.SellPrice          = 36250
        $this.TargetStats        = @{
            [StatId]::Defense = 168
            [StatId]::MagicDefense = 300
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 168
            [StatId]::MagicDefense = 150
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A helm containing a miniature universe within.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEChaosbringerPlate : BEHelmet {
    BEChaosbringerPlate() : base() {
        $this.Name               = 'Chaosbringer Plate'
        $this.MapObjName         = 'chaosbringerplate'
        $this.PurchasePrice      = 73000
        $this.SellPrice          = 36500
        $this.TargetStats        = @{
            [StatId]::Defense = 320
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 300
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Plate armor that brings chaos wherever it goes.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEFrostfallHood : BEHelmet {
    BEFrostfallHood() : base() {
        $this.Name               = 'Frostfall Hood'
        $this.MapObjName         = 'frostfallhood'
        $this.PurchasePrice      = 73500
        $this.SellPrice          = 36750
        $this.TargetStats        = @{
            [StatId]::Defense = 172
            [StatId]::MagicDefense = 305
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 172
            [StatId]::MagicDefense = 152
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A hood that brings the chill of winter.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEThunderstrikeHelmII : BEHelmet {
    BEThunderstrikeHelmII() : base() {
        $this.Name               = 'Thunderstrike Helm II'
        $this.MapObjName         = 'thunderstrikehelmii'
        $this.PurchasePrice      = 74000
        $this.SellPrice          = 37000
        $this.TargetStats        = @{
            [StatId]::Defense = 325
            [StatId]::MagicDefense = 160
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 305
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An improved helm that calls down lightning upon enemies.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEWorldshaperCircletII : BEHelmet {
    BEWorldshaperCircletII() : base() {
        $this.Name               = 'Worldshaper Circlet II'
        $this.MapObjName         = 'worldshapercircletii'
        $this.PurchasePrice      = 74500
        $this.SellPrice          = 37250
        $this.TargetStats        = @{
            [StatId]::Defense = 178
            [StatId]::MagicDefense = 310
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 178
            [StatId]::MagicDefense = 155
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An improved circlet said to have shaped the world itself.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEAbyssalLordPlate : BEHelmet {
    BEAbyssalLordPlate() : base() {
        $this.Name               = 'Abyssal Lord Plate'
        $this.MapObjName         = 'abyssallordplate'
        $this.PurchasePrice      = 75000
        $this.SellPrice          = 37500
        $this.TargetStats        = @{
            [StatId]::Defense = 330
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 310
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Plate armor fit for a lord of the abyss.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEStarcallerHoodII : BEHelmet {
    BEStarcallerHoodII() : base() {
        $this.Name               = 'Starcaller Hood II'
        $this.MapObjName         = 'starcallerhoodii'
        $this.PurchasePrice      = 75500
        $this.SellPrice          = 37750
        $this.TargetStats        = @{
            [StatId]::Defense = 182
            [StatId]::MagicDefense = 315
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 182
            [StatId]::MagicDefense = 158
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An improved hood that allows the wearer to call upon the power of stars.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGodkingHelmII : BEHelmet {
    BEGodkingHelmII() : base() {
        $this.Name               = 'Godking Helm II'
        $this.MapObjName         = 'godkinghelmii'
        $this.PurchasePrice      = 76000
        $this.SellPrice          = 38000
        $this.TargetStats        = @{
            [StatId]::Defense = 335
            [StatId]::MagicDefense = 165
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 315
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An improved helm fit for a god-king.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BECreatorCircletII : BEHelmet {
    BECreatorCircletII() : base() {
        $this.Name               = 'Creator Circlet II'
        $this.MapObjName         = 'creatorcircletii'
        $this.PurchasePrice      = 76500
        $this.SellPrice          = 38250
        $this.TargetStats        = @{
            [StatId]::Defense = 188
            [StatId]::MagicDefense = 320
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 188
            [StatId]::MagicDefense = 160
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An improved circlet said to hold the power of creation.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEVoidheartHelmII : BEHelmet {
    BEVoidheartHelmII() : base() {
        $this.Name               = 'Voidheart Helm II'
        $this.MapObjName         = 'voidhearthelmii'
        $this.PurchasePrice      = 77000
        $this.SellPrice          = 38500
        $this.TargetStats        = @{
            [StatId]::Defense = 340
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 320
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An improved helm that seems to draw power from the void itself.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEFrostfireHoodII : BEHelmet {
    BEFrostfireHoodII() : base() {
        $this.Name               = 'Frostfire Hood II'
        $this.MapObjName         = 'frostfirehoodii'
        $this.PurchasePrice      = 77500
        $this.SellPrice          = 38750
        $this.TargetStats        = @{
            [StatId]::Defense = 192
            [StatId]::MagicDefense = 325
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 192
            [StatId]::MagicDefense = 162
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An improved hood that crackles with both frost and fire.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEThundergodHelmII : BEHelmet {
    BEThundergodHelmII() : base() {
        $this.Name               = 'Thundergod Helm II'
        $this.MapObjName         = 'thundergodhelmii'
        $this.PurchasePrice      = 78000
        $this.SellPrice          = 39000
        $this.TargetStats        = @{
            [StatId]::Defense = 345
            [StatId]::MagicDefense = 170
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 325
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An improved helm imbued with the power of a thunder god.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEUniverseCircletII : BEHelmet {
    BEUniverseCircletII() : base() {
        $this.Name               = 'Universe Circlet II'
        $this.MapObjName         = 'universecircletii'
        $this.PurchasePrice      = 78500
        $this.SellPrice          = 39250
        $this.TargetStats        = @{
            [StatId]::Defense = 198
            [StatId]::MagicDefense = 330
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 198
            [StatId]::MagicDefense = 165
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An improved circlet containing a miniature universe within.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEApocalypsePlateII : BEHelmet {
    BEApocalypsePlateII() : base() {
        $this.Name               = 'Apocalypse Plate II'
        $this.MapObjName         = 'apocalypseplateii'
        $this.PurchasePrice      = 79000
        $this.SellPrice          = 39500
        $this.TargetStats        = @{
            [StatId]::Defense = 350
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 330
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Improved plate armor that heralds the apocalypse.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEHeavenlyHoodII : BEHelmet {
    BEHeavenlyHoodII() : base() {
        $this.Name               = 'Heavenly Hood II'
        $this.MapObjName         = 'heavenlyhoodii'
        $this.PurchasePrice      = 79500
        $this.SellPrice          = 39750
        $this.TargetStats        = @{
            [StatId]::Defense = 202
            [StatId]::MagicDefense = 335
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 202
            [StatId]::MagicDefense = 168
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An improved hood woven from divine threads.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEArchangelHelmII : BEHelmet {
    BEArchangelHelmII() : base() {
        $this.Name               = 'Archangel Helm II'
        $this.MapObjName         = 'archangelhelmii'
        $this.PurchasePrice      = 80000
        $this.SellPrice          = 40000
        $this.TargetStats        = @{
            [StatId]::Defense = 355
            [StatId]::MagicDefense = 175
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 335
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An improved helm radiating the power of an archangel.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEWorldeaterHelmII : BEHelmet {
    BEWorldeaterHelmII() : base() {
        $this.Name               = 'Worldeater Helm II'
        $this.MapObjName         = 'worldeaterhelmii'
        $this.PurchasePrice      = 81000
        $this.SellPrice          = 40500
        $this.TargetStats        = @{
            [StatId]::Defense = 360
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 340
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An improved helm said to devour worlds.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEStarforgedCircletII : BEHelmet {
    BEStarforgedCircletII() : base() {
        $this.Name               = 'Starforged Circlet II'
        $this.MapObjName         = 'starforgedcircletii'
        $this.PurchasePrice      = 81500
        $this.SellPrice          = 40750
        $this.TargetStats        = @{
            [StatId]::Defense = 208
            [StatId]::MagicDefense = 340
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 208
            [StatId]::MagicDefense = 170
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An improved circlet forged from the heart of a star.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGodkillerHelmII : BEHelmet {
    BEGodkillerHelmII() : base() {
        $this.Name               = 'Godkiller Helm II'
        $this.MapObjName         = 'godkillerhelmii'
        $this.PurchasePrice      = 82000
        $this.SellPrice          = 41000
        $this.TargetStats        = @{
            [StatId]::Defense = 365
            [StatId]::MagicDefense = 180
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 345
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An improved helm designed to slay gods.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEUniverseHoodII : BEHelmet {
    BEUniverseHoodII() : base() {
        $this.Name               = 'Universe Hood II'
        $this.MapObjName         = 'universehoodii'
        $this.PurchasePrice      = 82500
        $this.SellPrice          = 41250
        $this.TargetStats        = @{
            [StatId]::Defense = 212
            [StatId]::MagicDefense = 345
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 212
            [StatId]::MagicDefense = 172
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An improved hood that seems to contain the vastness of the universe.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEChaosbringerHelmII : BEHelmet {
    BEChaosbringerHelmII() : base() {
        $this.Name               = 'Chaosbringer Helm II'
        $this.MapObjName         = 'chaosbringerhelmii'
        $this.PurchasePrice      = 83000
        $this.SellPrice          = 41500
        $this.TargetStats        = @{
            [StatId]::Defense = 370
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 350
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An improved helm that brings chaos wherever it goes.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEFrostfallHelmII : BEHelmet {
    BEFrostfallHelmII() : base() {
        $this.Name               = 'Frostfall Helm II'
        $this.MapObjName         = 'frostfallhelmii'
        $this.PurchasePrice      = 83500
        $this.SellPrice          = 41750
        $this.TargetStats        = @{
            [StatId]::Defense = 218
            [StatId]::MagicDefense = 350
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 218
            [StatId]::MagicDefense = 175
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An improved helm that brings the chill of winter.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEThunderstrikePlateII : BEHelmet {
    BEThunderstrikePlateII() : base() {
        $this.Name               = 'Thunderstrike Plate II'
        $this.MapObjName         = 'thunderstrikeplateii'
        $this.PurchasePrice      = 84000
        $this.SellPrice          = 42000
        $this.TargetStats        = @{
            [StatId]::Defense = 375
            [StatId]::MagicDefense = 185
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 355
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Improved plate armor that channels the power of thunder.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEWorldshaperHoodII : BEHelmet {
    BEWorldshaperHoodII() : base() {
        $this.Name               = 'Worldshaper Hood II'
        $this.MapObjName         = 'worldshaperhoodii'
        $this.PurchasePrice      = 84500
        $this.SellPrice          = 42250
        $this.TargetStats        = @{
            [StatId]::Defense = 222
            [StatId]::MagicDefense = 355
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 222
            [StatId]::MagicDefense = 178
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An improved hood said to have been worn by those who shaped the world.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEAbyssalLordHelmII : BEHelmet {
    BEAbyssalLordHelmII() : base() {
        $this.Name               = 'Abyssal Lord Helm II'
        $this.MapObjName         = 'abyssallordhelmii'
        $this.PurchasePrice      = 85000
        $this.SellPrice          = 42500
        $this.TargetStats        = @{
            [StatId]::Defense = 380
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 360
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An improved helm fit for a lord of the abyss.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEStarcallerCircletII : BEHelmet {
    BEStarcallerCircletII() : base() {
        $this.Name               = 'Starcaller Circlet II'
        $this.MapObjName         = 'starcallercircletii'
        $this.PurchasePrice      = 85500
        $this.SellPrice          = 42750
        $this.TargetStats        = @{
            [StatId]::Defense = 228
            [StatId]::MagicDefense = 360
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 228
            [StatId]::MagicDefense = 180
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An improved circlet that allows the wearer to call upon the power of stars.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGodkingPlateII : BEHelmet {
    BEGodkingPlateII() : base() {
        $this.Name               = 'Godking Plate II'
        $this.MapObjName         = 'godkingplateii'
        $this.PurchasePrice      = 86000
        $this.SellPrice          = 43000
        $this.TargetStats        = @{
            [StatId]::Defense = 385
            [StatId]::MagicDefense = 190
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 365
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Improved plate armor fit for a god-king.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BECreatorHoodII : BEHelmet {
    BECreatorHoodII() : base() {
        $this.Name               = 'Creator Hood II'
        $this.MapObjName         = 'creatorhoodii'
        $this.PurchasePrice      = 86500
        $this.SellPrice          = 43250
        $this.TargetStats        = @{
            [StatId]::Defense = 232
            [StatId]::MagicDefense = 365
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 232
            [StatId]::MagicDefense = 182
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An improved hood woven from the threads of creation.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEVoidheartPlateII : BEHelmet {
    BEVoidheartPlateII() : base() {
        $this.Name               = 'Voidheart Plate II'
        $this.MapObjName         = 'voidheartplateii'
        $this.PurchasePrice      = 87000
        $this.SellPrice          = 43500
        $this.TargetStats        = @{
            [StatId]::Defense = 390
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 370
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Improved plate armor drawing power from the void.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEFrostfireHelmII : BEHelmet {
    BEFrostfireHelmII() : base() {
        $this.Name               = 'Frostfire Helm II'
        $this.MapObjName         = 'frostfirehelmii'
        $this.PurchasePrice      = 87500
        $this.SellPrice          = 43750
        $this.TargetStats        = @{
            [StatId]::Defense = 238
            [StatId]::MagicDefense = 370
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 238
            [StatId]::MagicDefense = 185
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An improved helm crackling with both frost and fire.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEThundergodPlateII : BEHelmet {
    BEThundergodPlateII() : base() {
        $this.Name               = 'Thundergod Plate II'
        $this.MapObjName         = 'thundergodplateii'
        $this.PurchasePrice      = 88000
        $this.SellPrice          = 44000
        $this.TargetStats        = @{
            [StatId]::Defense = 395
            [StatId]::MagicDefense = 195
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 375
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Improved plate armor imbued with the power of a thunder god.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEUniverseCircletIII : BEHelmet {
    BEUniverseCircletIII() : base() {
        $this.Name               = 'Universe Circlet III'
        $this.MapObjName         = 'universecircletiii'
        $this.PurchasePrice      = 88500
        $this.SellPrice          = 44250
        $this.TargetStats        = @{
            [StatId]::Defense = 242
            [StatId]::MagicDefense = 375
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 242
            [StatId]::MagicDefense = 188
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A greatly improved circlet containing a miniature universe within.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEApocalypseHoodII : BEHelmet {
    BEApocalypseHoodII() : base() {
        $this.Name               = 'Apocalypse Hood II'
        $this.MapObjName         = 'apocalypsehoodii'
        $this.PurchasePrice      = 89000
        $this.SellPrice          = 44500
        $this.TargetStats        = @{
            [StatId]::Defense = 248
            [StatId]::MagicDefense = 380
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 248
            [StatId]::MagicDefense = 190
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An improved hood that whispers of the apocalypse.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEHeavenlyPlateII : BEHelmet {
    BEHeavenlyPlateII() : base() {
        $this.Name               = 'Heavenly Plate II'
        $this.MapObjName         = 'heavenlyplateii'
        $this.PurchasePrice      = 89500
        $this.SellPrice          = 44750
        $this.TargetStats        = @{
            [StatId]::Defense = 400
            [StatId]::MagicDefense = 200
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 380
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Improved plate armor blessed by the heavens.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEArchangelHelmIII : BEHelmet {
    BEArchangelHelmIII() : base() {
        $this.Name               = 'Archangel Helm III'
        $this.MapObjName         = 'archangelhelm iii'
        $this.PurchasePrice      = 90000
        $this.SellPrice          = 45000
        $this.TargetStats        = @{
            [StatId]::Defense = 405
            [StatId]::MagicDefense = 205
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 385
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A greatly improved helm radiating the power of an archangel.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEWorldeaterHelmIII : BEHelmet {
    BEWorldeaterHelmIII() : base() {
        $this.Name               = 'Worldeater Helm III'
        $this.MapObjName         = 'worldeaterhelm iii'
        $this.PurchasePrice      = 91000
        $this.SellPrice          = 45500
        $this.TargetStats        = @{
            [StatId]::Defense = 410
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 390
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A greatly improved helm said to devour worlds.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEStarforgedCircletIII : BEHelmet {
    BEStarforgedCircletIII() : base() {
        $this.Name               = 'Starforged Circlet III'
        $this.MapObjName         = 'starforgedcirclet iii'
        $this.PurchasePrice      = 91500
        $this.SellPrice          = 45750
        $this.TargetStats        = @{
            [StatId]::Defense = 258
            [StatId]::MagicDefense = 385
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 258
            [StatId]::MagicDefense = 192
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A greatly improved circlet forged from the heart of a star.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGodkillerHelmIII : BEHelmet {
    BEGodkillerHelmIII() : base() {
        $this.Name               = 'Godkiller Helm III'
        $this.MapObjName         = 'godkillerhelm iii'
        $this.PurchasePrice      = 92000
        $this.SellPrice          = 46000
        $this.TargetStats        = @{
            [StatId]::Defense = 415
            [StatId]::MagicDefense = 210
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 395
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A greatly improved helm designed to slay gods.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEUniverseHoodIII : BEHelmet {
    BEUniverseHoodIII() : base() {
        $this.Name               = 'Universe Hood III'
        $this.MapObjName         = 'universehood iii'
        $this.PurchasePrice      = 92500
        $this.SellPrice          = 46250
        $this.TargetStats        = @{
            [StatId]::Defense = 262
            [StatId]::MagicDefense = 390
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 262
            [StatId]::MagicDefense = 195
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A greatly improved hood that seems to contain the vastness of the universe.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEChaosbringerHelmIII : BEHelmet {
    BEChaosbringerHelmIII() : base() {
        $this.Name               = 'Chaosbringer Helm III'
        $this.MapObjName         = 'chaosbringerhelm iii'
        $this.PurchasePrice      = 93000
        $this.SellPrice          = 46500
        $this.TargetStats        = @{
            [StatId]::Defense = 420
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 400
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A greatly improved helm that brings chaos wherever it goes.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEFrostfallHelmIII : BEHelmet {
    BEFrostfallHelmIII() : base() {
        $this.Name               = 'Frostfall Helm III'
        $this.MapObjName         = 'frostfallhelm iii'
        $this.PurchasePrice      = 93500
        $this.SellPrice          = 46750
        $this.TargetStats        = @{
            [StatId]::Defense = 268
            [StatId]::MagicDefense = 395
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 268
            [StatId]::MagicDefense = 198
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A greatly improved helm that brings the chill of winter.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEThunderstrikePlateIII : BEHelmet {
    BEThunderstrikePlateIII() : base() {
        $this.Name               = 'Thunderstrike Plate III'
        $this.MapObjName         = 'thunderstrikeplate iii'
        $this.PurchasePrice      = 94000
        $this.SellPrice          = 47000
        $this.TargetStats        = @{
            [StatId]::Defense = 425
            [StatId]::MagicDefense = 215
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 405
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Greatly improved plate armor that channels the power of thunder.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEWorldshaperHoodIII : BEHelmet {
    BEWorldshaperHoodIII() : base() {
        $this.Name               = 'Worldshaper Hood III'
        $this.MapObjName         = 'worldshaperhood iii'
        $this.PurchasePrice      = 94500
        $this.SellPrice          = 47250
        $this.TargetStats        = @{
            [StatId]::Defense = 272
            [StatId]::MagicDefense = 400
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 272
            [StatId]::MagicDefense = 200
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A greatly improved hood said to have been worn by those who shaped the world.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEAbyssalLordHelmIII : BEHelmet {
    BEAbyssalLordHelmIII() : base() {
        $this.Name               = 'Abyssal Lord Helm III'
        $this.MapObjName         = 'abyssallordhelm iii'
        $this.PurchasePrice      = 95000
        $this.SellPrice          = 47500
        $this.TargetStats        = @{
            [StatId]::Defense = 430
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 410
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A greatly improved helm fit for a lord of the abyss.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEStarcallerCircletIII : BEHelmet {
    BEStarcallerCircletIII() : base() {
        $this.Name               = 'Starcaller Circlet III'
        $this.MapObjName         = 'starcallercirclet iii'
        $this.PurchasePrice      = 95500
        $this.SellPrice          = 47750
        $this.TargetStats        = @{
            [StatId]::Defense = 278
            [StatId]::MagicDefense = 405
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 278
            [StatId]::MagicDefense = 202
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A greatly improved circlet that allows the wearer to call upon the power of stars.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGodkingPlateIII : BEHelmet {
    BEGodkingPlateIII() : base() {
        $this.Name               = 'Godking Plate III'
        $this.MapObjName         = 'godkingplate iii'
        $this.PurchasePrice      = 96000
        $this.SellPrice          = 48000
        $this.TargetStats        = @{
            [StatId]::Defense = 435
            [StatId]::MagicDefense = 220
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 415
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Greatly improved plate armor fit for a god-king.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BECreatorHoodIII : BEHelmet {
    BECreatorHoodIII() : base() {
        $this.Name               = 'Creator Hood III'
        $this.MapObjName         = 'creatorhood iii'
        $this.PurchasePrice      = 96500
        $this.SellPrice          = 48250
        $this.TargetStats        = @{
            [StatId]::Defense = 282
            [StatId]::MagicDefense = 410
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 282
            [StatId]::MagicDefense = 205
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A greatly improved hood woven from the threads of creation.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEVoidheartPlateIII : BEHelmet {
    BEVoidheartPlateIII() : base() {
        $this.Name               = 'Voidheart Plate III'
        $this.MapObjName         = 'voidheartplate iii'
        $this.PurchasePrice      = 97000
        $this.SellPrice          = 48500
        $this.TargetStats        = @{
            [StatId]::Defense = 440
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 420
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Greatly improved plate armor drawing power from the void.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEFrostfireHelmIII : BEHelmet {
    BEFrostfireHelmIII() : base() {
        $this.Name               = 'Frostfire Helm III'
        $this.MapObjName         = 'frostfirehelm iii'
        $this.PurchasePrice      = 97500
        $this.SellPrice          = 48750
        $this.TargetStats        = @{
            [StatId]::Defense = 288
            [StatId]::MagicDefense = 415
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 288
            [StatId]::MagicDefense = 208
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A greatly improved helm crackling with both frost and fire.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEThundergodPlateIII : BEHelmet {
    BEThundergodPlateIII() : base() {
        $this.Name               = 'Thundergod Plate III'
        $this.MapObjName         = 'thundergodplate iii'
        $this.PurchasePrice      = 98000
        $this.SellPrice          = 49000
        $this.TargetStats        = @{
            [StatId]::Defense = 445
            [StatId]::MagicDefense = 225
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 425
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Greatly improved plate armor imbued with the power of a thunder god.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEUniverseCircletIV : BEHelmet {
    BEUniverseCircletIV() : base() {
        $this.Name               = 'Universe Circlet IV'
        $this.MapObjName         = 'universecirclet iv'
        $this.PurchasePrice      = 98500
        $this.SellPrice          = 49250
        $this.TargetStats        = @{
            [StatId]::Defense = 292
            [StatId]::MagicDefense = 420
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 292
            [StatId]::MagicDefense = 210
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved circlet containing a miniature universe within.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEApocalypseHoodIII : BEHelmet {
    BEApocalypseHoodIII() : base() {
        $this.Name               = 'Apocalypse Hood III'
        $this.MapObjName         = 'apocalypsehood iii'
        $this.PurchasePrice      = 99000
        $this.SellPrice          = 49500
        $this.TargetStats        = @{
            [StatId]::Defense = 298
            [StatId]::MagicDefense = 425
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 298
            [StatId]::MagicDefense = 212
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A greatly improved hood that whispers of the apocalypse.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEHeavenlyPlateIII : BEHelmet {
    BEHeavenlyPlateIII() : base() {
        $this.Name               = 'Heavenly Plate III'
        $this.MapObjName         = 'heavenlyplate iii'
        $this.PurchasePrice      = 99500
        $this.SellPrice          = 49750
        $this.TargetStats        = @{
            [StatId]::Defense = 450
            [StatId]::MagicDefense = 230
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 430
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Greatly improved plate armor blessed by the heavens.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEArchangelHelmIV : BEHelmet {
    BEArchangelHelmIV() : base() {
        $this.Name               = 'Archangel Helm IV'
        $this.MapObjName         = 'archangelhelm iv'
        $this.PurchasePrice      = 100000
        $this.SellPrice          = 50000
        $this.TargetStats        = @{
            [StatId]::Defense = 455
            [StatId]::MagicDefense = 235
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 435
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved helm radiating the power of an archangel.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEWorldeaterHelmIV : BEHelmet {
    BEWorldeaterHelmIV() : base() {
        $this.Name               = 'Worldeater Helm IV'
        $this.MapObjName         = 'worldeaterhelm iv'
        $this.PurchasePrice      = 101000
        $this.SellPrice          = 50500
        $this.TargetStats        = @{
            [StatId]::Defense = 460
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 440
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved helm said to devour worlds.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEStarforgedCircletIV : BEHelmet {
    BEStarforgedCircletIV() : base() {
        $this.Name               = 'Starforged Circlet IV'
        $this.MapObjName         = 'starforgedcirclet iv'
        $this.PurchasePrice      = 101500
        $this.SellPrice          = 50750
        $this.TargetStats        = @{
            [StatId]::Defense = 308
            [StatId]::MagicDefense = 430
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 308
            [StatId]::MagicDefense = 215
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved circlet forged from the heart of a star.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGodkillerHelmIV : BEHelmet {
    BEGodkillerHelmIV() : base() {
        $this.Name               = 'Godkiller Helm IV'
        $this.MapObjName         = 'godkillerhelm iv'
        $this.PurchasePrice      = 102000
        $this.SellPrice          = 51000
        $this.TargetStats        = @{
            [StatId]::Defense = 465
            [StatId]::MagicDefense = 240
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 445
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved helm designed to slay gods.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEUniverseHoodIV : BEHelmet {
    BEUniverseHoodIV() : base() {
        $this.Name               = 'Universe Hood IV'
        $this.MapObjName         = 'universehood iv'
        $this.PurchasePrice      = 102500
        $this.SellPrice          = 51250
        $this.TargetStats        = @{
            [StatId]::Defense = 312
            [StatId]::MagicDefense = 435
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 312
            [StatId]::MagicDefense = 218
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved hood that seems to contain the vastness of the universe.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEChaosbringerHelmIV : BEHelmet {
    BEChaosbringerHelmIV() : base() {
        $this.Name               = 'Chaosbringer Helm IV'
        $this.MapObjName         = 'chaosbringerhelm iv'
        $this.PurchasePrice      = 103000
        $this.SellPrice          = 51500
        $this.TargetStats        = @{
            [StatId]::Defense = 470
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 450
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved helm that brings chaos wherever it goes.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEFrostfallHelmIV : BEHelmet {
    BEFrostfallHelmIV() : base() {
        $this.Name               = 'Frostfall Helm IV'
        $this.MapObjName         = 'frostfallhelm iv'
        $this.PurchasePrice      = 103500
        $this.SellPrice          = 51750
        $this.TargetStats        = @{
            [StatId]::Defense = 318
            [StatId]::MagicDefense = 440
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 318
            [StatId]::MagicDefense = 220
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved helm that brings the chill of winter.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEThunderstrikePlateIV : BEHelmet {
    BEThunderstrikePlateIV() : base() {
        $this.Name               = 'Thunderstrike Plate IV'
        $this.MapObjName         = 'thunderstrikeplate iv'
        $this.PurchasePrice      = 104000
        $this.SellPrice          = 52000
        $this.TargetStats        = @{
            [StatId]::Defense = 475
            [StatId]::MagicDefense = 245
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 455
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Incredibly improved plate armor that channels the power of thunder.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEWorldshaperHoodIV : BEHelmet {
    BEWorldshaperHoodIV() : base() {
        $this.Name               = 'Worldshaper Hood IV'
        $this.MapObjName         = 'worldshaperhood iv'
        $this.PurchasePrice      = 104500
        $this.SellPrice          = 52250
        $this.TargetStats        = @{
            [StatId]::Defense = 322
            [StatId]::MagicDefense = 445
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 322
            [StatId]::MagicDefense = 222
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved hood said to have been worn by those who shaped the world.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEAbyssalLordHelmIV : BEHelmet {
    BEAbyssalLordHelmIV() : base() {
        $this.Name               = 'Abyssal Lord Helm IV'
        $this.MapObjName         = 'abyssallordhelm iv'
        $this.PurchasePrice      = 105000
        $this.SellPrice          = 52500
        $this.TargetStats        = @{
            [StatId]::Defense = 480
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 460
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved helm fit for a lord of the abyss.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEStarcallerCircletIV : BEHelmet {
    BEStarcallerCircletIV() : base() {
        $this.Name               = 'Starcaller Circlet IV'
        $this.MapObjName         = 'starcallercirclet iv'
        $this.PurchasePrice      = 105500
        $this.SellPrice          = 52750
        $this.TargetStats        = @{
            [StatId]::Defense = 328
            [StatId]::MagicDefense = 450
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 328
            [StatId]::MagicDefense = 225
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved circlet that allows the wearer to call upon the power of stars.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGodkingPlateIV : BEHelmet {
    BEGodkingPlateIV() : base() {
        $this.Name               = 'Godking Plate IV'
        $this.MapObjName         = 'godkingplate iv'
        $this.PurchasePrice      = 106000
        $this.SellPrice          = 53000
        $this.TargetStats        = @{
            [StatId]::Defense = 485
            [StatId]::MagicDefense = 250
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 465
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Incredibly improved plate armor fit for a god-king.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BECreatorHoodIV : BEHelmet {
    BECreatorHoodIV() : base() {
        $this.Name               = 'Creator Hood IV'
        $this.MapObjName         = 'creatorhood iv'
        $this.PurchasePrice      = 106500
        $this.SellPrice          = 53250
        $this.TargetStats        = @{
            [StatId]::Defense = 332
            [StatId]::MagicDefense = 455
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 332
            [StatId]::MagicDefense = 228
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved hood woven from the threads of creation.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEFrostfireHelmIV : BEHelmet {
    BEFrostfireHelmIV() : base() {
        $this.Name               = 'Frostfire Helm IV'
        $this.MapObjName         = 'frostfirehelm iv'
        $this.PurchasePrice      = 107500
        $this.SellPrice          = 53750
        $this.TargetStats        = @{
            [StatId]::Defense = 338
            [StatId]::MagicDefense = 460
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 338
            [StatId]::MagicDefense = 230
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved helm crackling with both frost and fire.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEUniverseCircletV : BEHelmet {
    BEUniverseCircletV() : base() {
        $this.Name               = 'Universe Circlet V'
        $this.MapObjName         = 'universecirclet v'
        $this.PurchasePrice      = 108500
        $this.SellPrice          = 54250
        $this.TargetStats        = @{
            [StatId]::Defense = 342
            [StatId]::MagicDefense = 465
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 342
            [StatId]::MagicDefense = 232
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A supremely improved circlet containing a miniature universe within.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEApocalypseHoodIV : BEHelmet {
    BEApocalypseHoodIV() : base() {
        $this.Name               = 'Apocalypse Hood IV'
        $this.MapObjName         = 'apocalypsehood iv'
        $this.PurchasePrice      = 109000
        $this.SellPrice          = 54500
        $this.TargetStats        = @{
            [StatId]::Defense = 348
            [StatId]::MagicDefense = 470
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 348
            [StatId]::MagicDefense = 235
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved hood that whispers of the apocalypse.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEVoidheartPlateIV : BEHelmet {
    BEVoidheartPlateIV() : base() {
        $this.Name               = 'Voidheart Plate IV'
        $this.MapObjName         = 'voidheartplate iv'
        $this.PurchasePrice      = 117000
        $this.SellPrice          = 58500
        $this.TargetStats        = @{
            [StatId]::Defense = 540
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 520
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Incredibly improved plate armor drawing power from the void.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEFrostfireHelmIV_Alt : BEHelmet { # Name clash, renaming
    BEFrostfireHelmIV_Alt() : base() {
        $this.Name               = 'Frostfire Helm IV'
        $this.MapObjName         = 'frostfirehelm iv alt'
        $this.PurchasePrice      = 117500
        $this.SellPrice          = 58750
        $this.TargetStats        = @{
            [StatId]::Defense = 388
            [StatId]::MagicDefense = 505
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 388
            [StatId]::MagicDefense = 255
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved helm crackling with both frost and fire.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEThundergodPlateIV : BEHelmet {
    BEThundergodPlateIV() : base() {
        $this.Name               = 'Thundergod Plate IV'
        $this.MapObjName         = 'thundergodplate iv'
        $this.PurchasePrice      = 118000
        $this.SellPrice          = 59000
        $this.TargetStats        = @{
            [StatId]::Defense = 545
            [StatId]::MagicDefense = 285
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 525
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Greatly improved plate armor imbued with the power of a thunder god.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEUniverseCircletVI : BEHelmet {
    BEUniverseCircletVI() : base() {
        $this.Name               = 'Universe Circlet VI'
        $this.MapObjName         = 'universecirclet vi'
        $this.PurchasePrice      = 118500
        $this.SellPrice          = 59250
        $this.TargetStats        = @{
            [StatId]::Defense = 392
            [StatId]::MagicDefense = 510
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 392
            [StatId]::MagicDefense = 258
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A supremely improved circlet containing a miniature universe within.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEApocalypseHoodV : BEHelmet {
    BEApocalypseHoodV() : base() {
        $this.Name               = 'Apocalypse Hood V'
        $this.MapObjName         = 'apocalypsehood v'
        $this.PurchasePrice      = 119000
        $this.SellPrice          = 59500
        $this.TargetStats        = @{
            [StatId]::Defense = 398
            [StatId]::MagicDefense = 515
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 398
            [StatId]::MagicDefense = 260
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A supremely improved hood that whispers of the apocalypse.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEHeavenlyPlateIV : BEHelmet {
    BEHeavenlyPlateIV() : base() {
        $this.Name               = 'Heavenly Plate IV'
        $this.MapObjName         = 'heavenlyplate iv'
        $this.PurchasePrice      = 119500
        $this.SellPrice          = 59750
        $this.TargetStats        = @{
            [StatId]::Defense = 550
            [StatId]::MagicDefense = 290
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 530
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Greatly improved plate armor blessed by the heavens.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEArchangelHelmIV_Alt : BEHelmet { # Name clash, renaming
    BEArchangelHelmIV_Alt() : base() {
        $this.Name               = 'Archangel Helm IV'
        $this.MapObjName         = 'archangelhelm iv alt'
        $this.PurchasePrice      = 120000
        $this.SellPrice          = 60000
        $this.TargetStats        = @{
            [StatId]::Defense = 555
            [StatId]::MagicDefense = 295
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 535
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved helm radiating the power of an archangel.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEWorldeaterHelmIV_Alt : BEHelmet { # Name clash, renaming
    BEWorldeaterHelmIV_Alt() : base() {
        $this.Name               = 'Worldeater Helm IV'
        $this.MapObjName         = 'worldeaterhelm iv alt'
        $this.PurchasePrice      = 121000
        $this.SellPrice          = 60500
        $this.TargetStats        = @{
            [StatId]::Defense = 560
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 540
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved helm said to devour worlds.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEStarforgedCircletIV_Alt : BEHelmet { # Name clash, renaming
    BEStarforgedCircletIV_Alt() : base() {
        $this.Name               = 'Starforged Circlet IV'
        $this.MapObjName         = 'starforgedcirclet iv alt'
        $this.PurchasePrice      = 121500
        $this.SellPrice          = 60750
        $this.TargetStats        = @{
            [StatId]::Defense = 368
            [StatId]::MagicDefense = 490
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 368
            [StatId]::MagicDefense = 245
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved circlet forged from the heart of a star.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGodkillerHelmIV_Alt : BEHelmet { # Name clash, renaming
    BEGodkillerHelmIV_Alt() : base() {
        $this.Name               = 'Godkiller Helm IV'
        $this.MapObjName         = 'godkillerhelm iv alt'
        $this.PurchasePrice      = 122000
        $this.SellPrice          = 61000
        $this.TargetStats        = @{
            [StatId]::Defense = 565
            [StatId]::MagicDefense = 280
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 545
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved helm designed to slay gods.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEUniverseHoodIV_Alt : BEHelmet { # Name clash, renaming
    BEUniverseHoodIV_Alt() : base() {
        $this.Name               = 'Universe Hood IV'
        $this.MapObjName         = 'universehood iv alt'
        $this.PurchasePrice      = 122500
        $this.SellPrice          = 61250
        $this.TargetStats        = @{
            [StatId]::Defense = 372
            [StatId]::MagicDefense = 495
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 372
            [StatId]::MagicDefense = 248
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved hood that seems to contain the vastness of the universe.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEChaosbringerHelmIV_Alt : BEHelmet { # Name clash, renaming
    BEChaosbringerHelmIV_Alt() : base() {
        $this.Name               = 'Chaosbringer Helm IV'
        $this.MapObjName         = 'chaosbringerhelm iv alt'
        $this.PurchasePrice      = 123000
        $this.SellPrice          = 61500
        $this.TargetStats        = @{
            [StatId]::Defense = 570
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 550
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved helm that brings chaos wherever it goes.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEFrostfallHelmIV_Alt : BEHelmet { # Name clash, renaming
    BEFrostfallHelmIV_Alt() : base() {
        $this.Name               = 'Frostfall Helm IV'
        $this.MapObjName         = 'frostfallhelm iv alt'
        $this.PurchasePrice      = 123500
        $this.SellPrice          = 61750
        $this.TargetStats        = @{
            [StatId]::Defense = 378
            [StatId]::MagicDefense = 500
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 378
            [StatId]::MagicDefense = 250
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved helm that brings the chill of winter.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEThunderstrikePlateIV_Alt : BEHelmet { # Name clash, renaming
    BEThunderstrikePlateIV_Alt() : base() {
        $this.Name               = 'Thunderstrike Plate IV'
        $this.MapObjName         = 'thunderstrikeplate iv alt'
        $this.PurchasePrice      = 124000
        $this.SellPrice          = 62000
        $this.TargetStats        = @{
            [StatId]::Defense = 575
            [StatId]::MagicDefense = 285
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 555
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Incredibly improved plate armor that channels the power of thunder.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEWorldshaperHoodIV_Alt : BEHelmet { # Name clash, renaming
    BEWorldshaperHoodIV_Alt() : base() {
        $this.Name               = 'Worldshaper Hood IV'
        $this.MapObjName         = 'worldshaperhood iv alt'
        $this.PurchasePrice      = 124500
        $this.SellPrice          = 62250
        $this.TargetStats        = @{
            [StatId]::Defense = 382
            [StatId]::MagicDefense = 505
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 382
            [StatId]::MagicDefense = 252
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved hood said to have been worn by those who shaped the world.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEAbyssalLordHelmIV_Alt : BEHelmet { # Name clash, renaming
    BEAbyssalLordHelmIV_Alt() : base() {
        $this.Name               = 'Abyssal Lord Helm IV'
        $this.MapObjName         = 'abyssallordhelm iv alt'
        $this.PurchasePrice      = 125000
        $this.SellPrice          = 62500
        $this.TargetStats        = @{
            [StatId]::Defense = 580
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 560
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved helm fit for a lord of the abyss.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEStarcallerCircletIV_Alt : BEHelmet { # Name clash, renaming
    BEStarcallerCircletIV_Alt() : base() {
        $this.Name               = 'Starcaller Circlet IV'
        $this.MapObjName         = 'starcallercirclet iv alt'
        $this.PurchasePrice      = 125500
        $this.SellPrice          = 62750
        $this.TargetStats        = @{
            [StatId]::Defense = 388
            [StatId]::MagicDefense = 510
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 388
            [StatId]::MagicDefense = 255
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved circlet that allows the wearer to call upon the power of stars.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGodkingPlateIV_Alt : BEHelmet { # Name clash, renaming
    BEGodkingPlateIV_Alt() : base() {
        $this.Name               = 'Godking Plate IV'
        $this.MapObjName         = 'godkingplate iv alt'
        $this.PurchasePrice      = 126000
        $this.SellPrice          = 63000
        $this.TargetStats        = @{
            [StatId]::Defense = 585
            [StatId]::MagicDefense = 290
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 565
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Incredibly improved plate armor fit for a god-king.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BECreatorHoodIV_Alt : BEHelmet { # Name clash, renaming
    BECreatorHoodIV_Alt() : base() {
        $this.Name               = 'Creator Hood IV'
        $this.MapObjName         = 'creatorhood iv alt'
        $this.PurchasePrice      = 126500
        $this.SellPrice          = 63250
        $this.TargetStats        = @{
            [StatId]::Defense = 392
            [StatId]::MagicDefense = 515
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 392
            [StatId]::MagicDefense = 258
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved hood woven from the threads of creation.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEVoidheartPlateIV_Alt : BEHelmet { # Name clash, renaming
    BEVoidheartPlateIV_Alt() : base() {
        $this.Name               = 'Voidheart Plate IV'
        $this.MapObjName         = 'voidheartplate iv alt'
        $this.PurchasePrice      = 127000
        $this.SellPrice          = 63500
        $this.TargetStats        = @{
            [StatId]::Defense = 590
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 570
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Incredibly improved plate armor drawing power from the void.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEFrostfireHelmIV_Alt2 : BEHelmet { # Name clash, renaming
    BEFrostfireHelmIV_Alt2() : base() {
        $this.Name               = 'Frostfire Helm IV'
        $this.MapObjName         = 'frostfirehelm iv alt2'
        $this.PurchasePrice      = 127500
        $this.SellPrice          = 63750
        $this.TargetStats        = @{
            [StatId]::Defense = 398
            [StatId]::MagicDefense = 520
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 398
            [StatId]::MagicDefense = 260
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved helm crackling with both frost and fire.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEThundergodPlateIV_Alt : BEHelmet { # Name clash, renaming
    BEThundergodPlateIV_Alt() : base() {
        $this.Name               = 'Thundergod Plate IV'
        $this.MapObjName         = 'thundergodplate iv alt'
        $this.PurchasePrice      = 128000
        $this.SellPrice          = 64000
        $this.TargetStats        = @{
            [StatId]::Defense = 595
            [StatId]::MagicDefense = 300
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 575
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Greatly improved plate armor imbued with the power of a thunder god.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEUniverseCircletV_Alt : BEHelmet { # Name clash, renaming
    BEUniverseCircletV_Alt() : base() {
        $this.Name               = 'Universe Circlet V'
        $this.MapObjName         = 'universecirclet v alt'
        $this.PurchasePrice      = 128500
        $this.SellPrice          = 64250
        $this.TargetStats        = @{
            [StatId]::Defense = 402
            [StatId]::MagicDefense = 525
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 402
            [StatId]::MagicDefense = 262
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A supremely improved circlet containing a miniature universe within.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEApocalypseHoodV_Alt : BEHelmet { # Name clash, renaming
    BEApocalypseHoodV_Alt() : base() {
        $this.Name               = 'Apocalypse Hood V'
        $this.MapObjName         = 'apocalypsehood v alt'
        $this.PurchasePrice      = 129000
        $this.SellPrice          = 64500
        $this.TargetStats        = @{
            [StatId]::Defense = 408
            [StatId]::MagicDefense = 530
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 408
            [StatId]::MagicDefense = 265
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A supremely improved hood that whispers of the apocalypse.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEHeavenlyPlateIV_Alt : BEHelmet { # Name clash, renaming
    BEHeavenlyPlateIV_Alt() : base() {
        $this.Name               = 'Heavenly Plate IV'
        $this.MapObjName         = 'heavenlyplate iv alt'
        $this.PurchasePrice      = 129500
        $this.SellPrice          = 64750
        $this.TargetStats        = @{
            [StatId]::Defense = 550
            [StatId]::MagicDefense = 290
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 530
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Greatly improved plate armor blessed by the heavens.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEArchangelHelmIV_Alt2 : BEHelmet { # Name clash, renaming
    BEArchangelHelmIV_Alt2() : base() {
        $this.Name               = 'Archangel Helm IV'
        $this.MapObjName         = 'archangelhelm iv alt2'
        $this.PurchasePrice      = 130000
        $this.SellPrice          = 65000
        $this.TargetStats        = @{
            [StatId]::Defense = 555
            [StatId]::MagicDefense = 295
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 535
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved helm radiating the power of an archangel.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEWorldeaterHelmIV_Alt2 : BEHelmet { # Name clash, renaming
    BEWorldeaterHelmIV_Alt2() : base() {
        $this.Name               = 'Worldeater Helm IV'
        $this.MapObjName         = 'worldeaterhelm iv alt2'
        $this.PurchasePrice      = 131000
        $this.SellPrice          = 65500
        $this.TargetStats        = @{
            [StatId]::Defense = 560
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 540
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved helm said to devour worlds.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEStarforgedCircletIV_Alt2 : BEHelmet { # Name clash, renaming
    BEStarforgedCircletIV_Alt2() : base() {
        $this.Name               = 'Starforged Circlet IV'
        $this.MapObjName         = 'starforgedcirclet iv alt2'
        $this.PurchasePrice      = 131500
        $this.SellPrice          = 65750
        $this.TargetStats        = @{
            [StatId]::Defense = 368
            [StatId]::MagicDefense = 490
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 368
            [StatId]::MagicDefense = 245
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved circlet forged from the heart of a star.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGodkillerHelmIV_Alt2 : BEHelmet { # Name clash, renaming
    BEGodkillerHelmIV_Alt2() : base() {
        $this.Name               = 'Godkiller Helm IV'
        $this.MapObjName         = 'godkillerhelm iv alt2'
        $this.PurchasePrice      = 132000
        $this.SellPrice          = 66000
        $this.TargetStats        = @{
            [StatId]::Defense = 565
            [StatId]::MagicDefense = 280
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 545
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved helm designed to slay gods.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEUniverseHoodIV_Alt2 : BEHelmet { # Name clash, renaming
    BEUniverseHoodIV_Alt2() : base() {
        $this.Name               = 'Universe Hood IV'
        $this.MapObjName         = 'universehood iv alt2'
        $this.PurchasePrice      = 132500
        $this.SellPrice          = 66250
        $this.TargetStats        = @{
            [StatId]::Defense = 372
            [StatId]::MagicDefense = 495
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 372
            [StatId]::MagicDefense = 248
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved hood that seems to contain the vastness of the universe.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEChaosbringerHelmIV_Alt2 : BEHelmet { # Name clash, renaming
    BEChaosbringerHelmIV_Alt2() : base() {
        $this.Name               = 'Chaosbringer Helm IV'
        $this.MapObjName         = 'chaosbringerhelm iv alt2'
        $this.PurchasePrice      = 133000
        $this.SellPrice          = 66500
        $this.TargetStats        = @{
            [StatId]::Defense = 570
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 550
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved helm that brings chaos wherever it goes.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEFrostfallHelmIV_Alt3 : BEHelmet { # Name clash, renaming
    BEFrostfallHelmIV_Alt3() : base() {
        $this.Name               = 'Frostfall Helm IV'
        $this.MapObjName         = 'frostfallhelm iv alt3'
        $this.PurchasePrice      = 133500
        $this.SellPrice          = 66750
        $this.TargetStats        = @{
            [StatId]::Defense = 378
            [StatId]::MagicDefense = 500
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 378
            [StatId]::MagicDefense = 250
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved helm that brings the chill of winter.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEThunderstrikePlateIV_Alt2 : BEHelmet { # Name clash, renaming
    BEThunderstrikePlateIV_Alt2() : base() {
        $this.Name               = 'Thunderstrike Plate IV'
        $this.MapObjName         = 'thunderstrikeplate iv alt2'
        $this.PurchasePrice      = 134000
        $this.SellPrice          = 67000
        $this.TargetStats        = @{
            [StatId]::Defense = 575
            [StatId]::MagicDefense = 285
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 555
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Incredibly improved plate armor that channels the power of thunder.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEWorldshaperHoodIV_Alt2 : BEHelmet { # Name clash, renaming
    BEWorldshaperHoodIV_Alt2() : base() {
        $this.Name               = 'Worldshaper Hood IV'
        $this.MapObjName         = 'worldshaperhood iv alt2'
        $this.PurchasePrice      = 134500
        $this.SellPrice          = 67250
        $this.TargetStats        = @{
            [StatId]::Defense = 382
            [StatId]::MagicDefense = 505
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 382
            [StatId]::MagicDefense = 252
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved hood said to have been worn by those who shaped the world.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEAbyssalLordHelmIV_Alt2 : BEHelmet { # Name clash, renaming
    BEAbyssalLordHelmIV_Alt2() : base() {
        $this.Name               = 'Abyssal Lord Helm IV'
        $this.MapObjName         = 'abyssallordhelm iv alt2'
        $this.PurchasePrice      = 135000
        $this.SellPrice          = 67500
        $this.TargetStats        = @{
            [StatId]::Defense = 580
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 560
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved helm fit for a lord of the abyss.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEStarcallerCircletIV_Alt2 : BEHelmet { # Name clash, renaming
    BEStarcallerCircletIV_Alt2() : base() {
        $this.Name               = 'Starcaller Circlet IV'
        $this.MapObjName         = 'starcallercirclet iv alt2'
        $this.PurchasePrice      = 135500
        $this.SellPrice          = 67750
        $this.TargetStats        = @{
            [StatId]::Defense = 388
            [StatId]::MagicDefense = 510
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 388
            [StatId]::MagicDefense = 255
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved circlet that allows the wearer to call upon the power of stars.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGodkingPlateIV_Alt2 : BEHelmet { # Name clash, renaming
    BEGodkingPlateIV_Alt2() : base() {
        $this.Name               = 'Godking Plate IV'
        $this.MapObjName         = 'godkingplate iv alt2'
        $this.PurchasePrice      = 136000
        $this.SellPrice          = 68000
        $this.TargetStats        = @{
            [StatId]::Defense = 585
            [StatId]::MagicDefense = 290
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 565
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Incredibly improved plate armor fit for a god-king.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BECreatorHoodIV_Alt2 : BEHelmet { # Name clash, renaming
    BECreatorHoodIV_Alt2() : base() {
        $this.Name               = 'Creator Hood IV'
        $this.MapObjName         = 'creatorhood iv alt2'
        $this.PurchasePrice      = 136500
        $this.SellPrice          = 68250
        $this.TargetStats        = @{
            [StatId]::Defense = 392
            [StatId]::MagicDefense = 515
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 392
            [StatId]::MagicDefense = 258
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved hood woven from the threads of creation.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEVoidheartPlateIV_Alt2 : BEHelmet { # Name clash, renaming
    BEVoidheartPlateIV_Alt2() : base() {
        $this.Name               = 'Voidheart Plate IV'
        $this.MapObjName         = 'voidheartplate iv alt2'
        $this.PurchasePrice      = 137000
        $this.SellPrice          = 68500
        $this.TargetStats        = @{
            [StatId]::Defense = 590
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 570
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Incredibly improved plate armor drawing power from the void.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEFrostfireHelmIV_Alt3 : BEHelmet { # Name clash, renaming
    BEFrostfireHelmIV_Alt3() : base() {
        $this.Name               = 'Frostfire Helm IV'
        $this.MapObjName         = 'frostfirehelm iv alt3'
        $this.PurchasePrice      = 137500
        $this.SellPrice          = 68750
        $this.TargetStats        = @{
            [StatId]::Defense = 398
            [StatId]::MagicDefense = 520
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 398
            [StatId]::MagicDefense = 260
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved helm crackling with both frost and fire.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEThundergodPlateIV_Alt2 : BEHelmet { # Name clash, renaming
    BEThundergodPlateIV_Alt2() : base() {
        $this.Name               = 'Thundergod Plate IV'
        $this.MapObjName         = 'thundergodplate iv alt2'
        $this.PurchasePrice      = 138000
        $this.SellPrice          = 69000
        $this.TargetStats        = @{
            [StatId]::Defense = 595
            [StatId]::MagicDefense = 300
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 575
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Greatly improved plate armor imbued with the power of a thunder god.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEUniverseCircletV_Alt2 : BEHelmet { # Name clash, renaming
    BEUniverseCircletV_Alt2() : base() {
        $this.Name               = 'Universe Circlet V'
        $this.MapObjName         = 'universecirclet v alt2'
        $this.PurchasePrice      = 138500
        $this.SellPrice          = 69250
        $this.TargetStats        = @{
            [StatId]::Defense = 402
            [StatId]::MagicDefense = 525
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 402
            [StatId]::MagicDefense = 262
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A supremely improved circlet containing a miniature universe within.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEApocalypseHoodV_Alt2 : BEHelmet { # Name clash, renaming
    BEApocalypseHoodV_Alt2() : base() {
        $this.Name               = 'Apocalypse Hood V'
        $this.MapObjName         = 'apocalypsehood v alt2'
        $this.PurchasePrice      = 139000
        $this.SellPrice          = 69500
        $this.TargetStats        = @{
            [StatId]::Defense = 408
            [StatId]::MagicDefense = 530
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 408
            [StatId]::MagicDefense = 265
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A supremely improved hood that whispers of the apocalypse.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEHeavenlyPlateIV_Alt2 : BEHelmet { # Name clash, renaming
    BEHeavenlyPlateIV_Alt2() : base() {
        $this.Name               = 'Heavenly Plate IV'
        $this.MapObjName         = 'heavenlyplate iv alt2'
        $this.PurchasePrice      = 139500
        $this.SellPrice          = 69750
        $this.TargetStats        = @{
            [StatId]::Defense = 550
            [StatId]::MagicDefense = 290
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 530
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Greatly improved plate armor blessed by the heavens.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEArchangelHelmIV_Alt3 : BEHelmet { # Name clash, renaming
    BEArchangelHelmIV_Alt3() : base() {
        $this.Name               = 'Archangel Helm IV'
        $this.MapObjName         = 'archangelhelm iv alt3'
        $this.PurchasePrice      = 140000
        $this.SellPrice          = 70000
        $this.TargetStats        = @{
            [StatId]::Defense = 555
            [StatId]::MagicDefense = 295
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 535
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved helm radiating the power of an archangel.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEWorldeaterHelmIV_Alt3 : BEHelmet { # Name clash, renaming
    BEWorldeaterHelmIV_Alt3() : base() {
        $this.Name               = 'Worldeater Helm IV'
        $this.MapObjName         = 'worldeaterhelm iv alt3'
        $this.PurchasePrice      = 141000
        $this.SellPrice          = 70500
        $this.TargetStats        = @{
            [StatId]::Defense = 560
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 540
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved helm said to devour worlds.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEStarforgedCircletIV_Alt3 : BEHelmet { # Name clash, renaming
    BEStarforgedCircletIV_Alt3() : base() {
        $this.Name               = 'Starforged Circlet IV'
        $this.MapObjName         = 'starforgedcirclet iv alt3'
        $this.PurchasePrice      = 141500
        $this.SellPrice          = 70750
        $this.TargetStats        = @{
            [StatId]::Defense = 368
            [StatId]::MagicDefense = 490
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 368
            [StatId]::MagicDefense = 245
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved circlet forged from the heart of a star.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGodkillerHelmIV_Alt3 : BEHelmet { # Name clash, renaming
    BEGodkillerHelmIV_Alt3() : base() {
        $this.Name               = 'Godkiller Helm IV'
        $this.MapObjName         = 'godkillerhelm iv alt3'
        $this.PurchasePrice      = 142000
        $this.SellPrice          = 71000
        $this.TargetStats        = @{
            [StatId]::Defense = 565
            [StatId]::MagicDefense = 280
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 545
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved helm designed to slay gods.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEUniverseHoodIV_Alt3 : BEHelmet { # Name clash, renaming
    BEUniverseHoodIV_Alt3() : base() {
        $this.Name               = 'Universe Hood IV'
        $this.MapObjName         = 'universehood iv alt3'
        $this.PurchasePrice      = 142500
        $this.SellPrice          = 71250
        $this.TargetStats        = @{
            [StatId]::Defense = 372
            [StatId]::MagicDefense = 495
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 372
            [StatId]::MagicDefense = 248
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved hood that seems to contain the vastness of the universe.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEChaosbringerHelmIV_Alt3 : BEHelmet { # Name clash, renaming
    BEChaosbringerHelmIV_Alt3() : base() {
        $this.Name               = 'Chaosbringer Helm IV'
        $this.MapObjName         = 'chaosbringerhelm iv alt3'
        $this.PurchasePrice      = 143000
        $this.SellPrice          = 71500
        $this.TargetStats        = @{
            [StatId]::Defense = 570
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 550
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved helm that brings chaos wherever it goes.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEFrostfallHelmIV_Alt4 : BEHelmet { # Name clash, renaming
    BEFrostfallHelmIV_Alt4() : base() {
        $this.Name               = 'Frostfall Helm IV'
        $this.MapObjName         = 'frostfallhelm iv alt4'
        $this.PurchasePrice      = 143500
        $this.SellPrice          = 71750
        $this.TargetStats        = @{
            [StatId]::Defense = 378
            [StatId]::MagicDefense = 500
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 378
            [StatId]::MagicDefense = 250
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved helm that brings the chill of winter.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEThunderstrikePlateIV_Alt3 : BEHelmet { # Name clash, renaming
    BEThunderstrikePlateIV_Alt3() : base() {
        $this.Name               = 'Thunderstrike Plate IV'
        $this.MapObjName         = 'thunderstrikeplate iv alt3'
        $this.PurchasePrice      = 144000
        $this.SellPrice          = 72000
        $this.TargetStats        = @{
            [StatId]::Defense = 575
            [StatId]::MagicDefense = 285
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 555
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Incredibly improved plate armor that channels the power of thunder.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEWorldshaperHoodIV_Alt3 : BEHelmet { # Name clash, renaming
    BEWorldshaperHoodIV_Alt3() : base() {
        $this.Name               = 'Worldshaper Hood IV'
        $this.MapObjName         = 'worldshaperhood iv alt3'
        $this.PurchasePrice      = 144500
        $this.SellPrice          = 72250
        $this.TargetStats        = @{
            [StatId]::Defense = 382
            [StatId]::MagicDefense = 505
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 382
            [StatId]::MagicDefense = 252
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved hood said to have been worn by those who shaped the world.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEAbyssalLordHelmIV_Alt3 : BEHelmet { # Name clash, renaming
    BEAbyssalLordHelmIV_Alt3() : base() {
        $this.Name               = 'Abyssal Lord Helm IV'
        $this.MapObjName         = 'abyssallordhelm iv alt3'
        $this.PurchasePrice      = 145000
        $this.SellPrice          = 72500
        $this.TargetStats        = @{
            [StatId]::Defense = 580
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 560
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved helm fit for a lord of the abyss.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEStarcallerCircletIV_Alt3 : BEHelmet { # Name clash, renaming
    BEStarcallerCircletIV_Alt3() : base() {
        $this.Name               = 'Starcaller Circlet IV'
        $this.MapObjName         = 'starcallercirclet iv alt3'
        $this.PurchasePrice      = 145500
        $this.SellPrice          = 72750
        $this.TargetStats        = @{
            [StatId]::Defense = 388
            [StatId]::MagicDefense = 510
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 388
            [StatId]::MagicDefense = 255
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved circlet that allows the wearer to call upon the power of stars.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGodkingPlateIV_Alt3 : BEHelmet { # Name clash, renaming
    BEGodkingPlateIV_Alt3() : base() {
        $this.Name               = 'Godking Plate IV'
        $this.MapObjName         = 'godkingplate iv alt3'
        $this.PurchasePrice      = 146000
        $this.SellPrice          = 73000
        $this.TargetStats        = @{
            [StatId]::Defense = 585
            [StatId]::MagicDefense = 290
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 565
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Incredibly improved plate armor fit for a god-king.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BECreatorHoodIV_Alt3 : BEHelmet { # Name clash, renaming
    BECreatorHoodIV_Alt3() : base() {
        $this.Name               = 'Creator Hood IV'
        $this.MapObjName         = 'creatorhood iv alt3'
        $this.PurchasePrice      = 146500
        $this.SellPrice          = 73250
        $this.TargetStats        = @{
            [StatId]::Defense = 392
            [StatId]::MagicDefense = 515
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 392
            [StatId]::MagicDefense = 258
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved hood woven from the threads of creation.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEVoidheartPlateIV_Alt3 : BEHelmet { # Name clash, renaming
    BEVoidheartPlateIV_Alt3() : base() {
        $this.Name               = 'Voidheart Plate IV'
        $this.MapObjName         = 'voidheartplate iv alt3'
        $this.PurchasePrice      = 147000
        $this.SellPrice          = 73500
        $this.TargetStats        = @{
            [StatId]::Defense = 590
            [StatId]::MagicDefense = 0
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 570
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Incredibly improved plate armor drawing power from the void.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEFrostfireHelmIV_Alt4 : BEHelmet { # Name clash, renaming
    BEFrostfireHelmIV_Alt4() : base() {
        $this.Name               = 'Frostfire Helm IV'
        $this.MapObjName         = 'frostfirehelm iv alt4'
        $this.PurchasePrice      = 147500
        $this.SellPrice          = 73750
        $this.TargetStats        = @{
            [StatId]::Defense = 398
            [StatId]::MagicDefense = 520
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 398
            [StatId]::MagicDefense = 260
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved helm crackling with both frost and fire.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEThundergodPlateIV_Alt3 : BEHelmet { # Name clash, renaming
    BEThundergodPlateIV_Alt3() : base() {
        $this.Name               = 'Thundergod Plate IV'
        $this.MapObjName         = 'thundergodplate iv alt3'
        $this.PurchasePrice      = 148000
        $this.SellPrice          = 74000
        $this.TargetStats        = @{
            [StatId]::Defense = 595
            [StatId]::MagicDefense = 300
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 575
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Greatly improved plate armor imbued with the power of a thunder god.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEUniverseCircletV_Alt3 : BEHelmet { # Name clash, renaming
    BEUniverseCircletV_Alt3() : base() {
        $this.Name               = 'Universe Circlet V'
        $this.MapObjName         = 'universecirclet v alt3'
        $this.PurchasePrice      = 148500
        $this.SellPrice          = 74250
        $this.TargetStats        = @{
            [StatId]::Defense = 402
            [StatId]::MagicDefense = 525
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 402
            [StatId]::MagicDefense = 262
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A supremely improved circlet containing a miniature universe within.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEApocalypseHoodV_Alt3 : BEHelmet { # Name clash, renaming
    BEApocalypseHoodV_Alt3() : base() {
        $this.Name               = 'Apocalypse Hood V'
        $this.MapObjName         = 'apocalypsehood v alt3'
        $this.PurchasePrice      = 149000
        $this.SellPrice          = 74500
        $this.TargetStats        = @{
            [StatId]::Defense = 408
            [StatId]::MagicDefense = 530
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 408
            [StatId]::MagicDefense = 265
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A supremely improved hood that whispers of the apocalypse.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEHeavenlyPlateIV_Alt3 : BEHelmet { # Name clash, renaming
    BEHeavenlyPlateIV_Alt3() : base() {
        $this.Name               = 'Heavenly Plate IV'
        $this.MapObjName         = 'heavenlyplate iv alt3'
        $this.PurchasePrice      = 149500
        $this.SellPrice          = 74750
        $this.TargetStats        = @{
            [StatId]::Defense = 550
            [StatId]::MagicDefense = 290
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 530
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Greatly improved plate armor blessed by the heavens.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEArchangelHelmIV_Alt4 : BEHelmet { # Name clash, renaming
    BEArchangelHelmIV_Alt4() : base() {
        $this.Name               = 'Archangel Helm IV'
        $this.MapObjName         = 'archangelhelm iv alt4'
        $this.PurchasePrice      = 150000
        $this.SellPrice          = 75000
        $this.TargetStats        = @{
            [StatId]::Defense = 555
            [StatId]::MagicDefense = 295
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 535
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'An incredibly improved helm radiating the power of an archangel.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}




###############################################################################
#
# BEARMOR SPECIALIZATIONS
#
###############################################################################
Class BERags : BEArmor {
    BERags() : base() {
        $this.Name               = 'Tattered Rags'
        $this.MapObjName         = 'tatteredrags'
        $this.PurchasePrice      = 10
        $this.SellPrice          = 5
        $this.TargetStats        = @{
            [StatId]::Defense = 1
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Barely holds together. Better than nothing, perhaps.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEPaddedClothTunic : BEArmor {
    BEPaddedClothTunic() : base() {
        $this.Name               = 'Padded Cloth Tunic'
        $this.MapObjName         = 'paddedclothtunic'
        $this.PurchasePrice      = 25
        $this.SellPrice          = 12
        $this.TargetStats        = @{
            [StatId]::Defense = 2
            [StatId]::MagicDefense = 1
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 1
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Simple cloth tunic with some padding for extra protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BELeatherJerkin : BEArmor {
    BELeatherJerkin() : base() {
        $this.Name               = 'Leather Jerkin'
        $this.MapObjName         = 'leatherjerkin'
        $this.PurchasePrice      = 40
        $this.SellPrice          = 20
        $this.TargetStats        = @{
            [StatId]::Defense = 3
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 2
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A sturdy jerkin made of boiled leather.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BERobesOfApprentice : BEArmor {
    BERobesOfApprentice() : base() {
        $this.Name               = 'Robes of Apprentice'
        $this.MapObjName         = 'robesofapprentice'
        $this.PurchasePrice      = 35
        $this.SellPrice          = 17
        $this.TargetStats        = @{
            [StatId]::Defense      = 1
            [StatId]::MagicDefense = 3
        }
        $this.RequiredStats      = @{
            [StatId]::MagicDefense = 1
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Simple robes worn by novice magic users.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEHideArmor : BEArmor {
    BEHideArmor() : base() {
        $this.Name               = 'Hide Armor'
        $this.MapObjName         = 'hidearmor'
        $this.PurchasePrice      = 50
        $this.SellPrice          = 25
        $this.TargetStats        = @{
            [StatId]::Defense = 4
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 3
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Armor crafted from tough animal hides.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEQuiltedDoublet : BEArmor {
    BEQuiltedDoublet() : base() {
        $this.Name               = 'Quilted Doublet'
        $this.MapObjName         = 'quilteddoublet'
        $this.PurchasePrice      = 60
        $this.SellPrice          = 30
        $this.TargetStats        = @{
            [StatId]::Defense = 3
            [StatId]::MagicDefense = 2
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 2
            [StatId]::MagicDefense = 1
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A thick, quilted doublet offering modest protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BETravelersGarb : BEArmor {
    BETravelersGarb() : base() {
        $this.Name               = 'Traveler''s Garb'
        $this.MapObjName         = 'travelersgarb'
        $this.PurchasePrice      = 70
        $this.SellPrice          = 35
        $this.TargetStats        = @{
            [StatId]::Defense = 4
            [StatId]::MagicDefense = 1
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 3
            [StatId]::MagicDefense = 0
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Durable clothing suitable for long journeys.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEStuddedLeatherCuirass : BEArmor {
    BEStuddedLeatherCuirass() : base() {
        $this.Name               = 'Studded Leather Cuirass'
        $this.MapObjName         = 'studdedleathercuirass'
        $this.PurchasePrice      = 90
        $this.SellPrice          = 45
        $this.TargetStats        = @{
            [StatId]::Defense = 5
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 4
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Leather armor reinforced with metal studs.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEAcolytesRobes : BEArmor {
    BEAcolytesRobes() : base() {
        $this.Name               = 'Acolyte''s Robes'
        $this.MapObjName         = 'acolytesrobes'
        $this.PurchasePrice      = 80
        $this.SellPrice          = 40
        $this.TargetStats        = @{
            [StatId]::Defense = 2
            [StatId]::MagicDefense = 5
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 1
            [StatId]::MagicDefense = 3
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Robes worn by those dedicated to spiritual practices.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEBrigandine : BEArmor {
    BEBrigandine() : base() {
        $this.Name               = 'Brigandine'
        $this.MapObjName         = 'brigandine'
        $this.PurchasePrice      = 110
        $this.SellPrice          = 55
        $this.TargetStats        = @{
            [StatId]::Defense = 6
            [StatId]::MagicDefense = 1
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 5
            [StatId]::MagicDefense = 0
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Armor made of canvas or leather, lined with small steel plates.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEFurLinedCloak : BEArmor {
    BEFurLinedCloak() : base() {
        $this.Name               = 'Fur-Lined Cloak'
        $this.MapObjName         = 'furlinedcloak'
        $this.PurchasePrice      = 100
        $this.SellPrice          = 50
        $this.TargetStats        = @{
            [StatId]::Defense = 3
            [StatId]::MagicDefense = 4
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 2
            [StatId]::MagicDefense = 2
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A warm cloak lined with fur, offering some protection from the elements and blows.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BERingMail : BEArmor {
    BERingMail() : base() {
        $this.Name               = 'Ring Mail'
        $this.MapObjName         = 'ringmail'
        $this.PurchasePrice      = 130
        $this.SellPrice          = 65
        $this.TargetStats        = @{
            [StatId]::Defense = 7
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 6
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Armor made by sewing heavy rings to a leather backing.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEEnchantedTunic : BEArmor {
    BEEnchantedTunic() : base() {
        $this.Name               = 'Enchanted Tunic'
        $this.MapObjName         = 'enchantedtunic'
        $this.PurchasePrice      = 120
        $this.SellPrice          = 60
        $this.TargetStats        = @{
            [StatId]::Defense = 3
            [StatId]::MagicDefense = 6
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 2
            [StatId]::MagicDefense = 4
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A simple tunic imbued with minor protective enchantments.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEScaleVest : BEArmor {
    BEScaleVest() : base() {
        $this.Name               = 'Scale Vest'
        $this.MapObjName         = 'scalevest'
        $this.PurchasePrice      = 150
        $this.SellPrice          = 75
        $this.TargetStats        = @{
            [StatId]::Defense = 8
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 7
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A vest made of overlapping metal scales.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEHardLeatherArmor : BEArmor {
    BEHardLeatherArmor() : base() {
        $this.Name               = 'Hard Leather Armor'
        $this.MapObjName         = 'hardleatherarmor'
        $this.PurchasePrice      = 140
        $this.SellPrice          = 70
        $this.TargetStats        = @{
            [StatId]::Defense = 7
            [StatId]::MagicDefense = 2
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 6
            [StatId]::MagicDefense = 1
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Leather armor that has been specially treated for increased toughness.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEChainShirt : BEArmor {
    BEChainShirt() : base() {
        $this.Name               = 'Chain Shirt'
        $this.MapObjName         = 'chainshirt'
        $this.PurchasePrice      = 200
        $this.SellPrice          = 100
        $this.TargetStats        = @{
            [StatId]::Defense = 10
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 8
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A shirt made of interlocking metal rings, offering good protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BESilkRobes : BEArmor {
    BESilkRobes() : base() {
        $this.Name               = 'Silk Robes'
        $this.MapObjName         = 'silkrobes'
        $this.PurchasePrice      = 180
        $this.SellPrice          = 90
        $this.TargetStats        = @{
            [StatId]::Defense = 4
            [StatId]::MagicDefense = 8
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 3
            [StatId]::MagicDefense = 5
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Elegant robes made of fine silk, surprisingly resilient to magic.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEBronzeCuirass : BEArmor {
    BEBronzeCuirass() : base() {
        $this.Name               = 'Bronze Cuirass'
        $this.MapObjName         = 'bronzecuirass'
        $this.PurchasePrice      = 250
        $this.SellPrice          = 125
        $this.TargetStats        = @{
            [StatId]::Defense = 12
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 10
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A breastplate and backplate made of bronze.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEReinforcedRobes : BEArmor {
    BEReinforcedRobes() : base() {
        $this.Name               = 'Reinforced Robes'
        $this.MapObjName         = 'reinforcedrobes'
        $this.PurchasePrice      = 220
        $this.SellPrice          = 110
        $this.TargetStats        = @{
            [StatId]::Defense = 6
            [StatId]::MagicDefense = 10
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 4
            [StatId]::MagicDefense = 7
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Robes interwoven with metallic threads for added defense.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEIronHauberk : BEArmor {
    BEIronHauberk() : base() {
        $this.Name               = 'Iron Hauberk'
        $this.MapObjName         = 'ironhauberk'
        $this.PurchasePrice      = 300
        $this.SellPrice          = 150
        $this.TargetStats        = @{
            [StatId]::Defense = 15
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 12
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A long coat of iron chainmail.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEGambeson : BEArmor {
    BEGambeson() : base() {
        $this.Name               = 'Gambeson'
        $this.MapObjName         = 'gambeson'
        $this.PurchasePrice      = 160
        $this.SellPrice          = 80
        $this.TargetStats        = @{
            [StatId]::Defense = 9
            [StatId]::MagicDefense = 3
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 7
            [StatId]::MagicDefense = 1
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A padded defensive jacket, worn alone or under other armor.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BESplintMail : BEArmor {
    BESplintMail() : base() {
        $this.Name               = 'Splint Mail'
        $this.MapObjName         = 'splintmail'
        $this.PurchasePrice      = 350
        $this.SellPrice          = 175
        $this.TargetStats        = @{
            [StatId]::Defense = 18
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 15
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Armor made of overlapping metal splints riveted to a backing.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEBattlemageRobes : BEArmor {
    BEBattlemageRobes() : base() {
        $this.Name               = 'Battlemage Robes'
        $this.MapObjName         = 'battlemagerobes'
        $this.PurchasePrice      = 320
        $this.SellPrice          = 160
        $this.TargetStats        = @{
            [StatId]::Defense = 8
            [StatId]::MagicDefense = 14
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 6
            [StatId]::MagicDefense = 10
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Robes designed for mages who expect to see close combat.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BESteelCuirass : BEArmor {
    BESteelCuirass() : base() {
        $this.Name               = 'Steel Cuirass'
        $this.MapObjName         = 'steelcuirass'
        $this.PurchasePrice      = 420
        $this.SellPrice          = 210
        $this.TargetStats        = @{
            [StatId]::Defense = 20
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 17
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A well-crafted cuirass made of polished steel.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEWarriorsTunic : BEArmor {
    BEWarriorsTunic() : base() {
        $this.Name               = 'Warrior''s Tunic'
        $this.MapObjName         = 'warriorstunic'
        $this.PurchasePrice      = 280
        $this.SellPrice          = 140
        $this.TargetStats        = @{
            [StatId]::Defense = 13
            [StatId]::MagicDefense = 5
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 11
            [StatId]::MagicDefense = 3
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A rugged tunic favored by seasoned warriors.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEFullChainMail : BEArmor {
    BEFullChainMail() : base() {
        $this.Name               = 'Full Chain Mail'
        $this.MapObjName         = 'fullchainmail'
        $this.PurchasePrice      = 500
        $this.SellPrice          = 250
        $this.TargetStats        = @{
            [StatId]::Defense = 23
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 20
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A complete suit of chainmail, covering the torso and limbs.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BESorcerersCloak : BEArmor {
    BESorcerersCloak() : base() {
        $this.Name               = 'Sorcerer''s Cloak'
        $this.MapObjName         = 'sorcererscloak'
        $this.PurchasePrice      = 450
        $this.SellPrice          = 225
        $this.TargetStats        = @{
            [StatId]::Defense = 7
            [StatId]::MagicDefense = 18
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 5
            [StatId]::MagicDefense = 13
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A cloak imbued with arcane energies, offering magical protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEPlateArmor : BEArmor {
    BEPlateArmor() : base() {
        $this.Name               = 'Plate Armor'
        $this.MapObjName         = 'platearmor'
        $this.PurchasePrice      = 600
        $this.SellPrice          = 300
        $this.TargetStats        = @{
            [StatId]::Defense = 28
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 24
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Heavy armor consisting of large, interlocking steel plates.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEElvenChainmail : BEArmor {
    BEElvenChainmail() : base() {
        $this.Name               = 'Elven Chainmail'
        $this.MapObjName         = 'elvenchainmail'
        $this.PurchasePrice      = 550
        $this.SellPrice          = 275
        $this.TargetStats        = @{
            [StatId]::Defense = 16
            [StatId]::MagicDefense = 12
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 13
            [StatId]::MagicDefense = 9
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Finely crafted chainmail of elven make, surprisingly light.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEDwarvenPlate : BEArmor {
    BEDwarvenPlate() : base() {
        $this.Name               = 'Dwarven Plate'
        $this.MapObjName         = 'dwarvenplate'
        $this.PurchasePrice      = 750
        $this.SellPrice          = 375
        $this.TargetStats        = @{
            [StatId]::Defense = 33
            [StatId]::MagicDefense = 5
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 28
            [StatId]::MagicDefense = 3
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Thick, masterfully crafted plate armor of dwarven origin.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEMagesRobes : BEArmor {
    BEMagesRobes() : base() {
        $this.Name               = 'Mage''s Robes'
        $this.MapObjName         = 'magesrobes'
        $this.PurchasePrice      = 680
        $this.SellPrice          = 340
        $this.TargetStats        = @{
            [StatId]::Defense = 10
            [StatId]::MagicDefense = 22
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 7
            [StatId]::MagicDefense = 16
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Ornate robes worn by skilled mages, enhancing their magical defenses.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEKnightsArmor : BEArmor {
    BEKnightsArmor() : base() {
        $this.Name               = 'Knight''s Armor'
        $this.MapObjName         = 'knightsarmor'
        $this.PurchasePrice      = 900
        $this.SellPrice          = 450
        $this.TargetStats        = @{
            [StatId]::Defense = 38
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 32
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Full plate armor befitting a noble knight.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEShadowWeaveArmor : BEArmor {
    BEShadowWeaveArmor() : base() {
        $this.Name               = 'Shadow Weave Armor'
        $this.MapObjName         = 'shadowweavearmor'
        $this.PurchasePrice      = 800
        $this.SellPrice          = 400
        $this.TargetStats        = @{
            [StatId]::Defense = 20
            [StatId]::MagicDefense = 18
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 16
            [StatId]::MagicDefense = 14
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Armor woven from shadowy threads, offering stealth and protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEMithrilChainmail : BEArmor {
    BEMithrilChainmail() : base() {
        $this.Name               = 'Mithril Chainmail'
        $this.MapObjName         = 'mithrilchainmail'
        $this.PurchasePrice      = 1100
        $this.SellPrice          = 550
        $this.TargetStats        = @{
            [StatId]::Defense = 25
            [StatId]::MagicDefense = 15
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 21
            [StatId]::MagicDefense = 11
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Chainmail crafted from lightweight and durable mithril.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEArchmageRobes : BEArmor {
    BEArchmageRobes() : base() {
        $this.Name               = 'Archmage Robes'
        $this.MapObjName         = 'archmagerobes'
        $this.PurchasePrice      = 1000
        $this.SellPrice          = 500
        $this.TargetStats        = @{
            [StatId]::Defense = 12
            [StatId]::MagicDefense = 30
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 9
            [StatId]::MagicDefense = 22
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'The robes of a master magic wielder, potent with enchantments.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEAdamantitePlate : BEArmor {
    BEAdamantitePlate() : base() {
        $this.Name               = 'Adamantite Plate'
        $this.MapObjName         = 'adamantiteplate'
        $this.PurchasePrice      = 1300
        $this.SellPrice          = 650
        $this.TargetStats        = @{
            [StatId]::Defense = 45
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 38
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Extremely hard plate armor made from adamantite ore.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEDragonscaleMail : BEArmor {
    BEDragonscaleMail() : base() {
        $this.Name               = 'Dragonscale Mail'
        $this.MapObjName         = 'dragonscalemail'
        $this.PurchasePrice      = 1500
        $this.SellPrice          = 750
        $this.TargetStats        = @{
            [StatId]::Defense = 35
            [StatId]::MagicDefense = 20
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 30
            [StatId]::MagicDefense = 15
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Armor crafted from the resilient scales of a dragon.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEOrichalcumCuirass : BEArmor {
    BEOrichalcumCuirass() : base() {
        $this.Name               = 'Orichalcum Cuirass'
        $this.MapObjName         = 'orichalcumcuirass'
        $this.PurchasePrice      = 1200
        $this.SellPrice          = 600
        $this.TargetStats        = @{
            [StatId]::Defense = 42
            [StatId]::MagicDefense = 8
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 35
            [StatId]::MagicDefense = 5
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A cuirass made of the rare and magically conductive orichalcum.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEPhoenixDownRobes : BEArmor {
    BEPhoenixDownRobes() : base() {
        $this.Name               = 'Phoenix Down Robes'
        $this.MapObjName         = 'phoenixdownrobes'
        $this.PurchasePrice      = 1400
        $this.SellPrice          = 700
        $this.TargetStats        = @{
            [StatId]::Defense = 15
            [StatId]::MagicDefense = 35
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 11
            [StatId]::MagicDefense = 26
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Robes woven with phoenix down, offering resilience and magical protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGryphonHideArmor : BEArmor {
    BEGryphonHideArmor() : base() {
        $this.Name               = 'Gryphon Hide Armor'
        $this.MapObjName         = 'gryphonhidearmor'
        $this.PurchasePrice      = 1000
        $this.SellPrice          = 500
        $this.TargetStats        = @{
            [StatId]::Defense = 30
            [StatId]::MagicDefense = 10
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 25
            [StatId]::MagicDefense = 7
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Armor made from the tough hide of a gryphon.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEPaladinsPlateMail : BEArmor {
    BEPaladinsPlateMail() : base() {
        $this.Name               = 'Paladin''s Plate Mail'
        $this.MapObjName         = 'paladinsplatemail'
        $this.PurchasePrice      = 1800
        $this.SellPrice          = 900
        $this.TargetStats        = @{
            [StatId]::Defense = 50
            [StatId]::MagicDefense = 10
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 42
            [StatId]::MagicDefense = 7
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Heavy plate mail blessed to protect a holy warrior.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BERunicVestments : BEArmor {
    BERunicVestments() : base() {
        $this.Name               = 'Runic Vestments'
        $this.MapObjName         = 'runicvestments'
        $this.PurchasePrice      = 1600
        $this.SellPrice          = 800
        $this.TargetStats        = @{
            [StatId]::Defense = 18
            [StatId]::MagicDefense = 40
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 14
            [StatId]::MagicDefense = 30
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Vestments inscribed with powerful defensive runes.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEObsidianPlate : BEArmor {
    BEObsidianPlate() : base() {
        $this.Name               = 'Obsidian Plate'
        $this.MapObjName         = 'obsidianplate'
        $this.PurchasePrice      = 2000
        $this.SellPrice          = 1000
        $this.TargetStats        = @{
            [StatId]::Defense = 55
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 46
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Armor forged from volcanic obsidian, surprisingly resilient.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEWyrmhideArmor : BEArmor {
    BEWyrmhideArmor() : base() {
        $this.Name               = 'Wyrmhide Armor'
        $this.MapObjName         = 'wyrmhidearmor'
        $this.PurchasePrice      = 1700
        $this.SellPrice          = 850
        $this.TargetStats        = @{
            [StatId]::Defense = 40
            [StatId]::MagicDefense = 25
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 33
            [StatId]::MagicDefense = 18
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Armor crafted from the scales of a lesser dragon.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEStarSilverMail : BEArmor {
    BEStarSilverMail() : base() {
        $this.Name               = 'Star Silver Mail'
        $this.MapObjName         = 'starsilvermail'
        $this.PurchasePrice      = 2200
        $this.SellPrice          = 1100
        $this.TargetStats        = @{
            [StatId]::Defense = 30
            [StatId]::MagicDefense = 30
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 25
            [StatId]::MagicDefense = 25
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Mail forged from silver mined from a fallen star.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEVoidSilkRobes : BEArmor {
    BEVoidSilkRobes() : base() {
        $this.Name               = 'Void Silk Robes'
        $this.MapObjName         = 'voidsilkrobes'
        $this.PurchasePrice      = 2400
        $this.SellPrice          = 1200
        $this.TargetStats        = @{
            [StatId]::Defense = 20
            [StatId]::MagicDefense = 45
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 15
            [StatId]::MagicDefense = 35
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Robes woven from silk touched by the void, offering eerie protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGolemPlate : BEArmor {
    BEGolemPlate() : base() {
        $this.Name               = 'Golem Plate'
        $this.MapObjName         = 'golemplate'
        $this.PurchasePrice      = 2800
        $this.SellPrice          = 1400
        $this.TargetStats        = @{
            [StatId]::Defense = 60
            [StatId]::MagicDefense = 5
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 50
            [StatId]::MagicDefense = 3
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Massive plate armor, as if taken from a stone golem.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BECelestialRaiment : BEArmor {
    BECelestialRaiment() : base() {
        $this.Name               = 'Celestial Raiment'
        $this.MapObjName         = 'celestialraiment'
        $this.PurchasePrice      = 3000
        $this.SellPrice          = 1500
        $this.TargetStats        = @{
            [StatId]::Defense = 25
            [StatId]::MagicDefense = 50
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 20
            [StatId]::MagicDefense = 40
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Clothing that seems to shimmer with starlight.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEDemonHideArmor : BEArmor {
    BEDemonHideArmor() : base() {
        $this.Name               = 'Demon Hide Armor'
        $this.MapObjName         = 'demonhidearmor'
        $this.PurchasePrice      = 2600
        $this.SellPrice          = 1300
        $this.TargetStats        = @{
            [StatId]::Defense = 48
            [StatId]::MagicDefense = 15
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 40
            [StatId]::MagicDefense = 10
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Armor crafted from the tough, leathery hide of a demon.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEArchonRobes : BEArmor {
    BEArchonRobes() : base() {
        $this.Name               = 'Archon Robes'
        $this.MapObjName         = 'archonrobes'
        $this.PurchasePrice      = 3200
        $this.SellPrice          = 1600
        $this.TargetStats        = @{
            [StatId]::Defense = 22
            [StatId]::MagicDefense = 55
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 17
            [StatId]::MagicDefense = 44
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Robes worn by powerful, otherworldly beings of order.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BETitaniumMail : BEArmor {
    BETitaniumMail() : base() {
        $this.Name               = 'Titanium Mail'
        $this.MapObjName         = 'titaniummail'
        $this.PurchasePrice      = 3500
        $this.SellPrice          = 1750
        $this.TargetStats        = @{
            [StatId]::Defense = 65
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 54
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Armor made from exceptionally strong and light titanium.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEFrostweaveRobes : BEArmor {
    BEFrostweaveRobes() : base() {
        $this.Name               = 'Frostweave Robes'
        $this.MapObjName         = 'frostweaverobes'
        $this.PurchasePrice      = 3300
        $this.SellPrice          = 1650
        $this.TargetStats        = @{
            [StatId]::Defense = 28
            [StatId]::MagicDefense = 48
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 22
            [StatId]::MagicDefense = 38
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Robes woven with threads of enchanted ice, cool to the touch.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEHellforgedPlate : BEArmor {
    BEHellforgedPlate() : base() {
        $this.Name               = 'Hellforged Plate'
        $this.MapObjName         = 'hellforgedplate'
        $this.PurchasePrice      = 4000
        $this.SellPrice          = 2000
        $this.TargetStats        = @{
            [StatId]::Defense = 70
            [StatId]::MagicDefense = 10
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 58
            [StatId]::MagicDefense = 7
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Plate armor forged in infernal fires, radiating heat.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BESpiritWalkerRobes : BEArmor {
    BESpiritWalkerRobes() : base() {
        $this.Name               = 'Spirit Walker Robes'
        $this.MapObjName         = 'spiritwalkerrobes'
        $this.PurchasePrice      = 3800
        $this.SellPrice          = 1900
        $this.TargetStats        = @{
            [StatId]::Defense = 26
            [StatId]::MagicDefense = 60
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 20
            [StatId]::MagicDefense = 48
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Robes that allow the wearer to commune with spirits.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGuardianPlate : BEArmor {
    BEGuardianPlate() : base() {
        $this.Name               = 'Guardian Plate'
        $this.MapObjName         = 'guardianplate'
        $this.PurchasePrice      = 4500
        $this.SellPrice          = 2250
        $this.TargetStats        = @{
            [StatId]::Defense = 75
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 62
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Imposing plate armor worn by elite protectors.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEStormcallerMail : BEArmor {
    BEStormcallerMail() : base() {
        $this.Name               = 'Stormcaller Mail'
        $this.MapObjName         = 'stormcallermail'
        $this.PurchasePrice      = 4200
        $this.SellPrice          = 2100
        $this.TargetStats        = @{
            [StatId]::Defense = 50
            [StatId]::MagicDefense = 30
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 41
            [StatId]::MagicDefense = 23
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Mail that crackles with the energy of a brewing storm.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEAncientKingsMail : BEArmor {
    BEAncientKingsMail() : base() {
        $this.Name               = 'Ancient King''s Mail'
        $this.MapObjName         = 'ancientkingsmail'
        $this.PurchasePrice      = 5000
        $this.SellPrice          = 2500
        $this.TargetStats        = @{
            [StatId]::Defense = 80
            [StatId]::MagicDefense = 15
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 66
            [StatId]::MagicDefense = 10
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'The regal and time-worn mail of a long-dead king.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEEmpyreanRobes : BEArmor {
    BEEmpyreanRobes() : base() {
        $this.Name               = 'Empyrean Robes'
        $this.MapObjName         = 'empyreanrobes'
        $this.PurchasePrice      = 4800
        $this.SellPrice          = 2400
        $this.TargetStats        = @{
            [StatId]::Defense = 30
            [StatId]::MagicDefense = 65
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 24
            [StatId]::MagicDefense = 52
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Robes that shimmer with a heavenly light, offering divine protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEColossalPlate : BEArmor {
    BEColossalPlate() : base() {
        $this.Name               = 'Colossal Plate'
        $this.MapObjName         = 'colossalplate'
        $this.PurchasePrice      = 5500
        $this.SellPrice          = 2750
        $this.TargetStats        = @{
            [StatId]::Defense = 85
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 70
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Armor of immense size and thickness, incredibly resilient.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEWyvernLordMail : BEArmor {
    BEWyvernLordMail() : base() {
        $this.Name               = 'Wyvern Lord Mail'
        $this.MapObjName         = 'wyvernlordmail'
        $this.PurchasePrice      = 5200
        $this.SellPrice          = 2600
        $this.TargetStats        = @{
            [StatId]::Defense = 60
            [StatId]::MagicDefense = 30
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 50
            [StatId]::MagicDefense = 24
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Mail reinforced with the scales of a powerful Wyvern Lord.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEBloodforgedArmor : BEArmor {
    BEBloodforgedArmor() : base() {
        $this.Name               = 'Bloodforged Armor'
        $this.MapObjName         = 'bloodforgedarmor'
        $this.PurchasePrice      = 6200
        $this.SellPrice          = 3100
        $this.TargetStats        = @{
            [StatId]::Defense = 90
            [StatId]::MagicDefense = 10
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 75
            [StatId]::MagicDefense = 7
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Armor quenched in blood, said to draw strength from fallen foes.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEOracleRobes : BEArmor {
    BEOracleRobes() : base() {
        $this.Name               = 'Oracle Robes'
        $this.MapObjName         = 'oraclerobes'
        $this.PurchasePrice      = 5800
        $this.SellPrice          = 2900
        $this.TargetStats        = @{
            [StatId]::Defense = 35
            [StatId]::MagicDefense = 70
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 28
            [StatId]::MagicDefense = 56
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Robes worn by seers, granting glimpses into the flow of battle.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEAdamantiumFullPlate : BEArmor {
    BEAdamantiumFullPlate() : base() {
        $this.Name               = 'Adamantium Full Plate'
        $this.MapObjName         = 'adamantiumfullplate'
        $this.PurchasePrice      = 7000
        $this.SellPrice          = 3500
        $this.TargetStats        = @{
            [StatId]::Defense = 95
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 78
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A full suit of plate armor made from nearly indestructible adamantium.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEShadowmeldArmor : BEArmor {
    BEShadowmeldArmor() : base() {
        $this.Name               = 'Shadowmeld Armor'
        $this.MapObjName         = 'shadowmeldarmor'
        $this.PurchasePrice      = 6500
        $this.SellPrice          = 3250
        $this.TargetStats        = @{
            [StatId]::Defense = 65
            [StatId]::MagicDefense = 35
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 54
            [StatId]::MagicDefense = 28
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Armor that allows the wearer to blend into shadows.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEThunderforgedMail : BEArmor {
    BEThunderforgedMail() : base() {
        $this.Name               = 'Thunderforged Mail'
        $this.MapObjName         = 'thunderforgedmail'
        $this.PurchasePrice      = 7200
        $this.SellPrice          = 3600
        $this.TargetStats        = @{
            [StatId]::Defense = 70
            [StatId]::MagicDefense = 25
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 58
            [StatId]::MagicDefense = 20
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Mail forged in a mystical thunderstorm, crackling with latent energy.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEInfernalRobes : BEArmor {
    BEInfernalRobes() : base() {
        $this.Name               = 'Infernal Robes'
        $this.MapObjName         = 'infernalrobes'
        $this.PurchasePrice      = 6900
        $this.SellPrice          = 3450
        $this.TargetStats        = @{
            [StatId]::Defense = 40
            [StatId]::MagicDefense = 75
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 32
            [StatId]::MagicDefense = 60
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Robes imbued with the essence of hellfire, offering potent magical defense.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEChampionPlate : BEArmor {
    BEChampionPlate() : base() {
        $this.Name               = 'Champion Plate'
        $this.MapObjName         = 'championplate'
        $this.PurchasePrice      = 8000
        $this.SellPrice          = 4000
        $this.TargetStats        = @{
            [StatId]::Defense = 100
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 82
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'The distinguished plate armor of a renowned champion.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEStarweaveRobes : BEArmor {
    BEStarweaveRobes() : base() {
        $this.Name               = 'Starweave Robes'
        $this.MapObjName         = 'starweaverobes'
        $this.PurchasePrice      = 7500
        $this.SellPrice          = 3750
        $this.TargetStats        = @{
            [StatId]::Defense = 45
            [StatId]::MagicDefense = 80
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 36
            [StatId]::MagicDefense = 64
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Robes woven from threads of starlight, offering celestial protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGorgonScaleArmor : BEArmor {
    BEGorgonScaleArmor() : base() {
        $this.Name               = 'Gorgon Scale Armor'
        $this.MapObjName         = 'gorgonscalearmor'
        $this.PurchasePrice      = 8200
        $this.SellPrice          = 4100
        $this.TargetStats        = @{
            [StatId]::Defense = 78
            [StatId]::MagicDefense = 30
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 65
            [StatId]::MagicDefense = 24
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Armor made from the petrifying scales of a gorgon.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEVoidPlateArmor : BEArmor {
    BEVoidPlateArmor() : base() {
        $this.Name               = 'Void Plate Armor'
        $this.MapObjName         = 'voidplatearmor'
        $this.PurchasePrice      = 9000
        $this.SellPrice          = 4500
        $this.TargetStats        = @{
            [StatId]::Defense = 105
            [StatId]::MagicDefense = 15
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 86
            [StatId]::MagicDefense = 10
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Plate armor seemingly forged from the emptiness of the void.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEArchonPlate : BEArmor {
    BEArchonPlate() : base() {
        $this.Name               = 'Archon Plate'
        $this.MapObjName         = 'archonplate'
        $this.PurchasePrice      = 9500
        $this.SellPrice          = 4750
        $this.TargetStats        = @{
            [StatId]::Defense = 85
            [StatId]::MagicDefense = 40
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 70
            [StatId]::MagicDefense = 32
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Plate armor imbued with the power and authority of an Archon.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEDivineRaiment : BEArmor {
    BEDivineRaiment() : base() {
        $this.Name               = 'Divine Raiment'
        $this.MapObjName         = 'divineraiment'
        $this.PurchasePrice      = 8500
        $this.SellPrice          = 4250
        $this.TargetStats        = @{
            [StatId]::Defense = 50
            [StatId]::MagicDefense = 85
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 40
            [StatId]::MagicDefense = 68
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Clothing blessed by a deity, radiating holy energy.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEKrakenHideArmor : BEArmor {
    BEKrakenHideArmor() : base() {
        $this.Name               = 'Kraken Hide Armor'
        $this.MapObjName         = 'krakenhidearmor'
        $this.PurchasePrice      = 9200
        $this.SellPrice          = 4600
        $this.TargetStats        = @{
            [StatId]::Defense = 82
            [StatId]::MagicDefense = 25
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 68
            [StatId]::MagicDefense = 20
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Armor crafted from the incredibly tough hide of a kraken.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEWarlordArmor : BEArmor {
    BEWarlordArmor() : base() {
        $this.Name               = 'Warlord Armor'
        $this.MapObjName         = 'warlordarmor'
        $this.PurchasePrice      = 10000
        $this.SellPrice          = 5000
        $this.TargetStats        = @{
            [StatId]::Defense = 110
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 90
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'The formidable armor of a conquering warlord.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEPrismaticRobes : BEArmor {
    BEPrismaticRobes() : base() {
        $this.Name               = 'Prismatic Robes'
        $this.MapObjName         = 'prismaticrobes'
        $this.PurchasePrice      = 9800
        $this.SellPrice          = 4900
        $this.TargetStats        = @{
            [StatId]::Defense = 55
            [StatId]::MagicDefense = 90
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 44
            [StatId]::MagicDefense = 72
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Robes that shimmer with all colors of the rainbow, deflecting various energies.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEBehemothPlate : BEArmor {
    BEBehemothPlate() : base() {
        $this.Name               = 'Behemoth Plate'
        $this.MapObjName         = 'behemothplate'
        $this.PurchasePrice      = 11000
        $this.SellPrice          = 5500
        $this.TargetStats        = @{
            [StatId]::Defense = 115
            [StatId]::MagicDefense = 10
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 94
            [StatId]::MagicDefense = 7
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Armor made from the plates of a colossal behemoth.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BESeraphicVestments : BEArmor {
    BESeraphicVestments() : base() {
        $this.Name               = 'Seraphic Vestments'
        $this.MapObjName         = 'seraphicvestments'
        $this.PurchasePrice      = 10500
        $this.SellPrice          = 5250
        $this.TargetStats        = @{
            [StatId]::Defense = 60
            [StatId]::MagicDefense = 95
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 48
            [StatId]::MagicDefense = 76
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Vestments imbued with the grace and power of a seraph.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEDragonbonePlate : BEArmor {
    BEDragonbonePlate() : base() {
        $this.Name               = 'Dragonbone Plate'
        $this.MapObjName         = 'dragonboneplate'
        $this.PurchasePrice      = 12000
        $this.SellPrice          = 6000
        $this.TargetStats        = @{
            [StatId]::Defense = 120
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 98
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Plate armor crafted from the dense bones of ancient dragons.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEAstralWeaveRobes : BEArmor {
    BEAstralWeaveRobes() : base() {
        $this.Name               = 'Astral Weave Robes'
        $this.MapObjName         = 'astralweaverobes'
        $this.PurchasePrice      = 11500
        $this.SellPrice          = 5750
        $this.TargetStats        = @{
            [StatId]::Defense = 65
            [StatId]::MagicDefense = 100
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 52
            [StatId]::MagicDefense = 80
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Robes woven from threads gathered from the astral plane.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEInvincibleArmor : BEArmor {
    BEInvincibleArmor() : base() {
        $this.Name               = 'Invincible Armor'
        $this.MapObjName         = 'invinciblearmor'
        $this.PurchasePrice      = 13500
        $this.SellPrice          = 6750
        $this.TargetStats        = @{
            [StatId]::Defense = 125
            [StatId]::MagicDefense = 20
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 102
            [StatId]::MagicDefense = 15
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Armor fabled to make its wearer nearly impervious to harm.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGodhandRobes : BEArmor {
    BEGodhandRobes() : base() {
        $this.Name               = 'Godhand Robes'
        $this.MapObjName         = 'godhandrobes'
        $this.PurchasePrice      = 13000
        $this.SellPrice          = 6500
        $this.TargetStats        = @{
            [StatId]::Defense = 70
            [StatId]::MagicDefense = 105
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 56
            [StatId]::MagicDefense = 84
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Robes said to be touched by a divine entity, granting immense power.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEWorldTreeBarkArmor : BEArmor {
    BEWorldTreeBarkArmor() : base() {
        $this.Name               = 'World Tree Bark Armor'
        $this.MapObjName         = 'worldtreebarkarmor'
        $this.PurchasePrice      = 14000
        $this.SellPrice          = 7000
        $this.TargetStats        = @{
            [StatId]::Defense = 90
            [StatId]::MagicDefense = 45
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 74
            [StatId]::MagicDefense = 36
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Armor crafted from the hardened bark of the World Tree.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEPhoenixPlate : BEArmor {
    BEPhoenixPlate() : base() {
        $this.Name               = 'Phoenix Plate'
        $this.MapObjName         = 'phoenixplate'
        $this.PurchasePrice      = 15000
        $this.SellPrice          = 7500
        $this.TargetStats        = @{
            [StatId]::Defense = 130
            [StatId]::MagicDefense = 25
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 106
            [StatId]::MagicDefense = 20
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Plate armor imbued with the fiery spirit of a phoenix.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEAbyssalWrappings : BEArmor {
    BEAbyssalWrappings() : base() {
        $this.Name               = 'Abyssal Wrappings'
        $this.MapObjName         = 'abyssalwrappings'
        $this.PurchasePrice      = 14500
        $this.SellPrice          = 7250
        $this.TargetStats        = @{
            [StatId]::Defense = 75
            [StatId]::MagicDefense = 110
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 60
            [StatId]::MagicDefense = 88
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Dark wrappings that seem to absorb light and muffle sound.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEAdamantiteFullPlate : BEArmor {
    BEAdamantiteFullPlate() : base() {
        $this.Name               = 'Adamantite Full Plate'
        $this.MapObjName         = 'adamantitefullplate'
        $this.PurchasePrice      = 16000
        $this.SellPrice          = 8000
        $this.TargetStats        = @{
            [StatId]::Defense = 135
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 110
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A complete suit of nearly indestructible Adamantite plate armor.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BESunstoneRobes : BEArmor {
    BESunstoneRobes() : base() {
        $this.Name               = 'Sunstone Robes'
        $this.MapObjName         = 'sunstonerobes'
        $this.PurchasePrice      = 15500
        $this.SellPrice          = 7750
        $this.TargetStats        = @{
            [StatId]::Defense = 80
            [StatId]::MagicDefense = 115
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 64
            [StatId]::MagicDefense = 92
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Robes embedded with sunstones, radiating warmth and protective light.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEVoidwalkerArmor : BEArmor {
    BEVoidwalkerArmor() : base() {
        $this.Name               = 'Voidwalker Armor'
        $this.MapObjName         = 'voidwalkerarmor'
        $this.PurchasePrice      = 17000
        $this.SellPrice          = 8500
        $this.TargetStats        = @{
            [StatId]::Defense = 100
            [StatId]::MagicDefense = 40
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 82
            [StatId]::MagicDefense = 32
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Armor that allows brief passage through the void, making the wearer elusive.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEFrostlordPlate : BEArmor {
    BEFrostlordPlate() : base() {
        $this.Name               = 'Frostlord Plate'
        $this.MapObjName         = 'frostlordplate'
        $this.PurchasePrice      = 18000
        $this.SellPrice          = 9000
        $this.TargetStats        = @{
            [StatId]::Defense = 140
            [StatId]::MagicDefense = 20
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 115
            [StatId]::MagicDefense = 16
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Plate armor of a Frostlord, emanating an unnatural chill.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEThundergodRobes : BEArmor {
    BEThundergodRobes() : base() {
        $this.Name               = 'Thundergod Robes'
        $this.MapObjName         = 'thundergodrobes'
        $this.PurchasePrice      = 17500
        $this.SellPrice          = 8750
        $this.TargetStats        = @{
            [StatId]::Defense = 85
            [StatId]::MagicDefense = 120
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 68
            [StatId]::MagicDefense = 96
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Robes crackling with the power of a thunder deity.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEWorldshaperPlate : BEArmor {
    BEWorldshaperPlate() : base() {
        $this.Name               = 'Worldshaper Plate'
        $this.MapObjName         = 'worldshaperplate'
        $this.PurchasePrice      = 19000
        $this.SellPrice          = 9500
        $this.TargetStats        = @{
            [StatId]::Defense = 145
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 118
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Armor said to be worn by those who shaped the very land.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEStarcallerArmor : BEArmor {
    BEStarcallerArmor() : base() {
        $this.Name               = 'Starcaller Armor'
        $this.MapObjName         = 'starcallerarmor'
        $this.PurchasePrice      = 18500
        $this.SellPrice          = 9250
        $this.TargetStats        = @{
            [StatId]::Defense = 105
            [StatId]::MagicDefense = 50
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 86
            [StatId]::MagicDefense = 40
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Armor that resonates with the music of the spheres.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGodkingArmor : BEArmor {
    BEGodkingArmor() : base() {
        $this.Name               = 'Godking Armor'
        $this.MapObjName         = 'godkingarmor'
        $this.PurchasePrice      = 20000
        $this.SellPrice          = 10000
        $this.TargetStats        = @{
            [StatId]::Defense = 150
            [StatId]::MagicDefense = 25
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 123
            [StatId]::MagicDefense = 20
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'The legendary armor of a divine ruler.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BECreatorRobes : BEArmor {
    BECreatorRobes() : base() {
        $this.Name               = 'Creator Robes'
        $this.MapObjName         = 'creatorrobes'
        $this.PurchasePrice      = 19500
        $this.SellPrice          = 9750
        $this.TargetStats        = @{
            [StatId]::Defense = 90
            [StatId]::MagicDefense = 125
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 72
            [StatId]::MagicDefense = 100
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Robes said to be woven from the fabric of creation itself.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEFrostfireMail : BEArmor {
    BEFrostfireMail() : base() {
        $this.Name               = 'Frostfire Mail'
        $this.MapObjName         = 'frostfiremail'
        $this.PurchasePrice      = 20500
        $this.SellPrice          = 10250
        $this.TargetStats        = @{
            [StatId]::Defense = 110
            [StatId]::MagicDefense = 55
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 90
            [StatId]::MagicDefense = 44
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Mail that shifts between icy cold and burning hot to the touch.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEThunderclapPlate : BEArmor {
    BEThunderclapPlate() : base() {
        $this.Name               = 'Thunderclap Plate'
        $this.MapObjName         = 'thunderclapplate'
        $this.PurchasePrice      = 22000
        $this.SellPrice          = 11000
        $this.TargetStats        = @{
            [StatId]::Defense = 160
            [StatId]::MagicDefense = 30
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 131
            [StatId]::MagicDefense = 24
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Plate armor that emits a deafening clap of thunder when struck.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEUniverseRobes : BEArmor {
    BEUniverseRobes() : base() {
        $this.Name               = 'Universe Robes'
        $this.MapObjName         = 'universerobes'
        $this.PurchasePrice      = 21500
        $this.SellPrice          = 10750
        $this.TargetStats        = @{
            [StatId]::Defense = 95
            [StatId]::MagicDefense = 130
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 76
            [StatId]::MagicDefense = 104
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Robes that seem to contain the entirety of the cosmos within their folds.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEApocalypseArmor : BEArmor {
    BEApocalypseArmor() : base() {
        $this.Name               = 'Apocalypse Armor'
        $this.MapObjName         = 'apocalypsearmor'
        $this.PurchasePrice      = 23000
        $this.SellPrice          = 11500
        $this.TargetStats        = @{
            [StatId]::Defense = 165
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 135
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Armor heralding the end of all things, terrifyingly strong.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEHeavenlyMail : BEArmor {
    BEHeavenlyMail() : base() {
        $this.Name               = 'Heavenly Mail'
        $this.MapObjName         = 'heavenlymail'
        $this.PurchasePrice      = 22500
        $this.SellPrice          = 11250
        $this.TargetStats        = @{
            [StatId]::Defense = 115
            [StatId]::MagicDefense = 60
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 94
            [StatId]::MagicDefense = 48
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Mail blessed by celestial beings, offering divine protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEArchangelPlate : BEArmor {
    BEArchangelPlate() : base() {
        $this.Name               = 'Archangel Plate'
        $this.MapObjName         = 'archangelplate'
        $this.PurchasePrice      = 24000
        $this.SellPrice          = 12000
        $this.TargetStats        = @{
            [StatId]::Defense = 170
            [StatId]::MagicDefense = 35
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 139
            [StatId]::MagicDefense = 28
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Plate armor imbued with the might of an archangel.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEWorldEaterRobes : BEArmor {
    BEWorldEaterRobes() : base() {
        $this.Name               = 'World Eater Robes'
        $this.MapObjName         = 'worldeaterrobes'
        $this.PurchasePrice      = 23500
        $this.SellPrice          = 11750
        $this.TargetStats        = @{
            [StatId]::Defense = 100
            [StatId]::MagicDefense = 135
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 80
            [StatId]::MagicDefense = 108
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Robes worn by entities capable of consuming worlds.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEStarforgedPlate : BEArmor {
    BEStarforgedPlate() : base() {
        $this.Name               = 'Starforged Plate'
        $this.MapObjName         = 'starforgedplate'
        $this.PurchasePrice      = 25000
        $this.SellPrice          = 12500
        $this.TargetStats        = @{
            [StatId]::Defense = 175
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 143
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Plate armor forged in the heart of a dying star.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEGodkillerMail : BEArmor {
    BEGodkillerMail() : base() {
        $this.Name               = 'Godkiller Mail'
        $this.MapObjName         = 'godkillermail'
        $this.PurchasePrice      = 24500
        $this.SellPrice          = 12250
        $this.TargetStats        = @{
            [StatId]::Defense = 120
            [StatId]::MagicDefense = 65
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 98
            [StatId]::MagicDefense = 52
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Mail specifically designed to hunt and slay deities.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEChaosLordPlate : BEArmor {
    BEChaosLordPlate() : base() {
        $this.Name               = 'Chaos Lord Plate'
        $this.MapObjName         = 'chaoslordplate'
        $this.PurchasePrice      = 26000
        $this.SellPrice          = 13000
        $this.TargetStats        = @{
            [StatId]::Defense = 180
            [StatId]::MagicDefense = 15
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 147
            [StatId]::MagicDefense = 10
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'The imposing plate armor of a lord who revels in chaos.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEFrostmourneRobes : BEArmor {
    BEFrostmourneRobes() : base() {
        $this.Name               = 'Frostmourne Robes'
        $this.MapObjName         = 'frostmournerobes'
        $this.PurchasePrice      = 25500
        $this.SellPrice          = 12750
        $this.TargetStats        = @{
            [StatId]::Defense = 105
            [StatId]::MagicDefense = 140
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 84
            [StatId]::MagicDefense = 112
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Robes that whisper with the chilling power of a legendary, cursed blade.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEThundergodPlateMail : BEArmor {
    BEThundergodPlateMail() : base() {
        $this.Name               = 'Thundergod Plate Mail'
        $this.MapObjName         = 'thundergodplatemail'
        $this.PurchasePrice      = 27000
        $this.SellPrice          = 13500
        $this.TargetStats        = @{
            [StatId]::Defense = 185
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 151
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Plate mail blessed by a god of thunder, crackling with immense power.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEUniverseMail : BEArmor {
    BEUniverseMail() : base() {
        $this.Name               = 'Universe Mail'
        $this.MapObjName         = 'universemail'
        $this.PurchasePrice      = 26500
        $this.SellPrice          = 13250
        $this.TargetStats        = @{
            [StatId]::Defense = 125
            [StatId]::MagicDefense = 70
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 102
            [StatId]::MagicDefense = 56
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Mail that seems to reflect the vastness of the universe itself.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEApocalypsePlateMail : BEArmor {
    BEApocalypsePlateMail() : base() {
        $this.Name               = 'Apocalypse Plate Mail'
        $this.MapObjName         = 'apocalypseplatemail'
        $this.PurchasePrice      = 28000
        $this.SellPrice          = 14000
        $this.TargetStats        = @{
            [StatId]::Defense = 190
            [StatId]::MagicDefense = 20
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 155
            [StatId]::MagicDefense = 16
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'The ultimate defensive gear, heralding doom for your foes.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEHeavenlyRobes : BEArmor {
    BEHeavenlyRobes() : base() {
        $this.Name               = 'Heavenly Robes'
        $this.MapObjName         = 'heavenlyrobes'
        $this.PurchasePrice      = 27500
        $this.SellPrice          = 13750
        $this.TargetStats        = @{
            [StatId]::Defense = 110
            [StatId]::MagicDefense = 145
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 88
            [StatId]::MagicDefense = 116
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Robes woven from pure light, offering unparalleled magical defense.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEArchangelArmor : BEArmor {
    BEArchangelArmor() : base() {
        $this.Name               = 'Archangel Armor'
        $this.MapObjName         = 'archangelarmor'
        $this.PurchasePrice      = 29000
        $this.SellPrice          = 14500
        $this.TargetStats        = @{
            [StatId]::Defense = 195
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 159
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Armor blessed by an archangel, radiating holy power and resilience.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEWorldEaterPlateMail : BEArmor {
    BEWorldEaterPlateMail() : base() {
        $this.Name               = 'World Eater Plate Mail'
        $this.MapObjName         = 'worldeaterplatemail'
        $this.PurchasePrice      = 28500
        $this.SellPrice          = 14250
        $this.TargetStats        = @{
            [StatId]::Defense = 130
            [StatId]::MagicDefense = 75
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 106
            [StatId]::MagicDefense = 60
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Plate mail of an entity that consumes worlds, terrifyingly strong.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEStarforgedArmor : BEArmor {
    BEStarforgedArmor() : base() {
        $this.Name               = 'Starforged Armor'
        $this.MapObjName         = 'starforgedarmor'
        $this.PurchasePrice      = 30000
        $this.SellPrice          = 15000
        $this.TargetStats        = @{
            [StatId]::Defense = 200
            [StatId]::MagicDefense = 40
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 164
            [StatId]::MagicDefense = 32
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Armor forged from the very heart of a star, glowing with cosmic energy.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGodkillerRobes : BEArmor {
    BEGodkillerRobes() : base() {
        $this.Name               = 'Godkiller Robes'
        $this.MapObjName         = 'godkillerrobes'
        $this.PurchasePrice      = 29500
        $this.SellPrice          = 14750
        $this.TargetStats        = @{
            [StatId]::Defense = 115
            [StatId]::MagicDefense = 150
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 92
            [StatId]::MagicDefense = 120
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Robes imbued with power capable of slaying gods.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEChaosLordArmor : BEArmor {
    BEChaosLordArmor() : base() {
        $this.Name               = 'Chaos Lord Armor'
        $this.MapObjName         = 'chaoslordarmor'
        $this.PurchasePrice      = 31000
        $this.SellPrice          = 15500
        $this.TargetStats        = @{
            [StatId]::Defense = 205
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 168
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'The ultimate armor for a master of chaos, exuding raw, untamed power.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEFrostmournePlate : BEArmor {
    BEFrostmournePlate() : base() {
        $this.Name               = 'Frostmourne Plate'
        $this.MapObjName         = 'frostmourneplate'
        $this.PurchasePrice      = 30500
        $this.SellPrice          = 15250
        $this.TargetStats        = @{
            [StatId]::Defense = 135
            [StatId]::MagicDefense = 80
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 110
            [StatId]::MagicDefense = 64
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Plate armor that carries the chilling aura of the legendary runeblade.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEThundergodArmor : BEArmor {
    BEThundergodArmor() : base() {
        $this.Name               = 'Thundergod Armor'
        $this.MapObjName         = 'thundergodarmor'
        $this.PurchasePrice      = 32000
        $this.SellPrice          = 16000
        $this.TargetStats        = @{
            [StatId]::Defense = 210
            [StatId]::MagicDefense = 45
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 172
            [StatId]::MagicDefense = 36
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Armor blessed by the god of thunder, crackling with divine lightning.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEUniverseArmor : BEArmor {
    BEUniverseArmor() : base() {
        $this.Name               = 'Universe Armor'
        $this.MapObjName         = 'universearmor'
        $this.PurchasePrice      = 31500
        $this.SellPrice          = 15750
        $this.TargetStats        = @{
            [StatId]::Defense = 120
            [StatId]::MagicDefense = 155
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 96
            [StatId]::MagicDefense = 124
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Armor that holds a fragment of the universe''s power.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEApocalypseRobes : BEArmor {
    BEApocalypseRobes() : base() {
        $this.Name               = 'Apocalypse Robes'
        $this.MapObjName         = 'apocalypserobes'
        $this.PurchasePrice      = 33000
        $this.SellPrice          = 16500
        $this.TargetStats        = @{
            [StatId]::Defense = 125
            [StatId]::MagicDefense = 160
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 100
            [StatId]::MagicDefense = 128
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Robes woven with threads of impending doom, offering terrifying protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEHeavenlyPlateMail : BEArmor {
    BEHeavenlyPlateMail() : base() {
        $this.Name               = 'Heavenly Plate Mail'
        $this.MapObjName         = 'heavenlyplatemail'
        $this.PurchasePrice      = 32500
        $this.SellPrice          = 16250
        $this.TargetStats        = @{
            [StatId]::Defense = 215
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 176
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Plate mail so pure it seems to have descended from the heavens.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEArchangelRaiment : BEArmor {
    BEArchangelRaiment() : base() {
        $this.Name               = 'Archangel Raiment'
        $this.MapObjName         = 'archangelraiment'
        $this.PurchasePrice      = 34000
        $this.SellPrice          = 17000
        $this.TargetStats        = @{
            [StatId]::Defense = 130
            [StatId]::MagicDefense = 165
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 104
            [StatId]::MagicDefense = 132
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Raiment blessed by an archangel, glowing with protective light.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEWorldEaterArmor : BEArmor {
    BEWorldEaterArmor() : base() {
        $this.Name               = 'World Eater Armor'
        $this.MapObjName         = 'worldeaterarmor'
        $this.PurchasePrice      = 33500
        $this.SellPrice          = 16750
        $this.TargetStats        = @{
            [StatId]::Defense = 220
            [StatId]::MagicDefense = 50
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 180
            [StatId]::MagicDefense = 40
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Armor of an entity that consumes worlds, impossibly resilient.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEStarforgedRobes : BEArmor {
    BEStarforgedRobes() : base() {
        $this.Name               = 'Starforged Robes'
        $this.MapObjName         = 'starforgedrobes'
        $this.PurchasePrice      = 35000
        $this.SellPrice          = 17500
        $this.TargetStats        = @{
            [StatId]::Defense = 135
            [StatId]::MagicDefense = 170
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 108
            [StatId]::MagicDefense = 136
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Robes woven from stardust, offering cosmic protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGodkillerPlateMail : BEArmor {
    BEGodkillerPlateMail() : base() {
        $this.Name               = 'Godkiller Plate Mail'
        $this.MapObjName         = 'godkillerplatemail'
        $this.PurchasePrice      = 34500
        $this.SellPrice          = 17250
        $this.TargetStats        = @{
            [StatId]::Defense = 225
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 184
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Plate mail designed for the sole purpose of slaying gods.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEChaosLordRobes : BEArmor {
    BEChaosLordRobes() : base() {
        $this.Name               = 'Chaos Lord Robes'
        $this.MapObjName         = 'chaoslordrobes'
        $this.PurchasePrice      = 36000
        $this.SellPrice          = 18000
        $this.TargetStats        = @{
            [StatId]::Defense = 140
            [StatId]::MagicDefense = 175
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 112
            [StatId]::MagicDefense = 140
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'The robes of a being who commands absolute chaos.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEFrostmourneArmor : BEArmor {
    BEFrostmourneArmor() : base() {
        $this.Name               = 'Frostmourne Armor'
        $this.MapObjName         = 'frostmournearmor'
        $this.PurchasePrice      = 35500
        $this.SellPrice          = 17750
        $this.TargetStats        = @{
            [StatId]::Defense = 230
            [StatId]::MagicDefense = 55
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 188
            [StatId]::MagicDefense = 44
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Armor that echoes the chilling power of the legendary runeblade Frostmourne.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEThundergodArmorII : BEArmor { # Renamed to avoid clash
    BEThundergodArmorII() : base() {
        $this.Name               = 'Thundergod Armor II'
        $this.MapObjName         = 'thundergodarmorii'
        $this.PurchasePrice      = 37000
        $this.SellPrice          = 18500
        $this.TargetStats        = @{
            [StatId]::Defense = 235
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 192
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Even more powerful armor blessed by the god of thunder.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEUniversePlateMail : BEArmor {
    BEUniversePlateMail() : base() {
        $this.Name               = 'Universe Plate Mail'
        $this.MapObjName         = 'universeplatemail'
        $this.PurchasePrice      = 36500
        $this.SellPrice          = 18250
        $this.TargetStats        = @{
            [StatId]::Defense = 145
            [StatId]::MagicDefense = 180
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 116
            [StatId]::MagicDefense = 144
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Plate mail that seems to hold the cosmos within its structure.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEApocalypseFullPlate : BEArmor {
    BEApocalypseFullPlate() : base() {
        $this.Name               = 'Apocalypse Full Plate'
        $this.MapObjName         = 'apocalypsefullplate'
        $this.PurchasePrice      = 38000
        $this.SellPrice          = 19000
        $this.TargetStats        = @{
            [StatId]::Defense = 240
            [StatId]::MagicDefense = 25
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 196
            [StatId]::MagicDefense = 20
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'The ultimate suit of armor, heralding the end for all who oppose its wearer.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEHeavenlyGarb : BEArmor {
    BEHeavenlyGarb() : base() {
        $this.Name               = 'Heavenly Garb'
        $this.MapObjName         = 'heavenlygarb'
        $this.PurchasePrice      = 37500
        $this.SellPrice          = 18750
        $this.TargetStats        = @{
            [StatId]::Defense = 150
            [StatId]::MagicDefense = 185
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 120
            [StatId]::MagicDefense = 148
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Garb so pure and radiant, it seems to have descended from the highest heavens.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEArchangelPlateMail : BEArmor {
    BEArchangelPlateMail() : base() {
        $this.Name               = 'Archangel Plate Mail'
        $this.MapObjName         = 'archangelplatemail'
        $this.PurchasePrice      = 39000
        $this.SellPrice          = 19500
        $this.TargetStats        = @{
            [StatId]::Defense = 245
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 200
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Plate mail infused with the divine essence of an archangel.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEWorldEaterRobesII : BEArmor { # Renamed to avoid clash
    BEWorldEaterRobesII() : base() {
        $this.Name               = 'World Eater Robes II'
        $this.MapObjName         = 'worldeaterrobesii'
        $this.PurchasePrice      = 38500
        $this.SellPrice          = 19250
        $this.TargetStats        = @{
            [StatId]::Defense = 155
            [StatId]::MagicDefense = 190
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 124
            [StatId]::MagicDefense = 152
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Even more terrifying robes of an entity that consumes worlds.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEStarforgedPlateMail : BEArmor {
    BEStarforgedPlateMail() : base() {
        $this.Name               = 'Starforged Plate Mail'
        $this.MapObjName         = 'starforgedplatemail'
        $this.PurchasePrice      = 40000
        $this.SellPrice          = 20000
        $this.TargetStats        = @{
            [StatId]::Defense = 250
            [StatId]::MagicDefense = 50
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 205
            [StatId]::MagicDefense = 40
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Plate mail forged from the core of a collapsed star, incredibly dense and protective.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGodkillerArmor : BEArmor {
    BEGodkillerArmor() : base() {
        $this.Name               = 'Godkiller Armor'
        $this.MapObjName         = 'godkillerarmor'
        $this.PurchasePrice      = 39500
        $this.SellPrice          = 19750
        $this.TargetStats        = @{
            [StatId]::Defense = 160
            [StatId]::MagicDefense = 195
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 128
            [StatId]::MagicDefense = 156
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Armor specifically enchanted to withstand and counter divine powers.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEChaosLordFullPlate : BEArmor {
    BEChaosLordFullPlate() : base() {
        $this.Name               = 'Chaos Lord Full Plate'
        $this.MapObjName         = 'chaoslordfullplate'
        $this.PurchasePrice      = 41000
        $this.SellPrice          = 20500
        $this.TargetStats        = @{
            [StatId]::Defense = 255
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 209
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'The ultimate chaotic plate, offering unparalleled physical defense.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEFrostmourneRaiment : BEArmor {
    BEFrostmourneRaiment() : base() {
        $this.Name               = 'Frostmourne Raiment'
        $this.MapObjName         = 'frostmourneraiment'
        $this.PurchasePrice      = 40500
        $this.SellPrice          = 20250
        $this.TargetStats        = @{
            [StatId]::Defense = 165
            [StatId]::MagicDefense = 200
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 132
            [StatId]::MagicDefense = 160
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Raiment that seems to weep icy tears, imbued with the sorrow of Frostmourne.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEThundergodFullPlate : BEArmor {
    BEThundergodFullPlate() : base() {
        $this.Name               = 'Thundergod Full Plate'
        $this.MapObjName         = 'thundergodfullplate'
        $this.PurchasePrice      = 42000
        $this.SellPrice          = 21000
        $this.TargetStats        = @{
            [StatId]::Defense = 260
            [StatId]::MagicDefense = 55
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 213
            [StatId]::MagicDefense = 44
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Full plate armor that crackles with the unbridled fury of a thunder god.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEUniverseRaiment : BEArmor {
    BEUniverseRaiment() : base() {
        $this.Name               = 'Universe Raiment'
        $this.MapObjName         = 'universeraiment'
        $this.PurchasePrice      = 41500
        $this.SellPrice          = 20750
        $this.TargetStats        = @{
            [StatId]::Defense = 170
            [StatId]::MagicDefense = 205
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 136
            [StatId]::MagicDefense = 164
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Raiment that seems to hold the entirety of the cosmos within its fabric.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEApocalypseBattlePlate : BEArmor {
    BEApocalypseBattlePlate() : base() {
        $this.Name               = 'Apocalypse Battle Plate'
        $this.MapObjName         = 'apocalypsebattleplate'
        $this.PurchasePrice      = 43000
        $this.SellPrice          = 21500
        $this.TargetStats        = @{
            [StatId]::Defense = 265
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 217
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'The ultimate battle plate, signifying the end of all conflict for its wearer.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEHeavenlyBattleRobes : BEArmor {
    BEHeavenlyBattleRobes() : base() {
        $this.Name               = 'Heavenly Battle Robes'
        $this.MapObjName         = 'heavenlybattlerobes'
        $this.PurchasePrice      = 42500
        $this.SellPrice          = 21250
        $this.TargetStats        = @{
            [StatId]::Defense = 175
            [StatId]::MagicDefense = 210
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 140
            [StatId]::MagicDefense = 168
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Battle robes blessed by the highest heavens, offering supreme protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEArchangelFullPlate : BEArmor {
    BEArchangelFullPlate() : base() {
        $this.Name               = 'Archangel Full Plate'
        $this.MapObjName         = 'archangelfullplate'
        $this.PurchasePrice      = 44000
        $this.SellPrice          = 22000
        $this.TargetStats        = @{
            [StatId]::Defense = 270
            [StatId]::MagicDefense = 60
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 221
            [StatId]::MagicDefense = 48
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'The ultimate defensive gear, blessed by an archangel''s might.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEWorldEaterBattleMail : BEArmor {
    BEWorldEaterBattleMail() : base() {
        $this.Name               = 'World Eater Battle Mail'
        $this.MapObjName         = 'worldeaterbattlemail'
        $this.PurchasePrice      = 43500
        $this.SellPrice          = 21750
        $this.TargetStats        = @{
            [StatId]::Defense = 180
            [StatId]::MagicDefense = 215
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 144
            [StatId]::MagicDefense = 172
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Battle mail of an entity that consumes worlds, terrifyingly resilient.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEStarforgedBattlePlate : BEArmor {
    BEStarforgedBattlePlate() : base() {
        $this.Name               = 'Starforged Battle Plate'
        $this.MapObjName         = 'starforgedbattleplate'
        $this.PurchasePrice      = 45000
        $this.SellPrice          = 22500
        $this.TargetStats        = @{
            [StatId]::Defense = 275
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 225
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Battle plate forged from the heart of a star, radiating immense power.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEGodkillerBattleRobes : BEArmor {
    BEGodkillerBattleRobes() : base() {
        $this.Name               = 'Godkiller Battle Robes'
        $this.MapObjName         = 'godkillerbattlerobes'
        $this.PurchasePrice      = 44500
        $this.SellPrice          = 22250
        $this.TargetStats        = @{
            [StatId]::Defense = 185
            [StatId]::MagicDefense = 220
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 148
            [StatId]::MagicDefense = 176
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Battle robes imbued with the power to slay gods.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEChaosLordBattlePlate : BEArmor {
    BEChaosLordBattlePlate() : base() {
        $this.Name               = 'Chaos Lord Battle Plate'
        $this.MapObjName         = 'chaoslordbattleplate'
        $this.PurchasePrice      = 46000
        $this.SellPrice          = 23000
        $this.TargetStats        = @{
            [StatId]::Defense = 280
            [StatId]::MagicDefense = 30
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 229
            [StatId]::MagicDefense = 24
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'The ultimate battle plate for a master of chaos.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEFrostmourneBattleMail : BEArmor {
    BEFrostmourneBattleMail() : base() {
        $this.Name               = 'Frostmourne Battle Mail'
        $this.MapObjName         = 'frostmournebattlemail'
        $this.PurchasePrice      = 45500
        $this.SellPrice          = 22750
        $this.TargetStats        = @{
            [StatId]::Defense = 190
            [StatId]::MagicDefense = 225
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 152
            [StatId]::MagicDefense = 180
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Battle mail that carries the chilling aura of the legendary runeblade Frostmourne.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEThundergodBattleArmor : BEArmor {
    BEThundergodBattleArmor() : base() {
        $this.Name               = 'Thundergod Battle Armor'
        $this.MapObjName         = 'thundergodbattlearmor'
        $this.PurchasePrice      = 47000
        $this.SellPrice          = 23500
        $this.TargetStats        = @{
            [StatId]::Defense = 285
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 233
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Battle armor blessed by the god of thunder, crackling with divine lightning.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEUniverseBattlePlate : BEArmor {
    BEUniverseBattlePlate() : base() {
        $this.Name               = 'Universe Battle Plate'
        $this.MapObjName         = 'universebattleplate'
        $this.PurchasePrice      = 46500
        $this.SellPrice          = 23250
        $this.TargetStats        = @{
            [StatId]::Defense = 195
            [StatId]::MagicDefense = 230
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 156
            [StatId]::MagicDefense = 184
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Battle plate that seems to hold the cosmos within its structure.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEApocalypseFullMail : BEArmor {
    BEApocalypseFullMail() : base() {
        $this.Name               = 'Apocalypse Full Mail'
        $this.MapObjName         = 'apocalypsefullmail'
        $this.PurchasePrice      = 48000
        $this.SellPrice          = 24000
        $this.TargetStats        = @{
            [StatId]::Defense = 290
            [StatId]::MagicDefense = 35
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 237
            [StatId]::MagicDefense = 28
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'The ultimate suit of mail, heralding doom for your foes.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEHeavenlyBattleGarb : BEArmor {
    BEHeavenlyBattleGarb() : base() {
        $this.Name               = 'Heavenly Battle Garb'
        $this.MapObjName         = 'heavenlybattlegarb'
        $this.PurchasePrice      = 47500
        $this.SellPrice          = 23750
        $this.TargetStats        = @{
            [StatId]::Defense = 200
            [StatId]::MagicDefense = 235
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 160
            [StatId]::MagicDefense = 188
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Battle garb so pure and radiant, it seems to have descended from the highest heavens.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEArchangelBattlePlate : BEArmor {
    BEArchangelBattlePlate() : base() {
        $this.Name               = 'Archangel Battle Plate'
        $this.MapObjName         = 'archangelbattleplate'
        $this.PurchasePrice      = 49000
        $this.SellPrice          = 24500
        $this.TargetStats        = @{
            [StatId]::Defense = 295
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 241
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Battle plate infused with the divine essence of an archangel.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEWorldEaterFullMail : BEArmor {
    BEWorldEaterFullMail() : base() {
        $this.Name               = 'World Eater Full Mail'
        $this.MapObjName         = 'worldeaterfullmail'
        $this.PurchasePrice      = 48500
        $this.SellPrice          = 24250
        $this.TargetStats        = @{
            [StatId]::Defense = 205
            [StatId]::MagicDefense = 240
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 164
            [StatId]::MagicDefense = 192
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Full mail of an entity that consumes worlds, terrifyingly strong.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEStarforgedFullPlate : BEArmor {
    BEStarforgedFullPlate() : base() {
        $this.Name               = 'Starforged Full Plate'
        $this.MapObjName         = 'starforgedfullplate'
        $this.PurchasePrice      = 50000
        $this.SellPrice          = 25000
        $this.TargetStats        = @{
            [StatId]::Defense = 300
            [StatId]::MagicDefense = 60
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 246
            [StatId]::MagicDefense = 48
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Full plate armor forged from the core of a collapsed star, incredibly dense and protective.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}





###############################################################################
#
# BEPAULDRON SPECIALIZATIONS
#
###############################################################################
Class BERustedSpaulders : BEPauldron {
    BERustedSpaulders() : base() {
        $this.Name               = 'Rusted Spaulders'
        $this.MapObjName         = 'rustedspaulders'
        $this.PurchasePrice      = 15
        $this.SellPrice          = 7
        $this.TargetStats        = @{
            [StatId]::Defense = 1
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 0
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Barely hold together, but better than exposed shoulders.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEClothShoulderPads : BEPauldron {
    BEClothShoulderPads() : base() {
        $this.Name               = 'Cloth Shoulder Pads'
        $this.MapObjName         = 'clothshoulderpads'
        $this.PurchasePrice      = 20
        $this.SellPrice          = 10
        $this.TargetStats        = @{
            [StatId]::Defense = 1
            [StatId]::MagicDefense = 1
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 0
            [StatId]::MagicDefense = 0
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Simple cloth pads offering minimal protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEThinLeatherPads : BEPauldron {
    BEThinLeatherPads() : base() {
        $this.Name               = 'Thin Leather Pads'
        $this.MapObjName         = 'thinleatherpads'
        $this.PurchasePrice      = 25
        $this.SellPrice          = 12
        $this.TargetStats        = @{
            [StatId]::Defense = 2
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 1
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Thin pieces of leather strapped to the shoulders.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEWornWoodenPauldrons : BEPauldron {
    BEWornWoodenPauldrons() : base() {
        $this.Name               = 'Worn Wooden Pauldrons'
        $this.MapObjName         = 'wornwoodenpauldrons'
        $this.PurchasePrice      = 35
        $this.SellPrice          = 17
        $this.TargetStats        = @{
            [StatId]::Defense = 2
            [StatId]::MagicDefense = 1
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 1
            [StatId]::MagicDefense = 0
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Weathered wooden pieces offering slight shoulder defense.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEMakeshiftMetalPlates : BEPauldron {
    BEMakeshiftMetalPlates() : base() {
        $this.Name               = 'Makeshift Metal Plates'
        $this.MapObjName         = 'makeshiftmetalplates'
        $this.PurchasePrice      = 40
        $this.SellPrice          = 20
        $this.TargetStats        = @{
            [StatId]::Defense = 3
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 2
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Crudely fashioned metal plates for the shoulders.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEHardenedClothWraps : BEPauldron {
    BEHardenedClothWraps() : base() {
        $this.Name               = 'Hardened Cloth Wraps'
        $this.MapObjName         = 'hardenedclothwraps'
        $this.PurchasePrice      = 50
        $this.SellPrice          = 25
        $this.TargetStats        = @{
            [StatId]::Defense = 2
            [StatId]::MagicDefense = 2
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 1
            [StatId]::MagicDefense = 1
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Thick cloth wraps, stiffened for better protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEBoiledLeatherSpaulders : BEPauldron {
    BEBoiledLeatherSpaulders() : base() {
        $this.Name               = 'Boiled Leather Spaulders'
        $this.MapObjName         = 'boiledleatherspaulders'
        $this.PurchasePrice      = 60
        $this.SellPrice          = 30
        $this.TargetStats        = @{
            [StatId]::Defense = 4
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 3
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Spaulders made from tough, boiled leather.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEApprenticeEpaulets : BEPauldron {
    BEApprenticeEpaulets() : base() {
        $this.Name               = 'Apprentice Epaulets'
        $this.MapObjName         = 'apprenticeepaulets'
        $this.PurchasePrice      = 55
        $this.SellPrice          = 27
        $this.TargetStats        = @{
            [StatId]::Defense = 1
            [StatId]::MagicDefense = 3
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 0
            [StatId]::MagicDefense = 2
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Simple epaulets often worn by magic apprentices.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEReinforcedLeatherPads : BEPauldron {
    BEReinforcedLeatherPads() : base() {
        $this.Name               = 'Reinforced Leather Pads'
        $this.MapObjName         = 'reinforcedleatherpads'
        $this.PurchasePrice      = 70
        $this.SellPrice          = 35
        $this.TargetStats        = @{
            [StatId]::Defense = 3
            [StatId]::MagicDefense = 1
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 2
            [StatId]::MagicDefense = 0
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Leather shoulder pads with extra layers for durability.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BESmallIronPauldrons : BEPauldron {
    BESmallIronPauldrons() : base() {
        $this.Name               = 'Small Iron Pauldrons'
        $this.MapObjName         = 'smallironpauldrons'
        $this.PurchasePrice      = 80
        $this.SellPrice          = 40
        $this.TargetStats        = @{
            [StatId]::Defense = 5
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 4
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Basic iron pauldrons, offering decent protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BETravelersShoulderCape : BEPauldron {
    BETravelersShoulderCape() : base() {
        $this.Name               = 'Traveler''s Shoulder Cape'
        $this.MapObjName         = 'travelersshouldercape'
        $this.PurchasePrice      = 75
        $this.SellPrice          = 37
        $this.TargetStats        = @{
            [StatId]::Defense = 2
            [StatId]::MagicDefense = 3
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 1
            [StatId]::MagicDefense = 2
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A sturdy cape offering some shoulder protection and elemental resistance.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEStuddedHideShoulders : BEPauldron {
    BEStuddedHideShoulders() : base() {
        $this.Name               = 'Studded Hide Shoulders'
        $this.MapObjName         = 'studdedhideshoulders'
        $this.PurchasePrice      = 90
        $this.SellPrice          = 45
        $this.TargetStats        = @{
            [StatId]::Defense = 4
            [StatId]::MagicDefense = 1
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 3
            [StatId]::MagicDefense = 0
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Shoulder pieces made from animal hide, reinforced with studs.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BECopperGorgetAndSpaulders : BEPauldron {
    BECopperGorgetAndSpaulders() : base() {
        $this.Name               = 'Copper Gorget & Spaulders'
        $this.MapObjName         = 'coppergorgetandspaulders'
        $this.PurchasePrice      = 100
        $this.SellPrice          = 50
        $this.TargetStats        = @{
            [StatId]::Defense = 6
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 5
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A set of copper spaulders with an attached gorget for neck protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BELightweightChainSpaulders : BEPauldron {
    BELightweightChainSpaulders() : base() {
        $this.Name               = 'Lightweight Chain Spaulders'
        $this.MapObjName         = 'lightweightchainspaulders'
        $this.PurchasePrice      = 120
        $this.SellPrice          = 60
        $this.TargetStats        = @{
            [StatId]::Defense = 5
            [StatId]::MagicDefense = 2
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 4
            [StatId]::MagicDefense = 1
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Spaulders made of fine chain links, offering balanced protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEBoneShoulderguards : BEPauldron {
    BEBoneShoulderguards() : base() {
        $this.Name               = 'Bone Shoulderguards'
        $this.MapObjName         = 'boneshoulderguards'
        $this.PurchasePrice      = 110
        $this.SellPrice          = 55
        $this.TargetStats        = @{
            [StatId]::Defense = 7
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 6
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Shoulderguards crafted from sturdy animal bones.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEMysticWeavePads : BEPauldron {
    BEMysticWeavePads() : base() {
        $this.Name               = 'Mystic Weave Pads'
        $this.MapObjName         = 'mysticweavepads'
        $this.PurchasePrice      = 130
        $this.SellPrice          = 65
        $this.TargetStats        = @{
            [StatId]::Defense = 3
            [StatId]::MagicDefense = 4
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 2
            [StatId]::MagicDefense = 3
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Shoulder pads woven with threads that shimmer with faint magic.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEBronzePauldrons : BEPauldron {
    BEBronzePauldrons() : base() {
        $this.Name               = 'Bronze Pauldrons'
        $this.MapObjName         = 'bronzepauldrons'
        $this.PurchasePrice      = 140
        $this.SellPrice          = 70
        $this.TargetStats        = @{
            [StatId]::Defense = 6
            [StatId]::MagicDefense = 1
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 5
            [StatId]::MagicDefense = 0
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Solid bronze pauldrons offering good physical defense.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGuardiansLeatherSpaulders : BEPauldron {
    BEGuardiansLeatherSpaulders() : base() {
        $this.Name               = 'Guardian''s Leather Spaulders'
        $this.MapObjName         = 'guardiansleatherspaulders'
        $this.PurchasePrice      = 150
        $this.SellPrice          = 75
        $this.TargetStats        = @{
            [StatId]::Defense = 8
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 7
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Sturdy leather spaulders favored by town guards.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEFurLinedShoulderguards : BEPauldron {
    BEFurLinedShoulderguards() : base() {
        $this.Name               = 'Fur-Lined Shoulderguards'
        $this.MapObjName         = 'furlinedshoulderguards'
        $this.PurchasePrice      = 160
        $this.SellPrice          = 80
        $this.TargetStats        = @{
            [StatId]::Defense = 4
            [StatId]::MagicDefense = 3
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 3
            [StatId]::MagicDefense = 2
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Shoulderguards lined with fur for warmth and some protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEIronShoulderPlates : BEPauldron {
    BEIronShoulderPlates() : base() {
        $this.Name               = 'Iron Shoulder Plates'
        $this.MapObjName         = 'ironshoulderplates'
        $this.PurchasePrice      = 170
        $this.SellPrice          = 85
        $this.TargetStats        = @{
            [StatId]::Defense = 7
            [StatId]::MagicDefense = 2
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 6
            [StatId]::MagicDefense = 1
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Simple but effective iron plates for shoulder defense.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEScaledLeatherEpaulets : BEPauldron {
    BEScaledLeatherEpaulets() : base() {
        $this.Name               = 'Scaled Leather Epaulets'
        $this.MapObjName         = 'scaledleatherepaulets'
        $this.PurchasePrice      = 180
        $this.SellPrice          = 90
        $this.TargetStats        = @{
            [StatId]::Defense = 9
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 8
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Epaulets made of leather with overlapping small scales.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEEnchantedLinenPads : BEPauldron {
    BEEnchantedLinenPads() : base() {
        $this.Name               = 'Enchanted Linen Pads'
        $this.MapObjName         = 'enchantedlinenpads'
        $this.PurchasePrice      = 190
        $this.SellPrice          = 95
        $this.TargetStats        = @{
            [StatId]::Defense = 3
            [StatId]::MagicDefense = 5
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 2
            [StatId]::MagicDefense = 4
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Linen shoulder pads imbued with minor magical defenses.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEHeavyWoodenPauldrons : BEPauldron {
    BEHeavyWoodenPauldrons() : base() {
        $this.Name               = 'Heavy Wooden Pauldrons'
        $this.MapObjName         = 'heavywoodenpauldrons'
        $this.PurchasePrice      = 200
        $this.SellPrice          = 100
        $this.TargetStats        = @{
            [StatId]::Defense = 8
            [StatId]::MagicDefense = 1
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 7
            [StatId]::MagicDefense = 0
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Thick, cumbersome wooden pauldrons.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BESpikedIronSpaulders : BEPauldron {
    BESpikedIronSpaulders() : base() {
        $this.Name               = 'Spiked Iron Spaulders'
        $this.MapObjName         = 'spikedironspaulders'
        $this.PurchasePrice      = 220
        $this.SellPrice          = 110
        $this.TargetStats        = @{
            [StatId]::Defense = 10
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 9
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Iron spaulders adorned with intimidating spikes.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BECeremonialShoulderDrapes : BEPauldron {
    BECeremonialShoulderDrapes() : base() {
        $this.Name               = 'Ceremonial Shoulder Drapes'
        $this.MapObjName         = 'ceremonialshoulderdrapes'
        $this.PurchasePrice      = 210
        $this.SellPrice          = 105
        $this.TargetStats        = @{
            [StatId]::Defense = 4
            [StatId]::MagicDefense = 6
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 3
            [StatId]::MagicDefense = 5
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Ornate shoulder drapes used in ceremonies, offering some magical warding.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BESteelPauldrons : BEPauldron {
    BESteelPauldrons() : base() {
        $this.Name               = 'Steel Pauldrons'
        $this.MapObjName         = 'steelpauldrons'
        $this.PurchasePrice      = 250
        $this.SellPrice          = 125
        $this.TargetStats        = @{
            [StatId]::Defense = 12
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 10
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Well-crafted steel pauldrons.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEReinforcedChainSpaulders : BEPauldron {
    BEReinforcedChainSpaulders() : base() {
        $this.Name               = 'Reinforced Chain Spaulders'
        $this.MapObjName         = 'reinforcedchainspaulders'
        $this.PurchasePrice      = 300
        $this.SellPrice          = 150
        $this.TargetStats        = @{
            [StatId]::Defense = 11
            [StatId]::MagicDefense = 4
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 9
            [StatId]::MagicDefense = 3
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Chain spaulders with added plating for better protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEKnightsShoulderguards : BEPauldron {
    BEKnightsShoulderguards() : base() {
        $this.Name               = 'Knight''s Shoulderguards'
        $this.MapObjName         = 'knightsshoulderguards'
        $this.PurchasePrice      = 320
        $this.SellPrice          = 160
        $this.TargetStats        = @{
            [StatId]::Defense = 14
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 11
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Sturdy shoulderguards befitting a knight.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEAdeptMageEpaulets : BEPauldron {
    BEAdeptMageEpaulets() : base() {
        $this.Name               = 'Adept Mage Epaulets'
        $this.MapObjName         = 'adeptmageepaulets'
        $this.PurchasePrice      = 350
        $this.SellPrice          = 175
        $this.TargetStats        = @{
            [StatId]::Defense = 5
            [StatId]::MagicDefense = 10
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 4
            [StatId]::MagicDefense = 8
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Epaulets worn by adept mages, enhancing magical defenses.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEHeavyLeatherPauldrons : BEPauldron {
    BEHeavyLeatherPauldrons() : base() {
        $this.Name               = 'Heavy Leather Pauldrons'
        $this.MapObjName         = 'heavyleatherpauldrons'
        $this.PurchasePrice      = 380
        $this.SellPrice          = 190
        $this.TargetStats        = @{
            [StatId]::Defense = 13
            [StatId]::MagicDefense = 3
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 10
            [StatId]::MagicDefense = 2
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Thick and heavy leather pauldrons.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEOrnateBronzeSpaulders : BEPauldron {
    BEOrnateBronzeSpaulders() : base() {
        $this.Name               = 'Ornate Bronze Spaulders'
        $this.MapObjName         = 'ornatebronzespaulders'
        $this.PurchasePrice      = 400
        $this.SellPrice          = 200
        $this.TargetStats        = @{
            [StatId]::Defense = 15
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 12
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Bronze spaulders with decorative engravings.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BESoldiersSteelPlates : BEPauldron {
    BESoldiersSteelPlates() : base() {
        $this.Name               = 'Soldier''s Steel Plates'
        $this.MapObjName         = 'soldierssteelplates'
        $this.PurchasePrice      = 420
        $this.SellPrice          = 210
        $this.TargetStats        = @{
            [StatId]::Defense = 12
            [StatId]::MagicDefense = 5
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 10
            [StatId]::MagicDefense = 4
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Standard issue steel shoulder plates for soldiers.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEWolfHideShoulderPads : BEPauldron {
    BEWolfHideShoulderPads() : base() {
        $this.Name               = 'Wolf Hide Shoulder Pads'
        $this.MapObjName         = 'wolfhideshoulderpads'
        $this.PurchasePrice      = 450
        $this.SellPrice          = 225
        $this.TargetStats        = @{
            [StatId]::Defense = 16
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 13
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Shoulder pads made from tough wolf hide.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEWardensPauldrons : BEPauldron {
    BEWardensPauldrons() : base() {
        $this.Name               = 'Warden''s Pauldrons'
        $this.MapObjName         = 'wardenspauldrons'
        $this.PurchasePrice      = 480
        $this.SellPrice          = 240
        $this.TargetStats        = @{
            [StatId]::Defense = 14
            [StatId]::MagicDefense = 6
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 11
            [StatId]::MagicDefense = 5
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Pauldrons worn by experienced wardens.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEElvenLeafShoulders : BEPauldron {
    BEElvenLeafShoulders() : base() {
        $this.Name               = 'Elven Leaf Shoulders'
        $this.MapObjName         = 'elvenleafshoulders'
        $this.PurchasePrice      = 500
        $this.SellPrice          = 250
        $this.TargetStats        = @{
            [StatId]::Defense = 8
            [StatId]::MagicDefense = 12
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 6
            [StatId]::MagicDefense = 9
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Graceful shoulder pieces crafted in the likeness of leaves.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEFullSteelSpaulders : BEPauldron {
    BEFullSteelSpaulders() : base() {
        $this.Name               = 'Full Steel Spaulders'
        $this.MapObjName         = 'fullsteelspaulders'
        $this.PurchasePrice      = 550
        $this.SellPrice          = 275
        $this.TargetStats        = @{
            [StatId]::Defense = 18
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 15
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Large steel spaulders providing extensive shoulder coverage.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEEngravedIronPauldrons : BEPauldron {
    BEEngravedIronPauldrons() : base() {
        $this.Name               = 'Engraved Iron Pauldrons'
        $this.MapObjName         = 'engravedironpauldrons'
        $this.PurchasePrice      = 580
        $this.SellPrice          = 290
        $this.TargetStats        = @{
            [StatId]::Defense = 17
            [StatId]::MagicDefense = 4
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 14
            [StatId]::MagicDefense = 3
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Iron pauldrons with intricate engravings.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEBattlemageShoulderguards : BEPauldron {
    BEBattlemageShoulderguards() : base() {
        $this.Name               = 'Battlemage Shoulderguards'
        $this.MapObjName         = 'battlemageshoulderguards'
        $this.PurchasePrice      = 600
        $this.SellPrice          = 300
        $this.TargetStats        = @{
            [StatId]::Defense = 10
            [StatId]::MagicDefense = 10
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 8
            [StatId]::MagicDefense = 8
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Shoulderguards designed for mages who frequent the front lines.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGryphonFeatherEpaulets : BEPauldron {
    BEGryphonFeatherEpaulets() : base() {
        $this.Name               = 'Gryphon Feather Epaulets'
        $this.MapObjName         = 'gryphonfeatherepaulets'
        $this.PurchasePrice      = 620
        $this.SellPrice          = 310
        $this.TargetStats        = @{
            [StatId]::Defense = 19
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 16
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Lightweight epaulets adorned with gryphon feathers.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEPlateShoulderPlates : BEPauldron {
    BEPlateShoulderPlates() : base() {
        $this.Name               = 'Plate Shoulder Plates'
        $this.MapObjName         = 'plateshoulderplates'
        $this.PurchasePrice      = 650
        $this.SellPrice          = 325
        $this.TargetStats        = @{
            [StatId]::Defense = 15
            [StatId]::MagicDefense = 7
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 12
            [StatId]::MagicDefense = 5
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Solid metal plates designed to protect the shoulders.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEShadowSilkPads : BEPauldron {
    BEShadowSilkPads() : base() {
        $this.Name               = 'Shadow Silk Pads'
        $this.MapObjName         = 'shadowsilkpads'
        $this.PurchasePrice      = 680
        $this.SellPrice          = 340
        $this.TargetStats        = @{
            [StatId]::Defense = 9
            [StatId]::MagicDefense = 13
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 7
            [StatId]::MagicDefense = 10
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Shoulder pads made from dark, magically imbued silk.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEDwarvenSteelPauldrons : BEPauldron {
    BEDwarvenSteelPauldrons() : base() {
        $this.Name               = 'Dwarven Steel Pauldrons'
        $this.MapObjName         = 'dwarvensteelpauldrons'
        $this.PurchasePrice      = 700
        $this.SellPrice          = 350
        $this.TargetStats        = @{
            [StatId]::Defense = 20
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 17
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Masterfully crafted steel pauldrons of dwarven make.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BESilverThreadEpaulets : BEPauldron {
    BESilverThreadEpaulets() : base() {
        $this.Name               = 'Silver Thread Epaulets'
        $this.MapObjName         = 'silverthreadepaulets'
        $this.PurchasePrice      = 720
        $this.SellPrice          = 360
        $this.TargetStats        = @{
            [StatId]::Defense = 16
            [StatId]::MagicDefense = 8
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 13
            [StatId]::MagicDefense = 6
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Elegant epaulets woven with silver threads.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGladiatorsSpaulders : BEPauldron {
    BEGladiatorsSpaulders() : base() {
        $this.Name               = 'Gladiator''s Spaulders'
        $this.MapObjName         = 'gladiatorsspaulders'
        $this.PurchasePrice      = 750
        $this.SellPrice          = 375
        $this.TargetStats        = @{
            [StatId]::Defense = 22
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 19
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Spaulders worn by arena champions, scarred from battle.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BERunicLeatherShoulders : BEPauldron {
    BERunicLeatherShoulders() : base() {
        $this.Name               = 'Runic Leather Shoulders'
        $this.MapObjName         = 'runicleathershoulders'
        $this.PurchasePrice      = 780
        $this.SellPrice          = 390
        $this.TargetStats        = @{
            [StatId]::Defense = 12
            [StatId]::MagicDefense = 11
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 10
            [StatId]::MagicDefense = 9
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Leather shoulder pieces inscribed with protective runes.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEObsidianChipPauldrons : BEPauldron {
    BEObsidianChipPauldrons() : base() {
        $this.Name               = 'Obsidian Chip Pauldrons'
        $this.MapObjName         = 'obsidianchippauldrons'
        $this.PurchasePrice      = 800
        $this.SellPrice          = 400
        $this.TargetStats        = @{
            [StatId]::Defense = 21
            [StatId]::MagicDefense = 5
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 18
            [StatId]::MagicDefense = 4
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Pauldrons embedded with sharp obsidian chips.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEForestGuardMantle : BEPauldron {
    BEForestGuardMantle() : base() {
        $this.Name               = 'Forest Guard Mantle'
        $this.MapObjName         = 'forestguardmantle'
        $this.PurchasePrice      = 830
        $this.SellPrice          = 415
        $this.TargetStats        = @{
            [StatId]::Defense = 18
            [StatId]::MagicDefense = 9
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 15
            [StatId]::MagicDefense = 7
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A mantle worn by guardians of the forest, blending protection and camouflage.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BESpellWovenShoulderguards : BEPauldron {
    BESpellWovenShoulderguards() : base() {
        $this.Name               = 'Spell-Woven Shoulderguards'
        $this.MapObjName         = 'spellwovenshoulderguards'
        $this.PurchasePrice      = 850
        $this.SellPrice          = 425
        $this.TargetStats        = @{
            [StatId]::Defense = 11
            [StatId]::MagicDefense = 14
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 9
            [StatId]::MagicDefense = 11
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Shoulderguards with magical enchantments woven into their fabric.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEHeavySteelPauldrons : BEPauldron {
    BEHeavySteelPauldrons() : base() {
        $this.Name               = 'Heavy Steel Pauldrons'
        $this.MapObjName         = 'heavysteelpauldrons'
        $this.PurchasePrice      = 880
        $this.SellPrice          = 440
        $this.TargetStats        = @{
            [StatId]::Defense = 24
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 20
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Thick, heavy steel pauldrons for maximum physical defense.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEWyrmScaleSpaulders : BEPauldron {
    BEWyrmScaleSpaulders() : base() {
        $this.Name               = 'Wyrm Scale Spaulders'
        $this.MapObjName         = 'wyrmscalespaulders'
        $this.PurchasePrice      = 900
        $this.SellPrice          = 450
        $this.TargetStats        = @{
            [StatId]::Defense = 23
            [StatId]::MagicDefense = 6
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 19
            [StatId]::MagicDefense = 5
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Spaulders crafted from the scales of a young wyrm.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEEnchantedSteelEpaulets : BEPauldron {
    BEEnchantedSteelEpaulets() : base() {
        $this.Name               = 'Enchanted Steel Epaulets'
        $this.MapObjName         = 'enchantedsteelepaulets'
        $this.PurchasePrice      = 920
        $this.SellPrice          = 460
        $this.TargetStats        = @{
            [StatId]::Defense = 17
            [StatId]::MagicDefense = 10
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 14
            [StatId]::MagicDefense = 8
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Steel epaulets imbued with protective enchantments.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEBarbarianFurShoulders : BEPauldron {
    BEBarbarianFurShoulders() : base() {
        $this.Name               = 'Barbarian Fur Shoulders'
        $this.MapObjName         = 'barbarianfurshoulders'
        $this.PurchasePrice      = 950
        $this.SellPrice          = 475
        $this.TargetStats        = @{
            [StatId]::Defense = 25
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 21
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Thick fur shoulder coverings favored by barbarians.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEAncientGlyphPauldrons : BEPauldron {
    BEAncientGlyphPauldrons() : base() {
        $this.Name               = 'Ancient Glyph Pauldrons'
        $this.MapObjName         = 'ancientglyphpauldrons'
        $this.PurchasePrice      = 980
        $this.SellPrice          = 490
        $this.TargetStats        = @{
            [StatId]::Defense = 19
            [StatId]::MagicDefense = 12
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 16
            [StatId]::MagicDefense = 10
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Pauldrons marked with ancient, powerful glyphs.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BESorcerersShoulderDrapes : BEPauldron {
    BESorcerersShoulderDrapes() : base() {
        $this.Name               = 'Sorcerer''s Shoulder Drapes'
        $this.MapObjName         = 'sorcerersshoulderdrapes'
        $this.PurchasePrice      = 1000
        $this.SellPrice          = 500
        $this.TargetStats        = @{
            [StatId]::Defense = 13
            [StatId]::MagicDefense = 15
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 10
            [StatId]::MagicDefense = 12
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Ornate drapes worn by sorcerers, offering magical protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEKnightCommanderPauldrons : BEPauldron {
    BEKnightCommanderPauldrons() : base() {
        $this.Name               = 'Knight Commander Pauldrons'
        $this.MapObjName         = 'knightcommanderpauldrons'
        $this.PurchasePrice      = 1050
        $this.SellPrice          = 525
        $this.TargetStats        = @{
            [StatId]::Defense = 26
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 22
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Impressive pauldrons worn by knight commanders.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEMithrilPauldrons : BEPauldron {
    BEMithrilPauldrons() : base() {
        $this.Name               = 'Mithril Pauldrons'
        $this.MapObjName         = 'mithrilpauldrons'
        $this.PurchasePrice      = 1100
        $this.SellPrice          = 550
        $this.TargetStats        = @{
            [StatId]::Defense = 28
            [StatId]::MagicDefense = 10
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 23
            [StatId]::MagicDefense = 8
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Light yet incredibly strong pauldrons made of mithril.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEAdamantiteSpaulders : BEPauldron {
    BEAdamantiteSpaulders() : base() {
        $this.Name               = 'Adamantite Spaulders'
        $this.MapObjName         = 'adamantitespaulders'
        $this.PurchasePrice      = 1200
        $this.SellPrice          = 600
        $this.TargetStats        = @{
            [StatId]::Defense = 30
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 25
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Spaulders forged from nearly indestructible adamantite.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEArchonsEpaulets : BEPauldron {
    BEArchonsEpaulets() : base() {
        $this.Name               = 'Archon''s Epaulets'
        $this.MapObjName         = 'archonsepaulets'
        $this.PurchasePrice      = 1250
        $this.SellPrice          = 625
        $this.TargetStats        = @{
            [StatId]::Defense = 15
            [StatId]::MagicDefense = 20
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 12
            [StatId]::MagicDefense = 16
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Epaulets imbued with the power of an archon.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEDragonhideShoulderguards : BEPauldron {
    BEDragonhideShoulderguards() : base() {
        $this.Name               = 'Dragonhide Shoulderguards'
        $this.MapObjName         = 'dragonhideshoulderguards'
        $this.PurchasePrice      = 1300
        $this.SellPrice          = 650
        $this.TargetStats        = @{
            [StatId]::Defense = 32
            [StatId]::MagicDefense = 8
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 26
            [StatId]::MagicDefense = 6
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Shoulderguards crafted from resilient dragonhide.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEStarSilverPauldrons : BEPauldron {
    BEStarSilverPauldrons() : base() {
        $this.Name               = 'Star Silver Pauldrons'
        $this.MapObjName         = 'starsilverpauldrons'
        $this.PurchasePrice      = 1350
        $this.SellPrice          = 675
        $this.TargetStats        = @{
            [StatId]::Defense = 29
            [StatId]::MagicDefense = 12
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 24
            [StatId]::MagicDefense = 10
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Pauldrons made from silver mined from a fallen star.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEPaladinsShoulderPlates : BEPauldron {
    BEPaladinsShoulderPlates() : base() {
        $this.Name               = 'Paladin''s Shoulder Plates'
        $this.MapObjName         = 'paladinsshoulderplates'
        $this.PurchasePrice      = 1400
        $this.SellPrice          = 700
        $this.TargetStats        = @{
            [StatId]::Defense = 35
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 29
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Blessed shoulder plates worn by holy warriors.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEVoidtouchedMantle : BEPauldron {
    BEVoidtouchedMantle() : base() {
        $this.Name               = 'Void-touched Mantle'
        $this.MapObjName         = 'voidtouchedmantle'
        $this.PurchasePrice      = 1450
        $this.SellPrice          = 725
        $this.TargetStats        = @{
            [StatId]::Defense = 20
            [StatId]::MagicDefense = 22
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 17
            [StatId]::MagicDefense = 18
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A mantle that seems to shimmer with the emptiness of the void.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEOrichalcumSpaulders : BEPauldron {
    BEOrichalcumSpaulders() : base() {
        $this.Name               = 'Orichalcum Spaulders'
        $this.MapObjName         = 'orichalcumspaulders'
        $this.PurchasePrice      = 1500
        $this.SellPrice          = 750
        $this.TargetStats        = @{
            [StatId]::Defense = 33
            [StatId]::MagicDefense = 10
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 27
            [StatId]::MagicDefense = 8
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Spaulders crafted from the rare and magically conductive orichalcum.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGolemsHeartPauldrons : BEPauldron {
    BEGolemsHeartPauldrons() : base() {
        $this.Name               = 'Golem''s Heart Pauldrons'
        $this.MapObjName         = 'golemsheartpauldrons'
        $this.PurchasePrice      = 1550
        $this.SellPrice          = 775
        $this.TargetStats        = @{
            [StatId]::Defense = 38
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 31
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Massive pauldrons, as if taken from the core of a golem.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BECelestialWeaveEpaulets : BEPauldron {
    BECelestialWeaveEpaulets() : base() {
        $this.Name               = 'Celestial Weave Epaulets'
        $this.MapObjName         = 'celestialweaveepaulets'
        $this.PurchasePrice      = 1600
        $this.SellPrice          = 800
        $this.TargetStats        = @{
            [StatId]::Defense = 22
            [StatId]::MagicDefense = 25
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 18
            [StatId]::MagicDefense = 20
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Epaulets woven with threads of starlight.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEHellforgedShoulderguards : BEPauldron {
    BEHellforgedShoulderguards() : base() {
        $this.Name               = 'Hellforged Shoulderguards'
        $this.MapObjName         = 'hellforgedshoulderguards'
        $this.PurchasePrice      = 1650
        $this.SellPrice          = 825
        $this.TargetStats        = @{
            [StatId]::Defense = 36
            [StatId]::MagicDefense = 9
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 30
            [StatId]::MagicDefense = 7
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Shoulderguards forged in infernal fires, radiating heat.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEFrostGiantPauldrons : BEPauldron {
    BEFrostGiantPauldrons() : base() {
        $this.Name               = 'Frost Giant Pauldrons'
        $this.MapObjName         = 'frostgiantpauldrons'
        $this.PurchasePrice      = 1700
        $this.SellPrice          = 850
        $this.TargetStats        = @{
            [StatId]::Defense = 40
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 33
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Massive pauldrons taken from a frost giant, chilling to the touch.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEShadowLordSpaulders : BEPauldron {
    BEShadowLordSpaulders() : base() {
        $this.Name               = 'Shadow Lord Spaulders'
        $this.MapObjName         = 'shadowlordspaulders'
        $this.PurchasePrice      = 1750
        $this.SellPrice          = 875
        $this.TargetStats        = @{
            [StatId]::Defense = 25
            [StatId]::MagicDefense = 23
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 20
            [StatId]::MagicDefense = 19
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Spaulders worn by a lord of shadows, difficult to see clearly.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEStormTitanShoulders : BEPauldron {
    BEStormTitanShoulders() : base() {
        $this.Name               = 'Storm Titan Shoulders'
        $this.MapObjName         = 'stormtitanshoulders'
        $this.PurchasePrice      = 1800
        $this.SellPrice          = 900
        $this.TargetStats        = @{
            [StatId]::Defense = 39
            [StatId]::MagicDefense = 11
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 32
            [StatId]::MagicDefense = 9
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Shoulder pieces from a storm titan, crackling with energy.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEPhoenixAshMantle : BEPauldron {
    BEPhoenixAshMantle() : base() {
        $this.Name               = 'Phoenix Ash Mantle'
        $this.MapObjName         = 'phoenixashmantle'
        $this.PurchasePrice      = 1850
        $this.SellPrice          = 925
        $this.TargetStats        = @{
            [StatId]::Defense = 28
            [StatId]::MagicDefense = 28
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 23
            [StatId]::MagicDefense = 23
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A mantle woven from phoenix ash, warm to the touch and resilient.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEAncientKingsPauldrons : BEPauldron {
    BEAncientKingsPauldrons() : base() {
        $this.Name               = 'Ancient King''s Pauldrons'
        $this.MapObjName         = 'ancientkingspauldrons'
        $this.PurchasePrice      = 1900
        $this.SellPrice          = 950
        $this.TargetStats        = @{
            [StatId]::Defense = 42
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 35
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Regal pauldrons belonging to a king from a bygone era.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEEmpyreanGuardEpaulets : BEPauldron {
    BEEmpyreanGuardEpaulets() : base() {
        $this.Name               = 'Empyrean Guard Epaulets'
        $this.MapObjName         = 'empyreanguardepaulets'
        $this.PurchasePrice      = 1950
        $this.SellPrice          = 975
        $this.TargetStats        = @{
            [StatId]::Defense = 30
            [StatId]::MagicDefense = 26
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 25
            [StatId]::MagicDefense = 21
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Epaulets worn by celestial guardians, shimmering with holy light.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEColossalSteelSpaulders : BEPauldron {
    BEColossalSteelSpaulders() : base() {
        $this.Name               = 'Colossal Steel Spaulders'
        $this.MapObjName         = 'colossalsteelspaulders'
        $this.PurchasePrice      = 2000
        $this.SellPrice          = 1000
        $this.TargetStats        = @{
            [StatId]::Defense = 45
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 37
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Spaulders of immense size and weight, made of solid steel.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEWyrmLordShoulderPlates : BEPauldron {
    BEWyrmLordShoulderPlates() : base() {
        $this.Name               = 'Wyrm Lord Shoulder Plates'
        $this.MapObjName         = 'wyrmlordshoulderplates'
        $this.PurchasePrice      = 2100
        $this.SellPrice          = 1050
        $this.TargetStats        = @{
            [StatId]::Defense = 38
            [StatId]::MagicDefense = 15
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 31
            [StatId]::MagicDefense = 12
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Shoulder plates crafted from the scales of a powerful Wyrm Lord.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEBloodRitualPauldrons : BEPauldron {
    BEBloodRitualPauldrons() : base() {
        $this.Name               = 'Blood Ritual Pauldrons'
        $this.MapObjName         = 'bloodritualpauldrons'
        $this.PurchasePrice      = 2200
        $this.SellPrice          = 1100
        $this.TargetStats        = @{
            [StatId]::Defense = 43
            [StatId]::MagicDefense = 10
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 36
            [StatId]::MagicDefense = 8
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Pauldrons stained with blood from dark rituals, emanating a sinister aura.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEOracleWeaveShoulders : BEPauldron {
    BEOracleWeaveShoulders() : base() {
        $this.Name               = 'Oracle Weave Shoulders'
        $this.MapObjName         = 'oracleweaveshoulders'
        $this.PurchasePrice      = 2300
        $this.SellPrice          = 1150
        $this.TargetStats        = @{
            [StatId]::Defense = 27
            [StatId]::MagicDefense = 30
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 22
            [StatId]::MagicDefense = 24
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Shoulder pieces woven with threads that grant foresight.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEAdamantiumPlatedPauldrons : BEPauldron {
    BEAdamantiumPlatedPauldrons() : base() {
        $this.Name               = 'Adamantium-Plated Pauldrons'
        $this.MapObjName         = 'adamantiumplatedpauldrons'
        $this.PurchasePrice      = 2400
        $this.SellPrice          = 1200
        $this.TargetStats        = @{
            [StatId]::Defense = 48
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 39
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Pauldrons reinforced with plates of nearly unbreakable adamantium.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEShadowmeldSpaulders : BEPauldron {
    BEShadowmeldSpaulders() : base() {
        $this.Name               = 'Shadowmeld Spaulders'
        $this.MapObjName         = 'shadowmeldspaulders'
        $this.PurchasePrice      = 2500
        $this.SellPrice          = 1250
        $this.TargetStats        = @{
            [StatId]::Defense = 35
            [StatId]::MagicDefense = 20
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 29
            [StatId]::MagicDefense = 16
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Spaulders that allow the wearer to blend into shadows.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEThunderclapEpaulets : BEPauldron {
    BEThunderclapEpaulets() : base() {
        $this.Name               = 'Thunderclap Epaulets'
        $this.MapObjName         = 'thunderclapepaulets'
        $this.PurchasePrice      = 2600
        $this.SellPrice          = 1300
        $this.TargetStats        = @{
            [StatId]::Defense = 41
            [StatId]::MagicDefense = 18
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 34
            [StatId]::MagicDefense = 14
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Epaulets that crackle with the sound of thunder.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEInfernalSoulPauldrons : BEPauldron {
    BEInfernalSoulPauldrons() : base() {
        $this.Name               = 'Infernal Soul Pauldrons'
        $this.MapObjName         = 'infernalsoulpauldrons'
        $this.PurchasePrice      = 2700
        $this.SellPrice          = 1350
        $this.TargetStats        = @{
            [StatId]::Defense = 32
            [StatId]::MagicDefense = 29
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 26
            [StatId]::MagicDefense = 23
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Pauldrons imbued with the tormented souls of the inferno.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEChampionOfTheLightShoulders : BEPauldron {
    BEChampionOfTheLightShoulders() : base() {
        $this.Name               = 'Champion of the Light Shoulders'
        $this.MapObjName         = 'championofthelightshoulders'
        $this.PurchasePrice      = 2800
        $this.SellPrice          = 1400
        $this.TargetStats        = @{
            [StatId]::Defense = 50
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 41
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Shoulderguards worn by a champion dedicated to the light.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEStarfallMantle : BEPauldron {
    BEStarfallMantle() : base() {
        $this.Name               = 'Starfall Mantle'
        $this.MapObjName         = 'starfallmantle'
        $this.PurchasePrice      = 2850
        $this.SellPrice          = 1425
        $this.TargetStats        = @{
            [StatId]::Defense = 38
            [StatId]::MagicDefense = 32
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 31
            [StatId]::MagicDefense = 26
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A mantle that seems to capture the essence of falling stars.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGorgonScalePauldrons : BEPauldron {
    BEGorgonScalePauldrons() : base() {
        $this.Name               = 'Gorgon Scale Pauldrons'
        $this.MapObjName         = 'gorgonscalepauldrons'
        $this.PurchasePrice      = 2900
        $this.SellPrice          = 1450
        $this.TargetStats        = @{
            [StatId]::Defense = 46
            [StatId]::MagicDefense = 14
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 38
            [StatId]::MagicDefense = 11
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Pauldrons crafted from the petrifying scales of a gorgon.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEVoidForgedSpaulders : BEPauldron {
    BEVoidForgedSpaulders() : base() {
        $this.Name               = 'Void-Forged Spaulders'
        $this.MapObjName         = 'voidforgedspaulders'
        $this.PurchasePrice      = 2950
        $this.SellPrice          = 1475
        $this.TargetStats        = @{
            [StatId]::Defense = 30
            [StatId]::MagicDefense = 35
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 25
            [StatId]::MagicDefense = 28
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Spaulders seemingly forged from the emptiness of the void.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEArchonBlessedPauldrons : BEPauldron {
    BEArchonBlessedPauldrons() : base() {
        $this.Name               = 'Archon-Blessed Pauldrons'
        $this.MapObjName         = 'archonblessedpauldrons'
        $this.PurchasePrice      = 3000
        $this.SellPrice          = 1500
        $this.TargetStats        = @{
            [StatId]::Defense = 52
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 43
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Pauldrons blessed by a powerful archon.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEDivineGuardianShoulders : BEPauldron {
    BEDivineGuardianShoulders() : base() {
        $this.Name               = 'Divine Guardian Shoulders'
        $this.MapObjName         = 'divineguardianshoulders'
        $this.PurchasePrice      = 3500
        $this.SellPrice          = 1750
        $this.TargetStats        = @{
            [StatId]::Defense = 55
            [StatId]::MagicDefense = 30
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 45
            [StatId]::MagicDefense = 25
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Shoulder pieces imbued with divine energy for ultimate protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEKrakenbonePauldrons : BEPauldron {
    BEKrakenbonePauldrons() : base() {
        $this.Name               = 'Krakenbone Pauldrons'
        $this.MapObjName         = 'krakenbonepauldrons'
        $this.PurchasePrice      = 3800
        $this.SellPrice          = 1900
        $this.TargetStats        = @{
            [StatId]::Defense = 60
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 50
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Pauldrons crafted from the bones of a mighty kraken.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEWarlordsWarPauldrons : BEPauldron {
    BEWarlordsWarPauldrons() : base() {
        $this.Name               = 'Warlord''s War Pauldrons'
        $this.MapObjName         = 'warlordswarpauldrons'
        $this.PurchasePrice      = 4000
        $this.SellPrice          = 2000
        $this.TargetStats        = @{
            [StatId]::Defense = 58
            [StatId]::MagicDefense = 20
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 48
            [StatId]::MagicDefense = 15
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'The imposing war pauldrons of a conquering warlord.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEPrismaticAegisSpaulders : BEPauldron {
    BEPrismaticAegisSpaulders() : base() {
        $this.Name               = 'Prismatic Aegis Spaulders'
        $this.MapObjName         = 'prismaticaegisspaulders'
        $this.PurchasePrice      = 4200
        $this.SellPrice          = 2100
        $this.TargetStats        = @{
            [StatId]::Defense = 40
            [StatId]::MagicDefense = 40
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 33
            [StatId]::MagicDefense = 33
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Spaulders that shimmer with all colors, deflecting various energies.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEBehemothHideMantle : BEPauldron {
    BEBehemothHideMantle() : base() {
        $this.Name               = 'Behemoth Hide Mantle'
        $this.MapObjName         = 'behemothhidemantle'
        $this.PurchasePrice      = 4500
        $this.SellPrice          = 2250
        $this.TargetStats        = @{
            [StatId]::Defense = 65
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 54
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A massive mantle made from the hide of a colossal behemoth.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BESeraphicWingEpaulets : BEPauldron {
    BESeraphicWingEpaulets() : base() {
        $this.Name               = 'Seraphic Wing Epaulets'
        $this.MapObjName         = 'seraphicwingepaulets'
        $this.PurchasePrice      = 4800
        $this.SellPrice          = 2400
        $this.TargetStats        = @{
            [StatId]::Defense = 45
            [StatId]::MagicDefense = 45
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 37
            [StatId]::MagicDefense = 37
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Epaulets shaped like seraphic wings, imbued with holy power.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEDragonSovereignPauldrons : BEPauldron {
    BEDragonSovereignPauldrons() : base() {
        $this.Name               = 'Dragon Sovereign Pauldrons'
        $this.MapObjName         = 'dragonsovereignpauldrons'
        $this.PurchasePrice      = 5200
        $this.SellPrice          = 2600
        $this.TargetStats        = @{
            [StatId]::Defense = 70
            [StatId]::MagicDefense = 25
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 58
            [StatId]::MagicDefense = 20
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Pauldrons fit for a dragon sovereign, immensely powerful.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEAstralGuardianShoulders : BEPauldron {
    BEAstralGuardianShoulders() : base() {
        $this.Name               = 'Astral Guardian Shoulders'
        $this.MapObjName         = 'astralguardianshoulders'
        $this.PurchasePrice      = 5500
        $this.SellPrice          = 2750
        $this.TargetStats        = @{
            [StatId]::Defense = 50
            [StatId]::MagicDefense = 50
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 41
            [StatId]::MagicDefense = 41
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Shoulder pieces woven from astral threads, offering otherworldly protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEInvincibleBulwarkSpaulders : BEPauldron {
    BEInvincibleBulwarkSpaulders() : base() {
        $this.Name               = 'Invincible Bulwark Spaulders'
        $this.MapObjName         = 'invinciblebulwarkspaulders'
        $this.PurchasePrice      = 6000
        $this.SellPrice          = 3000
        $this.TargetStats        = @{
            [StatId]::Defense = 75
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 62
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Spaulders fabled to make the wearer nearly impervious to harm.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEGodhandEmbraceEpaulets : BEPauldron {
    BEGodhandEmbraceEpaulets() : base() {
        $this.Name               = 'Godhand Embrace Epaulets'
        $this.MapObjName         = 'godhandembraceepaulets'
        $this.PurchasePrice      = 6500
        $this.SellPrice          = 3250
        $this.TargetStats        = @{
            [StatId]::Defense = 55
            [StatId]::MagicDefense = 55
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 46
            [StatId]::MagicDefense = 46
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Epaulets said to be touched by a divine entity, granting immense power.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEWorldTreeHeartwoodPauldrons : BEPauldron {
    BEWorldTreeHeartwoodPauldrons() : base() {
        $this.Name               = 'World Tree Heartwood Pauldrons'
        $this.MapObjName         = 'worldtreeheartwoodpauldrons'
        $this.PurchasePrice      = 7000
        $this.SellPrice          = 3500
        $this.TargetStats        = @{
            [StatId]::Defense = 68
            [StatId]::MagicDefense = 35
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 56
            [StatId]::MagicDefense = 28
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Pauldrons crafted from the hardened heartwood of the World Tree.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEPhoenixSoulSpaulders : BEPauldron {
    BEPhoenixSoulSpaulders() : base() {
        $this.Name               = 'Phoenix Soul Spaulders'
        $this.MapObjName         = 'phoenixsoulspaulders'
        $this.PurchasePrice      = 7500
        $this.SellPrice          = 3750
        $this.TargetStats        = @{
            [StatId]::Defense = 78
            [StatId]::MagicDefense = 30
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 65
            [StatId]::MagicDefense = 24
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Spaulders imbued with the fiery spirit and resilience of a phoenix.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEAbyssalVoidMantle : BEPauldron {
    BEAbyssalVoidMantle() : base() {
        $this.Name               = 'Abyssal Void Mantle'
        $this.MapObjName         = 'abyssalvoidmantle'
        $this.PurchasePrice      = 8000
        $this.SellPrice          = 4000
        $this.TargetStats        = @{
            [StatId]::Defense = 60
            [StatId]::MagicDefense = 60
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 50
            [StatId]::MagicDefense = 50
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'A dark mantle that seems to absorb all light and sound, offering profound protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEStarforgedAegisPauldrons : BEPauldron {
    BEStarforgedAegisPauldrons() : base() {
        $this.Name               = 'Starforged Aegis Pauldrons'
        $this.MapObjName         = 'starforgedaegispauldrons'
        $this.PurchasePrice      = 9000
        $this.SellPrice          = 4500
        $this.TargetStats        = @{
            [StatId]::Defense = 80
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 68
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Pauldrons forged in the heart of a dying star, offering unparalleled defense.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEAspectOfTheCreatorShoulders : BEPauldron {
    BEAspectOfTheCreatorShoulders() : base() {
        $this.Name               = 'Aspect of the Creator Shoulders'
        $this.MapObjName         = 'aspectofthecreatorshoulders'
        $this.PurchasePrice      = 10000
        $this.SellPrice          = 5000
        $this.TargetStats        = @{
            [StatId]::Defense = 70
            [StatId]::MagicDefense = 70
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 58
            [StatId]::MagicDefense = 58
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Shoulder pieces said to be a fragment of the Creator''s own power.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}





###############################################################################
#
# BATTLE EQUIPMENT - GAUNTLET SPECIALIZATIONS
#
###############################################################################
Class BEWornLeatherGloves : BEGauntlets {
    BEWornLeatherGloves() : base() {
        $this.Name               = 'Worn Leather Gloves'
        $this.MapObjName         = 'wornleathergloves'
        $this.PurchasePrice      = 15
        $this.SellPrice          = 7
        $this.TargetStats        = @{
            [StatId]::Defense = 1
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 0
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Old, worn leather gloves. Offer minimal protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEClothHandwraps : BEGauntlets {
    BEClothHandwraps() : base() {
        $this.Name               = 'Cloth Handwraps'
        $this.MapObjName         = 'clothhandwraps'
        $this.PurchasePrice      = 20
        $this.SellPrice          = 10
        $this.TargetStats        = @{
            [StatId]::Defense      = 1
            [StatId]::MagicDefense = 1
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 0
            [StatId]::MagicDefense = 0
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Simple cloth wraps for the hands.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BERoughHideGauntlets : BEGauntlets {
    BERoughHideGauntlets() : base() {
        $this.Name               = 'Rough Hide Gauntlets'
        $this.MapObjName         = 'roughhidegauntlets'
        $this.PurchasePrice      = 25
        $this.SellPrice          = 12
        $this.TargetStats        = @{
            [StatId]::Defense = 2
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 1
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Crudely made gauntlets from untanned hide.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEPaddedGloves : BEGauntlets {
    BEPaddedGloves() : base() {
        $this.Name               = 'Padded Gloves'
        $this.MapObjName         = 'paddedgloves'
        $this.PurchasePrice      = 30
        $this.SellPrice          = 15
        $this.TargetStats        = @{
            [StatId]::Defense      = 2
            [StatId]::MagicDefense = 1
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 1
            [StatId]::MagicDefense = 0
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gloves with some extra padding for minor impacts.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BESimpleWoodenBracers : BEGauntlets {
    BESimpleWoodenBracers() : base() {
        $this.Name               = 'Simple Wooden Bracers'
        $this.MapObjName         = 'simplewoodenbracers'
        $this.PurchasePrice      = 35
        $this.SellPrice          = 17
        $this.TargetStats        = @{
            [StatId]::Defense = 3
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 2
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Basic wooden bracers, better than nothing.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BERustedIronMitts : BEGauntlets {
    BERustedIronMitts() : base() {
        $this.Name               = 'Rusted Iron Mitts'
        $this.MapObjName         = 'rustedironmitts'
        $this.PurchasePrice      = 40
        $this.SellPrice          = 20
        $this.TargetStats        = @{
            [StatId]::Defense = 3
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 2
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Iron mitts, heavily rusted but still somewhat protective.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEThinLeatherCuffs : BEGauntlets {
    BEThinLeatherCuffs() : base() {
        $this.Name               = 'Thin Leather Cuffs'
        $this.MapObjName         = 'thinleathercuffs'
        $this.PurchasePrice      = 45
        $this.SellPrice          = 22
        $this.TargetStats        = @{
            [StatId]::Defense      = 2
            [StatId]::MagicDefense = 2
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 1
            [StatId]::MagicDefense = 1
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Thin cuffs made of treated leather.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEWorkmansGloves : BEGauntlets {
    BEWorkmansGloves() : base() {
        $this.Name               = 'Workman''s Gloves'
        $this.MapObjName         = 'workmansgloves'
        $this.PurchasePrice      = 50
        $this.SellPrice          = 25
        $this.TargetStats        = @{
            [StatId]::Defense = 4
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 3
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Sturdy gloves designed for manual labor, offering some protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEBanditHideGloves : BEGauntlets {
    BEBanditHideGloves() : base() {
        $this.Name               = 'Bandit Hide Gloves'
        $this.MapObjName         = 'bandithidegloves'
        $this.PurchasePrice      = 55
        $this.SellPrice          = 27
        $this.TargetStats        = @{
            [StatId]::Defense = 4
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 3
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gloves crudely fashioned from various animal hides, common among bandits.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEInitiatesHandwraps : BEGauntlets {
    BEInitiatesHandwraps() : base() {
        $this.Name               = 'Initiate''s Handwraps'
        $this.MapObjName         = 'initiateshandwraps'
        $this.PurchasePrice      = 60
        $this.SellPrice          = 30
        $this.TargetStats        = @{
            [StatId]::Defense      = 2
            [StatId]::MagicDefense = 3
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 1
            [StatId]::MagicDefense = 1
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Handwraps given to new initiates of a mystical order.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEStuddedLeatherGloves : BEGauntlets {
    BEStuddedLeatherGloves() : base() {
        $this.Name               = 'Studded Leather Gloves'
        $this.MapObjName         = 'studdedleathergloves'
        $this.PurchasePrice      = 75
        $this.SellPrice          = 37
        $this.TargetStats        = @{
            [StatId]::Defense = 5
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 4
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Leather gloves reinforced with metal studs.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEBronzeKnuckles : BEGauntlets {
    BEBronzeKnuckles() : base() {
        $this.Name               = 'Bronze Knuckles'
        $this.MapObjName         = 'bronzeknuckles'
        $this.PurchasePrice      = 80
        $this.SellPrice          = 40
        $this.TargetStats        = @{
            [StatId]::Defense = 6
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 4
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Bronze knuckles that add a bit of punch and protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEIronGauntletsLight : BEGauntlets {
    BEIronGauntletsLight() : base() {
        $this.Name               = 'Light Iron Gauntlets'
        $this.MapObjName         = 'lightirongauntlets'
        $this.PurchasePrice      = 100
        $this.SellPrice          = 50
        $this.TargetStats        = @{
            [StatId]::Defense = 7
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 5
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets made of thin iron plates.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEHardenedLeatherBracers : BEGauntlets {
    BEHardenedLeatherBracers() : base() {
        $this.Name               = 'Hardened Leather Bracers'
        $this.MapObjName         = 'hardenedleatherbracers'
        $this.PurchasePrice      = 110
        $this.SellPrice          = 55
        $this.TargetStats        = @{
            [StatId]::Defense      = 6
            [StatId]::MagicDefense = 2
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 4
            [StatId]::MagicDefense = 1
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Bracers made of specially treated, hardened leather.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEBonePlatedGloves : BEGauntlets {
    BEBonePlatedGloves() : base() {
        $this.Name               = 'Bone-Plated Gloves'
        $this.MapObjName         = 'boneplatedgloves'
        $this.PurchasePrice      = 120
        $this.SellPrice          = 60
        $this.TargetStats        = @{
            [StatId]::Defense = 8
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 6
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gloves reinforced with plates of animal bone.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEThickFurMittens : BEGauntlets {
    BEThickFurMittens() : base() {
        $this.Name               = 'Thick Fur Mittens'
        $this.MapObjName         = 'thickfurmittens'
        $this.PurchasePrice      = 130
        $this.SellPrice          = 65
        $this.TargetStats        = @{
            [StatId]::Defense      = 4
            [StatId]::MagicDefense = 4
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 3
            [StatId]::MagicDefense = 2
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Very thick mittens made of animal fur, surprisingly protective.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BECopperGauntlets : BEGauntlets {
    BECopperGauntlets() : base() {
        $this.Name               = 'Copper Gauntlets'
        $this.MapObjName         = 'coppergauntlets'
        $this.PurchasePrice      = 140
        $this.SellPrice          = 70
        $this.TargetStats        = @{
            [StatId]::Defense = 9
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 7
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets crafted from beaten copper.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEEnchantedLeatherGloves : BEGauntlets {
    BEEnchantedLeatherGloves() : base() {
        $this.Name               = 'Enchanted Leather Gloves'
        $this.MapObjName         = 'enchantedleathergloves'
        $this.PurchasePrice      = 150
        $this.SellPrice          = 75
        $this.TargetStats        = @{
            [StatId]::Defense      = 5
            [StatId]::MagicDefense = 5
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 4
            [StatId]::MagicDefense = 3
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Leather gloves imbued with a faint magical aura.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEIronHandguards : BEGauntlets {
    BEIronHandguards() : base() {
        $this.Name               = 'Iron Handguards'
        $this.MapObjName         = 'ironhandguards'
        $this.PurchasePrice      = 160
        $this.SellPrice          = 80
        $this.TargetStats        = @{
            [StatId]::Defense = 10
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 8
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Solid iron guards that protect the back of the hands.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEWolfskinGloves : BEGauntlets {
    BEWolfskinGloves() : base() {
        $this.Name               = 'Wolfskin Gloves'
        $this.MapObjName         = 'wolfskingloves'
        $this.PurchasePrice      = 170
        $this.SellPrice          = 85
        $this.TargetStats        = @{
            [StatId]::Defense      = 7
            [StatId]::MagicDefense = 3
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 5
            [StatId]::MagicDefense = 1
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gloves made from tough wolfskin, offering decent protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BESteelGauntlets : BEGauntlets {
    BESteelGauntlets() : base() {
        $this.Name               = 'Steel Gauntlets'
        $this.MapObjName         = 'steelgauntlets'
        $this.PurchasePrice      = 200
        $this.SellPrice          = 100
        $this.TargetStats        = @{
            [StatId]::Defense = 12
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 9
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Well-made gauntlets of polished steel.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEChainmailGloves : BEGauntlets {
    BEChainmailGloves() : base() {
        $this.Name               = 'Chainmail Gloves'
        $this.MapObjName         = 'chainmailgloves'
        $this.PurchasePrice      = 220
        $this.SellPrice          = 110
        $this.TargetStats        = @{
            [StatId]::Defense      = 10
            [StatId]::MagicDefense = 4
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 8
            [StatId]::MagicDefense = 2
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gloves made of interlocking metal rings.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEReinforcedIronGauntlets : BEGauntlets {
    BEReinforcedIronGauntlets() : base() {
        $this.Name               = 'Reinforced Iron Gauntlets'
        $this.MapObjName         = 'reinforcedirongauntlets'
        $this.PurchasePrice      = 240
        $this.SellPrice          = 120
        $this.TargetStats        = @{
            [StatId]::Defense = 14
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 11
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Iron gauntlets with extra plating for improved defense.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEScaleGauntlets : BEGauntlets {
    BEScaleGauntlets() : base() {
        $this.Name               = 'Scale Gauntlets'
        $this.MapObjName         = 'scalegauntlets'
        $this.PurchasePrice      = 260
        $this.SellPrice          = 130
        $this.TargetStats        = @{
            [StatId]::Defense      = 11
            [StatId]::MagicDefense = 5
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 9
            [StatId]::MagicDefense = 3
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets covered in small, overlapping metal scales.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEFineLeatherGloves : BEGauntlets {
    BEFineLeatherGloves() : base() {
        $this.Name               = 'Fine Leather Gloves'
        $this.MapObjName         = 'fineleathergloves'
        $this.PurchasePrice      = 280
        $this.SellPrice          = 140
        $this.TargetStats        = @{
            [StatId]::Defense      = 8
            [StatId]::MagicDefense = 7
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 6
            [StatId]::MagicDefense = 4
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gloves crafted from high-quality, supple leather.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEWarriorsBracers : BEGauntlets {
    BEWarriorsBracers() : base() {
        $this.Name               = 'Warrior''s Bracers'
        $this.MapObjName         = 'warriorsbracers'
        $this.PurchasePrice      = 300
        $this.SellPrice          = 150
        $this.TargetStats        = @{
            [StatId]::Defense = 16
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 12
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Sturdy bracers favored by experienced warriors.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEGuardsGauntlets : BEGauntlets {
    BEGuardsGauntlets() : base() {
        $this.Name               = 'Guard''s Gauntlets'
        $this.MapObjName         = 'guardsgauntlets'
        $this.PurchasePrice      = 320
        $this.SellPrice          = 160
        $this.TargetStats        = @{
            [StatId]::Defense = 17
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 13
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Standard issue gauntlets for city guards.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEAcolytesGloves : BEGauntlets {
    BEAcolytesGloves() : base() {
        $this.Name               = 'Acolyte''s Gloves'
        $this.MapObjName         = 'acolytesgloves'
        $this.PurchasePrice      = 340
        $this.SellPrice          = 170
        $this.TargetStats        = @{
            [StatId]::Defense      = 7
            [StatId]::MagicDefense = 10
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 5
            [StatId]::MagicDefense = 6
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gloves worn by acolytes, offering some magical protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEHeavyIronGauntlets : BEGauntlets {
    BEHeavyIronGauntlets() : base() {
        $this.Name               = 'Heavy Iron Gauntlets'
        $this.MapObjName         = 'heavyirongauntlets'
        $this.PurchasePrice      = 360
        $this.SellPrice          = 180
        $this.TargetStats        = @{
            [StatId]::Defense = 18
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 14
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Bulky iron gauntlets providing substantial defense.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEBearClawGauntlets : BEGauntlets {
    BEBearClawGauntlets() : base() {
        $this.Name               = 'Bear Claw Gauntlets'
        $this.MapObjName         = 'bearclawgauntlets'
        $this.PurchasePrice      = 380
        $this.SellPrice          = 190
        $this.TargetStats        = @{
            [StatId]::Defense      = 15
            [StatId]::MagicDefense = 2 
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 12
            [StatId]::MagicDefense = 1
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets fashioned with bear claws, intimidating and protective.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BESteelPlateGauntlets : BEGauntlets {
    BESteelPlateGauntlets() : base() {
        $this.Name               = 'Steel Plate Gauntlets'
        $this.MapObjName         = 'steelplategauntlets'
        $this.PurchasePrice      = 450
        $this.SellPrice          = 225
        $this.TargetStats        = @{
            [StatId]::Defense = 20
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 16
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets made of solid steel plates.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BESilveredGauntlets : BEGauntlets {
    BESilveredGauntlets() : base() {
        $this.Name               = 'Silvered Gauntlets'
        $this.MapObjName         = 'silveredgauntlets'
        $this.PurchasePrice      = 480
        $this.SellPrice          = 240
        $this.TargetStats        = @{
            [StatId]::Defense      = 15
            [StatId]::MagicDefense = 8
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 12
            [StatId]::MagicDefense = 5
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Steel gauntlets coated with a layer of silver.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEDwarvenBronzeGauntlets : BEGauntlets {
    BEDwarvenBronzeGauntlets() : base() {
        $this.Name               = 'Dwarven Bronze Gauntlets'
        $this.MapObjName         = 'dwarvenbronzegauntlets'
        $this.PurchasePrice      = 500
        $this.SellPrice          = 250
        $this.TargetStats        = @{
            [StatId]::Defense = 22
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 17
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Sturdy bronze gauntlets of Dwarven make.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEElvenLeatherBracers : BEGauntlets {
    BEElvenLeatherBracers() : base() {
        $this.Name               = 'Elven Leather Bracers'
        $this.MapObjName         = 'elvenleatherbracers'
        $this.PurchasePrice      = 520
        $this.SellPrice          = 260
        $this.TargetStats        = @{
            [StatId]::Defense      = 12
            [StatId]::MagicDefense = 10
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 9
            [StatId]::MagicDefense = 7
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Finely crafted leather bracers of Elven design, light and agile.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEHuntersGloves : BEGauntlets {
    BEHuntersGloves() : base() {
        $this.Name               = 'Hunter''s Gloves'
        $this.MapObjName         = 'huntersgloves'
        $this.PurchasePrice      = 540
        $this.SellPrice          = 270
        $this.TargetStats        = @{
            [StatId]::Defense = 18
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 14
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gloves favored by hunters for their grip and durability.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEFortifiedGauntlets : BEGauntlets {
    BEFortifiedGauntlets() : base() {
        $this.Name               = 'Fortified Gauntlets'
        $this.MapObjName         = 'fortifiedgauntlets'
        $this.PurchasePrice      = 560
        $this.SellPrice          = 280
        $this.TargetStats        = @{
            [StatId]::Defense = 24
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 19
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets heavily reinforced for maximum protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BERunicHandguards : BEGauntlets {
    BERunicHandguards() : base() {
        $this.Name               = 'Runic Handguards'
        $this.MapObjName         = 'runichandguards'
        $this.PurchasePrice      = 580
        $this.SellPrice          = 290
        $this.TargetStats        = @{
            [StatId]::Defense      = 14
            [StatId]::MagicDefense = 12
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 11
            [StatId]::MagicDefense = 8
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Handguards inscribed with protective runes.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BESoldiersSteelGauntlets : BEGauntlets {
    BESoldiersSteelGauntlets() : base() {
        $this.Name               = 'Soldier''s Steel Gauntlets'
        $this.MapObjName         = 'soldierssteelgauntlets'
        $this.PurchasePrice      = 600
        $this.SellPrice          = 300
        $this.TargetStats        = @{
            [StatId]::Defense = 25
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 20
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Standard issue steel gauntlets for soldiers.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEFineChainGloves : BEGauntlets {
    BEFineChainGloves() : base() {
        $this.Name               = 'Fine Chain Gloves'
        $this.MapObjName         = 'finechaingloves'
        $this.PurchasePrice      = 620
        $this.SellPrice          = 310
        $this.TargetStats        = @{
            [StatId]::Defense      = 18
            [StatId]::MagicDefense = 7
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 14
            [StatId]::MagicDefense = 5
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gloves made of finely woven, high-quality chainmail.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEHeavyBronzeGauntlets : BEGauntlets {
    BEHeavyBronzeGauntlets() : base() {
        $this.Name               = 'Heavy Bronze Gauntlets'
        $this.MapObjName         = 'heavybronzegauntlets'
        $this.PurchasePrice      = 640
        $this.SellPrice          = 320
        $this.TargetStats        = @{
            [StatId]::Defense = 26
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 21
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Thick and heavy bronze gauntlets offering substantial protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEMithrilGloves : BEGauntlets {
    BEMithrilGloves() : base() {
        $this.Name               = 'Mithril Gloves'
        $this.MapObjName         = 'mithrilgloves'
        $this.PurchasePrice      = 750
        $this.SellPrice          = 375
        $this.TargetStats        = @{
            [StatId]::Defense      = 20
            [StatId]::MagicDefense = 15
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 16
            [StatId]::MagicDefense = 10
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Lightweight yet incredibly strong gloves made of mithril.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEKnightsGauntlets : BEGauntlets {
    BEKnightsGauntlets() : base() {
        $this.Name               = 'Knight''s Gauntlets'
        $this.MapObjName         = 'knightsgauntlets'
        $this.PurchasePrice      = 800
        $this.SellPrice          = 400
        $this.TargetStats        = @{
            [StatId]::Defense = 30
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 24
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets befitting a knight, offering excellent protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEEnchantersGloves : BEGauntlets {
    BEEnchantersGloves() : base() {
        $this.Name               = 'Enchanter''s Gloves'
        $this.MapObjName         = 'enchantersgloves'
        $this.PurchasePrice      = 850
        $this.SellPrice          = 425
        $this.TargetStats        = @{
            [StatId]::Defense      = 15
            [StatId]::MagicDefense = 20
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 12
            [StatId]::MagicDefense = 15
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gloves favored by enchanters, woven with threads of magic.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEDwarvenSteelGauntlets : BEGauntlets {
    BEDwarvenSteelGauntlets() : base() {
        $this.Name               = 'Dwarven Steel Gauntlets'
        $this.MapObjName         = 'dwarvensteelgauntlets'
        $this.PurchasePrice      = 900
        $this.SellPrice          = 450
        $this.TargetStats        = @{
            [StatId]::Defense = 32
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 26
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Masterfully crafted steel gauntlets of Dwarven make.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEElvenMithrilBracers : BEGauntlets {
    BEElvenMithrilBracers() : base() {
        $this.Name               = 'Elven Mithril Bracers'
        $this.MapObjName         = 'elvenmithrilbracers'
        $this.PurchasePrice      = 950
        $this.SellPrice          = 475
        $this.TargetStats        = @{
            [StatId]::Defense      = 22
            [StatId]::MagicDefense = 18
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 18
            [StatId]::MagicDefense = 13
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Elegant mithril bracers of Elven design, light and strong.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEPlateGauntlets : BEGauntlets {
    BEPlateGauntlets() : base() {
        $this.Name               = 'Plate Gauntlets'
        $this.MapObjName         = 'plategauntlets'
        $this.PurchasePrice      = 1000
        $this.SellPrice          = 500
        $this.TargetStats        = @{
            [StatId]::Defense = 35
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 28
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Heavy gauntlets made of interlocking steel plates.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEBattlemageGauntlets : BEGauntlets {
    BEBattlemageGauntlets() : base() {
        $this.Name               = 'Battlemage Gauntlets'
        $this.MapObjName         = 'battlemagegauntlets'
        $this.PurchasePrice      = 1050
        $this.SellPrice          = 525
        $this.TargetStats        = @{
            [StatId]::Defense      = 20
            [StatId]::MagicDefense = 22
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 16
            [StatId]::MagicDefense = 17
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets designed for mages who engage in close combat.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGryphonClawGloves : BEGauntlets {
    BEGryphonClawGloves() : base() {
        $this.Name               = 'Gryphon Claw Gloves'
        $this.MapObjName         = 'gryphonclawgloves'
        $this.PurchasePrice      = 1100
        $this.SellPrice          = 550
        $this.TargetStats        = @{
            [StatId]::Defense = 33
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 27
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gloves reinforced with sharp gryphon talons.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEShadowSilkGloves : BEGauntlets {
    BEShadowSilkGloves() : base() {
        $this.Name               = 'Shadow Silk Gloves'
        $this.MapObjName         = 'shadowsilkgloves'
        $this.PurchasePrice      = 1150
        $this.SellPrice          = 575
        $this.TargetStats        = @{
            [StatId]::Defense      = 18
            [StatId]::MagicDefense = 25
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 14
            [StatId]::MagicDefense = 19
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gloves woven from enchanted shadow silk, muffling sound.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEOrnateSteelGauntlets : BEGauntlets {
    BEOrnateSteelGauntlets() : base() {
        $this.Name               = 'Ornate Steel Gauntlets'
        $this.MapObjName         = 'ornatesteelgauntlets'
        $this.PurchasePrice      = 1200
        $this.SellPrice          = 600
        $this.TargetStats        = @{
            [StatId]::Defense = 36
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 29
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Steel gauntlets with intricate, decorative engravings.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEDragonscaleGloves : BEGauntlets {
    BEDragonscaleGloves() : base() {
        $this.Name               = 'Dragonscale Gloves'
        $this.MapObjName         = 'dragonscalegloves'
        $this.PurchasePrice      = 1500
        $this.SellPrice          = 750
        $this.TargetStats        = @{
            [StatId]::Defense      = 30
            [StatId]::MagicDefense = 20
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 24
            [StatId]::MagicDefense = 15
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gloves crafted from the tough scales of a dragon.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEObsidianGauntlets : BEGauntlets {
    BEObsidianGauntlets() : base() {
        $this.Name               = 'Obsidian Gauntlets'
        $this.MapObjName         = 'obsidiangauntlets'
        $this.PurchasePrice      = 1600
        $this.SellPrice          = 800
        $this.TargetStats        = @{
            [StatId]::Defense = 40
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 32
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets carved from volcanic obsidian, sharp and resilient.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEOrichalcumBracers : BEGauntlets {
    BEOrichalcumBracers() : base() {
        $this.Name               = 'Orichalcum Bracers'
        $this.MapObjName         = 'orichalcumbracers'
        $this.PurchasePrice      = 1700
        $this.SellPrice          = 850
        $this.TargetStats        = @{
            [StatId]::Defense      = 28
            [StatId]::MagicDefense = 28
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 22
            [StatId]::MagicDefense = 22
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Bracers made of the rare and magically conductive orichalcum.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEAdamantiteGloves : BEGauntlets {
    BEAdamantiteGloves() : base() {
        $this.Name               = 'Adamantite Gloves'
        $this.MapObjName         = 'adamantitegloves'
        $this.PurchasePrice      = 1800
        $this.SellPrice          = 900
        $this.TargetStats        = @{
            [StatId]::Defense = 42
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 34
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gloves woven with adamantite threads, incredibly durable.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BECrystalGauntlets : BEGauntlets {
    BECrystalGauntlets() : base() {
        $this.Name               = 'Crystal Gauntlets'
        $this.MapObjName         = 'crystalgauntlets'
        $this.PurchasePrice      = 1900
        $this.SellPrice          = 950
        $this.TargetStats        = @{
            [StatId]::Defense      = 25
            [StatId]::MagicDefense = 30
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 20
            [StatId]::MagicDefense = 24
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets crafted from enchanted crystal, resonating with magical energy.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEWyvernBoneGauntlets : BEGauntlets {
    BEWyvernBoneGauntlets() : base() {
        $this.Name               = 'Wyvern Bone Gauntlets'
        $this.MapObjName         = 'wyvernbonegauntlets'
        $this.PurchasePrice      = 2000
        $this.SellPrice          = 1000
        $this.TargetStats        = @{
            [StatId]::Defense = 45
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 36
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets made from the dense bones of a wyvern.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEBlessedSteelGauntlets : BEGauntlets {
    BEBlessedSteelGauntlets() : base() {
        $this.Name               = 'Blessed Steel Gauntlets'
        $this.MapObjName         = 'blessedsteelgauntlets'
        $this.PurchasePrice      = 2100
        $this.SellPrice          = 1050
        $this.TargetStats        = @{
            [StatId]::Defense      = 32
            [StatId]::MagicDefense = 25
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 26
            [StatId]::MagicDefense = 19
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Steel gauntlets blessed by a holy cleric, offering divine protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGolemFragmentGauntlets : BEGauntlets {
    BEGolemFragmentGauntlets() : base() {
        $this.Name               = 'Golem Fragment Gauntlets'
        $this.MapObjName         = 'golemfragmentgauntlets'
        $this.PurchasePrice      = 2200
        $this.SellPrice          = 1100
        $this.TargetStats        = @{
            [StatId]::Defense = 48
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 38
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets fashioned from fragments of a powerful stone golem.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BESpiritGuardBracers : BEGauntlets {
    BESpiritGuardBracers() : base() {
        $this.Name               = 'Spirit Guard Bracers'
        $this.MapObjName         = 'spiritguardbracers'
        $this.PurchasePrice      = 2300
        $this.SellPrice          = 1150
        $this.TargetStats        = @{
            [StatId]::Defense      = 28
            [StatId]::MagicDefense = 32
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 22
            [StatId]::MagicDefense = 25
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Bracers that ward off malevolent spirits and magical attacks.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEVolcanicRockGauntlets : BEGauntlets {
    BEVolcanicRockGauntlets() : base() {
        $this.Name               = 'Volcanic Rock Gauntlets'
        $this.MapObjName         = 'volcanicrockgauntlets'
        $this.PurchasePrice      = 2400
        $this.SellPrice          = 1200
        $this.TargetStats        = @{
            [StatId]::Defense = 50
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 40
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets made from hardened volcanic rock, still warm to the touch.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BETitaniumGauntlets : BEGauntlets {
    BETitaniumGauntlets() : base() {
        $this.Name               = 'Titanium Gauntlets'
        $this.MapObjName         = 'titaniumgauntlets'
        $this.PurchasePrice      = 3000
        $this.SellPrice          = 1500
        $this.TargetStats        = @{
            [StatId]::Defense = 55
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 44
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets forged from exceptionally strong and light titanium.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEStarMetalBracers : BEGauntlets {
    BEStarMetalBracers() : base() {
        $this.Name               = 'Star Metal Bracers'
        $this.MapObjName         = 'starmetalbracers'
        $this.PurchasePrice      = 3200
        $this.SellPrice          = 1600
        $this.TargetStats        = @{
            [StatId]::Defense      = 40
            [StatId]::MagicDefense = 35
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 32
            [StatId]::MagicDefense = 28
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Bracers made from metal fallen from the stars, humming with energy.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEVoidTouchedGauntlets : BEGauntlets {
    BEVoidTouchedGauntlets() : base() {
        $this.Name               = 'Void-Touched Gauntlets'
        $this.MapObjName         = 'voidtouchedgauntlets'
        $this.PurchasePrice      = 3400
        $this.SellPrice          = 1700
        $this.TargetStats        = @{
            [StatId]::Defense      = 35
            [StatId]::MagicDefense = 40
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 28
            [StatId]::MagicDefense = 32
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets that seem to absorb light, touched by the void.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEAncientRunicGauntlets : BEGauntlets {
    BEAncientRunicGauntlets() : base() {
        $this.Name               = 'Ancient Runic Gauntlets'
        $this.MapObjName         = 'ancientrunicgauntlets'
        $this.PurchasePrice      = 3600
        $this.SellPrice          = 1800
        $this.TargetStats        = @{
            [StatId]::Defense      = 45
            [StatId]::MagicDefense = 30
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 36
            [StatId]::MagicDefense = 24
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets covered in ancient, powerful runes of protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEDrakeScaleGauntlets : BEGauntlets {
    BEDrakeScaleGauntlets() : base() {
        $this.Name               = 'Drake Scale Gauntlets'
        $this.MapObjName         = 'drakescalegauntlets'
        $this.PurchasePrice      = 3800
        $this.SellPrice          = 1900
        $this.TargetStats        = @{
            [StatId]::Defense = 60
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 48
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets crafted from the tough scales of a fire drake.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEPaladinsGauntlets : BEGauntlets {
    BEPaladinsGauntlets() : base() {
        $this.Name               = 'Paladin''s Gauntlets'
        $this.MapObjName         = 'paladinsgauntlets'
        $this.PurchasePrice      = 4000
        $this.SellPrice          = 2000
        $this.TargetStats        = @{
            [StatId]::Defense      = 50
            [StatId]::MagicDefense = 25
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 40
            [StatId]::MagicDefense = 20
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets blessed for a holy warrior, radiating divine protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEArchmagesHandguards : BEGauntlets {
    BEArchmagesHandguards() : base() {
        $this.Name               = 'Archmage''s Handguards'
        $this.MapObjName         = 'archmageshandguards'
        $this.PurchasePrice      = 4200
        $this.SellPrice          = 2100
        $this.TargetStats        = @{
            [StatId]::Defense      = 30
            [StatId]::MagicDefense = 45
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 24
            [StatId]::MagicDefense = 36
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Handguards worn by powerful archmages, crackling with arcane energy.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEBlacksteelGauntlets : BEGauntlets {
    BEBlacksteelGauntlets() : base() {
        $this.Name               = 'Blacksteel Gauntlets'
        $this.MapObjName         = 'blacksteelgauntlets'
        $this.PurchasePrice      = 4400
        $this.SellPrice          = 2200
        $this.TargetStats        = @{
            [StatId]::Defense = 65
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 52
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets forged from rare blacksteel, known for its resilience.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEGryphonKnightGauntlets : BEGauntlets {
    BEGryphonKnightGauntlets() : base() {
        $this.Name               = 'Gryphon Knight Gauntlets'
        $this.MapObjName         = 'gryphonknightgauntlets'
        $this.PurchasePrice      = 4600
        $this.SellPrice          = 2300
        $this.TargetStats        = @{
            [StatId]::Defense      = 58
            [StatId]::MagicDefense = 20
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 46
            [StatId]::MagicDefense = 16
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets worn by knights who ride gryphons into battle.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BESunstoneInfusedGloves : BEGauntlets {
    BESunstoneInfusedGloves() : base() {
        $this.Name               = 'Sunstone-Infused Gloves'
        $this.MapObjName         = 'sunstoneinfusedgloves'
        $this.PurchasePrice      = 4800
        $this.SellPrice          = 2400
        $this.TargetStats        = @{
            [StatId]::Defense      = 38
            [StatId]::MagicDefense = 42
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 30
            [StatId]::MagicDefense = 33
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gloves infused with the radiant energy of sunstones.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEDragonboneGauntlets : BEGauntlets {
    BEDragonboneGauntlets() : base() {
        $this.Name               = 'Dragonbone Gauntlets'
        $this.MapObjName         = 'dragonbonegauntlets'
        $this.PurchasePrice      = 6000
        $this.SellPrice          = 3000
        $this.TargetStats        = @{
            [StatId]::Defense = 70
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 56
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets crafted from the ancient bones of a powerful dragon.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BECelestialVambraces : BEGauntlets {
    BECelestialVambraces() : base() {
        $this.Name               = 'Celestial Vambraces'
        $this.MapObjName         = 'celestialvambraces'
        $this.PurchasePrice      = 6500
        $this.SellPrice          = 3250
        $this.TargetStats        = @{
            [StatId]::Defense      = 50
            [StatId]::MagicDefense = 50
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 40
            [StatId]::MagicDefense = 40
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Vambraces that shimmer with celestial light, offering balanced protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEDemonicClaws : BEGauntlets {
    BEDemonicClaws() : base() {
        $this.Name               = 'Demonic Claws'
        $this.MapObjName         = 'demonicclaws'
        $this.PurchasePrice      = 6800
        $this.SellPrice          = 3400
        $this.TargetStats        = @{
            [StatId]::Defense = 75
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 60
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets ending in wicked demonic claws, surprisingly defensive.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEAbyssalGauntlets : BEGauntlets {
    BEAbyssalGauntlets() : base() {
        $this.Name               = 'Abyssal Gauntlets'
        $this.MapObjName         = 'abyssalgauntlets'
        $this.PurchasePrice      = 7000
        $this.SellPrice          = 3500
        $this.TargetStats        = @{
            [StatId]::Defense      = 60
            [StatId]::MagicDefense = 45
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 48
            [StatId]::MagicDefense = 36
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets forged in the abyss, cold to the touch and unnervingly silent.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEPhoenixTalonGloves : BEGauntlets {
    BEPhoenixTalonGloves() : base() {
        $this.Name               = 'Phoenix Talon Gloves'
        $this.MapObjName         = 'phoenixtalongloves'
        $this.PurchasePrice      = 7200
        $this.SellPrice          = 3600
        $this.TargetStats        = @{
            [StatId]::Defense      = 55
            [StatId]::MagicDefense = 55
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 44
            [StatId]::MagicDefense = 44
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gloves adorned with phoenix talons, warm and imbued with regenerative magic.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BETitanForgedGauntlets : BEGauntlets {
    BETitanForgedGauntlets() : base() {
        $this.Name               = 'Titan-Forged Gauntlets'
        $this.MapObjName         = 'titanforgedgauntlets'
        $this.PurchasePrice      = 7500
        $this.SellPrice          = 3750
        $this.TargetStats        = @{
            [StatId]::Defense = 80
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 64
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Massive gauntlets, as if forged by titans themselves.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEStormheraldGauntlets : BEGauntlets {
    BEStormheraldGauntlets() : base() {
        $this.Name               = 'Stormherald Gauntlets'
        $this.MapObjName         = 'stormheraldgauntlets'
        $this.PurchasePrice      = 7800
        $this.SellPrice          = 3900
        $this.TargetStats        = @{
            [StatId]::Defense      = 65
            [StatId]::MagicDefense = 40
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 52
            [StatId]::MagicDefense = 32
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets that crackle with the energy of a coming storm.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEHolyVindicatorGauntlets : BEGauntlets {
    BEHolyVindicatorGauntlets() : base() {
        $this.Name               = 'Holy Vindicator Gauntlets'
        $this.MapObjName         = 'holyvindicatorgauntlets'
        $this.PurchasePrice      = 8000
        $this.SellPrice          = 4000
        $this.TargetStats        = @{
            [StatId]::Defense      = 68
            [StatId]::MagicDefense = 38
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 54
            [StatId]::MagicDefense = 30
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets worn by holy vindicators, radiating righteous power.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEInfernalGraspGauntlets : BEGauntlets {
    BEInfernalGraspGauntlets() : base() {
        $this.Name               = 'Infernal Grasp Gauntlets'
        $this.MapObjName         = 'infernalgraspgauntlets'
        $this.PurchasePrice      = 8200
        $this.SellPrice          = 4100
        $this.TargetStats        = @{
            [StatId]::Defense = 82
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 66
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets that seem to burn with an inner fire, offering fearsome protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEWorldTreeVambraces : BEGauntlets {
    BEWorldTreeVambraces() : base() {
        $this.Name               = 'World Tree Vambraces'
        $this.MapObjName         = 'worldtreevambraces'
        $this.PurchasePrice      = 8500
        $this.SellPrice          = 4250
        $this.TargetStats        = @{
            [StatId]::Defense      = 62
            [StatId]::MagicDefense = 58
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 50
            [StatId]::MagicDefense = 46
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Vambraces crafted from the living wood of the World Tree.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

# Tier 9: Artifact Tier
Class BEGauntletsOfOdin : BEGauntlets {
    BEGauntletsOfOdin() : base() {
        $this.Name               = 'Gauntlets of Odin'
        $this.MapObjName         = 'gauntletsofodin'
        $this.PurchasePrice      = 10000
        $this.SellPrice          = 5000
        $this.TargetStats        = @{
            [StatId]::Defense      = 80
            [StatId]::MagicDefense = 50
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 64
            [StatId]::MagicDefense = 40
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Legendary gauntlets said to have been worn by the Allfather Odin.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEFistsOfHephaestus : BEGauntlets {
    BEFistsOfHephaestus() : base() {
        $this.Name               = 'Fists of Hephaestus'
        $this.MapObjName         = 'fistsofhephaestus'
        $this.PurchasePrice      = 10500
        $this.SellPrice          = 5250
        $this.TargetStats        = @{
            [StatId]::Defense = 90 # More offensive, but still armor
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 72
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets forged by the smith god Hephaestus, nearly indestructible.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEHandsOfMidas : BEGauntlets { # Could have a special gold-finding property in-game
    BEHandsOfMidas() : base() {
        $this.Name               = 'Hands of Midas'
        $this.MapObjName         = 'handsofmidas'
        $this.PurchasePrice      = 11000
        $this.SellPrice          = 5500
        $this.TargetStats        = @{
            [StatId]::Defense      = 70
            [StatId]::MagicDefense = 60
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 56
            [StatId]::MagicDefense = 48
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Golden gauntlets rumored to turn whatever they touch to gold... or just offer good defense.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGauntletsOfHercules : BEGauntlets {
    BEGauntletsOfHercules() : base() {
        $this.Name               = 'Gauntlets of Hercules'
        $this.MapObjName         = 'gauntletsofhercules'
        $this.PurchasePrice      = 11500
        $this.SellPrice          = 5750
        $this.TargetStats        = @{
            [StatId]::Defense = 95
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 76
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets imbued with the immense strength of Hercules.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEVambracesOfZeus : BEGauntlets {
    BEVambracesOfZeus() : base() {
        $this.Name               = 'Vambraces of Zeus'
        $this.MapObjName         = 'vambracesofzeus'
        $this.PurchasePrice      = 12000
        $this.SellPrice          = 6000
        $this.TargetStats        = @{
            [StatId]::Defense      = 75
            [StatId]::MagicDefense = 65
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 60
            [StatId]::MagicDefense = 52
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Vambraces crackling with the power of Zeus, king of the gods.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEClawsOfBahamut : BEGauntlets {
    BEClawsOfBahamut() : base() {
        $this.Name               = 'Claws of Bahamut'
        $this.MapObjName         = 'clawsofbahamut'
        $this.PurchasePrice      = 12500
        $this.SellPrice          = 6250
        $this.TargetStats        = @{
            [StatId]::Defense = 98
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 78
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets shaped like the talons of the dragon king, Bahamut.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEGlovesOfTiamat : BEGauntlets {
    BEGlovesOfTiamat() : base() {
        $this.Name               = 'Gloves of Tiamat'
        $this.MapObjName         = 'glovesoftiamat'
        $this.PurchasePrice      = 13000
        $this.SellPrice          = 6500
        $this.TargetStats        = @{
            [StatId]::Defense      = 78
            [StatId]::MagicDefense = 70
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 62
            [StatId]::MagicDefense = 56
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gloves imbued with the chaotic elemental power of the dragon queen, Tiamat.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGauntletsOfTheValkyrie : BEGauntlets {
    BEGauntletsOfTheValkyrie() : base() {
        $this.Name               = 'Gauntlets of the Valkyrie'
        $this.MapObjName         = 'gauntletsofthevalkyrie'
        $this.PurchasePrice      = 13500
        $this.SellPrice          = 6750
        $this.TargetStats        = @{
            [StatId]::Defense = 102
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 81
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets worn by the choosers of the slain, strong and swift.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEBracersOfAnubis : BEGauntlets {
    BEBracersOfAnubis() : base() {
        $this.Name               = 'Bracers of Anubis'
        $this.MapObjName         = 'bracersofanubis'
        $this.PurchasePrice      = 14000
        $this.SellPrice          = 7000
        $this.TargetStats        = @{
            [StatId]::Defense      = 82
            [StatId]::MagicDefense = 72
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 66
            [StatId]::MagicDefense = 58
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Bracers bearing the mark of Anubis, guardian of the afterlife.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEHandsOfPrometheus : BEGauntlets {
    BEHandsOfPrometheus() : base() {
        $this.Name               = 'Hands of Prometheus'
        $this.MapObjName         = 'handsofprometheus'
        $this.PurchasePrice      = 14500
        $this.SellPrice          = 7250
        $this.TargetStats        = @{
            [StatId]::Defense      = 85
            [StatId]::MagicDefense = 70 
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 68
            [StatId]::MagicDefense = 56
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets that carry the spark of forbidden fire, gifted by Prometheus.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGodslayerGauntlets : BEGauntlets {
    BEGodslayerGauntlets() : base() {
        $this.Name               = 'Godslayer Gauntlets'
        $this.MapObjName         = 'godslayergauntlets'
        $this.PurchasePrice      = 20000
        $this.SellPrice          = 10000
        $this.TargetStats        = @{
            [StatId]::Defense = 110
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 88
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets imbued with the power to fell deities.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEArmguardsOfTheCosmos : BEGauntlets {
    BEArmguardsOfTheCosmos() : base() {
        $this.Name               = 'Armguards of the Cosmos'
        $this.MapObjName         = 'armguardsofthecosmos'
        $this.PurchasePrice      = 21000
        $this.SellPrice          = 10500
        $this.TargetStats        = @{
            [StatId]::Defense      = 90
            [StatId]::MagicDefense = 80
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 72
            [StatId]::MagicDefense = 64
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Armguards that seem to hold the vastness of the cosmos within them.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGauntletsOfEternalNight : BEGauntlets {
    BEGauntletsOfEternalNight() : base() {
        $this.Name               = 'Gauntlets of Eternal Night'
        $this.MapObjName         = 'gauntletsofeternalnight'
        $this.PurchasePrice      = 22000
        $this.SellPrice          = 11000
        $this.TargetStats        = @{
            [StatId]::Defense      = 85
            [StatId]::MagicDefense = 85
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 68
            [StatId]::MagicDefense = 68
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets woven from the fabric of endless night, granting mastery over shadows.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEHandsOfTheWorldSerpent : BEGauntlets {
    BEHandsOfTheWorldSerpent() : base() {
        $this.Name               = 'Hands of the World Serpent'
        $this.MapObjName         = 'handsoftheworldserpent'
        $this.PurchasePrice      = 23000
        $this.SellPrice          = 11500
        $this.TargetStats        = @{
            [StatId]::Defense = 115
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 92
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets crafted from the scales of Jormungandr, the World Serpent.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEGauntletsOfTimelessness : BEGauntlets {
    BEGauntletsOfTimelessness() : base() {
        $this.Name               = 'Gauntlets of Timelessness'
        $this.MapObjName         = 'gauntletsoftimelessness'
        $this.PurchasePrice      = 24000
        $this.SellPrice          = 12000
        $this.TargetStats        = @{
            [StatId]::Defense      = 95
            [StatId]::MagicDefense = 90
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 76
            [StatId]::MagicDefense = 72
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets that seem to exist outside of time, offering profound protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEFistsOfThePrimordials : BEGauntlets {
    BEFistsOfThePrimordials() : base() {
        $this.Name               = 'Fists of the Primordials'
        $this.MapObjName         = 'fistsoftheprimordials'
        $this.PurchasePrice      = 25000
        $this.SellPrice          = 12500
        $this.TargetStats        = @{
            [StatId]::Defense = 120
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 96
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets imbued with the raw power of the first beings of creation.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEGauntletsOfDivineAscension : BEGauntlets {
    BEGauntletsOfDivineAscension() : base() {
        $this.Name               = 'Gauntlets of Divine Ascension'
        $this.MapObjName         = 'gauntletsofdivineascension'
        $this.PurchasePrice      = 26000
        $this.SellPrice          = 13000
        $this.TargetStats        = @{
            [StatId]::Defense      = 100
            [StatId]::MagicDefense = 100
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 80
            [StatId]::MagicDefense = 80
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets that signify the wearer''s path to godhood.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEArmguardsOfOblivion : BEGauntlets {
    BEArmguardsOfOblivion() : base() {
        $this.Name               = 'Armguards of Oblivion'
        $this.MapObjName         = 'armguardsofoblivion'
        $this.PurchasePrice      = 27000
        $this.SellPrice          = 13500
        $this.TargetStats        = @{
            [StatId]::Defense = 125
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 100
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Armguards that whisper of the void, capable of unmaking foes.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEGauntletsOfTheUnblinkingEye : BEGauntlets {
    BEGauntletsOfTheUnblinkingEye() : base() {
        $this.Name               = 'Gauntlets of the Unblinking Eye'
        $this.MapObjName         = 'gauntletsoftheunblinkingeye'
        $this.PurchasePrice      = 28000
        $this.SellPrice          = 14000
        $this.TargetStats        = @{
            [StatId]::Defense      = 105
            [StatId]::MagicDefense = 105
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 84
            [StatId]::MagicDefense = 84
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets that grant clarity and insight, revealing all truths.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEHandsOfTheCreator : BEGauntlets {
    BEHandsOfTheCreator() : base() {
        $this.Name               = 'Hands of the Creator'
        $this.MapObjName         = 'handsofthecreator'
        $this.PurchasePrice      = 30000
        $this.SellPrice          = 15000
        $this.TargetStats        = @{
            [StatId]::Defense      = 110
            [StatId]::MagicDefense = 110
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 88
            [StatId]::MagicDefense = 88
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets said to have been worn by the entity that shaped all existence.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEAdamantiumCoreGauntlets : BEGauntlets {
    BEAdamantiumCoreGauntlets() : base() {
        $this.Name               = 'Adamantium Core Gauntlets'
        $this.MapObjName         = 'adamantiumcoregauntlets'
        $this.PurchasePrice      = 32000
        $this.SellPrice          = 16000
        $this.TargetStats        = @{
            [StatId]::Defense = 130
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 104
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets with a core of pure Adamantium, offering unmatched physical defense.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEStarlightWeaveGloves : BEGauntlets {
    BEStarlightWeaveGloves() : base() {
        $this.Name               = 'Starlight Weave Gloves'
        $this.MapObjName         = 'starlightweavegloves'
        $this.PurchasePrice      = 33000
        $this.SellPrice          = 16500
        $this.TargetStats        = @{
            [StatId]::Defense      = 110
            [StatId]::MagicDefense = 115
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 88
            [StatId]::MagicDefense = 92
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gloves woven from concentrated starlight, shimmering with protective energy.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGauntletsOfResoluteMight : BEGauntlets {
    BEGauntletsOfResoluteMight() : base() {
        $this.Name               = 'Gauntlets of Resolute Might'
        $this.MapObjName         = 'gauntletsofresolutemight'
        $this.PurchasePrice      = 34000
        $this.SellPrice          = 17000
        $this.TargetStats        = @{
            [StatId]::Defense = 135
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 108
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets that embody unyielding strength and determination.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEWrapsOfAncientWisdom : BEGauntlets {
    BEWrapsOfAncientWisdom() : base() {
        $this.Name               = 'Wraps of Ancient Wisdom'
        $this.MapObjName         = 'wrapsofancientwisdom'
        $this.PurchasePrice      = 35000
        $this.SellPrice          = 17500
        $this.TargetStats        = @{
            [StatId]::Defense      = 112
            [StatId]::MagicDefense = 120
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 90
            [StatId]::MagicDefense = 96
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Handwraps inscribed with the lost knowledge of ancient sages.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGauntletsOfTheSunkenKing : BEGauntlets {
    BEGauntletsOfTheSunkenKing() : base() {
        $this.Name               = 'Gauntlets of the Sunken King'
        $this.MapObjName         = 'gauntletsofthesunkenking'
        $this.PurchasePrice      = 36000
        $this.SellPrice          = 18000
        $this.TargetStats        = @{
            [StatId]::Defense = 140
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 112
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets recovered from a lost, underwater kingdom, encrusted with barnacles and power.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEGlovesOfEtherealTouch : BEGauntlets {
    BEGlovesOfEtherealTouch() : base() {
        $this.Name               = 'Gloves of Ethereal Touch'
        $this.MapObjName         = 'glovesofetherealtouch'
        $this.PurchasePrice      = 37000
        $this.SellPrice          = 18500
        $this.TargetStats        = @{
            [StatId]::Defense      = 115
            [StatId]::MagicDefense = 125
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 92
            [StatId]::MagicDefense = 100
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gloves that allow the wearer to interact with the ethereal plane, offering unique defenses.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGauntletsOfShatteredRealms : BEGauntlets {
    BEGauntletsOfShatteredRealms() : base() {
        $this.Name               = 'Gauntlets of Shattered Realms'
        $this.MapObjName         = 'gauntletsofshatteredrealms'
        $this.PurchasePrice      = 38000
        $this.SellPrice          = 19000
        $this.TargetStats        = @{
            [StatId]::Defense = 145
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 116
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets pieced together from fragments of broken dimensions.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEBracersOfTheSilentMonk : BEGauntlets {
    BEBracersOfTheSilentMonk() : base() {
        $this.Name               = 'Bracers of the Silent Monk'
        $this.MapObjName         = 'bracersofthesilentmonk'
        $this.PurchasePrice      = 39000
        $this.SellPrice          = 19500
        $this.TargetStats        = @{
            [StatId]::Defense      = 118
            [StatId]::MagicDefense = 130
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 94
            [StatId]::MagicDefense = 104
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Bracers worn by monks who have taken a vow of silence, imbued with focused energy.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGauntletsOfTheEclipse : BEGauntlets {
    BEGauntletsOfTheEclipse() : base() {
        $this.Name               = 'Gauntlets of the Eclipse'
        $this.MapObjName         = 'gauntletsoftheeclipse'
        $this.PurchasePrice      = 40000
        $this.SellPrice          = 20000
        $this.TargetStats        = @{
            [StatId]::Defense      = 120
            [StatId]::MagicDefense = 120
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 96
            [StatId]::MagicDefense = 96
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets that embody the power of both sun and moon during an eclipse.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEHandsOfObliteration : BEGauntlets {
    BEHandsOfObliteration() : base() {
        $this.Name               = 'Hands of Obliteration'
        $this.MapObjName         = 'handsofobliteration'
        $this.PurchasePrice      = 41000
        $this.SellPrice          = 20500
        $this.TargetStats        = @{
            [StatId]::Defense = 150
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 120
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets capable of reducing foes to dust with a mere touch.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEGauntletsOfCelestialHarmony : BEGauntlets {
    BEGauntletsOfCelestialHarmony() : base() {
        $this.Name               = 'Gauntlets of Celestial Harmony'
        $this.MapObjName         = 'gauntletsofcelestialharmony'
        $this.PurchasePrice      = 45000
        $this.SellPrice          = 22500
        $this.TargetStats        = @{
            [StatId]::Defense      = 125
            [StatId]::MagicDefense = 125
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 100
            [StatId]::MagicDefense = 100
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets that resonate with the perfect harmony of the celestial spheres.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEFistsOfRagnarok : BEGauntlets {
    BEFistsOfRagnarok() : base() {
        $this.Name               = 'Fists of Ragnarok'
        $this.MapObjName         = 'fistsofragnarok'
        $this.PurchasePrice      = 46000
        $this.SellPrice          = 23000
        $this.TargetStats        = @{
            [StatId]::Defense = 155
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 124
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets that herald the end of days, imbued with apocalyptic power.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEGauntletsOfTheInfiniteVoid : BEGauntlets {
    BEGauntletsOfTheInfiniteVoid() : base() {
        $this.Name               = 'Gauntlets of the Infinite Void'
        $this.MapObjName         = 'gauntletsoftheinfinitevoid'
        $this.PurchasePrice      = 47000
        $this.SellPrice          = 23500
        $this.TargetStats        = @{
            [StatId]::Defense      = 128
            [StatId]::MagicDefense = 128
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 102
            [StatId]::MagicDefense = 102
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets that seem to contain an endless void, absorbing all forms of attack.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEHandsOfTheFirstFlame : BEGauntlets {
    BEHandsOfTheFirstFlame() : base() {
        $this.Name               = 'Hands of the First Flame'
        $this.MapObjName         = 'handsofthefirstflame'
        $this.PurchasePrice      = 48000
        $this.SellPrice          = 24000
        $this.TargetStats        = @{
            [StatId]::Defense      = 130
            [StatId]::MagicDefense = 130
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 104
            [StatId]::MagicDefense = 104
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets that burn with the primordial fire of creation.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEGauntletsOfAbsoluteZero : BEGauntlets {
    BEGauntletsOfAbsoluteZero() : base() {
        $this.Name               = 'Gauntlets of Absolute Zero'
        $this.MapObjName         = 'gauntletsofabsolutezero'
        $this.PurchasePrice      = 49000
        $this.SellPrice          = 24500
        $this.TargetStats        = @{
            [StatId]::Defense      = 132
            [StatId]::MagicDefense = 132
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 106
            [StatId]::MagicDefense = 106
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets so cold they can freeze time itself, offering ultimate magical defense.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEArmguardsOfTheWorldForge : BEGauntlets {
    BEArmguardsOfTheWorldForge() : base() {
        $this.Name               = 'Armguards of the World Forge'
        $this.MapObjName         = 'armguardsoftheworldforge'
        $this.PurchasePrice      = 50000
        $this.SellPrice          = 25000
        $this.TargetStats        = @{
            [StatId]::Defense = 160
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 128
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Armguards crafted at the legendary World Forge, embodying creation''s might.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEGauntletsOfAscendedPower : BEGauntlets {
    BEGauntletsOfAscendedPower() : base() {
        $this.Name               = 'Gauntlets of Ascended Power'
        $this.MapObjName         = 'gauntletsofascendedpower'
        $this.PurchasePrice      = 52000
        $this.SellPrice          = 26000
        $this.TargetStats        = @{
            [StatId]::Defense      = 135
            [StatId]::MagicDefense = 135
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 108
            [StatId]::MagicDefense = 108
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets worn by a mortal who achieved godhood, radiating immense power.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEHandsOfUnmaking : BEGauntlets {
    BEHandsOfUnmaking() : base() {
        $this.Name               = 'Hands of Unmaking'
        $this.MapObjName         = 'handsofunmaking'
        $this.PurchasePrice      = 54000
        $this.SellPrice          = 27000
        $this.TargetStats        = @{
            [StatId]::Defense = 165
        }
        $this.RequiredStats      = @{
            [StatId]::Defense = 132
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets capable of unraveling the fabric of reality, terrifyingly defensive.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense"
    }
}

Class BEGauntletsOfTheFinalTruth : BEGauntlets {
    BEGauntletsOfTheFinalTruth() : base() {
        $this.Name               = 'Gauntlets of the Final Truth'
        $this.MapObjName         = 'gauntletsofthefinaltruth'
        $this.PurchasePrice      = 56000
        $this.SellPrice          = 28000
        $this.TargetStats        = @{
            [StatId]::Defense      = 140
            [StatId]::MagicDefense = 140
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 112
            [StatId]::MagicDefense = 112
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'Gauntlets that reveal the ultimate truth of existence, offering unparalleled insight and protection.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}

Class BEOmegaGauntlets : BEGauntlets {
    BEOmegaGauntlets() : base() {
        $this.Name               = 'Omega Gauntlets'
        $this.MapObjName         = 'omegagauntlets'
        $this.PurchasePrice      = 60000
        $this.SellPrice          = 30000
        $this.TargetStats        = @{
            [StatId]::Defense      = 150
            [StatId]::MagicDefense = 150
        }
        $this.RequiredStats      = @{
            [StatId]::Defense      = 120
            [StatId]::MagicDefense = 120
        }
        $this.CanAddToInventory  = $true
        $this.ExamineString      = 'The ultimate gauntlets, signifying the end of all challenges.'
        $this.PlayerEffectString = "+$($this.TargetStats[[StatId]::Defense]) Defense, +$($this.TargetStats[[StatId]::MagicDefense]) Magic Defense"
    }
}














###############################################################################
#
# FAST NOISE LITE IMPLEMENTATION
#
###############################################################################
Class FastNoiseLite {
    Static [Int64]$PRIMEX         = 501125321
    Static [Int64]$PRIMEY         = 1136930381
    Static [Int64]$PRIMEZ         = 1720413743
    Static [Int64]$HASH_MAGIC     = 0x27D4EB2D
    Static [Int64]$HASHCALC_MAGIC = 2147483648
    Static [Int64]$SEEDADD_MAGIC  = 1293373
    Static [Int64]$APRIMEXMULT2   = [FastNoiseLite]::PRIMEX * 2
    Static [Int64]$APRIMEYMULT2   = [FastNoiseLite]::PRIMEY * 2
    Static [Int64]$APRIMEZMULT2   = [FastNoiseLite]::PRIMEZ * 2
    
    Static [Single]$SQRT3                     = 1.7320508075688772935274463415059
    Static [Single]$PLANARIMPROVEA_MAGIC      = 0.211324865405187
    Static [Single]$PLANARIMPROVEZSCALE_MAGIC = 0.577350269189626
    Static [Single]$SIMPLEXVALMODA_MAGIC      = 32.69428253173828125
    Static [Single]$A2DIV3                    = 2 / 3

    Static [Single[]]$GRADIENTS2D = @(
        0.130526192220052,  0.99144486137381,   0.38268343236509,   0.923879532511287,  0.608761429008721,  0.793353340291235,  0.793353340291235,  0.608761429008721,
        0.923879532511287,  0.38268343236509,   0.99144486137381,   0.130526192220051,  0.99144486137381,  -0.130526192220051,  0.923879532511287, -0.38268343236509,
        0.793353340291235, -0.60876142900872,   0.608761429008721, -0.793353340291235,  0.38268343236509,  -0.923879532511287,  0.130526192220052, -0.99144486137381,
        -0.130526192220052, -0.99144486137381,  -0.38268343236509,  -0.923879532511287, -0.608761429008721, -0.793353340291235, -0.793353340291235, -0.608761429008721,
        -0.923879532511287, -0.38268343236509,  -0.99144486137381,  -0.130526192220052, -0.99144486137381,   0.130526192220051, -0.923879532511287,  0.38268343236509,
        -0.793353340291235,  0.608761429008721, -0.608761429008721,  0.793353340291235, -0.38268343236509,   0.923879532511287, -0.130526192220052,  0.99144486137381,
        0.130526192220052,  0.99144486137381,   0.38268343236509,   0.923879532511287,  0.608761429008721,  0.793353340291235,  0.793353340291235,  0.608761429008721,
        0.923879532511287,  0.38268343236509,   0.99144486137381,   0.130526192220051,  0.99144486137381,  -0.130526192220051,  0.923879532511287, -0.38268343236509,
        0.793353340291235, -0.60876142900872,   0.608761429008721, -0.793353340291235,  0.38268343236509,  -0.923879532511287,  0.130526192220052, -0.99144486137381,
        -0.130526192220052, -0.99144486137381,  -0.38268343236509,  -0.923879532511287, -0.608761429008721, -0.793353340291235, -0.793353340291235, -0.608761429008721,
        -0.923879532511287, -0.38268343236509,  -0.99144486137381,  -0.130526192220052, -0.99144486137381,   0.130526192220051, -0.923879532511287,  0.38268343236509,
        -0.793353340291235,  0.608761429008721, -0.608761429008721,  0.793353340291235, -0.38268343236509,   0.923879532511287, -0.130526192220052,  0.99144486137381,
        0.130526192220052,  0.99144486137381,   0.38268343236509,   0.923879532511287,  0.608761429008721,  0.793353340291235,  0.793353340291235,  0.608761429008721,
        0.923879532511287,  0.38268343236509,   0.99144486137381,   0.130526192220051,  0.99144486137381,  -0.130526192220051,  0.923879532511287, -0.38268343236509,
        0.793353340291235, -0.60876142900872,   0.608761429008721, -0.793353340291235,  0.38268343236509,  -0.923879532511287,  0.130526192220052, -0.99144486137381,
        -0.130526192220052, -0.99144486137381,  -0.38268343236509,  -0.923879532511287, -0.608761429008721, -0.793353340291235, -0.793353340291235, -0.608761429008721,
        -0.923879532511287, -0.38268343236509,  -0.99144486137381,  -0.130526192220052, -0.99144486137381,   0.130526192220051, -0.923879532511287,  0.38268343236509,
        -0.793353340291235,  0.608761429008721, -0.608761429008721,  0.793353340291235, -0.38268343236509,   0.923879532511287, -0.130526192220052,  0.99144486137381,
        0.130526192220052,  0.99144486137381,   0.38268343236509,   0.923879532511287,  0.608761429008721,  0.793353340291235,  0.793353340291235,  0.608761429008721,
        0.923879532511287,  0.38268343236509,   0.99144486137381,   0.130526192220051,  0.99144486137381,  -0.130526192220051,  0.923879532511287, -0.38268343236509,
        0.793353340291235, -0.60876142900872,   0.608761429008721, -0.793353340291235,  0.38268343236509,  -0.923879532511287,  0.130526192220052, -0.99144486137381,
        -0.130526192220052, -0.99144486137381,  -0.38268343236509,  -0.923879532511287, -0.608761429008721, -0.793353340291235, -0.793353340291235, -0.608761429008721,
        -0.923879532511287, -0.38268343236509,  -0.99144486137381,  -0.130526192220052, -0.99144486137381,   0.130526192220051, -0.923879532511287,  0.38268343236509,
        -0.793353340291235,  0.608761429008721, -0.608761429008721,  0.793353340291235, -0.38268343236509,   0.923879532511287, -0.130526192220052,  0.99144486137381,
        0.130526192220052,  0.99144486137381,   0.38268343236509,   0.923879532511287,  0.608761429008721,  0.793353340291235,  0.793353340291235,  0.608761429008721,
        0.923879532511287,  0.38268343236509,   0.99144486137381,   0.130526192220051,  0.99144486137381,  -0.130526192220051,  0.923879532511287, -0.38268343236509,
        0.793353340291235, -0.60876142900872,   0.608761429008721, -0.793353340291235,  0.38268343236509,  -0.923879532511287,  0.130526192220052, -0.99144486137381,
        -0.130526192220052, -0.99144486137381,  -0.38268343236509,  -0.923879532511287, -0.608761429008721, -0.793353340291235, -0.793353340291235, -0.608761429008721,
        -0.923879532511287, -0.38268343236509,  -0.99144486137381,  -0.130526192220052, -0.99144486137381,   0.130526192220051, -0.923879532511287,  0.38268343236509,
        -0.793353340291235,  0.608761429008721, -0.608761429008721,  0.793353340291235, -0.38268343236509,   0.923879532511287, -0.130526192220052,  0.99144486137381,
        0.38268343236509,   0.923879532511287,  0.923879532511287,  0.38268343236509,   0.923879532511287, -0.38268343236509,   0.38268343236509,  -0.923879532511287,
        -0.38268343236509,  -0.923879532511287, -0.923879532511287, -0.38268343236509,  -0.923879532511287,  0.38268343236509,  -0.38268343236509,   0.923879532511287
    )

    Static [Single[]]$RANDVECS2D = @(
        -0.2700222198, -0.9628540911, 0.3863092627, -0.9223693152, 0.04444859006, -0.999011673, -0.5992523158, -0.8005602176, -0.7819280288, 0.6233687174, 0.9464672271, 0.3227999196, -0.6514146797, -0.7587218957, 0.9378472289, 0.347048376,
        -0.8497875957, -0.5271252623, -0.879042592, 0.4767432447, -0.892300288, -0.4514423508, -0.379844434, -0.9250503802, -0.9951650832, 0.0982163789, 0.7724397808, -0.6350880136, 0.7573283322, -0.6530343002, -0.9928004525, -0.119780055,
        -0.0532665713, 0.9985803285, 0.9754253726, -0.2203300762, -0.7665018163, 0.6422421394, 0.991636706, 0.1290606184, -0.994696838, 0.1028503788, -0.5379205513, -0.84299554, 0.5022815471, -0.8647041387, 0.4559821461, -0.8899889226,
        -0.8659131224, -0.5001944266, 0.0879458407, -0.9961252577, -0.5051684983, 0.8630207346, 0.7753185226, -0.6315704146, -0.6921944612, 0.7217110418, -0.5191659449, -0.8546734591, 0.8978622882, -0.4402764035, -0.1706774107, 0.9853269617,
        -0.9353430106, -0.3537420705, -0.9992404798, 0.03896746794, -0.2882064021, -0.9575683108, -0.9663811329, 0.2571137995, -0.8759714238, -0.4823630009, -0.8303123018, -0.5572983775, 0.05110133755, -0.9986934731, -0.8558373281, -0.5172450752,
        0.09887025282, 0.9951003332, 0.9189016087, 0.3944867976, -0.2439375892, -0.9697909324, -0.8121409387, -0.5834613061, -0.9910431363, 0.1335421355, 0.8492423985, -0.5280031709, -0.9717838994, -0.2358729591, 0.9949457207, 0.1004142068,
        0.6241065508, -0.7813392434, 0.662910307, 0.7486988212, -0.7197418176, 0.6942418282, -0.8143370775, -0.5803922158, 0.104521054, -0.9945226741, -0.1065926113, -0.9943027784, 0.445799684, -0.8951327509, 0.105547406, 0.9944142724,
        -0.992790267, 0.1198644477, -0.8334366408, 0.552615025, 0.9115561563, -0.4111755999, 0.8285544909, -0.5599084351, 0.7217097654, -0.6921957921, 0.4940492677, -0.8694339084, -0.3652321272, -0.9309164803, -0.9696606758, 0.2444548501,
        0.08925509731, -0.996008799, 0.5354071276, -0.8445941083, -0.1053576186, 0.9944343981, -0.9890284586, 0.1477251101, 0.004856104961, 0.9999882091, 0.9885598478, 0.1508291331, 0.9286129562, -0.3710498316, -0.5832393863, -0.8123003252,
        0.3015207509, 0.9534596146, -0.9575110528, 0.2883965738, 0.9715802154, -0.2367105511, 0.229981792, 0.9731949318, 0.955763816, -0.2941352207, 0.740956116, 0.6715534485, -0.9971513787, -0.07542630764, 0.6905710663, -0.7232645452,
        -0.290713703, -0.9568100872, 0.5912777791, -0.8064679708, -0.9454592212, -0.325740481, 0.6664455681, 0.74555369, 0.6236134912, 0.7817328275, 0.9126993851, -0.4086316587, -0.8191762011, 0.5735419353, -0.8812745759, -0.4726046147,
        0.9953313627, 0.09651672651, 0.9855650846, -0.1692969699, -0.8495980887, 0.5274306472, 0.6174853946, -0.7865823463, 0.8508156371, 0.52546432, 0.9985032451, -0.05469249926, 0.1971371563, -0.9803759185, 0.6607855748, -0.7505747292,
        -0.03097494063, 0.9995201614, -0.6731660801, 0.739491331, -0.7195018362, -0.6944905383, 0.9727511689, 0.2318515979, 0.9997059088, -0.0242506907, 0.4421787429, -0.8969269532, 0.9981350961, -0.061043673, -0.9173660799, -0.3980445648,
        -0.8150056635, -0.5794529907, -0.8789331304, 0.4769450202, 0.0158605829, 0.999874213, -0.8095464474, 0.5870558317, -0.9165898907, -0.3998286786, -0.8023542565, 0.5968480938, -0.5176737917, 0.8555780767, -0.8154407307, -0.5788405779,
        0.4022010347, -0.9155513791, -0.9052556868, -0.4248672045, 0.7317445619, 0.6815789728, -0.5647632201, -0.8252529947, -0.8403276335, -0.5420788397, -0.9314281527, 0.363925262, 0.5238198472, 0.8518290719, 0.7432803869, -0.6689800195,
        -0.985371561, -0.1704197369, 0.4601468731, 0.88784281, 0.825855404, 0.5638819483, 0.6182366099, 0.7859920446, 0.8331502863, -0.553046653, 0.1500307506, 0.9886813308, -0.662330369, -0.7492119075, -0.668598664, 0.743623444,
        0.7025606278, 0.7116238924, -0.5419389763, -0.8404178401, -0.3388616456, 0.9408362159, 0.8331530315, 0.5530425174, -0.2989720662, -0.9542618632, 0.2638522993, 0.9645630949, 0.124108739, -0.9922686234, -0.7282649308, -0.6852956957,
        0.6962500149, 0.7177993569, -0.9183535368, 0.3957610156, -0.6326102274, -0.7744703352, -0.9331891859, -0.359385508, -0.1153779357, -0.9933216659, 0.9514974788, -0.3076565421, -0.08987977445, -0.9959526224, 0.6678496916, 0.7442961705,
        0.7952400393, -0.6062947138, -0.6462007402, -0.7631674805, -0.2733598753, 0.9619118351, 0.9669590226, -0.254931851, -0.9792894595, 0.2024651934, -0.5369502995, -0.8436138784, -0.270036471, -0.9628500944, -0.6400277131, 0.7683518247,
        -0.7854537493, -0.6189203566, 0.06005905383, -0.9981948257, -0.02455770378, 0.9996984141, -0.65983623, 0.751409442, -0.6253894466, -0.7803127835, -0.6210408851, -0.7837781695, 0.8348888491, 0.5504185768, -0.1592275245, 0.9872419133,
        0.8367622488, 0.5475663786, -0.8675753916, -0.4973056806, -0.2022662628, -0.9793305667, 0.9399189937, 0.3413975472, 0.9877404807, -0.1561049093, -0.9034455656, 0.4287028224, 0.1269804218, -0.9919052235, -0.3819600854, 0.924178821,
        0.9754625894, 0.2201652486, -0.3204015856, -0.9472818081, -0.9874760884, 0.1577687387, 0.02535348474, -0.9996785487, 0.4835130794, -0.8753371362, -0.2850799925, -0.9585037287, -0.06805516006, -0.99768156, -0.7885244045, -0.6150034663,
        0.3185392127, -0.9479096845, 0.8880043089, 0.4598351306, 0.6476921488, -0.7619021462, 0.9820241299, 0.1887554194, 0.9357275128, -0.3527237187, -0.8894895414, 0.4569555293, 0.7922791302, 0.6101588153, 0.7483818261, 0.6632681526,
        -0.7288929755, -0.6846276581, 0.8729032783, -0.4878932944, 0.8288345784, 0.5594937369, 0.08074567077, 0.9967347374, 0.9799148216, -0.1994165048, -0.580730673, -0.8140957471, -0.4700049791, -0.8826637636, 0.2409492979, 0.9705377045,
        0.9437816757, -0.3305694308, -0.8927998638, -0.4504535528, -0.8069622304, 0.5906030467, 0.06258973166, 0.9980393407, -0.9312597469, 0.3643559849, 0.5777449785, 0.8162173362, -0.3360095855, -0.941858566, 0.697932075, -0.7161639607,
        -0.002008157227, -0.9999979837, -0.1827294312, -0.9831632392, -0.6523911722, 0.7578824173, -0.4302626911, -0.9027037258, -0.9985126289, -0.05452091251, -0.01028102172, -0.9999471489, -0.4946071129, 0.8691166802, -0.2999350194, 0.9539596344,
        0.8165471961, 0.5772786819, 0.2697460475, 0.962931498, -0.7306287391, -0.6827749597, -0.7590952064, -0.6509796216, -0.907053853, 0.4210146171, -0.5104861064, -0.8598860013, 0.8613350597, 0.5080373165, 0.5007881595, -0.8655698812,
        -0.654158152, 0.7563577938, -0.8382755311, -0.545246856, 0.6940070834, 0.7199681717, 0.06950936031, 0.9975812994, 0.1702942185, -0.9853932612, 0.2695973274, 0.9629731466, 0.5519612192, -0.8338697815, 0.225657487, -0.9742067022,
        0.4215262855, -0.9068161835, 0.4881873305, -0.8727388672, -0.3683854996, -0.9296731273, -0.9825390578, 0.1860564427, 0.81256471, 0.5828709909, 0.3196460933, -0.9475370046, 0.9570913859, 0.2897862643, -0.6876655497, -0.7260276109,
        -0.9988770922, -0.047376731, -0.1250179027, 0.992154486, -0.8280133617, 0.560708367, 0.9324863769, -0.3612051451, 0.6394653183, 0.7688199442, -0.01623847064, -0.9998681473, -0.9955014666, -0.09474613458, -0.81453315, 0.580117012,
        0.4037327978, -0.9148769469, 0.9944263371, 0.1054336766, -0.1624711654, 0.9867132919, -0.9949487814, -0.100383875, -0.6995302564, 0.7146029809, 0.5263414922, -0.85027327, -0.5395221479, 0.841971408, 0.6579370318, 0.7530729462,
        0.01426758847, -0.9998982128, -0.6734383991, 0.7392433447, 0.639412098, -0.7688642071, 0.9211571421, 0.3891908523, -0.146637214, -0.9891903394, -0.782318098, 0.6228791163, -0.5039610839, -0.8637263605, -0.7743120191, -0.6328039957
    )

    Static [Single[]]$GRADIENTS3D = @(
        0, 1, 1, 0,  0,-1, 1, 0,  0, 1,-1, 0,  0,-1,-1, 0,
        1, 0, 1, 0, -1, 0, 1, 0,  1, 0,-1, 0, -1, 0,-1, 0,
        1, 1, 0, 0, -1, 1, 0, 0,  1,-1, 0, 0, -1,-1, 0, 0,
        0, 1, 1, 0,  0,-1, 1, 0,  0, 1,-1, 0,  0,-1,-1, 0,
        1, 0, 1, 0, -1, 0, 1, 0,  1, 0,-1, 0, -1, 0,-1, 0,
        1, 1, 0, 0, -1, 1, 0, 0,  1,-1, 0, 0, -1,-1, 0, 0,
        0, 1, 1, 0,  0,-1, 1, 0,  0, 1,-1, 0,  0,-1,-1, 0,
        1, 0, 1, 0, -1, 0, 1, 0,  1, 0,-1, 0, -1, 0,-1, 0,
        1, 1, 0, 0, -1, 1, 0, 0,  1,-1, 0, 0, -1,-1, 0, 0,
        0, 1, 1, 0,  0,-1, 1, 0,  0, 1,-1, 0,  0,-1,-1, 0,
        1, 0, 1, 0, -1, 0, 1, 0,  1, 0,-1, 0, -1, 0,-1, 0,
        1, 1, 0, 0, -1, 1, 0, 0,  1,-1, 0, 0, -1,-1, 0, 0,
        0, 1, 1, 0,  0,-1, 1, 0,  0, 1,-1, 0,  0,-1,-1, 0,
        1, 0, 1, 0, -1, 0, 1, 0,  1, 0,-1, 0, -1, 0,-1, 0,
        1, 1, 0, 0, -1, 1, 0, 0,  1,-1, 0, 0, -1,-1, 0, 0,
        1, 1, 0, 0,  0,-1, 1, 0, -1, 1, 0, 0,  0,-1,-1, 0
    )

    Static [Single[]]$RANDVECS3D = @(
        -0.7292736885, -0.6618439697, 0.1735581948, 0, 0.790292081, -0.5480887466, -0.2739291014, 0, 0.7217578935, 0.6226212466, -0.3023380997, 0, 0.565683137, -0.8208298145, -0.0790000257, 0, 0.760049034, -0.5555979497, -0.3370999617, 0, 0.3713945616, 0.5011264475, 0.7816254623, 0, -0.1277062463, -0.4254438999, -0.8959289049, 0, -0.2881560924, -0.5815838982, 0.7607405838, 0,
        0.5849561111, -0.662820239, -0.4674352136, 0, 0.3307171178, 0.0391653737, 0.94291689, 0, 0.8712121778, -0.4113374369, -0.2679381538, 0, 0.580981015, 0.7021915846, 0.4115677815, 0, 0.503756873, 0.6330056931, -0.5878203852, 0, 0.4493712205, 0.601390195, 0.6606022552, 0, -0.6878403724, 0.09018890807, -0.7202371714, 0, -0.5958956522, -0.6469350577, 0.475797649, 0,
        -0.5127052122, 0.1946921978, -0.8361987284, 0, -0.9911507142, -0.05410276466, -0.1212153153, 0, -0.2149721042, 0.9720882117, -0.09397607749, 0, -0.7518650936, -0.5428057603, 0.3742469607, 0, 0.5237068895, 0.8516377189, -0.02107817834, 0, 0.6333504779, 0.1926167129, -0.7495104896, 0, -0.06788241606, 0.3998305789, 0.9140719259, 0, -0.5538628599, -0.4729896695, -0.6852128902, 0,
        -0.7261455366, -0.5911990757, 0.3509933228, 0, -0.9229274737, -0.1782808786, 0.3412049336, 0, -0.6968815002, 0.6511274338, 0.3006480328, 0, 0.9608044783, -0.2098363234, -0.1811724921, 0, 0.06817146062, -0.9743405129, 0.2145069156, 0, -0.3577285196, -0.6697087264, -0.6507845481, 0, -0.1868621131, 0.7648617052, -0.6164974636, 0, -0.6541697588, 0.3967914832, 0.6439087246, 0,
        0.6993340405, -0.6164538506, 0.3618239211, 0, -0.1546665739, 0.6291283928, 0.7617583057, 0, -0.6841612949, -0.2580482182, -0.6821542638, 0, 0.5383980957, 0.4258654885, 0.7271630328, 0, -0.5026987823, -0.7939832935, -0.3418836993, 0, 0.3202971715, 0.2834415347, 0.9039195862, 0, 0.8683227101, -0.0003762656404, -0.4959995258, 0, 0.791120031, -0.08511045745, 0.6057105799, 0,
        -0.04011016052, -0.4397248749, 0.8972364289, 0, 0.9145119872, 0.3579346169, -0.1885487608, 0, -0.9612039066, -0.2756484276, 0.01024666929, 0, 0.6510361721, -0.2877799159, -0.7023778346, 0, -0.2041786351, 0.7365237271, 0.644859585, 0, -0.7718263711, 0.3790626912, 0.5104855816, 0, -0.3060082741, -0.7692987727, 0.5608371729, 0, 0.454007341, -0.5024843065, 0.7357899537, 0,
        0.4816795475, 0.6021208291, -0.6367380315, 0, 0.6961980369, -0.3222197429, 0.641469197, 0, -0.6532160499, -0.6781148932, 0.3368515753, 0, 0.5089301236, -0.6154662304, -0.6018234363, 0, -0.1635919754, -0.9133604627, -0.372840892, 0, 0.52408019, -0.8437664109, 0.1157505864, 0, 0.5902587356, 0.4983817807, -0.6349883666, 0, 0.5863227872, 0.494764745, 0.6414307729, 0,
        0.6779335087, 0.2341345225, 0.6968408593, 0, 0.7177054546, -0.6858979348, 0.120178631, 0, -0.5328819713, -0.5205125012, 0.6671608058, 0, -0.8654874251, -0.0700727088, -0.4960053754, 0, -0.2861810166, 0.7952089234, 0.5345495242, 0, -0.04849529634, 0.9810836427, -0.1874115585, 0, -0.6358521667, 0.6058348682, 0.4781800233, 0, 0.6254794696, -0.2861619734, 0.7258696564, 0,
        -0.2585259868, 0.5061949264, -0.8227581726, 0, 0.02136306781, 0.5064016808, -0.8620330371, 0, 0.200111773, 0.8599263484, 0.4695550591, 0, 0.4743561372, 0.6014985084, -0.6427953014, 0, 0.6622993731, -0.5202474575, -0.5391679918, 0, 0.08084972818, -0.6532720452, 0.7527940996, 0, -0.6893687501, 0.0592860349, 0.7219805347, 0, -0.1121887082, -0.9673185067, 0.2273952515, 0,
        0.7344116094, 0.5979668656, -0.3210532909, 0, 0.5789393465, -0.2488849713, 0.7764570201, 0, 0.6988182827, 0.3557169806, -0.6205791146, 0, -0.8636845529, -0.2748771249, -0.4224826141, 0, -0.4247027957, -0.4640880967, 0.777335046, 0, 0.5257722489, -0.8427017621, 0.1158329937, 0, 0.9343830603, 0.316302472, -0.1639543925, 0, -0.1016836419, -0.8057303073, -0.5834887393, 0,
        -0.6529238969, 0.50602126, -0.5635892736, 0, -0.2465286165, -0.9668205684, -0.06694497494, 0, -0.9776897119, -0.2099250524, -0.007368825344, 0, 0.7736893337, 0.5734244712, 0.2694238123, 0, -0.6095087895, 0.4995678998, 0.6155736747, 0, 0.5794535482, 0.7434546771, 0.3339292269, 0, -0.8226211154, 0.08142581855, 0.5627293636, 0, -0.510385483, 0.4703667658, 0.7199039967, 0,
        -0.5764971849, -0.07231656274, -0.8138926898, 0, 0.7250628871, 0.3949971505, -0.5641463116, 0, -0.1525424005, 0.4860840828, -0.8604958341, 0, -0.5550976208, -0.4957820792, 0.667882296, 0, -0.1883614327, 0.9145869398, 0.357841725, 0, 0.7625556724, -0.5414408243, -0.3540489801, 0, -0.5870231946, -0.3226498013, -0.7424963803, 0, 0.3051124198, 0.2262544068, -0.9250488391, 0,
        0.6379576059, 0.577242424, -0.5097070502, 0, -0.5966775796, 0.1454852398, -0.7891830656, 0, -0.658330573, 0.6555487542, -0.3699414651, 0, 0.7434892426, 0.2351084581, 0.6260573129, 0, 0.5562114096, 0.8264360377, -0.0873632843, 0, -0.3028940016, -0.8251527185, 0.4768419182, 0, 0.1129343818, -0.985888439, -0.1235710781, 0, 0.5937652891, -0.5896813806, 0.5474656618, 0,
        0.6757964092, -0.5835758614, -0.4502648413, 0, 0.7242302609, -0.1152719764, 0.6798550586, 0, -0.9511914166, 0.0753623979, -0.2992580792, 0, 0.2539470961, -0.1886339355, 0.9486454084, 0, 0.571433621, -0.1679450851, -0.8032795685, 0, -0.06778234979, 0.3978269256, 0.9149531629, 0, 0.6074972649, 0.733060024, -0.3058922593, 0, -0.5435478392, 0.1675822484, 0.8224791405, 0,
        -0.5876678086, -0.3380045064, -0.7351186982, 0, -0.7967562402, 0.04097822706, -0.6029098428, 0, -0.1996350917, 0.8706294745, 0.4496111079, 0, -0.02787660336, -0.9106232682, -0.4122962022, 0, -0.7797625996, -0.6257634692, 0.01975775581, 0, -0.5211232846, 0.7401644346, -0.4249554471, 0, 0.8575424857, 0.4053272873, -0.3167501783, 0, 0.1045223322, 0.8390195772, -0.5339674439, 0,
        0.3501822831, 0.9242524096, -0.1520850155, 0, 0.1987849858, 0.07647613266, 0.9770547224, 0, 0.7845996363, 0.6066256811, -0.1280964233, 0, 0.09006737436, -0.9750989929, -0.2026569073, 0, -0.8274343547, -0.542299559, 0.1458203587, 0, -0.3485797732, -0.415802277, 0.840000362, 0, -0.2471778936, -0.7304819962, -0.6366310879, 0, -0.3700154943, 0.8577948156, 0.3567584454, 0,
        0.5913394901, -0.548311967, -0.5913303597, 0, 0.1204873514, -0.7626472379, -0.6354935001, 0, 0.616959265, 0.03079647928, 0.7863922953, 0, 0.1258156836, -0.6640829889, -0.7369967419, 0, -0.6477565124, -0.1740147258, -0.7417077429, 0, 0.6217889313, -0.7804430448, -0.06547655076, 0, 0.6589943422, -0.6096987708, 0.4404473475, 0, -0.2689837504, -0.6732403169, -0.6887635427, 0,
        -0.3849775103, 0.5676542638, 0.7277093879, 0, 0.5754444408, 0.8110471154, -0.1051963504, 0, 0.9141593684, 0.3832947817, 0.131900567, 0, -0.107925319, 0.9245493968, 0.3654593525, 0, 0.377977089, 0.3043148782, 0.8743716458, 0, -0.2142885215, -0.8259286236, 0.5214617324, 0, 0.5802544474, 0.4148098596, -0.7008834116, 0, -0.1982660881, 0.8567161266, -0.4761596756, 0,
        -0.03381553704, 0.3773180787, -0.9254661404, 0, -0.6867922841, -0.6656597827, 0.2919133642, 0, 0.7731742607, -0.2875793547, -0.5652430251, 0, -0.09655941928, 0.9193708367, -0.3813575004, 0, 0.2715702457, -0.9577909544, -0.09426605581, 0, 0.2451015704, -0.6917998565, -0.6792188003, 0, 0.977700782, -0.1753855374, 0.1155036542, 0, -0.5224739938, 0.8521606816, 0.02903615945, 0,
        -0.7734880599, -0.5261292347, 0.3534179531, 0, -0.7134492443, -0.269547243, 0.6467878011, 0, 0.1644037271, 0.5105846203, -0.8439637196, 0, 0.6494635788, 0.05585611296, 0.7583384168, 0, -0.4711970882, 0.5017280509, -0.7254255765, 0, -0.6335764307, -0.2381686273, -0.7361091029, 0, -0.9021533097, -0.270947803, -0.3357181763, 0, -0.3793711033, 0.872258117, 0.3086152025, 0,
        -0.6855598966, -0.3250143309, 0.6514394162, 0, 0.2900942212, -0.7799057743, -0.5546100667, 0, -0.2098319339, 0.85037073, 0.4825351604, 0, -0.4592603758, 0.6598504336, -0.5947077538, 0, 0.8715945488, 0.09616365406, -0.4807031248, 0, -0.6776666319, 0.7118504878, -0.1844907016, 0, 0.7044377633, 0.312427597, 0.637304036, 0, -0.7052318886, -0.2401093292, -0.6670798253, 0,
        0.081921007, -0.7207336136, -0.6883545647, 0, -0.6993680906, -0.5875763221, -0.4069869034, 0, -0.1281454481, 0.6419895885, 0.7559286424, 0, -0.6337388239, -0.6785471501, -0.3714146849, 0, 0.5565051903, -0.2168887573, -0.8020356851, 0, -0.5791554484, 0.7244372011, -0.3738578718, 0, 0.1175779076, -0.7096451073, 0.6946792478, 0, -0.6134619607, 0.1323631078, 0.7785527795, 0,
        0.6984635305, -0.02980516237, -0.715024719, 0, 0.8318082963, -0.3930171956, 0.3919597455, 0, 0.1469576422, 0.05541651717, -0.9875892167, 0, 0.708868575, -0.2690503865, 0.6520101478, 0, 0.2726053183, 0.67369766, -0.68688995, 0, -0.6591295371, 0.3035458599, -0.6880466294, 0, 0.4815131379, -0.7528270071, 0.4487723203, 0, 0.9430009463, 0.1675647412, -0.2875261255, 0,
        0.434802957, 0.7695304522, -0.4677277752, 0, 0.3931996188, 0.594473625, 0.7014236729, 0, 0.7254336655, -0.603925654, 0.3301814672, 0, 0.7590235227, -0.6506083235, 0.02433313207, 0, -0.8552768592, -0.3430042733, 0.3883935666, 0, -0.6139746835, 0.6981725247, 0.3682257648, 0, -0.7465905486, -0.5752009504, 0.3342849376, 0, 0.5730065677, 0.810555537, -0.1210916791, 0,
        -0.9225877367, -0.3475211012, -0.167514036, 0, -0.7105816789, -0.4719692027, -0.5218416899, 0, -0.08564609717, 0.3583001386, 0.929669703, 0, -0.8279697606, -0.2043157126, 0.5222271202, 0, 0.427944023, 0.278165994, 0.8599346446, 0, 0.5399079671, -0.7857120652, -0.3019204161, 0, 0.5678404253, -0.5495413974, -0.6128307303, 0, -0.9896071041, 0.1365639107, -0.04503418428, 0,
        -0.6154342638, -0.6440875597, 0.4543037336, 0, 0.1074204368, -0.7946340692, 0.5975094525, 0, -0.3595449969, -0.8885529948, 0.28495784, 0, -0.2180405296, 0.1529888965, 0.9638738118, 0, -0.7277432317, -0.6164050508, -0.3007234646, 0, 0.7249729114, -0.00669719484, 0.6887448187, 0, -0.5553659455, -0.5336586252, 0.6377908264, 0, 0.5137558015, 0.7976208196, -0.3160000073, 0,
        -0.3794024848, 0.9245608561, -0.03522751494, 0, 0.8229248658, 0.2745365933, -0.4974176556, 0, -0.5404114394, 0.6091141441, 0.5804613989, 0, 0.8036581901, -0.2703029469, 0.5301601931, 0, 0.6044318879, 0.6832968393, 0.4095943388, 0, 0.06389988817, 0.9658208605, -0.2512108074, 0, 0.1087113286, 0.7402471173, -0.6634877936, 0, -0.713427712, -0.6926784018, 0.1059128479, 0,
        0.6458897819, -0.5724548511, -0.5050958653, 0, -0.6553931414, 0.7381471625, 0.159995615, 0, 0.3910961323, 0.9188871375, -0.05186755998, 0, -0.4879022471, -0.5904376907, 0.6429111375, 0, 0.6014790094, 0.7707441366, -0.2101820095, 0, -0.5677173047, 0.7511360995, 0.3368851762, 0, 0.7858573506, 0.226674665, 0.5753666838, 0, -0.4520345543, -0.604222686, -0.6561857263, 0,
        0.002272116345, 0.4132844051, -0.9105991643, 0, -0.5815751419, -0.5162925989, 0.6286591339, 0, -0.03703704785, 0.8273785755, 0.5604221175, 0, -0.5119692504, 0.7953543429, -0.3244980058, 0, -0.2682417366, -0.9572290247, -0.1084387619, 0, -0.2322482736, -0.9679131102, -0.09594243324, 0, 0.3554328906, -0.8881505545, 0.2913006227, 0, 0.7346520519, -0.4371373164, 0.5188422971, 0,
        0.9985120116, 0.04659011161, -0.02833944577, 0, -0.3727687496, -0.9082481361, 0.1900757285, 0, 0.91737377, -0.3483642108, 0.1925298489, 0, 0.2714911074, 0.4147529736, -0.8684886582, 0, 0.5131763485, -0.7116334161, 0.4798207128, 0, -0.8737353606, 0.18886992, -0.4482350644, 0, 0.8460043821, -0.3725217914, 0.3814499973, 0, 0.8978727456, -0.1780209141, -0.4026575304, 0,
        0.2178065647, -0.9698322841, -0.1094789531, 0, -0.1518031304, -0.7788918132, -0.6085091231, 0, -0.2600384876, -0.4755398075, -0.8403819825, 0, 0.572313509, -0.7474340931, -0.3373418503, 0, -0.7174141009, 0.1699017182, -0.6756111411, 0, -0.684180784, 0.02145707593, -0.7289967412, 0, -0.2007447902, 0.06555605789, -0.9774476623, 0, -0.1148803697, -0.8044887315, 0.5827524187, 0,
        -0.7870349638, 0.03447489231, 0.6159443543, 0, -0.2015596421, 0.6859872284, 0.6991389226, 0, -0.08581082512, -0.10920836, -0.9903080513, 0, 0.5532693395, 0.7325250401, -0.396610771, 0, -0.1842489331, -0.9777375055, -0.1004076743, 0, 0.0775473789, -0.9111505856, 0.4047110257, 0, 0.1399838409, 0.7601631212, -0.6344734459, 0, 0.4484419361, -0.845289248, 0.2904925424, 0
    )

    [Int64]$Seed                                           = 1337
    [Int64]$Octaves                                        = 3
    [Single]$Frequency                                     = 0.01
    [Single]$Lacunarity                                    = 2
    [Single]$Gain                                          = 0.5
    [Single]$WeightedStrength                              = 0
    [Single]$PingPongStrength                              = 2
    [Single]$FractalBounding                               = 1 / 1.75
    [Single]$CellularJitterModifier                        = 1
    [Single]$DomainWarpAmp                                 = 1
    [FnlNoiseType]$NoiseType                               = [FnlNoiseType]::OpenSimplex2
    [FnlRotationType3D]$RotationType3D                     = [FnlRotationType3D]::None
    [FnlTransformType3D]$TransformType3D                   = [FnlTransformType3D]::DefaultOpenSimplex2
    [FnlTransformType3D]$WarpTransformType3D               = [FnlTransformType3D]::DefaultOpenSimplex2
    [FnlFractalType]$FractalType                           = [FnlFractalType]::None
    [FnlCellularDistanceFunction]$CellularDistanceFunction = [FnlCellularDistanceFunction]::EuclideanSq
    [FnlCellularReturnType]$CellularReturnType             = [FnlCellularReturnType]::Distance
    [FnlDomainWarpType]$DomainWarpType                     = [FnlDomainWarpType]::OpenSimplex2

    FastNoiseLite() {}

    ###########################################################################
    #
    # NOTE THAT THE FOLLOWING METHODS WERE INLINED IN THE C# SOURCE.
    # POWERSHELL DOESN'T SUPPORT INLINING, SO THERE *MAY* BE SOME PERFORMANCE
    # DECAY HERE.
    #
    ###########################################################################
    Static [Single]FastMin(
        [Single]$A,
        [Single]$B
    ) {
        Return $A -LT $B ? $A : $B
    }

    Static [Single]FastMax(
        [Single]$A,
        [Single]$B
    ) {
        Return $A -GT $B ? $A : $B
    }

    Static [Single]FastAbs(
        [Single]$F
    ) {
        Return $F -LT 0 ? $F * -1 : $F
    }

    Static [Single]FastSqrt(
        [Single]$F
    ) {
        Return ([Single]([System.Math]::Sqrt($F))) # SQRT RETURNS DOUBLE, SO THIS CAST MAY MAKE SENSE, BUT WE MAY LOSE RESOLUTION
    }

    Static [Int64]FastFloor(
        [Single]$F
    ) {
        Return $F -GE 0 ? ([Int64]$F) : ([Int64]$F) - 1
    }

    Static [Int64]FastRound(
        [Single]$F
    ) {
        Return $F -GE 0 ? ([Int64]($F + 0.5)) : ([Int64]($F - 0.5))
    }

    Static [Single]Lerp(
        [Single]$A,
        [Single]$B,
        [Single]$T
    ) {
        Return $A + $T * ($B - $A)
    }

    Static [Single]InterpHermite(
        [Single]$T
    ) {
        Return $T * $T * (3 - 2 * $T)
    }

    Static [Single]InterpQuintic(
        [Single]$T
    ) {
        Return $T * $T * $T * ($T * ($T * 6 - 15) + 10)
    }

    Static [Single]CubicLerp(
        [Single]$A,
        [Single]$B,
        [Single]$C,
        [Single]$D,
        [Single]$T
    ) {
        [Single]$P = ($D - $C) - ($A - $B)

        Return $T * $T * $T * $P + $T * $T * (($A - $B) - $P) + $T * ($C - $A) + $B
    }

    Static [Int64]Hash(
        [Int64]$ASeed,
        [Int64]$XPrimed,
        [Int64]$YPrimed
    ) {
        [Int64]$Hash  = $ASeed -BXOR $XPrimed -BXOR $YPrimed
        $Hash        *= [FastNoiseLite]::HASH_MAGIC

        Return $Hash
    }

    Static [Int64]Hash(
        [Int64]$ASeed,
        [Int64]$XPrimed,
        [Int64]$YPrimed,
        [Int64]$ZPrimed
    ) {
        [Int64]$Hash  = $ASeed -BXOR $XPrimed -BXOR $YPrimed -BXOR $ZPrimed
        $Hash        *= [FastNoiseLite]::HASH_MAGIC

        Return $Hash
    }

    Static [Single]ValCoord(
        [Int64]$ASeed,
        [Int64]$XPrimed,
        [Int64]$YPrimed
    ) {
        [Int64]$Hash  = [FastNoiseLite]::Hash($ASeed, $XPrimed, $YPrimed)
        $Hash        *= $Hash
        $Hash         = $Hash -BXOR ($Hash -SHL 19) # ORIGINAL STATEMENT WAS hash ^= hash << 19;

        Return $Hash * (1 / [FastNoiseLite]::HASHCALC_MAGIC)
    }

    Static [Single]ValCoord(
        [Int64]$ASeed,
        [Int64]$XPrimed,
        [Int64]$YPrimed,
        [Int64]$ZPrimed
    ) {
        [Int64]$Hash  = [FastNoiseLite]::Hash($ASeed, $XPrimed, $YPrimed, $ZPrimed)
        $Hash        *= $Hash
        $Hash         = $Hash -BXOR ($Hash -SHL 19) # ORIGINAL STATEMENT WAS hash ^= hash << 19;

        Return $Hash * (1 / [FastNoiseLite]::HASHCALC_MAGIC)
    }

    Static [Single]GradCoord(
        [Int64]$ASeed,
        [Int64]$XPrimed,
        [Int64]$YPrimed,
        [Single]$Xd,
        [Single]$Yd
    ) {
        [Int64]$Hash = [FastNoiseLite]::Hash($ASeed, $XPrimed, $YPrimed)
        $Hash        = $Hash -BXOR ($Hash -SHR 15) # ORIGINAL STATEMENT WAS hash ^= hash >> 15;
        $Hash        = $Hash -BAND (127 -SHL 1) # ORIGINAL STATEMENT WAS  hash &= 127 << 1;

        [Single]$Xg = [FastNoiseLite]::GRADIENTS2D[$Hash]
        [Single]$Yg = [FastNoiseLite]::GRADIENTS2D[($Hash -BOR 1)]

        Return $Xd * $Xg + $Yd * $Yg
    }

    Static [Single]GradCoord(
        [Int64]$ASeed,
        [Int64]$XPrimed,
        [Int64]$YPrimed,
        [Int64]$ZPrimed,
        [Single]$Xd,
        [Single]$Yd,
        [Single]$Zd
    ) {
        [Int64]$Hash = [FastNoiseLite]::Hash($ASeed, $XPrimed, $YPrimed, $ZPrimed)
        $Hash        = $Hash -BXOR ($Hash -SHR 15) # ORIGINAL STATEMENT WAS hash ^= hash >> 15;
        $Hash        = $Hash -BAND (63 -SHL 2) # ORIGINAL STATEMENT WAS  hash &= 63 << 2;

        [Single]$Xg = [FastNoiseLite]::GRADIENTS3D[$Hash]
        [Single]$Yg = [FastNoiseLite]::GRADIENTS3D[($Hash -BOR 1)]
        [Single]$Zg = [FastNoiseLite]::GRADIENTS3D[($Hash -BOR 2)]

        Return $Xd * $Xg + $Yd * $Yg + $Zd * $Zg
    }

    ###########################################################################
    #
    # THE ORIGINAL SOURCE FOR THIS METHOD IS AS FOLLOWS:
    #
    #     private static void GradCoordOut(int seed, int xPrimed, int yPrimed, out Single xo, out Single yo)
    #     {
    #     int hash = Hash(seed, xPrimed, yPrimed) & (255 << 1);
    #
    #     xo = RandVecs2D[hash];
    #     yo = RandVecs2D[hash | 1];
    #     }
    #
    # USING REF ARGS IN LIEU OF OUT SHOULD BE SATISFACTORY HERE
    #
    ###########################################################################
    Static [Void]GradCoordOut(
        [Int64]$ASeed,
        [Int64]$XPrimed,
        [Int64]$YPrimed,
        [Ref]$Xo,
        [Ref]$Yo
    ) {
        [Int64]$Hash = [FastNoiseLite]::Hash($ASeed, $XPrimed, $YPrimed) -BAND (255 -SHL 1)

        $Xo.Value = [FastNoiseLite]::RANDVECS2D[$Hash]
        $Yo.Value = [FastNoiseLite]::RANDVECS2D[($Hash -BOR 1)]
    }

    Static [Void]GradCoordOut(
        [Int64]$ASeed,
        [Int64]$XPrimed,
        [Int64]$YPrimed,
        [Int64]$ZPrimed,
        [Ref]$Xo,
        [Ref]$Yo,
        [Ref]$Zo
    ) {
        [Int64]$Hash = [FastNoiseLite]::Hash($ASeed, $XPrimed, $YPrimed) -BAND (255 -SHL 2)

        $Xo.Value = [FastNoiseLite]::RANDVECS2D[$Hash]
        $Yo.Value = [FastNoiseLite]::RANDVECS2D[($Hash -BOR 1)]
        $Zo.Value = [FastNoiseLite]::RANDVECS2D[($Hash -BOR 2)]
    }

    Static [Void]GradCoordDual(
        [Int64]$ASeed,
        [Int64]$XPrimed,
        [Int64]$YPrimed,
        [Single]$Xd,
        [Single]$Yd,
        [Ref]$Xo,
        [Ref]$Yo
    ) {
        [Int64]$Hash   = [FastNoiseLite]::Hash($ASeed, $XPrimed, $YPrimed)
        [Int64]$Index1 = $Hash -BAND (127 -SHL 1)
        [Int64]$Index2 = ($Hash -SHR 7) -BAND (255 -SHL 1)
        [Single]$Xg    = [FastNoiseLite]::GRADIENTS2D[$Index1]
        [Single]$Yg    = [FastNoiseLite]::GRADIENTS2D[($Index1 -BOR 1)]
        [Single]$Xgo   = [FastNoiseLite]::RANDVECS2D[$Index2]
        [Single]$Ygo   = [FastNoiseLite]::RANDVECS2D[($Index2 -BOR 1)]
        [Single]$Value = $Xd * $Xg + $Yd * $Yg

        $Xo.Value = $Value * $Xgo
        $Yo.Value = $Value * $Ygo
    }

    Static [Void]GradCoordDual(
        [Int64]$ASeed,
        [Int64]$XPrimed,
        [Int64]$YPrimed,
        [Int64]$ZPrimed,
        [Single]$Xd,
        [Single]$Yd,
        [Single]$Zd,
        [Ref]$Xo,
        [Ref]$Yo,
        [Ref]$Zo
    ) {
        [Int64]$Hash   = [FastNoiseLite]::Hash($ASeed, $XPrimed, $YPrimed, $ZPrimed)
        [Int64]$Index1 = $Hash -BAND (63 -SHL 2)
        [Int64]$Index2 = ($Hash -SHR 6) -BAND (255 -SHL 2)
        [Single]$Xg    = [FastNoiseLite]::GRADIENTS3D[$Index1]
        [Single]$Yg    = [FastNoiseLite]::GRADIENTS3D[($Index1 -BOR 1)]
        [Single]$Zg    = [FastNoiseLite]::GRADIENTS2D[($Index1 -BOR 2)]
        [Single]$Xgo   = [FastNoiseLite]::RANDVECS3D[$Index2]
        [Single]$Ygo   = [FastNoiseLite]::RANDVECS3D[($Index2 -BOR 1)]
        [Single]$Zgo   = [FastNoiseLite]::RANDVECS3D[($Index2 -BOR 2)]
        [Single]$Value = $Xd * $Xg + $Yd * $Yg + $Zd * $Zg

        $Xo.Value = $Value * $Xgo
        $Yo.Value = $Value * $Ygo
        $Zo.Value = $Value * $Zgo
    }

    [Void]SetNoiseType(
        [FnlNoiseType]$NoiseType
    ) {
        $this.NoiseType = $NoiseType
        $this.UpdateTransformType3D()
    }

    [Void]SetRotationType3D(
        [FnlRotationType3D]$RotationType3D
    ) {
        $this.RotationType3D = $RotationType3D
        $this.UpdateTransformType3D()
        $this.UpdateWarpTransformType3D()
    }

    [Void]SetFractalOctaves(
        [Int64]$Octaves
    ) {
        $this.Octaves = $Octaves
        $this.CalculateFractalBounding()
    }

    [Void]SetFractalGain(
        [Single]$Gain
    ) {
        $this.Gain = $Gain
        $this.CalculateFractalBounding()
    }

    [Void]SetDomainWarpType(
        [FnlDomainWarpType]$DomainWarpType
    ) {
        $this.DomainWarpType = $DomainWarpType
        $this.UpdateWarpTransformType3D()
    }

    [Single]GetNoise(
        [Single]$X,
        [Single]$Y
    ) {
        $this.TransformNoiseCoordinate(([Ref]$X), ([Ref]$Y))

        Switch($this.FractalType) {
            ([FnlFractalType]::FBm) {
                Return $this.GenFractalFBm($X, $Y)
            }

            ([FnlFractalType]::Ridged) {
                Return $this.GenFractalRidged($X, $Y)
            }

            ([FnlFractalType]::PingPong) {
                Return $this.GenFractalPingPong($X, $Y)
            }

            Default {
                Return $this.GenNoiseSingle($this.Seed, $X, $Y)
            }
        }

        # THIS CODE PATH ISN'T CONSIDERED IN THE ORIGINAL SOURCE, SO I'LL JUST INCLUDE THE DEFAULT CASE HERE
        # THIS IS MORE SO THE LINTER WILL SHUT UP, BUT JUSTIN CASE
        Return $this.GenNoiseSingle($this.Seed, $X, $Y)
    }

    [Single]GetNoise(
        [Single]$X,
        [Single]$Y,
        [Single]$Z
    ) {
        $this.TransformNoiseCoordinate(([Ref]$X), ([Ref]$Y), ([Ref]$Z))

        Switch($this.FractalType) {
            ([FnlFractalType]::FBm) {
                Return $this.GenFractalFBm($X, $Y, $Z)
            }

            ([FnlFractalType]::Ridged) {
                Return $this.GenFractalRidged($X, $Y, $Z)
            }

            ([FnlFractalType]::PingPong) {
                Return $this.GenFractalPingPong($X, $Y, $Z)
            }

            Default {
                Return $this.GenNoiseSingle($this.Seed, $X, $Y, $Z)
            }
        }

        # THIS CODE PATH ISN'T CONSIDERED IN THE ORIGINAL SOURCE, SO I'LL JUST INCLUDE THE DEFAULT CASE HERE
        # THIS IS MORE SO THE LINTER WILL SHUT UP, BUT JUSTIN CASE
        Return $this.GenNoiseSingle($this.Seed, $X, $Y, $Z)
    }

    [Void]DomainWarp(
        [Ref]$X,
        [Ref]$Y
    ) {
        Switch($this.FractalType) {
            ([FnlFractalType]::DomainWarpProgressive) {
                $this.DomainWarpFractalProgressive($X, $Y)

                Break
            }

            ([FnlFractalType]::DomainWarpIndependent) {
                $this.DomainWarpFractalIndependent($X, $Y)

                Break
            }

            Default {
                $this.DomainWarpSingle($X, $Y)

                Break
            }
        }

        $this.DomainWarpSingle($X, $Y)
    }

    [Void]DomainWarp(
        [Ref]$X,
        [Ref]$Y,
        [Ref]$Z
    ) {
        Switch($this.FractalType) {
            ([FnlFractalType]::DomainWarpProgressive) {
                $this.DomainWarpFractalProgressive($X, $Y, $Z)

                Break
            }

            ([FnlFractalType]::DomainWarpIndependent) {
                $this.DomainWarpFractalIndependent($X, $Y, $Z)

                Break
            }

            Default {
                $this.DomainWarpSingle($X, $Y, $Z)

                Break
            }
        }

        $this.DomainWarpSingle($X, $Y, $Z)
    }

    [Single]PingPong(
        [Single]$T
    ) {
        $T = $T - ([Int64]($T * 0.5)) * 2

        Return $T -LT 1 ? $T : 2 - $T
    }

    [Void]CalculateFractalBounding() {
        [Single]$LGain       = [FastNoiseLite]::FastAbs($this.Gain)
        [Single]$LAmp        = $LGain
        [Single]$LAmpFractal = 1

        For([Int64]$I = 1; $I -LT $this.Octaves; $I++) {
            $LAmpFractal += $LAmp
            $LAmp        *= $LGain
        }

        $this.FractalBounding = 1 / $LAmpFractal
    }

    [Single]GenNoiseSingle(
        [Int64]$ASeed,
        [Single]$X,
        [Single]$Y
    ) {
        Switch($this.NoiseType) {
            ([FnlNoiseType]::OpenSimplex2) {
                Return $this.SingleSimplex($ASeed, $X, $Y)
            }

            ([FnlNoiseType]::OpenSimplex2S) {
                Return $this.SingleOpenSimplex2S($ASeed, $X, $Y)
            }

            ([FnlNoiseType]::Cellular) {
                Return $this.SingleCellular($ASeed, $X, $Y)
            }

            ([FnlNoiseType]::Perlin) {
                Return $this.SinglePerlin($ASeed, $X, $Y)
            }

            ([FnlNoiseType]::ValueCubic) {
                Return $this.SingleValueCubic($ASeed, $X, $Y)
            }

            ([FnlNoiseType]::Value) {
                Return $this.SingleValue($ASeed, $X, $Y)
            }

            Default {
                Return 0
            }
        }

        Return 0
    }

    [Single]GenNoiseSingle(
        [Int64]$ASeed,
        [Single]$X,
        [Single]$Y,
        [Single]$Z
    ) {
        Switch($this.NoiseType) {
            ([FnlNoiseType]::OpenSimplex2) {
                Return $this.SingleSimplex($ASeed, $X, $Y, $Z)
            }

            ([FnlNoiseType]::OpenSimplex2S) {
                Return $this.SingleOpenSimplex2S($ASeed, $X, $Y, $Z)
            }

            ([FnlNoiseType]::Cellular) {
                Return $this.SingleCellular($ASeed, $X, $Y, $Z)
            }

            ([FnlNoiseType]::Perlin) {
                Return $this.SinglePerlin($ASeed, $X, $Y, $Z)
            }

            ([FnlNoiseType]::ValueCubic) {
                Return $this.SingleValueCubic($ASeed, $X, $Y, $Z)
            }

            ([FnlNoiseType]::Value) {
                Return $this.SingleValue($ASeed, $X, $Y, $Z)
            }

            Default {
                Return 0
            }
        }

        Return 0
    }

    [Void]TransformNoiseCoordinate(
        [Ref]$X,
        [Ref]$Y
    ) {
        $X.Value *= $this.Frequency
        $Y.Value *= $this.Frequency

        Switch($this.NoiseType) {
            ($_ -EQ [FnlNoiseType]::OpenSimplex2 -OR $_ -EQ [FnlNoiseType]::OpenSimplex2S) {
                [Single]$F2 = 0.5 * ([FastNoiseLite]::SQRT3 - 1)
                [Single]$T  = ($X.Value + $Y.Value) * $F2

                $X.Value += $T
                $Y.Value += $T

                Break
            }

            Default {
                Break
            }
        }

        Return
    }

    [Void]TransformNoiseCoordinate(
        [Ref]$X,
        [Ref]$Y,
        [Ref]$Z
    ) {
        $X.Value *= $this.Frequency
        $Y.Value *= $this.Frequency
        $Z.Value *= $this.Frequency

        Switch($this.TransformType3D) {
            ([FnlTransformType3D]::ImproveXYPlanes) {
                [Single]$Xy = $X.Value + $Y.Value
                [Single]$S2 = $Xy * -[FastNoiseLite]::PLANARIMPROVEA_MAGIC

                $Z.Value *= [FastNoiseLite]::PLANARIMPROVEZSCALE_MAGIC
                $X.Value += $S2 - $Z.Value
                $Y.Value += $S2 - $Z.Value
                $Z.Value += $Xy * [FastNoiseLite]::PLANARIMPROVEZSCALE_MAGIC

                Break
            }

            ([FnlTransformType3D]::ImproveXZPlanes) {
                [Single]$Xz = $X.Value + $Z.Value
                [Single]$S2 = $Xz * -[FastNoiseLite]::PLANARIMPROVEA_MAGIC

                $Y.Value *= [FastNoiseLite]::PLANARIMPROVEZSCALE_MAGIC
                $X.Value += $S2 - $Z.Value
                $Y.Value += $S2 - $Z.Value
                $Z.Value += $Xz * [FastNoiseLite]::PLANARIMPROVEZSCALE_MAGIC

                Break
            }

            ([FnlTransformType3D]::DefaultOpenSimplex2) {
                [Single]$R = ($X.Value + $Y.Value + $Z.Value) * [FastNoiseLite]::A2DIV3

                $X.Value = $R - $X.Value
                $Y.Value = $R - $Y.Value
                $Z.Value = $R - $Z.Value

                Break
            }

            Default {
                Break
            }
        }

        Return
    }

    [Void]UpdateTransformType3D() {
        Switch($this.RotationType3D) {
            ([FnlRotationType3D]::ImproveXYPlanes) {
                $this.TransformType3D = [FnlTransformType3D]::ImproveXYPlanes

                Break
            }

            ([FnlRotationType3D]::ImproveXZPlanes) {
                $this.TransformType3D = [FnlTransformType3D]::ImproveXZPlanes

                Break
            }

            Default {
                Switch($this.NoiseType) {
                    ($_ -EQ [FnlNoiseType]::OpenSimplex2 -OR $_ -EQ [FnlNoiseType]::OpenSimplex2S) {
                        $this.TransformType3D = [FnlTransformType3D]::DefaultOpenSimplex2

                        Break
                    }

                    Default {
                        $this.TransformType3D = [FnlTransformType3D]::None

                        Break
                    }
                }

                Break
            }
        }

        Return
    }

    [Void]TransformDomainWarpCoordinate(
        [Ref]$X,
        [Ref]$Y
    ) {
        Switch($this.DomainWarpType) {
            ($_ -EQ [FnlDomainWarpType]::OpenSimplex2 -OR $_ -EQ [FnlDomainWarpType]::OpenSimplex2Reduced) {
                [Single]$F2 = 0.5 * ([FastNoiseLite]::SQRT3 - 1)
                [Single]$T  = ($X.Value + $Y.Value) * $F2

                $X.Value += $T
                $Y.Value += $T

                Break
            }

            Default {
                Break
            }
        }

        Return
    }

    [Void]TransformDomainWarpCoordinate(
        [Ref]$X,
        [Ref]$Y,
        [Ref]$Z
    ) {
        Switch($this.WarpTransformType3D) {
            ([FnlTransformType3D]::ImproveXYPlanes) {
                [Single]$Xy = $X.Value + $Y.Value
                [Single]$S2 = $Xy * -[FastNoiseLite]::PLANARIMPROVEA_MAGIC

                $Z.Value *= [FastNoiseLite]::PLANARIMPROVEZSCALE_MAGIC
                $X.Value += $S2 - $Z.Value
                $Y.Value += $S2 - $Z.Value
                $Z.Value += $Xy * [FastNoiseLite]::PLANARIMPROVEZSCALE_MAGIC

                Break
            }

            ([FnlTransformType3D]::ImproveXZPlanes) {
                [Single]$Xz = $X.Value + $Z.Value
                [Single]$S2 = $Xz * -[FastNoiseLite]::PLANARIMPROVEA_MAGIC

                $Y.Value *= [FastNoiseLite]::PLANARIMPROVEZSCALE_MAGIC
                $X.Value += $S2 - $Y.Value
                $Z.Value += $S2 - $Y.Value
                $Y.Value += $Xz * [FastNoiseLite]::PLANARIMPROVEZSCALE_MAGIC

                Break
            }

            ([FnlTransformType3D]::DefaultOpenSimplex2) {
                [Single]$R = ($X.Value + $Y.Value + $Z.Value) * [FastNoiseLite]::A2DIV3

                $X.Value = $R - $X.Value
                $Y.Value = $R - $Y.Value
                $Z.Value = $R - $Z.Value

                Break
            }

            Default {
                Break
            }
        }

        Return
    }

    [Void]UpdateWarpTransformType3D() {
        Switch($this.RotationType3D) {
            ([FnlRotationType3D]::ImproveXYPlanes) {
                $this.WarpTransformType3D = [FnlTransformType3D]::ImproveXYPlanes

                Break
            }

            ([FnlRotationType3D]::ImproveXZPlanes) {
                $this.WarpTransformType3D = [FnlTransformType3D]::ImproveXZPlanes

                Break
            }

            Default {
                Switch($this.DomainWarpType) {
                    ($_ -EQ [FnlDomainWarpType]::OpenSimplex2 -OR $_ -EQ [FnlDomainWarpType]::OpenSimplex2Reduced) {
                        $this.WarpTransformType3D = [FnlTransformType3D]::DefaultOpenSimplex2

                        Break
                    }

                    Default {
                        $this.WarpTransformType3D = [FnlTransformType3D]::None

                        Break
                    }
                }

                Break
            }
        }

        Return
    }

    [Single]GenFractalFBm(
        [Single]$X,
        [Single]$Y
    ) {
        [Int64]$ASeed = $this.Seed
        [Single]$Sum  = 0
        [Single]$Amp  = $this.FractalBounding

        For([Int64]$I = 0; $I -LT $this.Octaves; $I++) {
            [Single]$Noise = $this.GenNoiseSingle($ASeed++, $X, $Y)

            $Sum += $Noise * $Amp
            $Amp *= $this.Lerp(1, [FastNoiseLite]::FastMin($Noise + 1, 2) * 0.5, $this.WeightedStrength)
            $X   *= $this.Lacunarity
            $Y   *= $this.Lacunarity
            $Amp *= $this.Gain
        }

        Return $Sum
    }

    [Single]GenFractalFBm(
        [Single]$X,
        [Single]$Y,
        [Single]$Z
    ) {
        [Int64]$ASeed = $this.Seed
        [Single]$Sum  = 0
        [Single]$Amp  = $this.FractalBounding

        For([Int64]$I = 0; $I -LT $this.Octaves; $I++) {
            [Single]$Noise = $this.GenNoiseSingle($ASeed++, $X, $Y, $Z)

            $Sum += $Noise * $Amp
            $Amp *= $this.Lerp(1, [FastNoiseLite]::FastMin($Noise + 1, 2) * 0.5, $this.WeightedStrength)
            $X   *= $this.Lacunarity
            $Y   *= $this.Lacunarity
            $Z   *= $this.Lacunarity
            $Amp *= $this.Gain
        }

        Return $Sum
    }

    [Single]GenFractalRidged(
        [Single]$X,
        [Single]$Y
    ) {
        [Int64]$ASeed = $this.Seed
        [Single]$Sum  = 0
        [Single]$Amp  = $this.FractalBounding

        For([Int64]$I = 0; $I -LT $this.Octaves; $I++) {
            [Single]$Noise = [FastNoiseLite]::FastAbs($this.GenNoiseSingle($ASeed++, $X, $Y))

            $Sum += ($Noise * -2 + 1) * $Amp
            $Amp *= $this.Lerp(1, 1 - $Noise, $this.WeightedStrength)
            $X   *= $this.Lacunarity
            $Y   *= $this.Lacunarity
            $Amp *= $this.Gain
        }

        Return $Sum
    }

    [Single]GenFractalRidged(
        [Single]$X,
        [Single]$Y,
        [Single]$Z
    ) {
        [Int64]$ASeed = $this.Seed
        [Single]$Sum  = 0
        [Single]$Amp  = $this.FractalBounding

        For([Int64]$I = 0; $I -LT $this.Octaves; $I++) {
            [Single]$Noise = [FastNoiseLite]::FastAbs($this.GenNoiseSingle($ASeed++, $X, $Y, $Z))

            $Sum += ($Noise * -2 + 1) * $Amp
            $Amp *= $this.Lerp(1, 1 - $Noise, $this.WeightedStrength)
            $X   *= $this.Lacunarity
            $Y   *= $this.Lacunarity
            $Z   *= $this.Lacunarity
            $Amp *= $this.Gain
        }

        Return $Sum
    }

    [Single]GenFractalPingPong(
        [Single]$X,
        [Single]$Y
    ) {
        [Int64]$ASeed = $this.Seed
        [Single]$Sum  = 0
        [Single]$Amp  = $this.FractalBounding

        For([Int64]$I = 0; $I -LT $this.Octaves; $I++) {
            [Single]$Noise = $this.PingPong(($this.GenNoiseSingle($ASeed++, $X, $Y) + 1) * $this.PingPongStrength)

            $Sum += ($Noise - 0.5) * 2 * $Amp
            $Amp *= $this.Lerp(1, $Noise, $this.WeightedStrength)
            $X   *= $this.Lacunarity
            $Y   *= $this.Lacunarity
            $Amp *= $this.Gain
        }

        Return $Sum
    }

    [Single]GenFractalPingPong(
        [Single]$X,
        [Single]$Y,
        [Single]$Z
    ) {
        [Int64]$ASeed = $this.Seed
        [Single]$Sum  = 0
        [Single]$Amp  = $this.FractalBounding

        For([Int64]$I = 0; $I -LT $this.Octaves; $I++) {
            [Single]$Noise = $this.PingPong(($this.GenNoiseSingle($ASeed++, $X, $Y, $Z) + 1) * $this.PingPongStrength)

            $Sum += ($Noise - 0.5) * 2 * $Amp
            $Amp *= $this.Lerp(1, $Noise, $this.WeightedStrength)
            $X   *= $this.Lacunarity
            $Y   *= $this.Lacunarity
            $Z   *= $this.Lacunarity
            $Amp *= $this.Gain
        }

        Return $Sum
    }

    [Single]SingleSimplex(
        [Int64]$ASeed,
        [Single]$X,
        [Single]$Y
    ) {
        [Single]$G2   = (3 - [FastNoiseLite]::SQRT3) / 6
        [Single]$G2m1 = $G2 - 1
        [Single]$G2a1 = 1 - 2 * $G2
        [Single]$G2a2 = 2 * $G2m1
        [Int64]$I     = [FastNoiseLite]::FastFloor($X)
        [Int64]$J     = [FastNoiseLite]::FastFloor($Y)
        [Single]$Xi   = ([Single]($X - $I))
        [Single]$Yi   = ([Single]($Y - $J))
        [Single]$T    = ($Xi + $Yi) * $G2
        [Single]$X0   = $Xi - $T
        [Single]$Y0   = $Yi - $T
        [Single]$N0   = 0
        [Single]$N1   = 0
        [Single]$N2   = 0

        $I *= [FastNoiseLite]::PRIMEX
        $J *= [FastNoiseLite]::PRIMEY

        [Single]$A  = 0.5 - $X0 * $X0 - $Y0 * $Y0

        If($A -LE 0) {
            $N0 = 0
        } Else {
            $N0 = $A * $A * $A * $A * [FastNoiseLite]::GradCoord($ASeed, $I, $J, $X0, $Y0)
        }

        [Single]$C  = ([Single](2 * $G2a1 * (1 / $G2 - 2)) * $T + ([Single](-2 * $G2a1 * $G2a1) + $A))

        If($C -LE 0) {
            $N2 = 0
        } Else {
            [Single]$X2 = $X0 + $G2a2
            [Single]$Y2 = $Y0 + $G2a2

            $N2 = $C * $C * $C * $C * [FastNoiseLite]::GradCoord($ASeed, $I + [FastNoiseLite]::PRIMEX, $J + [FastNoiseLite]::PRIMEY, $X2, $Y2)
        }

        If($Y0 -GT $X0) {
            [Single]$X1 = $X0 + $G2
            [Single]$Y1 = $Y0 + $G2m1
            [Single]$B  = 0.5 - $X1 * $X1 - $Y1 * $Y1

            If($B -LE 0) {
                $N1 = 0
            } Else {
                $N1 = $B * $B * $B * $B * [FastNoiseLite]::GradCoord($ASeed, $I, $J + [FastNoiseLite]::PRIMEY, $X1, $Y1)
            }
        } Else {
            [Single]$X1 = $X0 + $G2m1
            [Single]$Y1 = $Y0 + $G2
            [Single]$B  = 0.5 - $X1 * $X1 - $Y1 * $Y1

            If($B -LE 0) {
                $N1 = 0
            } Else {
                $N1 = $B * $B * $B * $B * [FastNoiseLite]::GradCoord($ASeed, $I + [FastNoiseLite]::PRIMEX, $J, $X1, $Y1)
            }
        }

        Return ($N0 + $N1 + $N2) * 99.83685446303647
    }

    [Single]SingleOpenSimplex2(
        [Int64]$ASeed,
        [Single]$X,
        [Single]$Y,
        [Single]$Z
    ) {
        [Int64]$I      = [FastNoiseLite]::FastRound($X)
        [Int64]$J      = [FastNoiseLite]::FastRound($Y)
        [Int64]$K      = [FastNoiseLite]::FastRound($Z)
        [Single]$X0    = ([Single]($X - $I))
        [Single]$Y0    = ([Single]($Y - $J))
        [Single]$Z0    = ([Single]($Z - $K))
        [Int64]$XNSign = ([Int64](-1 - $X0) -BOR 1)
        [Int64]$YNSign = ([Int64](-1 - $Y0) -BOR 1)
        [Int64]$ZNSign = ([Int64](-1 - $Z0) -BOR 1)
        [Single]$Ax0   = $XNSign * -$X0
        [Single]$Ay0   = $YNSign * -$Y0
        [Single]$Az0   = $ZNSign * -$Z0
    
        $I *= [FastNoiseLite]::PRIMEX
        $J *= [FastNoiseLite]::PRIMEY
        $K *= [FastNoiseLite]::PRIMEZ
    
        [Single]$Value = 0
        [Single]$A     = (0.6 - $X0 * $X0) - ($Y0 * $Y0 + $Z0 * $Z0)
    
        For([Int64]$L = 0; ; $L++) {
            If($A -GT 0) {
                $Value += $A * $A * $A * $A * [FastNoiseLite]::GradCoord($ASeed, $I, $J, $K, $X0, $Y0, $Z0)
            }

            If($Ax0 -GE $Ay0 -AND $Ax0 -GE $Az0) {
                [Single]$B  = $A + $Ax0 + $Ax0

                If($B -GT 1) {
                    $B     -= 1
                    $Value += $B * $B * $B * $B * [FastNoiseLite]::GradCoord($ASeed, $I - $XNSign * [FastNoiseLite]::PRIMEX, $J, $K, $X0 + $XNSign, $Y0, $Z0)
                }
            } Elseif($Ay0 -GT $Ax0 -AND $Ay0 -GE $Az0) {
                [Single]$B  = $A + $Ay0 + $Ay0

                If($B -GT 1) {
                    $B     -= 1
                    $Value += $B * $B * $B * $B * [FastNoiseLite]::GradCoord($ASeed, $I, $J - $YNSign * [FastNoiseLite]::PRIMEY, $K, $X0, $Y0 + $YNSign, $Z0)
                }
            } Else {
                [Single]$B  = $A + $Az0 + $Az0

                If($B -GT 1) {
                    $B     -= 1
                    $Value += $B * $B * $B * $B * [FastNoiseLite]::GradCoord($ASeed, $I, $J, $K - $ZNSign * [FastNoiseLite]::PRIMEZ, $X0, $Y0, $Z0 + $ZNSign)
                }
            }

            If($L == 1) {
                Break
            }

            $Ax0     = 0.5 - $Ax0
            $Ay0     = 0.5 - $Ay0
            $Az0     = 0.5 - $Az0
            $X0      = $XNSign * $Ax0
            $Y0      = $YNSign * $Ay0
            $Z0      = $ZNSign * $Az0
            $A      += (0.75 - $Ax0) - ($Ay0 + $Az0)
            $I      += ($XNSign -SHR 1) -BAND [FastNoiseLite]::PRIMEX
            $J      += ($YNSign -SHR 1) -BAND [FastNoiseLite]::PRIMEY
            $K      += ($ZNSign -SHR 1) -BAND [FastNoiseLite]::PRIMEZ
            $XNSign  = -$XNSign
            $YNSign  = -$YNSign
            $ZNSign  = -$ZNSign
            $ASeed   = -BNOT $ASeed
        }

        Return $Value * [FastNoiseLite]::SIMPLEXVALMODA_MAGIC
    }

    [Single]SingleOpenSimplex2S(
        [Int64]$ASeed,
        [Single]$X,
        [Single]$Y
    ) {
        [Single]$G2   = (3 - [FastNoiseLite]::SQRT3) / 6
        [Single]$G2m1 = $G2 - 1
        [Single]$G2a1 = 1 - 2 * $G2
        [Int64]$I     = [FastNoiseLite]::FastFloor($X)
        [Int64]$J     = [FastNoiseLite]::FastFloor($Y)
        [Single]$Xi   = ([Single]($X - $I))
        [Single]$Yi   = ([Single]($Y - $J))

        $I *= [FastNoiseLite]::PRIMEX
        $J *= [FastNoiseLite]::PRIMEY

        [Int64]$I1     = $I + [FastNoiseLite]::PRIMEX
        [Int64]$J1     = $J + [FastNoiseLite]::PRIMEY
        [Single]$T     = ($Xi + $Yi) * $G2
        [Single]$X0    = $Xi - $T
        [Single]$Y0    = $Yi - $T
        [Single]$A0    = [FastNoiseLite]::A2DIV3 - $X0 * $X0 - $Y0 * $Y0
        [Single]$Value = $A0 * $A0 * $A0 * $A0 * [FastNoiseLite]::GradCoord($ASeed, $I, $J, $X0, $Y0)
        [Single]$A1    = ([Single](2 * $G2a1 * (1 / $G2 - 2)) * $T + ([Single](-2 * $G2a1 * $G2a1) + $A0))
        [Single]$X1    = $X0 - $G2a1
        [Single]$Y1    = $Y0 - $G2a1

        $Value += $A1 * $A1 * $A1 * $A1 * [FastNoiseLite]::GradCoord($ASeed, $I1, $J1, $X1, $Y1)

        [Single]$Xmyi = $Xi - $Yi

        If($T -GT $G2) {
            If($Xi + $Xmyi -GT 1) {
                [Single]$X2  = $X0 + (3 * $G2 - 2)
                [Single]$Y2  = $Y0 + (3 * $G2 - 1)
                [Single]$A2  = [FastNoiseLite]::A2DIV3 - $X2 * $X2 - $Y2 * $Y2

                If($A2 -GT 0) {
                    $Value += $A2 * $A2 * $A2 * $A2 * [FastNoiseLite]::GradCoord($ASeed, $I + ([FastNoiseLite]::PRIMEX -SHL 1), $J + [FastNoiseLite]::PRIMEY, $X2, $Y2)
                }
            } Else {
                [Single]$X2  = $X0 + $G2
                [Single]$Y2  = $Y0 + $G2m1
                [Single]$A2  = [FastNoiseLite]::A2DIV3 - $X2 * $X2 - $Y2 * $Y2

                If($A2 -GT 0) {
                    $Value += $A2 * $A2 * $A2 * $A2 * [FastNoiseLite]::GradCoord($ASeed, $I, $J + [FastNoiseLite]::PRIMEY, $X2, $Y2)
                }
            }

            If($Yi - $Xmyi -GT 1) {
                [Single]$X3  = $X0 + $G2m1
                [Single]$Y3  = $Y0 + $G2
                [Single]$A3  = [FastNoiseLite]::A2DIV3 - $X3 * $X3 - $Y3 * $Y3

                If($A3 -GT 0) {
                    $Value += $A3 * $A3 * $A3 * $A3 * [FastNoiseLite]::GradCoord($ASeed, $I + [FastNoiseLite]::PRIMEX, $J, $X3, $Y3)
                }
            }
        } Else {
            If($Xi + $Xmyi -LT 0) {
                [Single]$X2  = $X0 + $G2m1
                [Single]$Y2  = $Y0 - $G2
                [Single]$A2  = [FastNoiseLite]::A2DIV3 - $X2 * $X2 - $Y2 * $Y2

                If($A2 -GT 0) {
                    $Value += $A2 * $A2 * $A2 * $A2 * [FastNoiseLite]::GradCoord($ASeed, $I - [FastNoiseLite]::PRIMEX, $J, $X2, $Y2)
                }
            } Else {
                [Single]$X2  = $X0 + $G2m1
                [Single]$Y2  = $Y0 - $G2
                [Single]$A2  = [FastNoiseLite]::A2DIV3 - $X2 * $X2 - $Y2 * $Y2

                If($A2 -GT 0) {
                    $Value += $A2 * $A2 * $A2 * $A2 * [FastNoiseLite]::GradCoord($ASeed, $I + [FastNoiseLite]::PRIMEX, $J, $X2, $Y2)
                }
            }

            If($Yi -LT $Xmyi) {
                [Single]$X2  = $X0 - $G2
                [Single]$Y2  = $Y0 - $G2m1
                [Single]$A2  = [FastNoiseLite]::A2DIV3 - $X2 * $X2 - $Y2 * $Y2

                If($A2 -GT 0) {
                    $Value += $A2 * $A2 * $A2 * $A2 * [FastNoiseLite]::GradCoord($ASeed, $I, $J - [FastNoiseLite]::PRIMEY, $X2, $Y2)
                }
            } Else {
                [Single]$X2  = $X0 + $G2
                [Single]$Y2  = $Y0 + $G2m1
                [Single]$A2  = [FastNoiseLite]::A2DIV3 - $X2 * $X2 - $Y2 * $Y2

                If($A2 -GT 0) {
                    $Value += $A2 * $A2 * $A2 * $A2 * [FastNoiseLite]::GradCoord($ASeed, $I, $J + [FastNoiseLite]::PRIMEY, $X2, $Y2)
                }
            }
        }

        Return $Value * 18.24196194486065
    }

    [Single]SingleOpenSimplex2S(
        [Int64]$ASeed,
        [Single]$X,
        [Single]$Y,
        [Single]$Z
    ) {
        [Int64]$I   = [FastNoiseLite]::FastFloor($X)
        [Int64]$J   = [FastNoiseLite]::FastFloor($Y)
        [Int64]$K   = [FastNoiseLite]::FastFloor($Z)
        [Single]$Xi = ([Single]($X - $I))
        [Single]$Yi = ([Single]($Y - $J))
        [Single]$Zi = ([Single]($Z - $K))

        $I *= [FastNoiseLite]::PRIMEX
        $J *= [FastNoiseLite]::PRIMEY
        $K *= [FastNoiseLite]::PRIMEZ

        [Int64]$Seed2  = $ASeed + [FastNoiseLite]::SEEDADD_MAGIC
        [Int64]$XNMask = ([Int64](0.5 - $Xi))
        [Int64]$YNMask = ([Int64](0.5 - $Yi))
        [Int64]$ZNMask = ([Int64](0.5 - $Zi))
        [Single]$X0    = $Xi + $XNMask
        [Single]$Y0    = $Yi + $YNMask
        [Single]$Z0    = $Zi + $ZNMask
        [Single]$A0    = 0.75 - $X0 * $X0 - $Y0 * $Y0 - $Z0 * $Z0
        [Single]$Value = $A0 * $A0 * $A0 * $A0 * [FastNoiseLite]::GradCoord(
            $ASeed,
            $I + ($XNMask -BAND [FastNoiseLite]::PRIMEX),
            $J + ($YNMask -BAND [FastNoiseLite]::PRIMEY),
            $K + ($ZNMask -BAND [FastNoiseLite]::PRIMEZ),
            $X0, $Y0, $Z0
        )

        [Single]$X1   = $Xi - 0.5
        [Single]$Y1   = $Yi - 0.5
        [Single]$Z1   = $Zi - 0.5
        [Single]$A1   = 0.75 - $X1 * $X1 - $Y1 * $Y1 - $Z1 * $Z1
        $Value       += $A1 * $A1 * $A1 * $A1 * [FastNoiseLite]::GradCoord(
            $Seed2,
            $I + [FastNoiseLite]::PRIMEX,
            $J + [FastNoiseLite]::PRIMEY,
            $K + [FastNoiseLite]::PRIMEZ,
            $X1, $Y1, $Z1
        )

        [Single]$XAFlipMask0 = (($XNMask -BOR 1) -SHL 1) * $X1
        [Single]$YAFlipMask0 = (($YNMask -BOR 1) -SHL 1) * $Y1
        [Single]$ZAFlipMask0 = (($ZNMask -BOR 1) -SHL 1) * $Z1
        [Single]$XAFlipMask1 = (-2 - ($XNMask -SHL 2)) * $X1 - 1
        [Single]$YAFlipMask1 = (-2 - ($YNMask -SHL 2)) * $Y1 - 1
        [Single]$ZAFlipMask1 = (-2 - ($ZNMask -SHL 2)) * $Z1 - 1
        [Boolean]$Skip5      = $false
        [Single]$A2          = $XAFlipMask0 + $A0

        If($A2 -GT 0) {
            [Single]$X2 = $X0 - ($XNMask -BOR 1)
            [Single]$Y2 = $Y0
            [Single]$Z2 = $Z0

            $Value += $A2 * $A2 * $A2 * $A2 * [FastNoiseLite]::GradCoord(
                $ASeed,
                $I + (-BNOT $XNMask -BAND [FastNoiseLite]::PRIMEX),
                $J + ($YNMask -BAND [FastNoiseLite]::PRIMEY),
                $K + ($ZNMask -BAND [FastNoiseLite]::PRIMEZ),
                $X2, $Y2, $Z2
            )
        } Else {
            [Single]$A3  = $YAFlipMask0 + $ZAFlipMask0 + $A0

            If($A3 -GT 0) {
                [Single]$X3 = $X0
                [Single]$Y3 = $Y0 - ($YNMask -BOR 1)
                [Single]$Z3 = $Z0 - ($ZNMask -BOR 1)

                $Value += $A3 * $A3 * $A3 * $A3 * [FastNoiseLite]::GradCoord(
                    $ASeed,
                    $I + ($XNMask -BAND [FastNoiseLite]::PRIMEX),
                    $J + (-BNOT $YNMask -BAND [FastNoiseLite]::PRIMEY),
                    $K + (-BNOT $ZNMask -BAND [FastNoiseLite]::PRIMEZ),
                    $X3, $Y3, $Z3
                )
            }

            [Single]$A4  = $XAFlipMask1 + $A1

            If($A4 -GT 0) {
                [Single]$X4 = ($XNMask -BOR 1) + $X1
                [Single]$Y4 = $Y1
                [Single]$Z4 = $Z1

                $Value += $A4 * $A4 * $A4 * $A4 * [FastNoiseLite]::GradCoord(
                    $Seed2,
                    $I + ($XNMask -BAND [FastNoiseLite]::APRIMEXMULT2),
                    $J + [FastNoiseLite]::PRIMEY,
                    $K + [FastNoiseLite]::PRIMEZ,
                    $X4, $Y4, $Z4
                )
                $Skip5 = $true
            }
        }

        [Boolean]$Skip9 = $false
        [Single]$A6     = $YAFlipMask0 + $A0

        If($A6 -GT 0) {
            [Single]$X6 = $X0
            [Single]$Y6 = $Y0 - ($YNMask -BOR 1)
            [Single]$Z6 = $Z0

            $Value += $A6 * $A6 * $A6 * $A6 * [FastNoiseLite]::GradCoord(
                $ASeed,
                $I + ($XNMask -BAND [FastNoiseLite]::PRIMEX),
                $J + (-BNOT $YNMask -BAND [FastNoiseLite]::PRIMEY),
                $K + ($ZNMask -BAND [FastNoiseLite]::PRIMEZ),
                $X6, $Y6, $Z6
            )
        } Else {
            [Single]$A7  = $XAFlipMask0 + $ZAFlipMask0 + $A0

            If($A7 -GT 0) {
                [Single]$X7 = $X0 - ($XNMask -BOR 1)
                [Single]$Y7 = $Y0
                [Single]$Z7 = $Z0 - ($ZNMask -BOR 1)

                $Value += $A7 * $A7 * $A7 * $A7 * [FastNoiseLite]::GradCoord(
                    $ASeed,
                    $I + (-BNOT $XNMask -BAND [FastNoiseLite]::PRIMEX),
                    $J + ($YNMask -BAND [FastNoiseLite]::PRIMEY),
                    $K + (-BNOT $ZNMask -BAND [FastNoiseLite]::PRIMEZ),
                    $X7, $Y7, $Z7
                )
            }

            [Single]$A8  = $YAFlipMask1 + $A1

            If($A8 -GT 0) {
                [Single]$X8 = $X1
                [Single]$Y8 = ($YNMask -BOR 1) + $Y1
                [Single]$Z8 = $Z1

                $Value += $A8 * $A8 * $A8 * $A8 * [FastNoiseLite]::GradCoord(
                    $Seed2,
                    $I + [FastNoiseLite]::PRIMEX,
                    $J + ($YNMask -BAND ([FastNoiseLite]::PRIMEY -SHL 1)),
                    $K + [FastNoiseLite]::PRIMEZ,
                    $X8, $Y8, $Z8
                )
                $Skip9 = $true
            }
        }

        [Boolean]$SkipD = $false
        [Single]$Aa     = $ZAFlipMask0 + $A0

        If($Aa -GT 0) {
            [Single]$Xa = $X0
            [Single]$Ya = $Y0
            [Single]$Za = $Z0 - ($ZNMask -BOR 1)

            $Value += $Aa * $Aa * $Aa * $Aa * [FastNoiseLite]::GradCoord(
                $ASeed,
                $I + ($XNMask -BAND [FastNoiseLite]::PRIMEX),
                $J + ($YNMask -BAND [FastNoiseLite]::PRIMEY),
                $K + (-BNOT $ZNMask -BAND [FastNoiseLite]::PRIMEZ),
                $Xa, $Ya, $Za
            )
        } Else {
            [Single]$Ab  = $XAFlipMask0 + $YAFlipMask0 + $A0

            If($Ab -GT 0) {
                [Single]$Xb = $X0 - ($XNMask -BOR 1)
                [Single]$Yb = $Y0 - ($YNMask -BOR 1)
                [Single]$Zb = $Z0

                $Value += $Ab * $Ab * $Ab * $Ab * [FastNoiseLite]::GradCoord(
                    $ASeed,
                    $I + (-BNOT $XNMask -BAND [FastNoiseLite]::PRIMEX),
                    $J + (-BNOT $YNMask -BAND [FastNoiseLite]::PRIMEY),
                    $K + ($ZNMask -BAND [FastNoiseLite]::PRIMEZ),
                    $Xb, $Yb, $Zb
                )
            }

            [Single]$Ac  = $ZAFlipMask1 + $A1

            If($Ac -GT 0) {
                [Single]$Xc = $X1
                [Single]$Yc = $Y1
                [Single]$Zc = ($ZNMask -BOR 1) + $Z1

                $Value += $Ac * $Ac * $Ac * $Ac * [FastNoiseLite]::GradCoord(
                    $Seed2,
                    $I + [FastNoiseLite]::PRIMEX,
                    $J + [FastNoiseLite]::PRIMEY,
                    $K + ($ZNMask -BAND ([FastNoiseLite]::PRIMEZ -SHL 1)),
                    $Xc, $Yc, $Zc
                )
                $SkipD = $true
            }
        }

        If(-NOT $Skip5) {
            [Single]$A5  = $YAFlipMask1 + $ZAFlipMask1 + $A1

            If($A5 -GT 0) {
                [Single]$X5 = $X1
                [Single]$Y5 = ($YNMask -BOR 1) + $Y1
                [Single]$Z5 = ($ZNMask -BOR 1) + $Z1

                $Value += $A5 * $A5 * $A5 * $A5 * [FastNoiseLite]::GradCoord(
                    $Seed2,
                    $I + [FastNoiseLite]::PRIMEX,
                    $J + ($YNMask -BAND ([FastNoiseLite]::PRIMEY -SHL 1)),
                    $K + ($ZNMask -BAND ([FastNoiseLite]::PRIMEZ -SHL 1)),
                    $X5, $Y5, $Z5
                )
            }
        }

        If(-NOT $Skip9) {
            [Single]$A9  = $XAFlipMask1 + $ZAFlipMask1 + $A1

            If($A9 -GT 0) {
                [Single]$X9 = ($XNMask -BOR 1) + $X1
                [Single]$Y9 = $Y1
                [Single]$Z9 = ($ZNMask -BOR 1) + $Z1

                $Value += $A9 * $A9 * $A9 * $A9 * [FastNoiseLite]::GradCoord(
                    $Seed2,
                    $I + ($XNMask -BAND [FastNoiseLite]::APRIMEXMULT2),
                    $J + [FastNoiseLite]::PRIMEY,
                    $K + ($ZNMask -BAND ([FastNoiseLite]::PRIMEZ -SHL 1)),
                    $X9, $Y9, $Z9
                )
            }
        }

        If(-NOT $SkipD) {
            [Single]$Ad  = $XAFlipMask1 + $YAFlipMask1 + $A1

            If($Ad -GT 0) {
                [Single]$Xd = ($XNMask -BOR 1) + $X1
                [Single]$Yd = ($YNMask -BOR 1) + $Y1
                [Single]$Zd = $Z1

                $Value += $Ad * $Ad * $Ad * $Ad * [FastNoiseLite]::GradCoord(
                    $Seed2,
                    $I + ($XNMask -BAND ([FastNoiseLite]::PRIMEX -SHL 1)),
                    $J + ($YNMask -BAND ([FastNoiseLite]::PRIMEY -SHL 1)),
                    $K + [FastNoiseLite]::PRIMEZ,
                    $Xd, $Yd, $Zd
                )
            }
        }

        Return $Value * 9.046026385208288
    }

    [Single]SingleCellular(
        [Int64]$ASeed,
        [Single]$X,
        [Single]$Y
    ) {
        [Int64]$Xr              = [FastNoiseLite]::FastRound($X)
        [Int64]$Yr              = [FastNoiseLite]::FastRound($Y)
        [Int64]$ClosestHash     = 0
        [Int64]$XPrimed         = ($Xr - 1) * [FastNoiseLite]::PRIMEX
        [Int64]$YPrimedBase     = ($Yr - 1) * [FastNoiseLite]::PRIMEY
        [Single]$Distance0      = [Single]::MaxValue
        [Single]$Distance1      = [Single]::MaxValue
        [Single]$CellularJitter = 0.43701595 * $this.CellularJitterModifier

        Switch($this.CellularDistanceFunction) {
            { $_ -EQ [FnlCellularDistanceFunction]::Euclidean -OR $_ -EQ [FnlCellularDistanceFunction]::EuclideanSq } {
                For([Int64]$Xi = $Xr - 1; $Xi -LE $Xr + 1; $Xi++) {
                    [Int64]$YPrimed = $YPrimedBase

                    For([Int64]$Yi = $Yr - 1; $Yi -LE $Yr - 1; $Yi++) {
                        [Int64]$AHash        = [FastNoiseLite]::Hash($ASeed, $XPrimed, $YPrimed)
                        [Int64]$Idx          = $AHash -BAND (255 -SHL 1)
                        [Single]$VecX        = ([Single]($Xi - $X) + [FastNoiseLite]::RANDVECS2D[$Idx] * $CellularJitter)
                        [Single]$VecY        = ([Single]($Yi - $Y) + [FastNoiseLite]::RANDVECS2D[$Idx -BOR 1] * $CellularJitter)
                        [Single]$NewDistance = $VecX * $VecX + $VecY * $VecY

                        $Distance1 = [FastNoiseLite]::FastMax([FastNoiseLite]::FastMin($Distance1, $NewDistance), $Distance0)
                        If($NewDistance -LT $Distance0) {
                            $Distance0   = $NewDistance
                            $ClosestHash = $AHash
                        }

                        $YPrimed += [FastNoiseLite]::PRIMEY
                    }

                    $XPrimed += [FastNoiseLite]::PRIMEX
                }

                Break
            }

            ([FnlCellularDistanceFunction]::Manhattan) {
                For([Int64]$Xi = $Xr - 1; $Xi -LE $Xr + 1; $Xi++) {
                    [Int64]$YPrimed = $YPrimedBase

                    For([Int64]$Yi = $Yr - 1; $Yi -LE $Yr + 1; $Yi++) {
                        [Int64]$AHash        = [FastNoiseLite]::Hash($ASeed, $XPrimed, $YPrimed)
                        [Int64]$Idx          = $AHash -BAND (255 -SHL 1)
                        [Single]$VecX        = ([Single]($Xi - $X) + [FastNoiseLite]::RANDVECS2D[$Idx] * $CellularJitter)
                        [Single]$VecY        = ([Single]($Yi - $Y) + [FastNoiseLite]::RANDVECS2D[$Idx -BOR 1] * $CellularJitter)
                        [Single]$NewDistance = [FastNoiseLite]::FastAbs($VecX) + [FastNoiseLite]::FastAbs($VecY)

                        $Distance1 = [FastNoiseLite]::FastMax([FastNoiseLite]::FastMin($Distance1, $NewDistance), $Distance0)
                        If($NewDistance -LT $Distance0) {
                            $Distance0   = $NewDistance
                            $ClosestHash = $AHash
                        }

                        $YPrimed += [FastNoiseLite]::PRIMEY
                    }

                    $XPrimed += [FastNoiseLite]::PRIMEX
                }

                Break
            }

            ([FnlCellularDistanceFunction]::Hybrid) {
                For([Int64]$Xi = $Xr - 1; $Xi -LE $Xr + 1; $Xi++) {
                    [Int64]$YPrimed = $YPrimedBase

                    For([Int64]$Yi = $Yr - 1; $Yi -LE $Yr + 1; $Yi++) {
                        [Int64]$AHash        = [FastNoiseLite]::Hash($ASeed, $XPrimed, $YPrimed)
                        [Int64]$Idx          = $AHash -BAND (255 -SHL 1)
                        [Single]$VecX        = ([Single]($Xi - $X) + [FastNoiseLite]::RANDVECS2D[$Idx] * $CellularJitter)
                        [Single]$VecY        = ([Single]($Yi - $Y) + [FastNoiseLite]::RANDVECS2D[$Idx -BOR 1] * $CellularJitter)
                        [Single]$NewDistance = ([FastNoiseLite]::FastAbs($VecX) + [FastNoiseLite]::FastAbs($VecY)) + ($VecX * $VecX + $VecY * $VecY)

                        $Distance1 = [FastNoiseLite]::FastMax([FastNoiseLite]::FastMin($Distance0))
                        If($NewDIstance -LT $Distance0) {
                            $Distance0   = $NewDistance
                            $ClosestHash = $AHash
                        }

                        $YPrimed += [FastNoiseLite]::PRIMEY
                    }

                    $XPrimed += [FastNoiseLite]::PRIMEX
                }

                Break
            }

            Default { # SAME AS FIRST CASE
                For([Int64]$Xi = $Xr - 1; $Xi -LE $Xr + 1; $Xi++) {
                    [Int64]$YPrimed = $YPrimedBase

                    For([Int64]$Yi = $Yr - 1; $Yi -LE $Yr - 1; $Yi++) {
                        [Int64]$AHash        = [FastNoiseLite]::Hash($ASeed, $XPrimed, $YPrimed)
                        [Int64]$Idx          = $AHash -BAND (255 -SHL 1)
                        [Single]$VecX        = ([Single]($Xi - $X) + [FastNoiseLite]::RANDVECS2D[$Idx] * $CellularJitter)
                        [Single]$VecY        = ([Single]($Yi - $Y) + [FastNoiseLite]::RANDVECS2D[$Idx -BOR 1] * $CellularJitter)
                        [Single]$NewDistance = $VecX * $VecX + $VecY * $VecY

                        $Distance1 = [FastNoiseLite]::FastMax([FastNoiseLite]::FastMin($Distance1, $NewDistance), $Distance0)
                        If($NewDistance -LT $Distance0) {
                            $Distance0   = $NewDistance
                            $ClosestHash = $AHash
                        }

                        $YPrimed += [FastNoiseLite]::PRIMEY
                    }

                    $XPrimed += [FastNoiseLite]::PRIMEX
                }

                Break
            }
        }

        If($this.CellularDistanceFunction -EQ [FnlCellularDistanceFunction]::Euclidean -AND $this.CellularReturnType -GE [FnlCellularReturnType]::Distance) {
            $Distance0 = [FastNoiseLite]::FastSqrt($Distance0)

            If($this.CellularReturnType -GE [FnlCellularReturnType]::Distance2) {
                $Distance1 = [FastNoiseLite]::FastSqrt($Distance1)
            }
        }

        Switch($this.CellularReturnType) {
            ([FnlCellularReturnType]::CellValue) {
                Return $ClosestHash * (1 / [FastNoiseLite]::HASHCALC_MAGIC)
            }

            ([FnlCellularReturnType]::Distance) {
                Return $Distance0 - 1
            }

            ([FnlCellularReturnType]::Distance2) {
                Return $Distance1 - 1
            }

            ([FnlCellularReturnType]::Distance2Add) {
                Return ($Distance1 + $Distance0) * 0.5 - 1
            }

            ([FnlCellularReturnType]::Distance2Sub) {
                Return $Distance1 - $Distance0 - 1
            }

            ([FnlCellularReturnType]::Distance2Mul) {
                Return $Distance1 * $Distance0 * 0.5 - 1
            }

            ([FnlCellularReturnType]::Distance2Div) {
                Return $Distance0 / $Distance1 - 1
            }

            Default {
                Return 0
            }
        }

        Return 0
    }

    [Single]SingleCellular(
        [Int64]$ASeed,
        [Single]$X,
        [Single]$Y,
        [Single]$Z
    ) {
        [Int64]$Xr              = [FastNoiseLite]::FastRound($X)
        [Int64]$Yr              = [FastNoiseLite]::FastRound($Y)
        [Int64]$Zr              = [FastNoiseLite]::FastRound($Z)
        [Int64]$ClosestHash     = 0
        [Single]$Distance0      = [Single]::MaxValue
        [Single]$Distance1      = [Single]::MaxValue
        [Single]$CellularJitter = 0.39614353 * $this.CellularJitterModifier
        [Int64]$XPrimed         = ($Xr - 1) * [FastNoiseLite]::PRIMEX
        [Int64]$YPrimedBase     = ($Yr - 1) * [FastNoiseLite]::PRIMEY
        [Int64]$ZPrimedBase     = ($Zr - 1) * [FastNoiseLite]::PRIMEZ

        Switch($this.CellularDistanceFunction) {
            { $_ -EQ [FnlCellularDistanceFunction]::Euclidean -OR $_ -EQ [FnlCellularDistanceFunction]::EuclideanSq } {
                For([Int64]$Xi = $Xr - 1; $Xi -LE $Xr; $Xi++) {
                    [Int64]$YPrimed = $YPrimedBase

                    For([Int64]$Yi = $Yr - 1; $Yi -LE $Yr; $Yi++) {
                        [Int64]$ZPrimed = $ZPrimedBase

                        For([Int64]$Zi = $Zr - 1; $Zi -LE $Zr; $Zi++) {
                            [Int64]$AHash        = [FastNoiseLite]::Hash($ASeed, $XPrimed, $YPrimed, $ZPrimed)
                            [Int64]$Idx          = $AHash -BAND (255 -SHL 2)
                            [Single]$VecX        = ([Single]($Xi - $X) + [FastNoiseLite]::RANDVECS3D[$Idx] * $CellularJitter)
                            [Single]$VecY        = ([Single]($Yi - $Y) + [FastNoiseLite]::RANDVECS3D[$Idx -BOR 1] * $CellularJitter)
                            [Single]$VecZ        = ([Single]($Zi - $Z) + [FastNoiseLite]::RANDVECS3D[$Idx -BOR 2] * $CellularJitter)
                            [Single]$NewDistance = $VecX * $VecX + $VecY * $VecY + $VecZ * $VecZ

                            $Distance1 = [FastNoiseLite]::FastMax([FastNoiseLite]::FastMin($Distance1, $NewDistance), $Distance0)
                            If($NewDistance -LT $Distance0) {
                                $Distance0   = $NewDistance
                                $ClosestHash = $AHash
                            }

                            $ZPrimed += [FastNoiseLite]::PRIMEZ
                        }

                        $YPrimed += [FastNoiseLite]::PRIMEY
                    }

                    $XPrimed += [FastNoiseLite]::PRIMEX
                }

                Break
            }

            ([FnlCellularDistanceFunction]::Manhattan) {
                For([Int64]$Xi = $Xr - 1; $Xi -LE $Xr; $Xi++) {
                    [Int64]$YPrimed = $YPrimedBase

                    For([Int64]$Yi = $Yr - 1; $Yi -LE $Yr; $Yi++) {
                        [Int64]$ZPrimed = $ZPrimedBase

                        For([Int64]$Zi = $Zr - 1; $Zi -LE $Zr + 1; $Zi++) {
                            [Int64]$AHash        = [FastNoiseLite]::Hash($ASeed, $XPrimed, $YPrimed, $ZPrimed)
                            [Int64]$Idx          = $AHash -BAND (255 -SHL 2)
                            [Single]$VecX        = ([Single]($Xi - $X) + [FastNoiseLite]::RANDVECS3D[$Idx] * $CellularJitter)
                            [Single]$VecY        = ([Single]($Yi - $Y) + [FastNoiseLite]::RANDVECS3D[$Idx -BOR 1] * $CellularJitter)
                            [Single]$VecZ        = ([Single]($Zi - $Z) + [FastNoiseLite]::RANDVECS3D[$Idx -BOR 2] * $CellularJitter)
                            [Single]$NewDistance = [FastNoiseLite]::FastAbs($VecX) + [FastNoiseLite]::FastAbs($VecY) + [FastNoiseLite]::FastAbs($VecZ)

                            $Distance1 = [FastNoiseLite]::FastMax([FastNoiseLite]::FastMin($Distance1, $NewDistance), $Distance0)
                            If($NewDistance -LT $Distance0) {
                                $Distance0   = $NewDistance
                                $ClosestHash = $AHash
                            }

                            $ZPrimed += [FastNoiseLite]::PRIMEZ
                        }

                        $YPrimed += [FastNoiseLite]::PRIMEY
                    }

                    $XPrimed += [FastNoiseLite]::PRIMEX
                }

                Break
            }

            ([FnlCellularDistanceFunction]::Hybrid) {
                For([Int64]$Xi = $Xr - 1; $Xi -LE $Xr + 1; $Xi++) {
                    [Int64]$YPrimed = $YPrimedBase

                    For([Int64]$Yi = $Yr - 1; $Yi -LE $Yr + 1; $Yi++) {
                        [Int64]$ZPrimed = $ZPrimedBase

                        For([Int64]$Zi = $Zr - 1; $Zi -LE $Zr + 1; $Zi++) {
                            [Int64]$AHash        = [FastNoiseLite]::Hash($ASeed, $XPrimed, $YPrimed, $ZPrimed)
                            [Int64]$Idx          = $AHash -BAND (255 -SHL 2)
                            [Single]$VecX        = ([Single]($Xi - $X) + [FastNoiseLite]::RANDVECS3D[$Idx] * $CellularJitter)
                            [Single]$VecY        = ([Single]($Yi - $Y) + [FastNoiseLite]::RANDVECS3D[$Idx -BOR 1] * $CellularJitter)
                            [Single]$VecZ        = ([Single]($Zi - $Z) + [FastNoiseLite]::RANDVECS3D[$Idx -BOR 2] * $CellularJitter)
                            [Single]$NewDistance = (
                                [FastNoiseLite]::FastAbs($VecX) +
                                [FastNoiseLite]::FastAbs($VecY) +
                                [FastNoiseLite]::FastAbs($VecZ)
                            ) + (
                                $VecX * $VecX +
                                $VecY * $VecY +
                                $VecZ * $VecZ
                            )

                            $Distance1 = [FastNoiseLite]::FastMax([FastNoiseLite]::FastMin($Distance1, $NewDistance), $Distance0)
                            If($NewDistance -LT $Distance0) {
                                $Distance0   = $NewDistance
                                $ClosestHash = $AHash
                            }

                            $Zprimed += [FastNoiseLite]::PRIMEZ
                        }

                        $YPrimed += [FastNoiseLite]::PRIMEY
                    }

                    $XPrimed += [FastNoiseLite]::PRIMEX
                }

                Break
            }

            Default {
                Break
            }
        }

        If($this.CellularDistanceFunction -EQ [FnlCellularDistanceFunction]::Euclidean -AND $this.CellularReturnType -GE [FnlCellularReturnType]::Distance) {
            $Distance0 = [FastNoiseLite]::FastSqrt($Distance0)

            If($this.CellularReturnType -GE [FnlCellularReturnType].Distance2) {
                $Distance1 = [FastNoiseLite]::FastSqrt($Distance1)
            }
        }

        Switch($this.CellularReturnType) {
            ([FnlCellularReturnType]::CellValue) {
                Return $ClosestHash * (1 / [FastNoiseLite]::HASHCALC_MAGIC)
            }

            ([FnlCellularReturnType]::Distance) {
                Return $Distance0 - 1
            }

            ([FnlCellularReturnType]::Distance2) {
                Return $Distance1 - 1
            }

            ([FnlCellularReturnType]::Distance2Add) {
                Return ($Distance1 + $Distance0) * 0.5 - 1
            }

            ([FnlCellularReturnType]::Distance2Sub) {
                Return $Distance1 - $Distance0 - 1
            }

            ([FnlCellularReturnType]::Distance2Mul) {
                Return $Distance1 * $Distance0 * 0.5 - 1
            }

            ([FnlCellularReturnType]::Distance2Div) {
                Return $Distance0 / $Distance1 - 1
            }

            Default {
                Return 0
            }
        }

        Return 0
    }

    [Single]SinglePerlin(
        [Int64]$ASeed,
        [Single]$X,
        [Single]$Y
    ) {
        [Int64]$X0   = [FastNoiseLite]::FastFloor($X)
        [Int64]$Y0   = [FastNoiseLite]::FastFloor($Y)
        [Single]$Xd0 = ([Single]($X - $X0))
        [Single]$Yd0 = ([Single]($Y - $Y0))
        [Single]$Xd1 = $Xd0 - 1
        [Single]$Yd1 = $Yd0 - 1
        [Single]$Xs  = [FastNoiseLite]::InterpQuintic($Xd0)
        [Single]$Ys  = [FastNoiseLite]::InterpQuintic($Yd0)

        $X0 *= [FastNoiseLite]::PRIMEX
        $Y0 *= [FastNoiseLite]::PRIMEY

        [Int64]$X1 = $X0 + [FastNoiseLite]::PRIMEX
        [Int64]$Y1 = $Y0 + [FastNoiseLite]::PRIMEY

        [Single]$Xf0 = [FastNoiseLite]::Lerp(
            [FastNoiseLite]::GradCoord($ASeed, $X0, $Y0, $Xd0, $Yd0),
            [FastNoiseLite]::GradCoord($ASeed, $X1, $Y0, $Xd1, $Yd0),
            $Xs
        )
        [Single]$Xf1 = [FastNoiseLite]::Lerp(
            [FastNoiseLite]::GradCoord($ASeed, $X0, $Y1, $Xd0, $Yd1),
            [FastNoiseLite]::GradCoord($ASeed, $X1, $Y1, $Xd1, $Yd1),
            $Xs
        )

        Return [FastNoiseLite]::Lerp($Xf0, $Xf1, $Ys) * 1.4247691104677813
    }

    [Single]SinglePerlin(
        [Int64]$ASeed,
        [Single]$X,
        [Single]$Y,
        [Single]$Z
    ) {
        [Int64]$X0   = [FastNoiseLite]::FastFloor($X)
        [Int64]$Y0   = [FastNoiseLite]::FastFloor($Y)
        [Int64]$Z0   = [FastNoiseLite]::FastFloor($Z)
        [Single]$Xd0 = ([Single]($X - $X0))
        [Single]$Yd0 = ([Single]($Y - $Y0))
        [Single]$Zd0 = ([Single]($Z - $Z0))
        [Single]$Xd1 = $Xd0 - 1
        [Single]$Yd1 = $Yd0 - 1
        [Single]$Zd1 = $Zd0 - 1
        [Single]$Xs  = [FastNoiseLite]::InterpQuintic($Xd0)
        [Single]$Ys  = [FastNoiseLite]::InterpQuintic($Yd0)
        [Single]$Zs  = [FastNoiseLite]::InterpQuintic($Zd0)

        $X0 *= [FastNoiseLite]::PRIMEX
        $Y0 *= [FastNoiseLite]::PRIMEY
        $Z0 *= [FastNoiseLite]::PRIMEZ

        [Int64]$X1 = $X0 + [FastNoiseLite]::PRIMEX
        [Int64]$Y1 = $Y0 + [FastNoiseLite]::PRIMEY
        [Int64]$Z1 = $Z0 + [FastNoiseLite]::PRIMEZ

        [Single]$Xf00 = [FastNoiseLite]::Lerp(
            [FastNoiseLite]::GradCoord(
                $ASeed,
                $X0, $Y0, $Z0,
                $Xd0, $Yd0, $Zd0
            ),
            [FastNoiseLite]::GradCoord(
                $ASeed,
                $X1, $Y0, $Z0,
                $Xd1, $Yd0, $Zd0
            ),
            $Xs
        )
        [Single]$Xf10 = [FastNoiseLite]::Lerp(
            [FastNoiseLite]::GradCoord(
                $ASeed,
                $X0, $Y1, $Z0,
                $Xd0, $Yd1, $Zd0
            ),
            [FastNoiseLite]::GradCoord(
                $ASeed,
                $X1, $Y1, $Z0,
                $Xd1, $Yd1, $Zd0
            ),
            $Xs
        )
        [Single]$Xf01 = [FastNoiseLite]::Lerp(
            [FastNoiseLite]::GradCoord(
                $ASeed,
                $X0, $Y0, $Z1,
                $Xd0, $Yd0, $Zd1
            ),
            [FastNoiseLite]::GradCoord(
                $ASeed,
                $X1, $Y0, $Z1,
                $Xd1, $Yd0, $Zd1
            ),
            $Xs
        )
        [Single]$Xf11 = [FastNoiseLite]::Lerp(
            [FastNoiseLite]::GradCoord(
                $ASeed,
                $X0, $Y1, $Z1,
                $Xd0, $Yd1, $Zd1
            ),
            [FastNoiseLite]::GradCoord(
                $ASeed,
                $X1, $Y1, $Z1,
                $Xd1, $Yd1, $Zd1
            ),
            $Xs
        )

        [Single]$Yf0 = [FastNoiseLite]::Lerp($Xf00, $Xf10, $Ys)
        [Single]$Yf1 = [FastNoiseLite]::Lerp($Xf01, $Xf11, $Ys)

        Return [FastNoiseLite]::Lerp($Yf0, $Yf1, $Zs) * 0.964921414852142333984375
    }

    [Single]SingleValueCubic(
        [Int64]$ASeed,
        [Single]$X,
        [Single]$Y
    ) {
        [Int64]$X1  = [FastNoiseLite]::FastFloor($X)
        [Int64]$Y1  = [FastNoiseLite]::FastFloor($Y)
        [Single]$Xs = ([Single]($X - $X1))
        [Single]$Ys = ([Single]($Y - $Y1))

        $X1 *= [FastNoiseLite]::PRIMEX
        $Y1 *= [FastNoiseLite]::PRIMEY

        [Int64]$X0 = $X1 - [FastNoiseLite]::PRIMEX
        [Int64]$Y0 = $Y1 - [FastNoiseLite]::PRIMEY
        [Int64]$X2 = $X1 + [FastNoiseLite]::PRIMEX
        [Int64]$Y2 = $Y1 + [FastNoiseLite]::PRIMEY
        
        # THE FOLLOWING TWO STATEMENTS ORIGINALLY USED UNCHECKED STATEMENTS IN THE ARITHMETIC.
        # POWERSHELL DOESN'T REALLY OFFER THIS, SO A FIXED CEILING COMPENSATING CONTROL IS
        # USED (WHICH WOULD LIKELY BE THE SAME RESULT IN C# GIVEN THE BEHAVIOR OF THE UNCHECKED OPERATION,
        # SAVE THE LACK OF A THROWN EXCEPTION).
        #
        # ANOTHER SANITY CHECK HERE IS TO USE INT64 RATHER THAN INT. INT MASKS TO INT32, AND AN OVERFLOW WILL THROW
        # AN EXCEPTION IN POWERSHELL (SYSTEM.OVERFLOWEXCEPTION).
        [Int64]$X3 = $X1 + (([FastNoiseLite]::APRIMEXMULT2 -GT [Int64]::MaxValue) ? [Int64]::MaxValue : [FastNoiseLite]::APRIMEXMULT2)
        [Int64]$Y3 = $Y1 + (([FastNoiseLite]::APRIMEYMULT2 -GT [Int64]::MaxValue) ? [Int64]::MaxValue : [FastNoiseLite]::APRIMEYMULT2)

        Return [FastNoiseLite]::CubicLerp(
            [FastNoiseLite]::CubicLerp(
                [FastNoiseLite]::ValCoord($ASeed, $X0, $Y0),
                [FastNoiseLite]::ValCoord($ASeed, $X1, $Y0),
                [FastNoiseLite]::ValCoord($ASeed, $X2, $Y0),
                [FastNoiseLite]::ValCoord($ASeed, $X3, $Y0),
                $Xs
            ),
            [FastNoiseLite]::CubicLerp(
                [FastNoiseLite]::ValCoord($ASeed, $X0, $Y1),
                [FastNoiseLite]::ValCoord($ASeed, $X1, $Y1),
                [FastNoiseLite]::ValCoord($ASeed, $X2, $Y1),
                [FastNoiseLite]::ValCoord($ASeed, $X3, $Y1),
                $Xs
            ),
            [FastNoiseLite]::CubicLerp(
                [FastNoiseLite]::ValCoord($ASeed, $X0, $Y2),
                [FastNoiseLite]::ValCoord($ASeed, $X1, $Y2),
                [FastNoiseLite]::ValCoord($ASeed, $X2, $Y2),
                [FastNoiseLite]::ValCoord($ASeed, $X3, $Y2),
                $Xs
            ),
            [FastNoiseLite]::CubicLerp(
                [FastNoiseLite]::ValCoord($ASeed, $X0, $Y3),
                [FastNoiseLite]::ValCoord($ASeed, $X1, $Y3),
                [FastNoiseLite]::ValCoord($ASeed, $X2, $Y3),
                [FastNoiseLite]::ValCoord($ASeed, $X3, $Y3),
                $Xs
            ),
            $Ys
        ) * (1 / (1.5 * 1.5))
    }

    [Single]SingleValueCubic(
        [Int64]$ASeed,
        [Single]$X,
        [Single]$Y,
        [Single]$Z
    ) {
        [Int64]$X1  = [FastNoiseLite]::FastFloor($X)
        [Int64]$Y1  = [FastNoiseLite]::FastFloor($Y)
        [Int64]$Z1  = [FastNoiseLite]::FastFloor($Z)
        [Single]$Xs = ([Single]($X - $X1))
        [Single]$Ys = ([Single]($Y - $Y1))
        [Single]$Zs = ([Single]($Z - $Z1))

        $X1 *= [FastNoiseLite]::PRIMEX
        $Y1 *= [FastNoiseLite]::PRIMEY
        $Z1 *= [FastNoiseLite]::PRIMEZ

        [Int64]$X0 = $X1 - [FastNoiseLite]::PRIMEX
        [Int64]$Y0 = $Y1 - [FastNoiseLite]::PRIMEY
        [Int64]$Z0 = $Z1 - [FastNoiseLite]::PRIMEZ
        [Int64]$X2 = $X1 + [FastNoiseLite]::PRIMEX
        [Int64]$Y2 = $Y1 + [FastNoiseLite]::PRIMEY
        [Int64]$Z2 = $Z1 + [FastNoiseLite]::PRIMEZ

        # THE FOLLOWING THREE STATEMENTS ORIGINALLY USED UNCHECKED STATEMENTS IN THE ARITHMETIC.
        # POWERSHELL DOESN'T REALLY OFFER THIS, SO A FIXED CEILING COMPENSATING CONTROL IS
        # USED (WHICH WOULD LIKELY BE THE SAME RESULT IN C# GIVEN THE BEHAVIOR OF THE UNCHECKED OPERATION,
        # SAVE THE LACK OF A THROWN EXCEPTION).
        #
        # ANOTHER SANITY CHECK HERE IS TO USE INT64 RATHER THAN INT. INT MASKS TO INT32, AND AN OVERFLOW WILL THROW
        # AN EXCEPTION IN POWERSHELL (SYSTEM.OVERFLOWEXCEPTION).
        [Int64]$X3 = $X1 + (([FastNoiseLite]::APRIMEXMULT2 -GT [Int64]::MaxValue) ? [Int64]::MaxValue : [FastNoiseLite]::APRIMEXMULT2)
        [Int64]$Y3 = $Y1 + (([FastNoiseLite]::APRIMEYMULT2 -GT [Int64]::MaxValue) ? [Int64]::MaxValue : [FastNoiseLite]::APRIMEYMULT2)
        [Int64]$Z3 = $Z1 + (([FastNoiseLite]::APRIMEZMULT2 -GT [Int64]::MaxValue) ? [Int64]::MaxValue : [FastNoiseLite]::APRIMEZMULT2)

        Return [FastNoiseLite]::CubicLerp(
            [FastNoiseLite]::CubicLerp(
                [FastNoiseLite]::CubicLerp(
                    [FastNoiseLite]::ValCoord($ASeed, $X0, $Y0, $Z0),
                    [FastNoiseLite]::ValCoord($ASeed, $X1, $Y0, $Z0),
                    [FastNoiseLite]::ValCoord($ASeed, $X2, $Y0, $Z0),
                    [FastNoiseLite]::ValCoord($ASeed, $X3, $Y0, $Z0),
                    $Xs
                ),
                [FastNoiseLite]::CubicLerp(
                    [FastNoiseLite]::ValCoord($ASeed, $X0, $Y1, $Z0),
                    [FastNoiseLite]::ValCoord($ASeed, $X1, $Y1, $Z0),
                    [FastNoiseLite]::ValCoord($ASeed, $X2, $Y1, $Z0),
                    [FastNoiseLite]::ValCoord($ASeed, $X3, $Y1, $Z0),
                    $Xs
                ),
                [FastNoiseLite]::CubicLerp(
                    [FastNoiseLite]::ValCoord($ASeed, $X0, $Y2, $Z0),
                    [FastNoiseLite]::ValCoord($ASeed, $X1, $Y2, $Z0),
                    [FastNoiseLite]::ValCoord($ASeed, $X2, $Y2, $Z0),
                    [FastNoiseLite]::ValCoord($ASeed, $X3, $Y2, $Z0),
                    $Xs
                ),
                [FastNoiseLite]::CubicLerp(
                    [FastNoiseLite]::ValCoord($ASeed, $X0, $Y3, $Z0),
                    [FastNoiseLite]::ValCoord($ASeed, $X1, $Y3, $Z0),
                    [FastNoiseLite]::ValCoord($ASeed, $X2, $Y3, $Z0),
                    [FastNoiseLite]::ValCoord($ASeed, $X3, $Y3, $Z0),
                    $Xs
                ),
                $Ys
            ),
            [FastNoiseLite]::CubicLerp(
                [FastNoiseLite]::CubicLerp(
                    [FastNoiseLite]::ValCoord($ASeed, $X0, $Y0, $Z1),
                    [FastNoiseLite]::ValCoord($ASeed, $X1, $Y0, $Z1),
                    [FastNoiseLite]::ValCoord($ASeed, $X2, $Y0, $Z1),
                    [FastNoiseLite]::ValCoord($ASeed, $X3, $Y0, $Z1),
                    $Xs
                ),
                [FastNoiseLite]::CubicLerp(
                    [FastNoiseLite]::ValCoord($ASeed, $X0, $Y1, $Z1),
                    [FastNoiseLite]::ValCoord($ASeed, $X1, $Y1, $Z1),
                    [FastNoiseLite]::ValCoord($ASeed, $X2, $Y1, $Z1),
                    [FastNoiseLite]::ValCoord($ASeed, $X3, $Y1, $Z1),
                    $Xs
                ),
                [FastNoiseLite]::CubicLerp(
                    [FastNoiseLite]::ValCoord($ASeed, $X0, $Y2, $Z1),
                    [FastNoiseLite]::ValCoord($ASeed, $X1, $Y2, $Z1),
                    [FastNoiseLite]::ValCoord($ASeed, $X2, $Y2, $Z1),
                    [FastNoiseLite]::ValCoord($ASeed, $X3, $Y2, $Z1),
                    $Xs
                ),
                [FastNoiseLite]::CubicLerp(
                    [FastNoiseLite]::ValCoord($ASeed, $X0, $Y3, $Z1),
                    [FastNoiseLite]::ValCoord($ASeed, $X1, $Y3, $Z1),
                    [FastNoiseLite]::ValCoord($ASeed, $X2, $Y3, $Z1),
                    [FastNoiseLite]::ValCoord($ASeed, $X3, $Y3, $Z1),
                    $Xs
                ),
                $Ys
            ),
            [FastNoiseLite]::CubicLerp(
                [FastNoiseLite]::CubicLerp(
                    [FastNoiseLite]::ValCoord($ASeed, $X0, $Y0, $Z2),
                    [FastNoiseLite]::ValCoord($ASeed, $X1, $Y0, $Z2),
                    [FastNoiseLite]::ValCoord($ASeed, $X2, $Y0, $Z2),
                    [FastNoiseLite]::ValCoord($ASeed, $X3, $Y0, $Z2),
                    $Xs
                ),
                [FastNoiseLite]::CubicLerp(
                    [FastNoiseLite]::ValCoord($ASeed, $X0, $Y1, $Z2),
                    [FastNoiseLite]::ValCoord($ASeed, $X1, $Y1, $Z2),
                    [FastNoiseLite]::ValCoord($ASeed, $X2, $Y1, $Z2),
                    [FastNoiseLite]::ValCoord($ASeed, $X3, $Y1, $Z2),
                    $Xs
                ),
                [FastNoiseLite]::CubicLerp(
                    [FastNoiseLite]::ValCoord($ASeed, $X0, $Y2, $Z2),
                    [FastNoiseLite]::ValCoord($ASeed, $X1, $Y2, $Z2),
                    [FastNoiseLite]::ValCoord($ASeed, $X2, $Y2, $Z2),
                    [FastNoiseLite]::ValCoord($ASeed, $X3, $Y2, $Z2),
                    $Xs
                ),
                [FastNoiseLite]::CubicLerp(
                    [FastNoiseLite]::ValCoord($ASeed, $X0, $Y3, $Z2),
                    [FastNoiseLite]::ValCoord($ASeed, $X1, $Y3, $Z2),
                    [FastNoiseLite]::ValCoord($ASeed, $X2, $Y3, $Z2),
                    [FastNoiseLite]::ValCoord($ASeed, $X3, $Y3, $Z2),
                    $Xs
                ),
                $Ys
            ),
            [FastNoiseLite]::CubicLerp(
                [FastNoiseLite]::CubicLerp(
                    [FastNoiseLite]::ValCoord($ASeed, $X0, $Y0, $Z3),
                    [FastNoiseLite]::ValCoord($ASeed, $X1, $Y0, $Z3),
                    [FastNoiseLite]::ValCoord($ASeed, $X2, $Y0, $Z3),
                    [FastNoiseLite]::ValCoord($ASeed, $X3, $Y0, $Z3),
                    $Xs
                ),
                [FastNoiseLite]::CubicLerp(
                    [FastNoiseLite]::ValCoord($ASeed, $X0, $Y1, $Z3),
                    [FastNoiseLite]::ValCoord($ASeed, $X1, $Y1, $Z3),
                    [FastNoiseLite]::ValCoord($ASeed, $X2, $Y1, $Z3),
                    [FastNoiseLite]::ValCoord($ASeed, $X3, $Y1, $Z3),
                    $Xs
                ),
                [FastNoiseLite]::CubicLerp(
                    [FastNoiseLite]::ValCoord($ASeed, $X0, $Y2, $Z3),
                    [FastNoiseLite]::ValCoord($ASeed, $X1, $Y2, $Z3),
                    [FastNoiseLite]::ValCoord($ASeed, $X2, $Y2, $Z3),
                    [FastNoiseLite]::ValCoord($ASeed, $X3, $Y2, $Z3),
                    $Xs
                ),
                [FastNoiseLite]::CubicLerp(
                    [FastNoiseLite]::ValCoord($ASeed, $X0, $Y3, $Z3),
                    [FastNoiseLite]::ValCoord($ASeed, $X1, $Y3, $Z3),
                    [FastNoiseLite]::ValCoord($ASeed, $X2, $Y3, $Z3),
                    [FastNoiseLite]::ValCoord($ASeed, $X3, $Y3, $Z3),
                    $Xs
                ),
                $Ys
            ),
            $Zs
        ) * (1 / (1.5 * 1.5 * 1.5))
    }

    [Single]SingleValue(
        [Int64]$ASeed,
        [Single]$X,
        [Single]$Y
    ) {
        [Int64]$X0  = [FastNoiseLite]::FastFloor($X)
        [Int64]$Y0  = [FastNoiseLite]::FastFloor($Y)
        [Single]$Xs = [FastNoiseLite]::InterpHermite(([Single]($X - $X0)))
        [Single]$Ys = [FastNoiseLite]::InterpHermite(([Single]($Y - $Y0)))

        $X0 *= [FastNoiseLite]::PRIMEX
        $Y0 *= [FastNoiseLite]::PRIMEY

        [Int64]$X1 = $X0 + [FastNoiseLite]::PRIMEX
        [Int64]$Y1 = $Y0 + [FastNoiseLite]::PRIMEY

        [Single]$Xf0 = [FastNoiseLite]::Lerp(
            [FastNoiseLite]::ValCoord($ASeed, $X0, $Y0),
            [FastNoiseLite]::ValCoord($ASeed, $X1, $Y0),
            $Xs
        )
        [Single]$Xf1 = [FastNoiseLite]::Lerp(
            [FastNoiseLite]::ValCoord($ASeed, $X0, $Y1),
            [FastNoiseLite]::ValCoord($ASeed, $X1, $Y1),
            $Xs
        )

        Return [FastNoiseLite]::Lerp($Xf0, $Xf1, $Ys)
    }

    [Single]SingleValue(
        [Int64]$ASeed,
        [Single]$X,
        [Single]$Y,
        [Single]$Z
    ) {
        [Int64]$X0  = [FastNoiseLite]::FastFloor($X)
        [Int64]$Y0  = [FastNoiseLite]::FastFloor($Y)
        [Int64]$Z0  = [FastNoiseLite]::FastFloor($Z)
        [Single]$Xs = [FastNoiseLite]::InterpHermite(([Single]($X - $X0)))
        [Single]$Ys = [FastNoiseLite]::InterpHermite(([Single]($Y - $Y0)))
        [Single]$Zs = [FastNoiseLite]::InterpHermite(([Single]($Z - $Z0)))

        $X0 *= [FastNoiseLite]::PRIMEX
        $Y0 *= [FastNoiseLite]::PRIMEY
        $Z0 *= [FastNoiseLite]::PRIMEZ

        [Int64]$X1 = $X0 + [FastNoiseLite]::PRIMEX
        [Int64]$Y1 = $Y0 + [FastNoiseLite]::PRIMEY
        [Int64]$Z1 = $Z0 + [FastNoiseLite]::PRIMEZ

        [Single]$Xf00 = [FastNoiseLite]::Lerp(
            [FastNoiseLite]::ValCoord($ASeed, $X0, $Y0, $Z0),
            [FastNoiseLite]::ValCoord($ASeed, $X1, $Y0, $Z0),
            $Xs
        )
        [Single]$Xf10 = [FastNoiseLite]::Lerp(
            [FastNoiseLite]::ValCoord($ASeed, $X0, $Y1, $Z0),
            [FastNoiseLite]::ValCoord($ASeed, $X1, $Y1, $Z0),
            $Xs
        )
        [Single]$Xf01 = [FastNoiseLite]::Lerp(
            [FastNoiseLite]::ValCoord($ASeed, $X0, $Y0, $Z1),
            [FastNoiseLite]::ValCoord($ASeed, $X1, $Y0, $Z1),
            $Xs
        )
        [Single]$Xf11 = [FastNoiseLite]::Lerp(
            [FastNoiseLite]::ValCoord($ASeed, $X0, $Y1, $Z1),
            [FastNoiseLite]::ValCoord($ASeed, $X1, $Y1, $Z1),
            $Xs
        )

        [Single]$Yf0 = [FastNoiseLite]::Lerp($Xf00, $Xf10, $Ys)
        [Single]$Yf1 = [FastNoiseLite]::Lerp($Xf01, $Xf11, $Ys)

        Return [FastNoiseLite]::Lerp($Yf0, $Yf1, $Zs)
    }

    [Void]DoSingleDomainWarp(
        [Int64]$ASeed,
        [Single]$Amp,
        [Single]$Freq,
        [Single]$X,
        [Single]$Y,
        [Ref]$Xr,
        [Ref]$Yr

    ) {
        Switch($this.DomainWarpType) {
            ([FnlDomainWarpType]::OpenSimplex2) {
                $this.SingleDomainWarpOpenSimplex2Gradient($ASeed, $Amp * [FastNoiseLite]::SIMPLEXVALMODA_MAGIC, $Freq, $X, $Y, $Xr, $Yr, $false)

                Break
            }

            ([FnlDomainWarpType]::OpenSimplex2Reduced) {
                $this.SingleDomainWarpSimplexGradient($ASeed, $Amp * 16.0, $Freq, $X, $Y, $Xr, $Yr, $true)

                Break
            }

            ([FnlDomainWarpType]::BasicGrid) {
                $this.SingleDomainWarpBasicGrid($ASeed, $Amp, $Freq, $X, $Y, $Xr, $Yr)

                Break
            }

            Default {
                Break
            }
        }
    }

    [Void]DoSingleDomainWarp(
        [Int64]$ASeed,
        [Single]$Amp,
        [Single]$Freq,
        [Single]$X,
        [Single]$Y,
        [Single]$Z,
        [Ref]$Xr,
        [Ref]$Yr,
        [Ref]$Zr
    ) {
        Switch($this.DomainWarpType) {
            ([FnlDomainWarpType]::OpenSimplex2) {
                $this.SingleDomainWarpOpenSimplex2Gradient($ASeed, $Amp * [FastNoiseLite]::SIMPLEXVALMODA_MAGIC, $Freq, $X, $Y, $Z, $Xr, $Yr, $Zr, $false)

                Break
            }

            ([FnlDomainWarpType]::OpenSimplex2Reduced) {
                $this.SingleDomainWarpOpenSimplex2Gradient($ASeed, $Amp * 7.71604938271605, $Freq, $X, $Y, $Z, $Xr, $Yr, $Zr, $true)

                Break
            }

            ([FnlDomainWarpType]::BasicGrid) {
                $this.SingleDomainWarpBasicGrid($ASeed, $Amp, $Freq, $X, $Y, $Z, $Xr, $Yr, $Zr)

                Break
            }

            Default {
                Break
            }
        }
    }

    [Void]DomainWarpSingle(
        [Ref]$X,
        [Ref]$Y
    ) {
        [Int64]$ASeed = $this.Seed
        [Single]$Amp  = $this.DomainWarpAmp * $this.FractalBounding
        [Single]$Freq = $this.Frequency
        [Single]$Xs   = $X.Value
        [Single]$Ys   = $Y.Value

        $this.TransformDomainWarpCoordinate(([Ref]$Xs), ([Ref]$Ys))
        $this.DoSingleDomainWarp($ASeed, $Amp, $Freq, $Xs, $Ys, $X, $Y)
    }

    [Void]DomainWarpSingle(
        [Ref]$X,
        [Ref]$Y,
        [Ref]$Z
    ) {
        [Int64]$ASeed = $this.Seed
        [Single]$Amp  = $this.DomainWarpAmp * $this.FractalBounding
        [Single]$Freq = $this.Frequency
        [Single]$Xs   = $X.Value
        [Single]$Ys   = $Y.Value
        [Single]$Zs   = $Z.Value

        $this.TransformDomainWarpCoordinate(([Ref]$Xs), ([Ref]$Ys), ([Ref]$Zs))
        $this.DoSingleDomainWarp($ASeed, $Amp, $Freq, $Xs, $Ys, $Zs, $X, $Y, $Z)
    }

    [Void]DomainWarpFractalProgressive(
        [Ref]$X,
        [Ref]$Y
    ) {
        [Int64]$Aseed = $this.Seed
        [Single]$Amp  = $this.DomainWarpAmp * $this.FractalBounding
        [Single]$Freq = $this.Frequency

        For([Int64]$I = 0; $I -LT $this.Octaves; $I++) {
            [Single]$Xs = $X.Value
            [Single]$Ys = $Y.Value

            $this.TransformDomainWarpCoordinate(([Ref]$Xs), ([Ref]$Ys))
            $this.DoSingleDomainWarp($ASeed, $Amp, $Freq, $Xs, $Ys, $X, $Y)

            $ASeed++
            $Amp  *= $this.Gain
            $Freq *= $this.Lacunarity
        }
    }

    [Void]DomainWarpFractalProgressive(
        [Ref]$X,
        [Ref]$Y,
        [Ref]$Z
    ) {
        [Int64]$ASeed = $this.Seed
        [Single]$Amp  = $this.DomainWarpAmp * $this.FractalBounding
        [Single]$Freq = $this.Frequency

        For([Int64]$I = 0; $I -LT $this.Octaves; $I++) {
            [Single]$Xs = $X.Value
            [Single]$Ys = $Y.Value
            [Single]$Zs = $Z.Value

            $this.TransformDomainWarpCoordinate(([Ref]$Xs), ([Ref]$Ys), ([Ref]$Zs))
            $this.DoSingleDomainWarp($ASeed, $Amp, $Freq, $Xs, $Ys, $Zs, $X, $Y, $Z)

            $ASeed++
            $Amp  *= $this.Gain
            $Freq *= $this.Lacunarity
        }
    }

    [Void]DomainWarpFractalIndependent(
        [Ref]$X,
        [Ref]$Y
    ) {
        [Int64]$ASeed = $this.Seed
        [Single]$Xs   = $X.Value
        [Single]$Ys   = $Y.Value
        [Single]$Amp  = $this.DomainWarpAmp * $this.FractalBounding
        [Single]$Freq = $this.Frequency

        $this.TransformDomainWarpCoordinate(([Ref]$Xs), ([Ref]$Ys))

        For([Int64]$I = 0; $I -LT $this.Octaves; $I++) {
            $this.DoSingleDomainWarp($ASeed, $Amp, $Freq, $Xs, $Ys, $X, $Y)

            $ASeed++
            $Amp  *= $this.Gain
            $Freq *= $this.Lacunarity
        }
    }

    [Void]DomainWarpFractalIndependent(
        [Ref]$X,
        [Ref]$Y,
        [Ref]$Z
    ) {
        [Int64]$ASeed = $this.Seed
        [Single]$Xs   = $X.Value
        [Single]$Ys   = $Y.Value
        [Single]$Zs   = $Z.Value
        [Single]$Amp  = $this.DomainWarpAmp * $this.FractalBounding
        [Single]$Freq = $this.Frequency

        $this.TransformDomainWarpCoordinate(([Ref]$Xs), ([Ref]$Ys), ([Ref]$Zs))

        For([Int64]$I = 0; $I -LT $this.Octaves; $I++) {
            $this.DoSingleDomainWarp($ASeed, $Amp, $Freq, $Xs, $Ys, $Zs, $X, $Y, $Z)

            $ASeed++
            $Amp  *= $this.Gain
            $Freq *= $this.Lacunarity
        }
    }

    [Void]SingleDomainWarpBasicGrid(
        [Int64]$ASeed,
        [Single]$WarpAmp,
        [Single]$AFrequency,
        [Single]$X,
        [Single]$Y,
        [Ref]$Xr,
        [Ref]$Yr
    ) {
        [Single]$Xf = $X * $AFrequency
        [Single]$Yf = $Y * $AFrequency
        [Int64]$X0  = [FastNoiseLite]::FastFloor($Xf)
        [Int64]$Y0  = [FastNoiseLite]::FastFloor($Yf)
        [Single]$Xs = [FastNoiseLite]::InterpHermite(([Single]($Xf - $X0)))
        [Single]$Ys = [FastNoiseLite]::InterpHermite(([Single]($Yf - $Y0)))

        $X0 *= [FastNoiseLite]::PRIMEX
        $Y0 *= [FastNoiseLite]::PRIMEY

        [Int64]$X1    = $X0 + [FastNoiseLite]::PRIMEX
        [Int64]$Y1    = $Y0 + [FastNoiseLite]::PRIMEY
        [Int64]$Hash0 = [FastNoiseLite]::Hash($ASeed, $X0, $Y0) -BAND (255 -SHL 1)
        [Int64]$Hash1 = [FastNoiseLite]::Hash($ASeed, $X1, $Y1) -BAND (255 -SHL 1)

        [Single]$Lx0x = [FastNoiseLite]::Lerp(
            [FastNoiseLite]::RANDVECS2D[$Hash0],
            [FastNoiseLite]::RANDVECS2D[$Hash1],
            $Xs
        )
        [Single]$Ly0x = [FastNoiseLite]::Lerp(
            [FastNoiseLite]::RANDVECS2D[$Hash0 -BOR 1],
            [FastNoiseLite]::RANDVECS2D[$Hash1 -BOR 1],
            $Xs
        )

        $Hash0 = [FastNoiseLite]::Hash($ASeed, $X0, $Y1) -BAND (255 -SHL 1)
        $Hash1 = [FastNoiseLite]::Hash($Aseed, $X1, $Y1) -BAND (255 -SHL 1)

        [Single]$Lx1x = [FastNoiseLite]::Lerp(
            [FastNoiseLite]::RANDVECS2D[$Hash0],
            [FastNoiseLite]::RANDVECS2D[$Hash1],
            $Xs
        )
        [Single]$Ly1x = [FastNoiseLite]::Lerp(
            [FastNoiseLite]::RANDVECS2D[$Hash0 -BOR 1],
            [FastNoiseLite]::RANDVECS2D[$Hash1 -BOR 1],
            $Xs
        )

        $Xr.Value += [FastNoiseLite]::Lerp($Lx0x, $Lx1x, $Ys) * $WarpAmp
        $Yr.Value += [FastNoiseLite]::Lerp($Ly0x, $Ly1x, $Ys) * $WarpAmp
    }

    [Void]SingleDomainWarpBasicGrid(
        [Int64]$ASeed,
        [Single]$WarpAmp,
        [Single]$AFrequency,
        [Single]$X,
        [Single]$Y,
        [Single]$Z,
        [Ref]$Xr,
        [Ref]$Yr,
        [Ref]$Zr
    ) {
        [Single]$Xf = $X * $AFrequency
        [Single]$Yf = $Y * $AFrequency
        [Single]$Zf = $Z * $AFrequency
        [Int64]$X0  = [FastNoiseLite]::FastFloor($Xf)
        [Int64]$Y0  = [FastNoiseLite]::FastFloor($Yf)
        [Int64]$Z0  = [FastNoiseLite]::FastFloor($Zf)
        [Single]$Xs = [FastNoiseLite]::InterpHermite(([Single]($Xf - $X0)))
        [Single]$Ys = [FastNoiseLite]::InterpHermite(([Single]($Yf - $Y0)))
        [Single]$Zs = [FastNoiseLite]::InterpHermite(([Single]($Zf - $Z0)))

        $X0 *= [FastNoiseLite]::PRIMEX
        $Y0 *= [FastNoiseLite]::PRIMEY
        $Z0 *= [FastNoiseLite]::PRIMEZ

        [Int64]$X1    = $X0 + [FastNoiseLite]::PRIMEX
        [Int64]$Y1    = $Y0 + [FastNoiseLite]::PRIMEY
        [Int64]$Z1    = $Z0 + [FastNoiseLite]::PRIMEZ
        [Int64]$Hash0 = [FastNoiseLite]::Hash($ASeed, $X0, $Y0, $Z0) -BAND (255 -SHL 2)
        [Int64]$Hash1 = [FastNoiseLite]::Hash($ASeed, $X1, $Y0, $Z0) -BAND (255 -SHL 2)

        [Single]$Lx0x = [FastNoiseLite]::Lerp(
            [FastNoiseLite]::RANDVECS3D[$Hash0],
            [FastNoiseLite]::RANDVECS3D[$Hash1],
            $Xs
        )
        [Single]$Ly0x = [FastNoiseLite]::Lerp(
            [FastNoiseLite]::RANDVECS3D[$Hash0 -BOR 1],
            [FastNoiseLite]::RANDVECS3D[$Hash1 -BOR 1],
            $Xs
        )
        [Single]$Lz0x = [FastNoiseLite]::Lerp(
            [FastNoiseLite]::RANDVECS3D[$Hash0 -BOR 2],
            [FastNoiseLite]::RANDVECS3D[$Hash1 -BOR 2],
            $Xs
        )

        $Hash0 = [FastNoiseLite]::Hash($ASeed, $X0, $Y1, $Z0) -BAND (255 -SHL 2)
        $Hash1 = [FastNoiseLite]::Hash($Aseed, $X1, $Y1, $Z0) -BAND (255 -SHL 2)

        [Single]$Lx1x = [FastNoiseLite]::Lerp(
            [FastNoiseLite]::RANDVECS3D[$Hash0],
            [FastNoiseLite]::RANDVECS3D[$Hash1],
            $Xs
        )
        [Single]$Ly1x = [FastNoiseLite]::Lerp(
            [FastNoiseLite]::RANDVECS3D[$Hash0 -BOR 1],
            [FastNoiseLite]::RANDVECS3D[$Hash1 -BOR 1],
            $Xs
        )
        [Single]$Lz1x = [FastNoiseLite]::Lerp(
            [FastNoiseLite]::RANDVECS3D[$Hash0 -BOR 2],
            [FastNoiseLite]::RANDVECS3D[$Hash1 -BOR 2],
            $Xs
        )

        [Single]$Lx0y = [FastNoiseLite]::Lerp($Lx0x, $Lx1x, $Ys)
        [Single]$Ly0y = [FastNoiseLite]::Lerp($Ly0x, $Ly1x, $Ys)
        [Single]$Lz0y = [FastNoiseLite]::Lerp($Lz0x, $Lz1x, $Ys)

        $Hash0 = [FastNoiseLite]::Hash($ASeed, $X0, $Y0, $Z1) -BAND (255 -SHL 2)
        $Hash1 = [FastNoiseLite]::Hash($ASeed, $X1, $Y0, $Z1) -BAND (255 -SHL 2)

        $Lx0x = [FastNoiseLite]::Lerp(
            [FastNoiseLite]::RANDVECS3D[$Hash0],
            [FastNoiseLite]::RANDVECS3D[$Hash1],
            $Xs
        )
        $Ly0x = [FastNoiseLite]::Lerp(
            [FastNoiseLite]::RANDVECS3D[$Hash0 -BOR 1],
            [FastNoiseLite]::RANDVECS3D[$Hash1 -BOR 1],
            $Xs
        )
        $Lz0x = [FastNoiseLite]::Lerp(
            [FastNoiseLite]::RANDVECS3D[$Hash0 -BOR 2],
            [FastNoiseLite]::RANDVECS3D[$Hash1 -BOR 2],
            $Xs
        )

        $Hash0 = [FastNoiseLite]::Hash($ASeed, $X0, $Y1, $Z1) -BAND (255 -SHL 2)
        $Hash1 = [FastNoiseLite]::Hash($ASeed, $X1, $Y1, $Z1) -BAND (255 -SHL 2)

        $Lx1x = [FastNoiseLite]::Lerp(
            [FastNoiseLite]::RANDVECS3D[$Hash0],
            [FastNoiseLite]::RANDVECS3D[$Hash1],
            $Xs
        )
        $Ly1x = [FastNoiseLite]::Lerp(
            [FastNoiseLite]::RANDVECS3D[$Hash0 -BOR 1],
            [FastNoiseLite]::RANDVECS3D[$Hash0 -BOR 1],
            $Xs
        )
        $Lz1x = [FastNoiseLite]::Lerp(
            [FastNoiseLite]::RANDVECS3D[$Hash0 -BOR 2],
            [FastNoiseLite]::RANDVECS3D[$Hash1 -BOR 2],
            $Xs
        )

        $Xr.Value += [FastNoiseLite]::Lerp(
            $Lx0y,
            [FastNoiseLite]::Lerp(
                $Lx0x,
                $Lx1x,
                $Ys
            ),
            $Zs
        ) * $WarpAmp
        $Yr.Value += [FastNoiseLite]::Lerp(
            $Ly0y,
            [FastNoiseLite]::Lerp(
                $Ly0x,
                $Ly1x,
                $Ys
            ),
            $Zs
        ) * $WarpAmp
        $Zr.Value += [FastNoiseLite]::Lerp(
            $Lz0y,
            [FastNoiseLite]::Lerp(
                $Ly0x,
                $Lz1x,
                $Ys
            ),
            $Zs
        ) * $WarpAmp
    }

    [Void]SingleDomainWarpSimplexGradient(
        [Int64]$ASeed,
        [Single]$WarpAmp,
        [Single]$AFrequency,
        [Single]$X,
        [Single]$Y,
        [Ref]$Xr,
        [Ref]$Yr,
        [Boolean]$OutGradOnly
    ) {
        [Single]$G2   = (3 - [FastNoiseLite]::SQRT3) / 6
        [Single]$G2m1 = $G2 - 1
        [Single]$G2a1 = 1 - 2 * $G2

        $X *= $AFrequency
        $Y *= $AFrequency

        [Int64]$I   = [FastNoiseLite]::FastFloor($X)
        [Int64]$J   = [FastNoiseLite]::FastFloor($Y)
        [Single]$Xi = ([Single]($X - $I))
        [Single]$Yi = ([Single]($Y - $J))
        [Single]$T  = ($Xi + $Yi) * $G2
        [Single]$X0 = $Xi - $T
        [Single]$Y0 = $Yi - $T

        $I *= [FastNoiseLite]::PRIMEX
        $J *= [FastNoiseLite]::PRIMEY

        [Single]$Vx = 0
        [Single]$Vy = 0
        [Single]$A  = 0.5 - $X0 * $X0 - $Y0 * $Y0
        [Single]$A2 = $A * $A

        If($A -GT 0) {
            [Single]$Aaaa = $A2 * $A2
            [Single]$Xo   = 0
            [Single]$Yo   = 0

            If($OutGradOnly -EQ $true) {
                [FastNoiseLite]::GradCoordOut($ASeed, $I, $J, ([Ref]$Xo), ([Ref]$Yo))
            } Else {
                [FastNoiseLite]::GradCoordDual($ASeed, $I, $J, $X0, $Y0, ([Ref]$Xo), ([Ref]$Yo))
            }
            $Vx += $Aaaa * $Xo
            $Vy += $Aaaa * $Yo
        }

        [Single]$C = ([Single](
            2 * $G2a1 * (1 / $G2 - 2)) * $T +
            ([Single](-2 * $G2a1 * $G2a1) + $A)
        )
        [Single]$C2 = $C * $C

        If($C -GT 0) {
            [Single]$X2   = $X0 + (2 * $G2m1)
            [Single]$Y2   = $Y0 + (2 * $G2m1)
            [Single]$Cccc = $C2 * $C2
            [Single]$Xo   = 0
            [Single]$Yo   = 0

            If($OutGradOnly -EQ $true) {
                [FastNoiseLite]::GradCoordOut($ASeed, $I + [FastNoiseLite]::PRIMEX, $J + [FastNoiseLite]::PRIMEY, ([Ref]$Xo), ([Ref]$Yo))
            } Else {
                [FastNoiseLite]::GradCoordDual($ASeed, $I + [FastNoiseLite]::PRIMEX, $J + [FastNoiseLite]::PRIMEY, $X2, $Y2, ([Ref]$Xo), ([Ref]$Yo))
            }

            $Vx += $Cccc * $Xo
            $Vy += $Cccc * $Yo
        }

        If($Y0 -GT $X0) {
            [Single]$X1 = $X0 + $G2
            [Single]$Y1 = $Y0 + $G2m1
            [Single]$B  = 0.5 - $X1 * $X1 - $Y1 * $Y1
            [Single]$B2 = $B * $B

            If($B -GT 0) {
                [Single]$Bbbb = $B2 * $B2
                [Single]$Xo   = 0
                [Single]$Yo   = 0

                If($OutGradOnly -EQ $true) {
                    [FastNoiseLite]::GradCoordOut($ASeed, $I, $J + [FastNoiseLite]::PRIMEY, ([Ref]$Xo), ([Ref]$Yo))
                } Else {
                    [FastNoiseLite]::GradCoordDual($ASeed, $I, $J + [FastNoiseLite]::PRIMEY, $X1, $Y1, ([Ref]$Xo), ([Ref]$Yo))
                }

                $Vx += $Bbbb * $Xo
                $Vy += $Bbbb * $Yo
            }
        } Else {
            [Single]$X1 = $X0 + $G2m1
            [Single]$Y1 = $Y0 + $G2
            [Single]$B  = 0.5 - $X1 * $X1 - $Y1 * $Y1
            [Single]$B2 = $B * $B

            If($B -GT 0) {
                [Single]$Bbbb = $B2 * $B2
                [Single]$Xo   = 0
                [Single]$Yo   = 0

                If($OutGradOnly -EQ $true) {
                    [FastNoiseLite]::GradCoordOut($ASeed, $I + [FastNoiseLite]::PRIMEX, $J, ([Ref]$Xo), ([Ref]$Yo))
                } Else {
                    [FastNoiseLite]::GradCoordDual($ASeed, $I + [FastNoiseLite]::PRIMEX, $J, $X1, $Y1, ([Ref]$Xo), ([Ref]$Yo))
                }

                $Vx += $Bbbb * $Xo
                $Vy += $Bbbb * $Yo
            }
        }

        $Xr.Value += $Vx * $WarpAmp
        $Yr.Value += $Vy * $WarpAmp
    }

    [Void]SingleDomainWarpOpenSimplex2Gradient(
        [Int64]$ASeed,
        [Single]$WarpAmp,
        [Single]$AFrequency,
        [Single]$X,
        [Single]$Y,
        [Single]$Z,
        [Ref]$Xr,
        [Ref]$Yr,
        [Ref]$Zr,
        [Boolean]$OutGradOnly
    ) {
        $X *= $AFrequency
        $Y *= $AFrequency
        $Z *= $AFrequency

        [Int64]$I      = [FastNoiseLite]::FastRound($X)
        [Int64]$J      = [FastNoiseLite]::FastRound($Y)
        [Int64]$K      = [FastNoiseLite]::FastRound($Z)
        [Single]$X0    = ([Single]($X - $I))
        [Single]$Y0    = ([Single]($Y - $J))
        [Single]$Z0    = ([Single]($Z - $K))
        [Int64]$XNSign = ([Int64](-$X0 - 1) -BOR 1)
        [Int64]$YNSign = ([Int64](-$Y0 - 1) -BOR 1)
        [Int64]$ZNSign = ([Int64](-$Z0 - 1) -BOR 1)
        [Single]$Ax0   = $XNSign * -$X0
        [Single]$Ay0   = $YNSign * -$Y0
        [Single]$Az0   = $ZNSign * -$Z0

        $I *= [FastNoiseLite]::PRIMEX
        $J *= [FastNoiseLite]::PRIMEY
        $K *= [FastNoiseLite]::PRIMEZ

        [Single]$Vx = 0
        [Single]$Vy = 0
        [Single]$Vz = 0
        [Single]$A  = (0.6 - $X0 * $X0)- ($Y0 * $Y0 + $Z0 * $Z0)
        [Single]$A2 = $A * $A

        For([Int64]$L = 0; ; $L++) {
            If($A -GT 0) {
                [Single]$Aaaa = $A2 * $A2
                [Single]$Xo   = 0
                [Single]$Yo   = 0
                [Single]$Zo   = 0

                If($OutGradOnly -EQ $true) {
                    [FastNoiseLite]::GradCoordOut($ASeed, $I, $J, $K, ([Ref]$Xo), ([Ref]$Yo), ([Ref]$Zo))
                } Else {
                    [FastNoiseLite]::GradCoordDual($ASeed, $I, $J, $K, $X0, $Y0, $Z0, ([Ref]$Xo), ([Ref]$Yo), ([Ref]$Zo))
                }

                $Vx += $Aaaa * $Xo
                $Vy += $Aaaa * $Yo
                $Vz += $Aaaa * $Zo
            }

            [Int64]$I1  = $I
            [Int64]$J1  = $J
            [Int64]$K1  = $K
            [Single]$B  = $A
            [Single]$B2 = $B * $B
            [Single]$X1 = $X0
            [Single]$Y1 = $Y0
            [Single]$Z1 = $Z0

            If($Ax0 -GE $Ay0 -AND $Ax0 -GE $Az0) {
                $X1 += $XNSign
                $B  += $Ax0 + $Ax0
                $I1 -= $XNSign + [FastNoiseLite]::PRIMEX
            } Elseif($Ay0 -GT $Ax0 -AND $Ay0 -GE $Az0) {
                $Y1 += $YNSign
                $B  += $Ay0 + $Ay0
                $J1 -= $YNSign * [FastNoiseLite]::PRIMEY
            } Else {
                $Z1 += $ZNSign
                $B  += $Az0 + $Az0
                $K1 -= $ZNSign * [FastNoiseLite]::PRIMEZ
            }

            If($B -GT 1) {
                $B -= 1

                [Single]$Bbbb = $B2 * $B2
                [Single]$Xo   = 0
                [Single]$Yo   = 0
                [Single]$Zo   = 0

                If($OutGradOnly -EQ $true) {
                    [FastNoiseLite]::GradCoordOut($ASeed, $I, $J, $K, ([Ref]$Xo), ([Ref]$Yo), ([Ref]$Zo))
                } Else {
                    [FastNoiseLite]::GradCoordDual($ASeed, $I1, $J1, $K1, $X1, $Y1, $Z1, ([Ref]$Xo), ([Ref]$Yo), ([Ref]$Zo))
                }

                $Vx += $Bbbb * $Xo
                $Vy += $Bbbb * $Yo
                $Vz += $Bbbb * $Zo
            }

            If($L -EQ 1) {
                Break
            }

            $Ax0     = 0.5 - $Ax0
            $Ay0     = 0.5 - $Ay0
            $Az0     = 0.5 - $Az0
            $X0      = $XNSign * $Ax0
            $Y0      = $YNSign * $Ay0
            $Z0      = $ZNSign * $Az0
            $A      += (0.75 - $Ax0) - ($Ay0 + $Az0)
            $I      += ($XNSign -SHR 1) -BAND [FastNoiseLite]::PRIMEX
            $J      += ($YNSign -SHR 1) -BAND [FastNoiseLite]::PRIMEY
            $K      += ($ZNSign -SHR 1) -BAND [FastNoiseLite]::PRIMEZ
            $XNSign  = -$XNSign
            $YNSign  = -$YNSign
            $ZNSign  = -$ZNSign
            $ASeed  += [FastNoiseLite]::SEEDADD_MAGIC
        }

        $Xr.Value += $Vx * $WarpAmp
        $Yr.Value += $Vy * $WarpAmp
        $Zr.Value += $Vz * $WarpAmp
    }
}






###############################################################################
#
# MAP TILE OBJECT ABSTRACTIONS
#
# THESE ABSTRACTIONS SERVE TO BUILD UP ACTUAL ITEMS THAT THE PLAYER CAN 
# INTERACT WITH. THESE CONSTRUCTS CAN BE A LITTLE CUMBERSOME TO SETUP.
#
###############################################################################
Class MTOTree : MapTileObject {
    [Boolean]$HasRopeTied

    MTOTree() {
        $this.Name              = 'Tree'
        $this.MapObjName        = 'tree'
        $this.CanAddToInventory = $false
        $this.ExamineString     = 'It''s a tree. Looks like all the other ones.'
        $this.Effect = {
            <#
            Note the pattern here for the params. In order for state changes to work, the ScriptBlock will need to have two arguments:
            A reference to the object itself, and the source. AFAIK, this is because of how the ScriptBlock gets invoked. The $this reference
            doesn't work as it references the CommandWindow instance rather than the owning object (in this case, MTOTree). Because of this
            somewhat counterintuitive nature, the caller (in this case, the 'use' command) will invoke the ScriptBlock with two arguments that
            match the signature here. State changes can be inflicted upon Self (passed as a reference), and Source gets removed from the Player's
            Inventory.
            #>
            Param(
                [MTOTree]$Self,
                [Object]$Source
            )

            Switch($Source.PSTypeNames[0]) {
                'MTORope' {
                    $Script:TheMessageWindow.WriteTiedRopeToTreeMessage()

                    <#
                    It's important to note that this action *SHOULD* cause a state change with this object. To be more specific,
                    prior to running this action, it's assumed that the Tree did NOT have a Rope tied to it. After this action,
                    it does. So the questions now are (A) can you tie another Rope to the Tree, and (B) what can you do with the Tree
                    now that it has a Rope tied to it?

                    Also, the Rope should be removed from the Player's Inventory, but I don't yet have that functionality in place.

                    UPDATE: I have this functionality in place.
                    #>
                    $Self.HasRopeTied   = $true
                    $Self.ExamineString = 'A rope is tied to this tree. Wee.'
                    $Script:ThePlayer.RemoveInventoryItemByName($Source.Name)
                }
            }
        }
        $this.TargetOfFilter = @(
            'MTORope'
        )
        $this.HasRopeTied = $false
    }
}

Class MTOLadder : MapTileObject {
    MTOLadder() {
        $this.Name              = 'Ladder'
        $this.MapObjName        = $this.Name.ToLower()
        $this.CanAddToInventory = $false
        $this.ExamineString     = 'Used to climb things. Just don''t walk under one.'
    }
}

Class MTORope : MapTileObject {
    MTORope() {
        $this.Name              = 'Rope'
        $this.MapObjName        = $this.Name.ToLower()
        $this.CanAddToInventory = $true
        $this.ExamineString     = 'It''s not a snake. Hopefully.'
    }
}

Class MTOStairs : MapTileObject {
    MTOStairs() {
        $this.Name              = 'Stairs'
        $this.MapObjName        = $this.Name.ToLower()
        $this.CanAddToInventory = $true
        $this.ExamineString     = 'A faithful ally for elevating one''s position.'
    }
}

Class MTOPole : MapTileObject {
    MTOPole() {
        $this.Name              = 'Pole'
        $this.MapObjName        = $this.Name.ToLower()
        $this.CanAddToInventory = $false
        $this.ExamineString     = 'Not the north or the south one.'
    }
}

Class MTOBacon : MapTileObject {
    MTOBacon() {
        $this.Name              = 'Bacon'
        $this.MapObjName        = $this.Name.ToLower()
        $this.CanAddToInventory = $true
        $this.ExamineString     = 'Shredded swine flesh. Cholesterol never tasted so good.'
        $this.KeyItem           = $true
    }
}

Class MTOApple : MapTileObject {
    MTOApple() {
        $this.Name              = 'Apple'
        $this.MapObjName        = $this.Name.ToLower()
        $this.CanAddToInventory = $true
        $this.ExamineString     = 'A big, juicy, red apple. Worm not included.'
    }
}

Class MTOStick : MapTileObject {
    MTOStick() {
        $this.Name              = 'Stick'
        $this.MapObjName        = $this.Name.ToLower()
        $this.CanAddToInventory = $true
        $this.ExamineString     = 'Be careful not to poke your eye out with it.'
    }
}

Class MTOYogurt : MapTileObject {
    MTOYogurt() {
        $this.Name              = 'Yogurt'
        $this.MapObjName        = $this.Name.ToLower()
        $this.CanAddToInventory = $true
        $this.ExamineString     = 'For some reason, people enjoy this spoiled milk.'
    }
}

Class MTORock : MapTileObject {
    MTORock() {
        $this.Name              = 'Rock'
        $this.MapObjName        = $this.Name.ToLower()
        $this.CanAddToInventory = $true
        $this.ExamineString     = 'A garden variety rock. Good for taunting raccoons with.'
    }
}

Class MTOMilk : MapTileObject {
    [Int]$PlayerHpBonus
    [Boolean]$IsSpoiled

    MTOMilk() {
        $this.Name = 'Milk'
        $this.MapObjName = $this.Name.ToLower()
        $this.CanAddToInventory = $true
        $this.ExamineString = '2%. We don''t take kindly to whole milk ''round here.'
        $this.Effect = {
            Param(
                [MTOMilk]$Self,
                [Object]$Source
            )

            Switch($Source.PSTypeNames[0]) {
                'Player' {
                    <#
                    Now we're getting into some pretty esoteric stuff here.

                    First, we need to check and see if the Milk is spoiled.
                    #>
                    If($Self.IsSpoiled -EQ $true) {
                        # It is - this will cause the Player's Hp to decrease
                        # Attempt to decrement the Player's Hp by the Hp Bonus
                        If($Source.DecrementHitPoints(-$Self.PlayerHpBonus) -EQ $true) {
                            $Script:TheMessageWindow.WriteMilkUseSpoiledMessage()
                            $Source.RemoveInventoryItemByName($Self.Name)
                        } Else {
                            $Script:TheMessageWindow.WriteMilkUseNotNowMessage()
                        }
                    } Else {
                        # The milk isn't spoiled - attempt to increment the Player's Hp by the Hp Bonus
                        # Attempt to increment the Player's HP by the Hp Bonus
                        If($Script:ThePlayer.IncrementHitPoints($Self.PlayerHpBonus) -EQ $true) {
                            $Script:TheMessageWindow.WriteMilkUseOkayMessage()
                            $Script:ThePlayer.RemoveInventoryItemByName($Self.Name)
                        } Else {
                            $Script:TheMessageWindow.WriteMilkUseNotNowMessage()
                        }
                    }
                }
            }
        }

        # THIS LOOKS STRANGE, BUT NOW WE'RE STILL IN THE CTOR AND THIS SETS, RANDOMLY, SOME STUFF ABOUT THE MLIK
        $a                  = $(Get-Random -Minimum 0 -Maximum 10)
        $this.PlayerHpBonus = 75
        $this.IsSpoiled     = $($a -GE 6 ? $true : $false)
        
        If($this.IsSpoiled -EQ $true) {
            $this.ExamineString      = 'This looks funny. Should I really be drinking this?'
            $this.PlayerEffectString = "-$($this.PlayerHpBonus) HP, 10% chance to inflict Poison"
        } Else {
            $this.PlayerEffectString = "+$($this.PlayerHpBonus) HP"
        }
    }
}

Class MTOWarpable : MapTileObject {
    [Ref]$WarpToReference
    [Int]$WarpToX
    [Int]$WarpToY

    MTOWarpable() {
        $this.WarpToReference = $null
        $this.WarpToX         = 0
        $this.WarpToY         = 0
        $this.Effect          = $Script:MapWarpHandler
    }
}

Class MTODoor : MTOWarpable {
    MTODoor() {
        $this.Name       = 'Door'
        $this.MapObjName = 'door'
    }
}

Class MTODoor00001 : MTODoor {
    MTODoor00001() {
        $this.WarpToReference = ([Ref]$Script:SampleWarpMap02)
    }
}

Class MTODoor00002 : MTODoor {
    MTODoor00002() {
        $this.WarpToReference = ([Ref]$Script:SampleWarpMap01)
        $this.WarpToX         = 3
    }
}





###############################################################################
#
# BUFFER MANAGER CLASS
#
# MANAGES A SET OF BUFFER STORES TO KEEP THE STATE OF THE GAME BUFFER IN.
#
###############################################################################
Class BufferManager {
    [BufferCell[,]]$ScreenBufferA
    [BufferCell[,]]$ScreenBufferB

    BufferManager() {
        $this.ScreenBufferA = New-Object 'BufferCell[,]' 80, 80
        $this.ScreenBufferB = New-Object 'BufferCell[,]' 80, 80
    }

    [Void]CopyActiveToBufferA() {
        $this.ScreenBufferA = $Script:Rui.GetBufferContents([Rectangle]::new(0, 0, 80, 80))
    }

    [Void]CopyActiveToBufferAWithWipe() {
        $this.ScreenBufferA = $Script:Rui.GetBufferContents([Rectangle]::new(0, 0, 80, 80))
        Clear-Host
    }

    [Void]CopyActiveToBufferB() {
        $this.ScreenBufferB = $Script:Rui.GetBufferContents([Rectangle]::new(0, 0, 80, 80))
    }

    [Void]CopyActiveToBufferBWithWipe() {
        $this.ScreenBufferB = $Script:Rui.GetBufferContents([Rectangle]::new(0, 0, 80, 80))
        Clear-Host
    }

    [Void]SwapAToB() {
        $this.ScreenBufferB = $this.ScreenBufferA
    }

    [Void]SwapBToA() {
        $this.ScreenBufferA = $this.ScreenBufferB
    }

    [Void]RestoreBufferAToActive() {
        Clear-Host
        $Script:Rui.SetBufferContents([Coordinates]::new(0, 0), $this.ScreenBufferA)
        $this.ScreenBufferA = New-Object 'BufferCell[,]' 80, 80
    }

    [Void]RestoreBufferBToActive() {
        Clear-Host
        $Script:Rui.SetBufferContents([Coordinates]::new(0, 0), $this.ScreenBufferB)
        $this.ScreenBufferB = New-Object 'BufferCell[,]' 80, 80
    }
}





###############################################################################
#
# UIE CONTAINER
#
# THE ROOT CONTAINER FOR ANY UI ELEMENT.
#
###############################################################################
Class UIEContainer {
    [ATCoordinates]$LeftTop
    [ATCoordinates]$RightBottom
    [Int]$Width
    [Int]$Height
    [Stack[UIEContainer]]$Children
    [UIELayout]$Layout

    UIEContainer() {
        $this.LeftTop     = [ATCoordinates]::new()
        $this.RightBottom = [ATCoordinates]::new()
        $this.Width       = 0
        $this.Height      = 0
        $this.Children    = [Stack[UIEContainer]]::new()
        $this.Layout      = [UIELayout]::Vertical
    }

    [Void]UpdateDimensions() {
        If($this.Children.Count -EQ 0) {
            $this.Width  = $this.LeftTop.Column + $this.RightBottom.Column
            $this.Height = $this.LeftTop.Row + $this.RightBottom.Row
        } Else {
            $this.Width  = 0
            $this.Height = 0
    
            Foreach($Child in $this.Children) {
                $this.Width  += $Child.Width
                $this.Height += $Child.Height
            }
        }
    }

    [Void]PushChild(
        [UIEContainer]$Child
    ) {
        If($null -EQ $Child) {
            # PROBABLY SHOULD DO SOMETHING A LITTLE DIFFERENT HERE, BUT WHATEVER
            Return
        }

        Switch($this.Layout) {
            ([UIELayout]::Horizontal) {
                If($this.Children.Count -GT 1) {
                    [UIEContainer]$Top = $this.Children.Peek()

                    $Child.LeftTop.Column = $Top.RightBottom.Column + 2
                    $Child.LeftTop.Row    = $Top.LeftTop.Row

                    $this.Children.Push($Child)
                    $this.UpdateDimensions()
                } Else {
                    $this.Children.Push($Child)
                    $this.UpdateDimensions()
                }
            }

            ([UIELayout]::Vertical) {
                If($this.Children.Count -GT 1) {
                    [UIEContainer]$Top = $this.Children.Peek()

                    # THIS PADDING CALCULATION MIGHT NEED ADJUSTED
                    $Child.LeftTop.Row = $Top.RightBottom.Row + 2

                    # ALIGN LEFT TO THE ABOVE CONTAINER
                    $Child.LeftTop.Column = $Top.LeftTop.Column

                    $this.Children.Push($Child)

                    $this.UpdateDimensions()
                } Else {
                    $this.Children.Push($Child)
                    $this.UpdateDimensions()
                }
            }

            Default {}
        }
    }
}





###############################################################################
#
# WINDOW BASE
#
# INTENDED TO BE USED AS THE FOUNDATION FOR MORE SPECIFIC "WINDOWS". THIS CLASS
# ISN'T INTENDED TO BE INSTANTIATED DIRECTLY FOR ANY REASON OTHER THAN TESTING.
#
# THE VERSION SHOWN HERE IS DERIVED FROM BURNT LATTE. IT EXTENDS THE ORIGINAL
# DESIGN BY ADDING SUPPORT FOR INDEPENDENT LEFT AND RIGHT BORDER CHARACTERS,
# AS WELL AS ADDING A TITLE. LEGACY DERIVED CLASSES WILL BE REQUIRED TO CHANGE
# CERTAIN INITIALIZATION PROCESSES TO FACILITATE DERIVATION FROM THIS VERSION.
#
# THE INCLUSION OF THE SECONDARY CONSTRUCTOR IS FOR POSTERITY. IT'S CURRENTLY
# UNCLEAR IF THIS CONSTRUCTOR IS USED. THIS SHOULD BE CLEANED UP LATER.
#
# NEWER ADDITIONS TO THIS CODE ARE INTENDED TO ADD CORNER CHARACTERS TO THE
# SPEC. THIS IS A DERIVATIVE OF PWSHSPECTRECONSOLE (THANKS TO TRACKD FOR THIS).
# I WASN'T DOING THIS ORIGINALLY, AND IT SEEMS LIKE IT MAY GIVE A BIT OF A
# BETTER VISUAL EXPERIENCE, ESPCIALLY SINCE I MAY NOT BE ABLE TO USE SAID
# LIBRARY TO RENDER THE GAME AFTER TALKING WITH HIM.
#
###############################################################################
Class WindowBase {
    [ATCoordinates]$LeftTop
    [ATCoordinates]$RightBottom
    [ConsoleColor24[]]$BorderDrawColors
    [Boolean[]]$BorderDrawDirty
    [Int]$Width
    [Int]$Height

    [String]$Title
    [Boolean]$UseTitle
    [Boolean]$TitleDirty
    [Boolean]$ComplexTitle
    [ConsoleColor24]$TitleColor

    WindowBase() {
        $this.LeftTop          = [ATCoordinatesNone]::new()
        $this.RightBottom      = [ATCoordinatesNone]::new()
        $this.BorderDrawColors = [ConsoleColor24[]](
            [CCWindowBorderDefault24]::new(),
            [CCWindowBorderDefault24]::new(),
            [CCWindowBorderDefault24]::new(),
            [CCWindowBorderDefault24]::new(),
            [CCWindowBorderDefault24]::new(),
            [CCWindowBorderDefault24]::new(),
            [CCWindowBorderDefault24]::new(),
            [CCWindowBorderDefault24]::new()
        )
        $this.BorderDrawDirty = [Boolean[]](
            $true,
            $true,
            $true,
            $true
        )
        $this.Title        = ''
        $this.UseTitle     = $false
        $this.TitleDirty   = $false
        $this.ComplexTitle = $false
        $this.TitleColor   = [CCTextDefault24]::new()
        $this.UpdateDimensions()
    }

    [Void]Draw() {
        [ATStringComposite]$Bt = [ATStringComposite]::new()
        [ATStringComposite]$Bb = [ATStringComposite]::new()
        [ATStringComposite]$Bl = [ATStringComposite]::new()
        [ATStringComposite]$Br = [ATStringComposite]::new()

        If($this.BorderDrawDirty[[WindowBorderPart]::Top] -EQ $true) {
            $Bt = [ATStringComposite]::new(@(
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = $this.BorderDrawColors[[WindowBorderPart]::LeftTop]
                        Coordinates     = $this.LeftTop
                    }
                    UserData = $($Script:CurrentWindowDesign[[WindowBorderPart]::LeftTop])
                },
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = $this.BorderDrawColors[[WindowBorderPart]::Top]
                    }

                    # I HAVE OFFICIALLY COMMITTED THE CARDINAL SIN OF MULTIPLYING A STRING WITH AN INTEGER
                    # TO REPEAT INLINE.
                    # FUCK ME. FUCK ME. FUCK ME.
                    UserData = $($Script:CurrentWindowDesign[[WindowBorderPart]::Top] * ($this.Width - 1))
                },
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = $this.BorderDrawColors[[WindowBorderPart]::RightTop]
                    }
                    UserData   = $($Script:CurrentWindowDesign[[WindowBorderPart]::RightTop])
                    UseATReset = $true
                }
            ))
            $this.BorderDrawDirty[[WindowBorderPartDirty]::Top] = $false
        }

        If($this.BorderDrawDirty[[WindowBorderPartDirty]::Bottom] -EQ $true) {
            $Bb = [ATStringComposite]::new(@(
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = $this.BorderDrawColors[[WindowBorderPart]::LeftBottom]
                        Coordinates     = [ATCoordinates]@{
                            Row    = $this.RightBottom.Row
                            Column = $this.LeftTop.Column
                        }
                    }
                    UserData = $($Script:CurrentWindowDesign[[WindowBorderPart]::LeftBottom])
                },
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = $this.BorderDrawColors[[WindowBorderPart]::Bottom]
                    }
                    UserData = $($Script:CurrentWindowDesign[[WindowBorderPart]::Bottom] * ($this.Width - 1))
                },
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = $this.BorderDrawColors[[WindowBorderPart]::RightBottom]
                    }
                    UserData   = $($Script:CurrentWindowDesign[[WindowBorderPart]::RightBottom])
                    UseATReset = $true
                }
            ))
            $this.BorderDrawDirty[[WindowBorderPartDirty]::Bottom] = $false
        }

        If($this.BorderDrawDirty[[WindowBorderPartDirty]::Left] -EQ $true) {
            # THE CORNERS WILL ALREADY HAVE BEEN DRAWN AT THIS POINT, SO WE JUST NEED TO REPEAT THE LEFT CHARACTER VERTICALLY
            $Bl = [ATStringComposite]::new(@(
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = $this.BorderDrawColors[[WindowBorderPart]::Left]
                        Coordinates     = [ATCoordinates]@{
                            Row    = $this.LeftTop.Row + 1
                            Column = $this.LeftTop.Column
                        }
                    }
                    UserData = $(
                        Invoke-Command -ScriptBlock {
                            [String]$T = ''

                            For($A = 0; $A -LT $this.Height; $A++) {
                                [ATCoordinates]$B = [ATCoordinates]@{
                                    Row    = ($this.LeftTop.Row + 1) + $A
                                    Column = $this.LeftTop.Column
                                }
                                $T += "$($Script:CurrentWindowDesign[[WindowBorderPart]::Left])$($B.ToAnsiControlSequenceString())"
                            }

                            Return $T
                        }
                    )
                }
            ))
            $this.BorderDrawDirty[[WindowBorderPartDirty]::Left] = $true
        }

        If($this.BorderDrawDirty[[WindowBorderPartDirty]::Right] -EQ $true) {
            $Br = [ATStringComposite]::new(@(
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = $this.BorderDrawColors[[WindowBorderPart]::Right]
                        Coordinates     = [ATCoordinates]@{
                            Row    = $this.LeftTop.Row + 1
                            Column = $this.RightBottom.Column
                        }
                    }
                    UserData = $(
                        Invoke-Command -ScriptBlock {
                            [String]$T = ''

                            For($A = 0; $A -LT $this.Height; $A++) {
                                [ATCoordinates]$B = [ATCoordinates]@{
                                    Row    = ($this.LeftTop.Row + 1) + $A
                                    Column = $this.RightBottom.Column
                                }
                                $T += "$($Script:CurrentWindowDesign[[WindowBorderPart]::Right])$($B.ToAnsiControlSequenceString())"
                            }

                            Return $T
                        }
                    )
                }
            ))
            $this.BorderDrawDirty[[WindowBorderPartDirty]::Right] = $false
        }

        Write-Host "$($Bt.ToAnsiControlSequenceString())$($Bb.ToAnsiControlSequenceString())$($Bl.ToAnsiControlSequenceString())$($Br.ToAnsiControlSequenceString())"

        If($this.UseTitle -EQ $true) {
            If($this.TitleDirty -EQ $true) {
                [ATString]$A = [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        # ForegroundColor = $this.TitleColor
                        Coordinates = [ATCoordinates]@{
                            Row    = $this.LeftTop.Row
                            Column = $this.LeftTop.Column + 2
                        }
                    }
                    UserData   = $this.Title
                    UseATReset = $true
                }

                Write-Host "$($A.ToAnsiControlSequenceString())"
                $this.TitleDirty = $false
            }
        }
    }

    [Void]UpdateDimensions() {
        $this.Width  = $this.RightBottom.Column - $this.LeftTop.Column
        $this.Height = $this.RightBottom.Row - $this.LeftTop.Row
    }

    [Void]SetupTitle(
        [String]$Title,
        [ConsoleColor24]$Color
    ) {
        $this.UseTitle   = $true
        $this.TitleDirty = $true
        $this.Title      = $Title
        $this.TitleColor = $Color
    }
}





###############################################################################
#
# STATUS WINDOW
#
# USED IN THE WORLD NAVIGATION STATE/SCREEN, THIS WINDOW SHOWS VERY BASIC
# STATISTICS ABOUT THE PLAYER. THE NAME OF THIS OBJECT SHOULD REALLY BE 
# CHANGED TO BETTER REFLECT ITS INTENDED USE. THIS NAME IS A VESTIGE FROM THE
# ORIGINAL CODE BASE.
#
# THIS CODE HAS ALSO BEEN DRAMATICALLY SIMPLIFIED FROM ITS ORIGINAL DESIGN.
# ONE OF THE MAJOR COMPONENTS THAT'S BEEN REMOVED IS CROSS PLATFORM SUPPORT
# IN THE DRAW METHOD. THIS VESTIGE IS NO LONGER NECESSARY SINCE THE CODE WILL
# NO LONGER BE PORTABLE BY DESIGN.
#
###############################################################################
Class StatusWindow : WindowBase {
    Static [Int]$PlayerStatDrawColumn = 3
    Static [Int]$PlayerNameDrawRow    = 2
    Static [Int]$PlayerHpDrawRow      = 4
    Static [Int]$PlayerMpDrawRow      = 6
    Static [Int]$PlayerGoldDrawRow    = 9
    Static [Int]$WindowLTRow          = 1
    Static [Int]$WindowLTColumn       = 1
    Static [Int]$WindowRBRow          = 10
    Static [Int]$WindowRBColumn       = 19

    Static [String]$LineBlank   = '                '
    Static [String]$WindowTitle = 'Status'

    Static [ATCoordinates]$PlayerNameDrawCoordinates = [ATCoordinates]::new([StatusWindow]::PlayerNameDrawRow, [StatusWindow]::PlayerStatDrawColumn)
    Static [ATCoordinates]$PlayerHpDrawCoordinates   = [ATCoordinates]::new([StatusWindow]::PlayerHpDrawRow, [StatusWindow]::PlayerStatDrawColumn)
    Static [ATCoordinates]$PlayerMpDrawCoordinates   = [ATCoordinates]::new([StatusWindow]::PlayerMpDrawRow, [StatusWindow]::PlayerStatDrawColumn)
    Static [ATCoordinates]$PlayerGoldDrawCoordinates = [ATCoordinates]::new([StatusWindow]::PlayerGoldDrawRow, [StatusWindow]::PlayerStatDrawColumn)

    [Boolean]$PlayerNameDrawDirty
    [Boolean]$PlayerHpDrawDirty
    [Boolean]$PlayerMpDrawDirty
    [Boolean]$PlayerGoldDrawDirty

    [ATString]$LineBlankActual

    StatusWindow() : base() {
        $this.LeftTop          = [ATCoordinates]::new([StatusWindow]::WindowLTRow, [StatusWindow]::WindowLTColumn)
        $this.RightBottom      = [ATCoordinates]::new([StatusWindow]::WindowRBRow, [StatusWindow]::WindowRBColumn)

        $this.UpdateDimensions()
        $this.SetupTitle([StatusWindow]::WindowTitle, [CCTextDefault24]::new())

        $this.PlayerNameDrawDirty = $true
        $this.PlayerHpDrawDirty   = $true
        $this.PlayerMpDrawDirty   = $true
        $this.PlayerGoldDrawDirty = $true
        $this.LineBlankActual     = [ATString]@{
            Prefix = [ATStringPrefix]@{
                Coordinates = [ATCoordinates]::new()
            }
            UserData   = "$([StatusWindow]::LineBlank)"
            UseATReset = $true
        }
    }

    [Void]Draw() {
        ([WindowBase]$this).Draw()

        If($this.PlayerNameDrawDirty -EQ $true) {
            [ATString]$A = [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Script:ThePlayer.NameDrawColor
                    Coordinates     = [StatusWindow]::PlayerNameDrawCoordinates
                }
                UserData   = $Script:ThePlayer.Name
                UseATReset = $true
            }
            $this.LineBlankActual.Prefix.Coordinates = [StatusWindow]::PlayerNameDrawCoordinates
            Write-Host "$($this.LineBlankActual.ToAnsiControlSequenceString())$($A.ToAnsiControlSequenceString())"
            $this.PlayerNameDrawDirty = $false
        }

        If($this.PlayerHpDrawDirty -EQ $true) {
            [String]$A               = ''
            [ATStringComposite]$Line = [ATStringComposite]::new(@(
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCTextDefault24]::new()
                        Coordinates     = [StatusWindow]::PlayerHpDrawCoordinates
                    }
                    UserData = 'H '
                },
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [BattleEntityProperty]::StatNumDrawColorSafe
                    }
                    UserData = "$($Script:ThePlayer.Stats[[StatId]::HitPoints].Base)`n`t"
                },
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCTextDefault24]::new()
                    }
                    UserData = '/ '
                },
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [BattleEntityProperty]::StatNumDrawColorSafe
                    }
                    UserData   = "$($Script:ThePlayer.Stats[[StatId]::HitPoints].Max)"
                    UseATReset = $true
                }
            ))

            Switch($Script:ThePlayer.Stats[[StatId]::HitPoints].State) {
                ([StatNumberState]::Normal) {
                    $A += "$($Line.ToAnsiControlSequenceString())"

                    Break
                }

                ([StatNumberState]::Caution) {
                    $Line.CompositeActual[1].Prefix.ForegroundColor = [BattleEntityProperty]::StatNumDrawColorCaution
                    $Line.CompositeActual[3].Prefix.ForegroundColor = [BattleEntityProperty]::StatNumDrawColorCaution
                    $A += "$($Line.ToAnsiControlSequenceString())"

                    Break
                }

                ([StatNumberState]::Danger) {
                    $Line.CompositeActual[1].Prefix.ForegroundColor = [BattleEntityProperty]::StatNumDrawColorDanger
                    $Line.CompositeActual[3].Prefix.ForegroundColor = [BattleEntityProperty]::StatNumDrawColorDanger
                    $A += "$($Line.ToAnsiControlSequenceString())"

                    Break
                }

                Default {
                    $A += "$($Line.ToAnsiControlSequenceString())"

                    Break
                }
            }

            ###################################################################
            #
            # MAKE A FUCKING MENTAL NOTE THAT THIS IS ABSOLUTELY NECESSARY!!!
            #
            # I TOTALLY FORGOT WHY I NEEDED THIS, AND NOW I REMEMBER!
            #
            # IF LINEBLANKACTUAL.PREFIX.COORDINATES IS ASSIGNED TO PLAYERHPDRAWCOORDINATES,
            # THE STATEMENT THAT POSTFIXES THE ROW VALUE WILL MODIFY PLAYERHPDRAWCOORDINATES
            # AND CAUSE SUBSEQUENT DRAWS TO TRAIL DOWN THE SCREEN, WHICH IS TOTAL BULLSHIT!!!
            # IMPLICIT COPY IS TOO MUCH TO ASK EVIDENTLY.
            #
            ###################################################################
            $this.LineBlankActual.Prefix.Coordinates = [ATCoordinates]::new([StatusWindow]::PlayerHpDrawCoordinates)
            Write-Host "$($this.LineBlankActual.ToAnsiControlSequenceString())"
            $this.LineBlankActual.Prefix.Coordinates.Row++
            Write-Host "$($this.LineBlankActual.ToAnsiControlSequenceString())$($A)"
            $this.PlayerHpDrawDirty = $false
        }

        If($this.PlayerMpDrawDirty -EQ $true) {
            [String]$A = ''
            [ATStringComposite]$Line = [ATStringComposite]::new(@(
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCTextDefault24]::new()
                        Coordinates     = [StatusWindow]::PlayerMpDrawCoordinates
                    }
                    UserData = 'M '
                },
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [BattleEntityProperty]::StatNumDrawColorSafe
                    }
                    UserData = "$($Script:ThePlayer.Stats[[StatId]::MagicPoints].Base)`n`t"
                },
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCTextDefault24]::new()
                    }
                    UserData = '/ '
                },
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [BattleEntityProperty]::StatNumDrawColorSafe
                    }
                    UserData   = "$($Script:ThePlayer.Stats[[StatId]::MagicPoints].Max)"
                    UseATReset = $true
                }
            ))

            Switch($Script:ThePlayer.Stats[[StatId]::MagicPoints].State) {
                ([StatNumberState]::Normal) {
                    $A += "$($Line.ToAnsiControlSequenceString())"

                    Break
                }

                ([StatNumberState]::Caution) {
                    $Line.CompositeActual[1].Prefix.ForegroundColor = [BattleEntityProperty]::StatNumDrawColorCaution
                    $Line.CompositeActual[3].Prefix.ForegroundColor = [BattleEntityProperty]::StatNumDrawColorCaution
                    $A += "$($Line.ToAnsiControlSequenceString())"

                    Break
                }

                ([StatNumberState]::Danger) {
                    $Line.CompositeActual[1].Prefix.ForegroundColor = [BattleEntityProperty]::StatNumDrawColorDanger
                    $Line.CompositeActual[3].Prefix.ForegroundColor = [BattleEntityProperty]::StatNumDrawColorDanger
                    $A += "$($Line.ToAnsiControlSequenceString())"

                    Break
                }

                Default {
                    $A += "$($Line.ToAnsiControlSequenceString())"

                    Break
                }
            }

            $this.LineBlankActual.Prefix.Coordinates = [ATCoordinates]::new([StatusWindow]::PlayerMpDrawCoordinates)
            Write-Host "$($this.LineBlankActual.ToAnsiControlSequenceString())"
            $this.LineBlankActual.Prefix.Coordinates.Row++
            Write-Host "$($this.LineBlankActual.ToAnsiControlSequenceString())$($a)"
            $this.PlayerMpDrawDirty = $false
        }

        If($this.PlayerGoldDrawDirty -EQ $true) {
            [ATStringComposite]$Line = [ATStringComposite]::new(@(
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [Player]::GoldDrawColor
                        Coordinates     = [StatusWindow]::PlayerGoldDrawCoordinates
                    }
                    UserData = "$($Script:ThePlayer.CurrentGold)"
                },
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCTextDefault24]::new()
                    }
                    UserData   = 'G'
                    UseATReset = $true
                }
            ))

            $this.LineBlankActual.Prefix.Coordinates = [ATCoordinates]::new([StatusWindow]::PlayerGoldDrawCoordinates)
            Write-Host "$($this.LineBlankActual.ToAnsiControlSequenceString())$($Line.ToAnsiControlSequenceString())"
            $this.PlayerGoldDrawDirty = $false
        }
    }
}





###############################################################################
#
# COMMAND WINDOW
#
# THIS IS THE WINDOW THAT ALLOWS THE USER TO INPUT COMMANDS AND ALSO SHOWS THE
# COMMAND HISTORY (FIVE MOST RECENT COMMANDS). 
#
###############################################################################
Class CommandWindow : WindowBase {
    Static [Int]$CommandHistoryARef    = 0
    Static [Int]$CommandHistoryBRef    = 1
    Static [Int]$CommandHistoryCRef    = 2
    Static [Int]$CommandHistoryDRef    = 3
    Static [Int]$CommandHistoryERef    = 4
    Static [Int]$WindowLTRow           = 12
    Static [Int]$WindowLTColumn        = 1
    Static [Int]$WindowRBRow           = 20
    Static [Int]$WindowRBColumn        = 19
    Static [Int]$DrawColumnOffset      = 1
    Static [Int]$DrawDivRowOffset      = 2
    Static [Int]$DrawHistoryDRowOffset = 3
    Static [Int]$DrawHistoryCRowOffset = 4
    Static [Int]$DrawHistoryBRowOffset = 5
    Static [Int]$DrawHistoryARowOffset = 6
    Static [Int]$DrawHistoryERowOffset = 7

    Static [String]$CommandBlankData = '                 '
    Static [String]$WindowCommandDiv = '─────────────────'
    Static [String]$WindowTitle      = 'Commands'

    Static [ATCoordinates]$CommandDivDrawCoordinates      = [ATCoordinatesNone]::new()
    Static [ATCoordinates]$CommandHistoryEDrawCoordinates = [ATCoordinatesNone]::new()
    Static [ATCoordinates]$CommandHistoryDDrawCoordinates = [ATCoordinatesNone]::new()
    Static [ATCoordinates]$CommandHistoryCDrawCoordinates = [ATCoordinatesNone]::new()
    Static [ATCoordinates]$CommandHistoryBDrawCoordinates = [ATCoordinatesNone]::new()
    Static [ATCoordinates]$CommandHistoryADrawCoordinates = [ATCoordinatesNone]::new()

    Static [ConsoleColor24]$HistoryEntryValid   = [CCAppleNGreenLight24]::new()
    Static [ConsoleColor24]$HistoryEntryError   = [CCAppleNRedLight24]::new()
    Static [ConsoleColor24]$HistoryBlankColor   = [CCBlack24]::new()
    Static [ConsoleColor24]$CommandDivDrawColor = [CCTextDefault24]::new()
    Static [ATString]$CommandDiv                = [ATStringNone]::new()
    Static [ATString]$CommandBlank              = [ATStringNone]::new()
    Static [ATString]$CommandHistBlank          = [ATStringNone]::new()

    [ATString]$CommandActual
    [ATString[]]$CommandHistory

    [Boolean]$CommandDivDirty
    [Boolean]$CommandHistoryDirty

    CommandWindow() : base() {
        $this.LeftTop          = [ATCoordinates]::new([CommandWindow]::WindowLTRow, [CommandWindow]::WindowLTColumn)
        $this.RightBottom      = [ATCoordinates]::new([CommandWindow]::WindowRBRow, [CommandWindow]::WindowRBColumn)

        $this.UpdateDimensions()
        $this.SetupTitle([CommandWindow]::WindowTitle, [CCTextDefault24]::new())

        $this.CommandDivDirty     = $true
        $this.CommandHistoryDirty = $false
        [Int]$rowBase             = $this.RightBottom.Row
        [Int]$columnBase          = $this.LeftTop.Column + [CommandWindow]::DrawColumnOffset

        [CommandWindow]::CommandDivDrawCoordinates = [ATCoordinates]@{
            Row    = ($rowBase - [CommandWindow]::DrawDivRowOffset)
            Column = $columnBase
        }
        [CommandWindow]::CommandHistoryEDrawCoordinates = [ATCoordinates]@{
            Row    = $rowBase - [CommandWindow]::DrawHistoryERowOffset
            Column = $columnBase
        }
        [CommandWindow]::CommandHistoryDDrawCoordinates = [ATCoordinates]@{
            Row    = $rowBase - [CommandWindow]::DrawHistoryDRowOffset
            Column = $columnBase
        }
        [CommandWindow]::CommandHistoryCDrawCoordinates = [ATCoordinates]@{
            Row    = $rowBase - [CommandWindow]::DrawHistoryCRowOffset
            Column = $columnBase
        }
        [CommandWindow]::CommandHistoryBDrawCoordinates = [ATCoordinates]@{
            Row    = $rowBase - [CommandWindow]::DrawHistoryBRowOffset
            Column = $columnBase
        }
        [CommandWindow]::CommandHistoryADrawCoordinates = [ATCoordinates]@{
            Row    = $rowBase - [CommandWindow]::DrawHistoryARowOffset
            Column = $columnBase
        }

        [CommandWindow]::CommandDiv = [ATString]@{
            Prefix = [ATStringPrefix]@{
                ForegroundColor = [CommandWindow]::CommandDivDrawColor
                Coordinates     = [CommandWindow]::CommandDivDrawCoordinates
            }
            UserData   = "$([CommandWindow]::WindowCommandDiv)"
            UseATReset = $true
        }
        [CommandWindow]::CommandBlank = [ATString]@{
            Prefix = [ATStringPrefix]@{
                ForegroundColor = [CommandWindow]::HistoryBlankColor
            }
            UserData   = "$([CommandWindow]::CommandBlankData)"
            UseATReset = $true
        }
        [CommandWindow]::CommandHistBlank = [ATString]@{
            Prefix = [ATStringPrefix]@{
                ForegroundColor = [CommandWindow]::HistoryBlankColor
            }
            UserData   = "$([CommandWindow]::CommandBlankData)"
            UseATReset = $true
        }

        $this.CommandActual                                       = [ATStringNone]::new()
        $this.CommandHistory                                      = New-Object 'ATString[]' 5
        $this.CommandHistory[[CommandWindow]::CommandHistoryARef] = [ATString]@{
            Prefix = [ATStringPrefix]@{
                ForegroundColor = [CCTextDefault24]::new()
                Coordinates     = [CommandWindow]::CommandHistoryADrawCoordinates
            }
            UserData   = "$([CommandWindow]::CommandBlank.UserData)"
            UseATReset = $true
        }
        $this.CommandHistory[[CommandWindow]::CommandHistoryBRef] = [ATString]@{
            Prefix = [ATStringPrefix]@{
                ForegroundColor = [CCTextDefault24]::new()
                Coordinates     = [CommandWindow]::CommandHistoryBDrawCoordinates
            }
            UserData   = "$([CommandWindow]::CommandBlank.UserData)"
            UseATReset = $true
        }
        $this.CommandHistory[[CommandWindow]::CommandHistoryCRef] = [ATString]@{
            Prefix = [ATStringPrefix]@{
                ForegroundColor = [CCTextDefault24]::new()
                Coordinates     = [CommandWindow]::CommandHistoryCDrawCoordinates
            }
            UserData   = "$([CommandWindow]::CommandBlank.UserData)"
            UseATReset = $true
        }
        $this.CommandHistory[[CommandWindow]::CommandHistoryDRef] = [ATString]@{
            Prefix = [ATStringPrefix]@{
                ForegroundColor = [CCTextDefault24]::new()
                Coordinates     = [CommandWindow]::CommandHistoryDDrawCoordinates
            }
            UserData   = "$([CommandWindow]::CommandBlank.UserData)"
            UseATReset = $true
        }
        $this.CommandHistory[[CommandWindow]::CommandHistoryERef] = [ATString]@{
            Prefix = [ATStringPrefix]@{
                ForegroundColor = [CCTextDefault24]::new()
                Coordinates     = [CommandWindow]::CommandHistoryEDrawCoordinates
            }
            UserData   = "$([CommandWindow]::CommandBlank.UserData)"
            UseATReset = $true
        }
    }

    [Void]Draw() {
        ([WindowBase]$this).Draw()
        If($this.CommandDivDirty -EQ $true) {
            Write-Host "$([CommandWindow]::CommandDiv.ToAnsiControlSequenceString())"
            $this.CommandDivDirty = $false
        }
        If($this.CommandHistoryDirty -EQ $true) {
            [CommandWindow]::CommandHistBlank.Prefix.Coordinates = [CommandWindow]::CommandHistoryDDrawCoordinates
            Write-Host "$([CommandWindow]::CommandHistBlank.ToAnsiControlSequenceString())$($this.CommandHistory[[CommandWindow]::CommandHistoryDRef].ToAnsiControlSequenceString())"
            [CommandWindow]::CommandHistBlank.Prefix.Coordinates = [CommandWindow]::CommandHistoryCDrawCoordinates
            Write-Host "$([CommandWindow]::CommandHistBlank.ToAnsiControlSequenceString())$($this.CommandHistory[[CommandWindow]::CommandHistoryCRef].ToAnsiControlSequenceString())"
            [CommandWindow]::CommandHistBlank.Prefix.Coordinates = [CommandWindow]::CommandHistoryBDrawCoordinates
            Write-Host "$([CommandWindow]::CommandHistBlank.ToAnsiControlSequenceString())$($this.CommandHistory[[CommandWindow]::CommandHistoryBRef].ToAnsiControlSequenceString())"
            [CommandWindow]::CommandHistBlank.Prefix.Coordinates = [CommandWindow]::CommandHistoryADrawCoordinates
            Write-Host "$([CommandWindow]::CommandHistBlank.ToAnsiControlSequenceString())$($this.CommandHistory[[CommandWindow]::CommandHistoryARef].ToAnsiControlSequenceString())"
            [CommandWindow]::CommandHistBlank.Prefix.Coordinates = [CommandWindow]::CommandHistoryEDrawCoordinates
            Write-Host "$([CommandWindow]::CommandHistBlank.ToAnsiControlSequenceString())$($this.CommandHistory[[CommandWindow]::CommandHistoryERef].ToAnsiControlSequenceString())"
            $this.CommandHistoryDirty = $false
        }
    }

    [Void]HandleInput() {
        $Script:Rui.CursorPosition = $Script:DefaultCursorCoordinates.ToAutomationCoordinates()
        $keyCap = $Script:Rui.ReadKey('IncludeKeyDown')
        While($keyCap.VirtualKeyCode -NE 13) {
            $cpx = $Script:Rui.CursorPosition.X
            If($cpx -GE 18) {
                Break
            }
            Switch($keyCap.VirtualKeyCode) {
                8 { # Backspace
                    $fpx = $Script:Rui.CursorPosition.X
                    If($fpx -GT $Script:DefaultCursorCoordinates.Row) {
                        Write-Host " `b" -NoNewLine
                        If($this.CommandActual.UserData.Length -GT 0) {
                            $this.CommandActual.UserData = $this.CommandActual.UserData.Remove($this.CommandActual.UserData.Length - 1, 1)
                        }
                    } Elseif($fpx -LT $Script:DefaultCursorCoordinates.Row) {
                        $Script:Rui.CursorPosition = $Script:DefaultCursorCoordinates.ToAutomationCoordinates()
                    } Elseif($fpx -EQ $Script:DefaultCursorCoordinates.Row) {
                        Write-Host " `b" -NoNewline
                        If($this.CommandActual.UserData.Length -GT 0) {
                            $this.CommandActual.UserData = $this.CommandActual.UserData.Remove($this.CommandActual.UserData.Length - 1, 1)
                        }
                    }
                }

                Default {
                    $this.CommandActual.UserData += $keyCap.Character
                }
            }
            $keyCap = $Script:Rui.ReadKey('IncludeKeyDown')
        }
        $this.InvokeCommandParser()
    }

    [Void]InvokeCommandParser() {
        $Script:Rui.CursorPosition = $Script:DefaultCursorCoordinates.ToAutomationCoordinates()
        Write-Host "$([CommandWindow]::CommandBlank.ToAnsiControlSequenceString())" -NoNewline
        $Script:Rui.CursorPosition = $Script:DefaultCursorCoordinates.ToAutomationCoordinates()

        If([String]::IsNullOrEmpty($this.CommandActual.UserData.Trim()) -EQ $true) {
            $Script:TheMessageWindow.WriteBadCommandRetortMessage()
            $this.CommandActual.UserData = ''

            Return
        } Else {
            $cmdactSplit = $this.CommandActual.UserData.Trim()
            $cmdactSplit = -SPLIT $this.CommandActual.UserData
            $rootFound   = $Script:TheCommandTable.GetEnumerator() | Where-Object { $_.Name -IEQ $cmdactSplit[0] }
            If($null -NE $rootFound) {
                Switch($cmdactSplit.Length) {
                    1 {
                        Invoke-Command $rootFound.Value
                    }

                    2 {
                        Invoke-Command $rootFound.Value -ArgumentList $cmdactSplit[1]
                    }

                    3 {
                        Invoke-Command $rootFound.Value -ArgumentList $cmdactSplit[1], $cmdactSplit[2]
                    }

                    Default {
                        $Script:TheCommandWindow.UpdateCommandHistory($false)
                        $Script:TheMessageWindow.WriteBadCommandRetortMessage()
                    }
                }
            } Else {
                $Script:TheCommandWindow.UpdateCommandHistory($false)
                $Script:TheMessageWindow.WriteBadCommandRetortMessage()

                Return
            }
        }
    }

    [Void]UpdateCommandHistory(
        [Boolean]$CmdValid
    ) {
        $this.CommandHistory[[CommandWindow]::CommandHistoryERef].UserData               = $this.CommandHistory[[CommandWindow]::CommandHistoryARef].UserData
        $this.CommandHistory[[CommandWindow]::CommandHistoryERef].Prefix.Decorations     = $this.CommandHistory[[CommandWindow]::CommandHistoryARef].Prefix.Decorations
        $this.CommandHistory[[CommandWindow]::CommandHistoryERef].Prefix.ForegroundColor = $this.CommandHistory[[CommandWindow]::CommandHistoryARef].Prefix.ForegroundColor
        $this.CommandHistory[[CommandWindow]::CommandHistoryARef].UserData               = $this.CommandHistory[[CommandWindow]::CommandHistoryBRef].UserData
        $this.CommandHistory[[CommandWindow]::CommandHistoryARef].Prefix.Decorations     = $this.CommandHistory[[CommandWindow]::CommandHistoryBRef].Prefix.Decorations
        $this.CommandHistory[[CommandWindow]::CommandHistoryARef].Prefix.ForegroundColor = $this.CommandHistory[[CommandWindow]::CommandHistoryBRef].Prefix.ForegroundColor
        $this.CommandHistory[[CommandWindow]::CommandHistoryBRef].UserData               = $this.CommandHistory[[CommandWindow]::CommandHistoryCRef].UserData
        $this.CommandHistory[[CommandWindow]::CommandHistoryBRef].Prefix.Decorations     = $this.CommandHistory[[CommandWindow]::CommandHistoryCRef].Prefix.Decorations
        $this.CommandHistory[[CommandWindow]::CommandHistoryBRef].Prefix.ForegroundColor = $this.CommandHistory[[CommandWindow]::CommandHistoryCRef].Prefix.ForegroundColor
        $this.CommandHistory[[CommandWindow]::CommandHistoryCRef].UserData               = $this.CommandHistory[[CommandWindow]::CommandHistoryDRef].UserData
        $this.CommandHistory[[CommandWindow]::CommandHistoryCRef].Prefix.Decorations     = $this.CommandHistory[[CommandWindow]::CommandHistoryDRef].Prefix.Decorations
        $this.CommandHistory[[CommandWindow]::CommandHistoryCRef].Prefix.ForegroundColor = $this.CommandHistory[[CommandWindow]::CommandHistoryDRef].Prefix.ForegroundColor
        $this.CommandHistory[[CommandWindow]::CommandHistoryDRef].UserData               = $this.CommandActual.UserData
        If($CmdValid -EQ $true) {
            $this.CommandHistory[[CommandWindow]::CommandHistoryDRef].Prefix.ForegroundColor = [CommandWindow]::HistoryEntryValid
            $this.CommandHistory[[CommandWindow]::CommandHistoryDRef].Prefix.Decorations     = [ATDecorationNone]::new()
        } Else {
            $this.CommandHistory[[CommandWindow]::CommandHistoryDRef].Prefix.ForegroundColor = [CommandWindow]::HistoryEntryError
            $this.CommandHistory[[CommandWindow]::CommandHistoryDRef].Prefix.Decorations = [ATDecoration]@{
                Blink = $true
            }
        }
        $this.CommandActual.UserData = ''
        $this.CommandHistoryDirty    = $true
    }
}





###############################################################################
#
# SCENE WINDOW
#
# THIS WINDOW DISPLAYS AN IMAGE FOR THE CURRENT MAP TILE. THIS IS A VISUAL
# HACK TO GIVE A VISUAL FLAIR TO THE PROGRAM.
#
###############################################################################
Class SceneWindow : WindowBase {
    Static [Int]$WindowLTRow           = 1
    Static [Int]$WindowLTColumn        = 30
    Static [Int]$WindowRBRow           = 20
    Static [Int]$WindowRBColumn        = 79
    Static [Int]$ImageDrawRowOffset    = [SceneWindow]::WindowLTRow + 1
    Static [Int]$ImageDrawColumnOffset = [SceneWindow]::WindowLTColumn + 1

    Static [String]$WindowTitle = 'Scene'

    Static [ATCoordinates]$SceneImageDrawCoordinates = [ATCoordinatesNone]::new()

    [Boolean]$SceneImageDirty
    [SceneImage]$Image

    SceneWindow() : base() {
        $this.LeftTop     = [ATCoordinates]::new([SceneWindow]::WindowLTRow, [SceneWindow]::WindowLTColumn)
        $this.RightBottom = [ATCoordinates]::new([SceneWindow]::WindowRBRow, [SceneWindow]::WindowRBColumn)

        $this.UpdateDimensions()
        $this.SetupTitle([SceneWindow]::WindowTitle, [CCTextDefault24]::new())

        $this.SceneImageDirty = $true
        $this.Image           = [SIEmpty]::new()

        [SceneWindow]::SceneImageDrawCoordinates = [ATCoordinates]@{
            Row    = [SceneWindow]::ImageDrawRowOffset
            Column = [SceneWindow]::ImageDrawColumnOffset
        }
    }

    [Void]Draw() {
        ([WindowBase]$this).Draw()

        If($this.SceneImageDirty -EQ $true) {
            # THRE MAY BE AN OPPORTUNITY TO DO SOMETHING A BIT DIFFERENT HERE
            $this.Image = $Script:CurrentMap.GetTileAtPlayerCoordinates().BackgroundImage
            Write-Host "$($this.Image.ToAnsiControlSequenceString())"
            $this.SceneImageDirty = $false
        }
    }

    [Void]UpdateCurrentImage(
        [SceneImage]$NewImage
    ) {
        $this.Image           = $NewImage
        $this.SceneImageDirty = $true
    }
}





###############################################################################
#
# MESSAGE WINDOW
#
# THIS WINDOW DISPLAYS MESSAGES IN THE MAP NAVIGATION SCREEN.
#
###############################################################################
Class MessageWindow : WindowBase {
    Static [Int]$MessageHistoryARef = 0
    Static [Int]$MessageHistoryBRef = 1
    Static [Int]$MessageHistoryCRef = 2
    Static [Int]$WindowLTRow        = 21
    Static [Int]$WindowLTColumn     = 1
    Static [Int]$WindowRBRow        = 25
    Static [Int]$WindowRBColumn     = 79

    Static [String]$WindowTitle = 'Messages'

    Static [ATCoordinates]$MessageADrawCoordinates = [ATCoordinatesNone]::new()
    Static [ATCoordinates]$MessageBDrawCoordinates = [ATCoordinatesNone]::new()
    Static [ATCoordinates]$MessageCDrawCoordinates = [ATCoordinatesNone]::new()

    Static [ATString]$MessageWindowBlank = [ATStringNone]::new()

    [ATStringComposite[]]$MessageHistory

    [Boolean]$MessageADirty
    [Boolean]$MessageBDirty
    [Boolean]$MessageCDirty

    MessageWindow() : base() {
        $this.LeftTop     = [ATCoordinates]::new([MessageWindow]::WindowLTRow, [MessageWindow]::WindowLTColumn)
        $this.RightBottom = [ATCoordinates]::new([MessageWindow]::WindowRBRow, [MessageWindow]::WindowRBColumn)

        $this.UpdateDimensions()
        $this.SetupTitle([MessageWindow]::WindowTitle, [CCTextDefault24]::new())

        [MessageWindow]::MessageCDrawCoordinates = [ATCoordinates]@{
            Row    = ($this.RightBottom.Row - 1)
            Column = ($this.LeftTop.Column + 1)
        }
        [MessageWindow]::MessageBDrawCoordinates = [ATCoordinates]@{
            Row    = ([MessageWindow]::MessageCDrawCoordinates.Row - 1)
            Column = ($this.LeftTop.Column + 1)
        }
        [MessageWindow]::MessageADrawCoordinates = [ATCoordinates]@{
            Row    = ([MessageWindow]::MessageBDrawCoordinates.Row - 1)
            Column = ($this.LeftTop.Column + 1)
        }
        [MessageWindow]::MessageWindowBlank = [ATString]@{
            Prefix     = [ATStringPrefix]::new()
            UserData   = '                                                                             '
            UseATReset = $true
        }
        $this.MessageHistory = @(
            [ATStringComposite]::new(),
            [ATStringComposite]::new(),
            [ATStringComposite]::new()
        )
        $this.MessageHistory[[MessageWindow]::MessageHistoryARef].CompositeActual[0].Prefix.Coordinates = [MessageWindow]::MessageADrawCoordinates
        $this.MessageHistory[[MessageWindow]::MessageHistoryBRef].CompositeActual[0].Prefix.Coordinates = [MessageWindow]::MessageBDrawCoordinates
        $this.MessageHistory[[MessageWindow]::MessageHistoryCRef].CompositeActual[0].Prefix.Coordinates = [MessageWindow]::MessageCDrawCoordinates
    }

    [Void]Draw() {
        ([WindowBase]$this).Draw()

        If($this.MessageADirty -EQ $true) {
            [MessageWindow]::MessageWindowBlank.Prefix.Coordinates = [MessageWindow]::MessageADrawCoordinates
            Write-Host "$([MessageWindow]::MessageWindowBlank.ToAnsiControlSequenceString())$([MessageWindow]::MessageADrawCoordinates.ToAnsiControlSequenceString())$($this.MessageHistory[[MessageWindow]::MessageHistoryARef].ToAnsiControlSequenceString())"
            $this.MessageADirty = $false
        }
        If($this.MessageBDirty -EQ $true) {
            [MessageWindow]::MessageWindowBlank.Prefix.Coordinates = [MessageWindow]::MessageBDrawCoordinates
            Write-Host "$([MessageWindow]::MessageWindowBlank.ToAnsiControlSequenceString())$([MessageWindow]::MessageBDrawCoordinates.ToAnsiControlSequenceString())$($this.MessageHistory[[MessageWindow]::MessageHistoryBRef].ToAnsiControlSequenceString())"
            $this.MessageBDirty = $false
        }
        If($this.MessageCDirty -EQ $true) {
            [MessageWindow]::MessageWindowBlank.Prefix.Coordinates = [MessageWindow]::MessageCDrawCoordinates
            Write-Host "$([MessageWindow]::MessageWindowBlank.ToAnsiControlSequenceString())$([MessageWindow]::MessageCDrawCoordinates.ToAnsiControlSequenceString())$($this.MessageHistory[[MessageWindow]::MessageHistoryCRef].ToAnsiControlSequenceString())"
            $this.MessageCDirty = $false
        }
    }

    [Void]WriteMessageComposite(
        [ATString[]]$Composite
    ) {
        $this.MessageHistory[[MessageWindow]::MessageHistoryARef].CompositeActual = [List[ATString]]::new($this.MessageHistory[[MessageWindow]::MessageHistoryBRef].CompositeActual)
        $this.MessageHistory[[MessageWindow]::MessageHistoryBRef].CompositeActual = [List[ATString]]::new($this.MessageHistory[[MessageWindow]::MessageHistoryCRef].CompositeActual)
        $this.MessageHistory[[MessageWindow]::MessageHistoryCRef].CompositeActual = [List[ATString]]::new($Composite)
        $this.MessageADirty                                                       = $true
        $this.MessageBDirty                                                       = $true
        $this.MessageCDirty                                                       = $true
    }

    [Void]WriteBadCommandMessage(
        [String]$Command
    ) {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleRedDark24]::new()
                    Decorations     = [ATDecoration]@{
                        Blink = $true
                    }
                }
                UserData   = "$($Command)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' isn''t a valid command.'
                UseATReset = $true
            }
        ))
    }

    [Void]WriteBadArg0Message(
        [String]$Command,
        [String]$Arg0
    ) {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = 'We can''t '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleYellowDark24]::new()
                    Decorations     = [ATDecoration]@{
                        Blink = $true
                    }
                }
                UserData   = "$($Command)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' with a(n) '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                    Decorations     = [ATDecoration]@{
                        Blink = $true
                    }
                }
                UserData   = "$($Arg0)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = '.'
                UseATReset = $true
            }
        ))
    }

    [Void]WriteBadArg1Message(
        [String]$Command,
        [String]$Arg0,
        [String]$Arg1
    ) {
		$this.WriteMessageComposite(@(
			[ATString]@{
				Prefix = [ATStringPrefix]@{
					ForegroundColor = [CCTextDefault24]::new()
				}
				UserData   = 'We can''t '
				UseATReset = $true
			},
			[ATString]@{
				Prefix = [ATStringPrefix]@{
					ForegroundColor = [CCAppleYellowDark24]::new()
					Decorations     = [ATDecoration]@{
						Blink = $true
					}
				}
				UserData   = "$($Command)"
				UseATReset = $true
			},
			[ATString]@{
				Prefix = [ATStringPrefix]@{
					ForegroundColor = [CCTextDefault24]::new()
				}
				UserData   = ' with a(n) '
				UseATReset = $true
			},
			[ATString]@{
				Prefix = [ATStringPrefix]@{
					ForegroundColor = [CCAppleYellowDark24]::new()
					Decorations     = [ATDecoration]@{
						Blink = $true
					}
				}
				UserData   = "$($Arg0)"
				UseATReset = $true
			},
			[ATString]@{
				Prefix = [ATStringPrefix]@{
					ForegroundColor = [CCTextDefault24]::new()
				}
				UserData   = ' and a(n) '
				UseATReset = $true
			},
			[ATString]@{
				Prefix = [ATStringPrefix]@{
					ForegroundColor = [CCAppleYellowDark24]::new()
					Decorations     = [ATDecoration]@{
						Blink = $true
					}
				}
				UserData   = "$($Arg1)"
				UseATReset = $true
			},
			[ATString]@{
				Prefix = [ATStringPrefix]@{
					ForegroundColor = [CCTextDefault24]::new()
				}
				UserData   = '.'
				UseATReset = $true
			}
		))
    }

    [Void]WriteSomethingBadMessage() {
		$this.WriteMessageComposite(@(
			[ATString]@{
				Prefix = [ATStringPrefix]@{
					ForegroundColor = [CCTextDefault24]::new()
				}
				UserData   = 'I''m God, and I don''t know what just happened...'
				UseATReset = $true
			}
		))
    }

    [Void]WriteInvisibleWallEncounteredMessage() {
		$this.WriteMessageComposite(@(
			[ATString]@{
				Prefix = [ATStringPrefix]@{
					ForegroundColor = [CCTextDefault24]::new()
				}
				UserData   = 'The invisible wall blocks your path...'
				UseATReset = $true
			}
		))
    }

    [Void]WriteYouShallNotPassMessage() {
		$this.WriteMessageComposite(@(
			[ATString]@{
				Prefix = [ATStringPrefix]@{
					ForegroundColor = [CCTextDefault24]::new()
				}
				UserData   = 'The path you asked for is impossible...'
				UseATReset = $true
			}
		))
    }

    [Void]WriteMapNoItemsFoundMessage() {
		$this.WriteMessageComposite(@(
			[ATString]@{
				Prefix = [ATStringPrefix]@{
					ForegroundColor = [CCTextDefault24]::new()
				}
				UserData   = 'There''s nothing of interest here.'
				UseATReset = $true
			}
		))
    }

    [Void]WriteMapInvalidItemMessage(
        [String]$ItemName
    ) {
		$this.WriteMessageComposite(@(
			[ATString]@{
				Prefix = [ATStringPrefix]@{
					ForegroundColor = [CCTextDefault24]::new()
				}
				UserData   = 'There''s no '
				UseATReset = $true
			},
			[ATString]@{
				Prefix = [ATStringPrefix]@{
					ForegroundColor = [CCAppleYellowDark24]::new()
					Decorations     = [ATDecoration]@{
						Blink = $true
					}
				}
				UserData   = "$($ItemName)"
				UseATReset = $true
			},
			[ATString]@{
				Prefix = [ATStringPrefix]@{
					ForegroundColor = [CCTextDefault24]::new()
				}
				UserData   = ' here.'
				UseATReset = $true
			}
		))
    }

    [Void]WriteItemTakenMessage(
        [String]$ItemName
    ) {
		$this.WriteMessageComposite(@(
			[ATString]@{
				Prefix = [ATStringPrefix]@{
					ForegroundColor = [CCTextDefault24]::new()
				}
				UserData   = 'I''ve taken the '
				UseATReset = $true
			},
			[ATString]@{
				Prefix = [ATStringPrefix]@{
					ForegroundColor = [CCAppleYellowDark24]::new()
					Decorations     = [ATDecoration]@{
						Blink = $true
					}
				}
				UserData   = "$($ItemName)"
				UseATReset = $true
			},
			[ATString]@{
				Prefix = [ATStringPrefix]@{
					ForegroundColor = [CCTextDefault24]::new()
				}
				UserData   = ' and put it in my pocket.'
				UseATReset = $true
			}
		))
    }

    [Void]WriteItemCantTakeMessage(
        [String]$ItemName
    ) {
		$this.WriteMessageComposite(@(
			[ATString]@{
				Prefix = [ATStringPrefix]@{
					ForegroundColor = [CCTextDefault24]::new()
				}
				UserData   = 'It''s not possible to take the '
				UseATReset = $true
			},
			[ATString]@{
				Prefix = [ATStringPrefix]@{
					ForegroundColor = [CCAppleYellowDark24]::new()
					Decorations     = [ATDecoration]@{
						Blink = $true
					}
				}
				UserData   = "$($ItemName)"
				UseATReset = $true
			},
			[ATString]@{
				Prefix = [ATStringPrefix]@{
					ForegroundColor = [CCTextDefault24]::new()
				}
				UserData   = '.'
				UseATReset = $true
			}
		))
    }

    [Void]WriteCmdExtraArgsWarning(
        [String]$Command,
        [String[]]$ExtraArgs
    ) {
		$this.WriteMessageComposite(@(
			[ATString]@{
				Prefix = [ATStringPrefix]@{
					ForegroundColor = [CCAppleNPinkLight24]::new()
					Decorations     = [ATDecoration]@{
						Blink = $true
					}
				}
				UserData   = "$($Command)"
				UseATReset = $true
			},
			[ATString]@{
				Prefix = [ATStringPrefix]@{
					ForegroundColor = [CCTextDefault24]::new()
				}
				UserData   = ' has garbage: '
				UseATReset = $true
			},
			[ATString]@{
				Prefix = [ATStringPrefix]@{
					ForegroundColor = [CCAppleNYellowDark24]::new()
					Decorations     = [ATDecoration]@{
						Blink = $true
					}
				}
				UserData   = "$($ExtraArgs)"
				UseATReset = $true
			}
		))
    }

    [Void]WriteBadCommandRetortMessage() {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleNRedDark24]::new()
                }
                UserData   = "$($Script:BadCommandRetorts | Get-Random)"
                UseATReset = $true
            }
        ))
    }

    [Void]WriteCantUseItemMessage(
        [String]$Source,
        [String]$Target
    ) {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleRedDark24]::new()
                }
                UserData   = 'Can''t use a(n) '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleYellowDark24]::new()
                }
                UserData   = "$($Source)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleRedDark24]::new()
                }
                UserData   = ' on a(n) '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleYellowDark24]::new()
                }
                UserData   = "$($Target)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleRedDark24]::new()
                }
                UserData   = '.'
                UseATReset = $true
            }
        ))
    }

    [Void]WriteCantUseItemOnSelfMessage(
        [String]$ItemName
    ) {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleRedDark24]::new()
                }
                UserData   = 'I can''t use '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleYellowDark24]::new()
                }
                UserData   = "$($ItemName)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleRedDark24]::new()
                }
                UserData   = ' on myself.'
                UseATReset = $true
            }
        ))
    }

    [Void]WriteNoItemInInvMessage(
        [String]$DesiredItem
    ) {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleRedDark24]::new()
                }
                UserData   = 'There ain''t no '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleYellowDark24]::new()
                }
                UserData   = "$($DesiredItem)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleRedDark24]::new()
                }
                UserData   = ' in your pockets guv''.'
                UseATReset = $true
            }
        ))
    }

    [Void]WriteNoItemTargetMessage(
        [String]$Source
    ) {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleRedDark24]::new()
                }
                UserData   = 'You need to tell me what you want to use the '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleYellowDark24]::new()
                }
                UserData   = "$($Source)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleRedDark24]::new()
                }
                UserData   = ' on.'
                UseATReset = $true
            }
        ))
    }

    [Void]WriteItemUseUnsureMessage(
        [String]$Target
    ) {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleRedDark24]::new()
                }
                UserData   = 'I have no idea how to use a(n) '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleYellowDark24]::new()
                }
                UserData   = "$($Target)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleRedDark24]::new()
                }
                UserData   = '.'
                UseATReset = $true
            }
        ))
    }

    [Void]WriteCantDropMultMessage() {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleYellowDark24]::new()
                }
                UserData   = 'Can''t drop all those items at once, bruh.'
                UseATReset = $true
            }
        ))
    }

    [Void]WriteItemDroppedMessage(
        [String]$ItemName
    ) {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = 'Dropped '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleYellowDark24]::new()
                }
                UserData   = "$($ItemName)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' from your inventory.'
                UseATReset = $true
            }
        ))
    }

    [Void]WriteMilkUseOkayMessage() {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = 'Hmmm. Delicious cow juice.'
                UseATReset = $true
            }
        ))
    }

    [Void]WriteMilkUseSpoiledMessage() {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = 'Now that wasn''t very smart, was it?'
                UseATReset = $true
            }
        ))
    }

    [Void]WriteMilkUseNotNowMessage() {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = 'There''s no need to drink this now.'
                UseATReset = $true
            }
        ))
    }

    [Void]WriteTiedRopeToTreeMessage() {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = 'I''ve tied the '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleYellowDark24]::new()
                }
                UserData   = 'Rope'
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' to the '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleYellowDark24]::new()
                }
                UserData   = 'Tree'
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = '.'
                UseATReset = $true
            }
        ))
    }

    [Void]WriteLookMessage(
        [String]$ItemSetA,
        [String]$ItemSetB,
        [Boolean]$UseSetB
    ) {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = 'I can see the following things here:'
                UseATReset = $true
            }
        ))
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleYellowLight24]::new()
                }
                UserData   = "$($ItemSetA)"
                UseATReset = $true
            }
        ))
        If($UseSetB -EQ $true) {
            $this.WriteMessageComposite(@(
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCAppleYellowLight24]::new()
                    }
                    UserData   = "$($ItemSetB)"
                    UseATReset = $true
                }
            ))
        }
    }

    [Void]WriteItemExamineMessage(
        [String]$ExamineString
    ) {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleMintDark24]::new()
                }
                UserData   = "$($ExamineString)"
                UseATReset = $true
            }
        ))
    }
}





###############################################################################
#
# INVENTORY WINDOW
#
# AS WITH OTHER CLASSES, THE NAME OF THIS CLASS IS A BIT OF A MISNOMER.
# SPECIFICALLY, THIS CLASS INCORPORATES MULTIPLE WINDOWS TOGETHER INTO A SINGLE
# SCREEN. ALSO, THIS INVENTORY COVERS THE PLAYER'S ITEM INVENTORY AND NOT THE
# BATTLE ACTION INVENTORY, SO THERE'S A BIT TO BE DESIRED HERE. THIS WILL BE
# WORKED ON AFTER COVERAGE IS COMPLETED.
#
###############################################################################
Class InventoryWindow : WindowBase {
    Static [Int]$WindowLTRow    = 1
    Static [Int]$WindowLTColumn = 1
    Static [Int]$WindowBRRow    = 20
    Static [Int]$WindowBRColumn = 79

    Static [String]$WindowTitle = 'Inventory'

    Static [String]$IChevronCharacter           = '❱'
    Static [String]$IChevronBlankCharacter      = ' '
    Static [String]$PagingChevronRightCharacter = "`u{1433}"
    Static [String]$PagingChevronLeftCharacter  = "`u{1438}"
    Static [String]$PagingChevronBlankCharater  = ' '

    Static [String]$DivLineHorizontalString = '─────────────────────────────────────────────────────────────────────────────'
    Static [String]$ZpLineBlank             = '                                                                             '
    Static [String]$DescLineBlank           = '                                                                          '
    Static [String]$ItemLabelBlank          = '               '

    Static [ATString]$PagingChevronRight = [ATString]@{
        Prefix = [ATStringPrefix]@{
            ForegroundColor = [CCAppleYellowLight24]::new()
            Coordinates     = [ATCoordinates]@{
                Row    = 2
                Column = 77
            }
        }
        UserData   = "$([InventoryWindow]::PagingChevronRightCharacter)"
        UseATReset = $true
    }
    Static [ATString]$PagingChevronLeft = [ATString]@{
        Prefix = [ATStringPrefix]@{
            ForegroundColor = [CCAppleYellowLight24]::new()
            Coordinates     = [ATCoordinates]@{
                Row    = 2
                Column = 3
            }
        }
        UserData   = "$([InventoryWindow]::PagingChevronLeftCharacter)"
        UseATReset = $true
    }
    Static [ATString]$PagingChevronRightBlank = [ATString]@{
        Prefix = [ATStringPrefix]@{
            ForegroundColor = [CCAppleMintLight24]::new()
            Coordinates     = [ATCoordinates]@{
                Row    = 2
                Column = 77
            }
        }
        UserData   = "$([InventoryWindow]::PagingChevronBlankCharater)"
        UseATReset = $true
    }
    Static [ATString]$PagingChevronLeftBlank = [ATString]@{
        Prefix = [ATStringPrefix]@{
            Coordinates = [ATCoordinates]@{
                Row    = 2
                Column = 3
            }
        }
        UserData   = "$([InventoryWindow]::PagingChevronBlankCharater)"
        UseATReset = $true
    }
    Static [ATString]$DivLineHorizontal = [ATString]@{
        Prefix = [ATStringPrefix]@{
            ForegroundColor = [CCTextDefault24]::new()
            Coordinates     = [ATCoordinates]@{
                Row    = 13
                Column = 2
            }
        }
        UserData   = "$([InventoryWindow]::DivLineHorizontalString)"
        UseATReset = $true
    }

    Static [Boolean]$DebugMode     = $false
    Static [Int]$MoronCounter      = 0
    Static [String]$ZeroPagePrompt = 'You have no items in your inventory.'

    [Boolean]$PlayerChevronDirty
    [Boolean]$PagingChevronRightDirty
    [Boolean]$PagingChevronLeftDirty
    [Boolean]$ItemsListDirty
    [Boolean]$CurrentPageDirty
    [Boolean]$PlayerChevronVisible
    [Boolean]$PagingChevronRightVisible
    [Boolean]$PagingChevronLeftVisible
    [Boolean]$ZeroPageActive
    [Boolean]$MoronPageActive
    [Boolean]$BookDirty
    [Boolean]$ActiveItemBlinking
    [Boolean]$DivLineDirty
    [Boolean]$ItemDescDirty
    [Boolean]$ZpBlankedDirty
    [Boolean]$ZpPromptDirty

    [Int]$ItemsPerPage
    [Int]$NumPages
    [Int]$CurrentPage
    [Int]$ActiveIChevronIndex
    [List[MapTileObject]]$PageRefs
    [List[ValueTuple[[ATString], [Boolean]]]]$IChevrons
    [List[ATString]]$ItemLabels
    [List[ATString]]$ItemLabelBlanks

    InventoryWindow() : base() {
        $this.LeftTop          = [ATCoordinates]@{
            Row    = [InventoryWindow]::WindowLTRow
            Column = [InventoryWindow]::WindowLTColumn
        }
        $this.RightBottom      = [ATCoordinates]@{
            Row    = [InventoryWindow]::WindowBRRow
            Column = [InventoryWindow]::WindowBRColumn
        }

        $this.UpdateDimensions()
        $this.SetupTitle([InventoryWindow]::WindowTitle, [CCTextDefault24]::new())

        $this.PlayerChevronDirty        = $true
        $this.PagingChevronRightDirty   = $true
        $this.PagingChevronLeftDirty    = $true
        $this.ItemsListDirty            = $true
        $this.CurrentPageDirty          = $true
        $this.PlayerChevronVisible      = $true
        $this.PagingChevronRightVisible = $false
        $this.PagingChevronLeftVisible  = $false
        $this.ZeroPageActive            = $false
        $this.MoronPageActive           = $false
        $this.BookDirty                 = $true
        $this.ActiveItemBlinking        = $false
        $this.DivLineDirty              = $true
        $this.ItemDescDirty             = $true
        $this.ZpBlankedDirty            = $true
        $this.ZpPromptDirty             = $true
        $this.ItemsPerPage              = 10
        $this.NumPages                  = 1
        $this.CurrentPage               = 1
        $this.PageRefs                  = [List[MapTileObject]]::new()

        $this.CreateIChevrons()
    }

    [Void]Draw() {
        ([WindowBase]$this).Draw()

        If($this.BookDirty -EQ $true) {
            $this.CalculateNumPages()
            $this.BookDirty = $false
        }
        If($this.CurrentPageDirty -EQ $true) {
            $this.PopulatePage()
        }
        If($this.ZeroPageActive -EQ $true) {
            If($this.MoronPageActive -EQ $true) {
                $this.WriteMoronPage()
            } Else {
                $this.WriteZeroInventoryPage()
            }
        } Else {
            If($this.DivLineDirty -EQ $true) {
                Write-Host "$([InventoryWindow]::DivLineHorizontal.ToAnsiControlSequenceString())"
                $this.DivLineDirty = $false
            }
            If(($this.PlayerChevronVisible -EQ $true) -AND ($this.PlayerChevronDirty -EQ $true)) {
                Foreach($ic in $this.IChevrons) {
                    Write-Host "$($ic.Item1.ToAnsiControlSequenceString())"
                }
                $this.PlayerChevronDirty = $false
            }
            If($this.NumPages -GT 1) {
                If($this.CurrentPage -EQ 1) {
                    If($this.PagingChevronLeftVisible -EQ $true) {
                        Write-Host "$([InventoryWindow]::PagingChevronLeftBlank.ToAnsiControlSequenceString())"
                        $this.PagingChevronLeftVisible = $false
                        $this.PagingChevronLeftDirty   = $true
                    }
                    If($this.PagingChevronRightVisible -EQ $false) {
                        $this.PagingChevronRightVisible = $true
                    }
                    If(($this.PagingChevronRightVisible -EQ $true) -AND ($this.PagingChevronRightDirty -EQ $true)) {
                        Write-Host "$([InventoryWindow]::PagingChevronRight.ToAnsiControlSequenceString())"
                        $this.PagingChevronRightDirty = $false
                    }
                } Elseif(($this.CurrentPage -GT 1) -AND ($this.CurrentPage -LT $this.NumPages)) {
                    If($this.PagingChevronLeftVisible -EQ $false) {
                        $this.PagingChevronLeftVisible = $true
                    }
                    If($this.PagingChevronRightVisible -EQ $false) {
                        $this.PagingChevronRightVisible = $true
                    }
                    If(($this.PagingChevronRightVisible -EQ $true) -AND ($this.PagingChevronRightDirty -EQ $true)) {
                        Write-Host "$([InventoryWindow]::PagingChevronRight.ToAnsiControlSequenceString())"
                        $this.PagingChevronRightDirty = $false
                    }
                    If(($this.PagingChevronLeftVisible -EQ $true) -AND ($this.PagingChevronLeftDirty -EQ $true)) {
                        Write-Host "$([InventoryWindow]::PagingChevronLeft.ToAnsiControlSequenceString())"
                        $this.PagingChevronLeftDirty = $false
                    }
                } Elseif($this.CurrentPage -GE $this.NumPages) {
                    If($this.PagingChevronRightVisible -EQ $true) {
                        Write-Host "$([InventoryWindow]::PagingChevronRightBlank.ToAnsiControlSequenceString())"
                        $this.PagingChevronRightVisible = $false
                        $this.PagingChevronRightDirty   = $true
                    }
                    If($this.PagingChevronLeftVisible -EQ $false) {
                        $this.PagingChevronLeftVisible = $true
                    }
                    If(($this.PagingChevronLeftVisible -EQ $true) -AND ($this.PagingChevronLeftDirty -EQ $true)) {
                        Write-Host "$([InventoryWindow]::PagingChevronLeft.ToAnsiControlSequenceString())"
                        $this.PagingChevronLeftDirty = $false
                    }
                }
            } Elseif($this.NumPages -EQ 1) {
                If($this.PagingChevronLeftVisible -EQ $true) {
                    $this.PagingChevronLeftVisible = $false
                }
                If($this.PagingChevronRightVisible -EQ $true) {
                    $this.PagingChevronRightVisible = $false
                }
                If($this.PagingChevronLeftVisible -EQ $false) {
                    Write-Host "$([InventoryWindow]::PagingChevronLeftBlank.ToAnsiControlSequenceString())"
                }
                If($this.PagingChevronRightVisible -EQ $false) {
                    Write-Host "$([InventoryWindow]::PagingChevronRightBlank.ToAnsiControlSequenceString())"
                }
            }
            If($this.ActiveItemBlinking -EQ $false) {
                $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.Decorations = [ATDecoration]@{
                    Blink = $true
                }
                $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.ForegroundColor = [CCListItemCurrentHighlight24]::new()
                $this.ItemsListDirty                                               = $true
                $this.ActiveItemBlinking                                           = $true
            }
            If($this.ItemsListDirty -EQ $true) {
                $this.WriteItemLabels()
                Write-Host "$([ATControlSequences]::CursorHide)"
                $this.ItemsListDirty = $false
            }
            If($this.ItemDescDirty -EQ $true) {
                [ATString]$b = [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCTextDefault24]::new()
                        Coordinates     = [ATCoordinates]@{
                            Row    = 15
                            Column = 4
                        }
                    }
                    UserData   = [InventoryWindow]::DescLineBlank
                    UseATReset = $true
                }
                [ATString]$d = [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCTextDefault24]::new()
                        Coordinates     = [ATCoordinates]@{
                            Row    = 15
                            Column = 4
                        }
                    }
                    UserData   = $this.PageRefs[$this.ActiveIChevronIndex].ExamineString
                    UseATReset = $true
                }
                [ATString]$f = [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCTextDefault24]::new()
                        Coordinates     = [ATCoordinates]@{
                            Row    = 16
                            Column = 4
                        }
                    }
                    UserData   = [InventoryWindow]::DescLineBlank
                    UseATReset = $true
                }
                [ATString]$e = [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCApplePinkLight24]::new()
                        Coordinates     = [ATCoordinates]@{
                            Row    = 16
                            Column = 4
                        }
                    }
                    UserData   = $this.PageRefs[$this.ActiveIChevronIndex].PlayerEffectString
                    UseATReset = $true
                }
                [ATString]$h = [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCTextDefault24]::new()
                        Coordinates     = [ATCoordinates]@{
                            Row    = 17
                            Column = 4
                        }
                    }
                    UserData   = [InventoryWindow]::DescLineBlank
                    UseATReset = $true
                }
                [ATString]$i = [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCAppleYellowLight24]::new()
                        Decorations     = [ATDecoration]@{
                            Blink  = $true
                            Italic = $true
                        }
                        Coordinates = [ATCoordinates]@{
                            Row    = 17
                            Column = 4
                        }
                    }
                    UserData   = ($this.PageRefs[$this.ActiveIChevronIndex].KeyItem -EQ $true ? 'KEY ITEM' : '')
                    UseATReset = $true
                }
                Write-Host "$($b.ToAnsiControlSequenceString())$($d.ToAnsiControlSequenceString())$($f.ToAnsiControlSequenceString())$($e.ToAnsiControlSequenceString())$($h.ToAnsiControlSequenceString())$($i.ToAnsiControlSequenceString())"
            }
        }
    }

    [Void]CreateIChevrons() {
        $this.IChevrons = [List[ValueTuple[[ATString], [Boolean]]]]::new()
        $this.IChevrons.Add([ValueTuple]::Create(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleGreenLight24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = 3
                        Column = 15
                    }
                }
                UserData   = [InventoryWindow]::IChevronCharacter
                UseATReset = $true
            },
            $true
        ))
        $this.IChevrons.Add([ValueTuple]::Create(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleGreenLight24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = 5
                        Column = 15
                    }
                }
                UserData = [InventoryWindow]::IChevronBlankCharacter
            },
            $false
        ))
        $this.IChevrons.Add([ValueTuple]::Create(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleGreenLight24]::new()
                    Coordinates      = [ATCoordinates]@{
                        Row    = 7
                        Column = 15
                    }
                }
                UserData = [InventoryWindow]::IChevronBlankCharacter
            },
            $false
        ))
        $this.IChevrons.Add([ValueTuple]::Create(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleGreenLight24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = 9
                        Column = 15
                    }
                }
                UserData = [InventoryWindow]::IChevronBlankCharacter
            },
            $false
        ))
        $this.IChevrons.Add([ValueTuple]::Create(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleGreenLight24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = 11
                        Column = 15
                    }
                }
                UserData = [InventoryWindow]::IChevronBlankCharacter
            },
            $false
        ))
        $this.IChevrons.Add([ValueTuple]::Create(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleGreenLight24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = 3
                        Column = 50
                    }
                }
                UserData = [InventoryWindow]::IChevronBlankCharacter
            },
            $false
        ))
        $this.IChevrons.Add([ValueTuple]::Create(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleGreenLight24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = 5
                        Column = 50
                    }
                }
                UserData = [InventoryWindow]::IChevronBlankCharacter
            },
            $false
        ))
        $this.IChevrons.Add([ValueTuple]::Create(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleGreenLight24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = 7
                        Column = 50
                    }
                }
                UserData = [InventoryWindow]::IChevronBlankCharacter
            },
            $false
        ))
        $this.IChevrons.Add([ValueTuple]::Create(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleGreenLight24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = 9
                        Column = 50
                    }
                }
                UserData = [InventoryWindow]::IChevronBlankCharacter
            },
            $false
        ))
        $this.IChevrons.Add([ValueTuple]::Create(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleGreenLight24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = 11
                        Column = 50
                    }
                }
                UserData = [InventoryWindow]::IChevronBlankCharacter
            },
            $false
        ))
    }

    [Void]CreateItemLabels() {
        $this.ItemLabels = [List[ATString]]::new()
        [Int]$c          = 0

        Foreach($i in $this.PageRefs) {
            $this.ItemLabels.Add(
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCTextDefault24]::new()
                        Coordinates     = [ATCoordinates]@{
                            Row    = $this.IChevrons[$c].Item1.Prefix.Coordinates.Row
                            Column = $this.IChevrons[$c].Item1.Prefix.Coordinates.Column + 2
                        }
                    }
                    UserData = $i.Name
                    UseATReset = $true
                }
            )
            $c++ # FYI - This was intentional
        }
        $this.ResetIChevronPosition()
        $this.CreateItemLabelBlanks()
    }

    [Void]CreateItemLabelBlanks() {
        $this.ItemLabelBlanks = [List[ATString]]::new()
        $this.ItemLabelBlanks.Add(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    Coordinates = [ATCoordinates]@{
                        Row    = 3
                        Column = 17
                    }
                }
                UserData   = [InventoryWindow]::ItemLabelBlank
                UseATReset = $true
            }
        )
        $this.ItemLabelBlanks.Add(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    Coordinates = [ATCoordinates]@{
                        Row    = 5
                        Column = 17
                    }
                }
                UserData   = [InventoryWindow]::ItemLabelBlank
                UseATReset = $true
            }
        )
        $this.ItemLabelBlanks.Add(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    Coordinates = [ATCoordinates]@{
                        Row    = 7
                        Column = 17
                    }
                }
                UserData   = [InventoryWindow]::ItemLabelBlank
                UseATReset = $true
            }
        )
        $this.ItemLabelBlanks.Add(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    Coordinates = [ATCoordinates]@{
                        Row    = 9
                        Column = 17
                    }
                }
                UserData   = [InventoryWindow]::ItemLabelBlank
                UseATReset = $true
            }
        )
        $this.ItemLabelBlanks.Add(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    Coordinates = [ATCoordinates]@{
                        Row    = 11
                        Column = 17
                    }
                }
                UserData   = [InventoryWindow]::ItemLabelBlank
                UseATReset = $true
            }
        )
        $this.ItemLabelBlanks.Add(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    Coordinates = [ATCoordinates]@{
                        Row    = 3
                        Column = 52
                    }
                }
                UserData   = [InventoryWindow]::ItemLabelBlank
                UseATReset = $true
            }
        )
        $this.ItemLabelBlanks.Add(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    Coordinates = [ATCoordinates]@{
                        Row    = 5
                        Column = 52
                    }
                }
                UserData   = [InventoryWindow]::ItemLabelBlank
                UseATReset = $true
            }
        )
        $this.ItemLabelBlanks.Add(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    Coordinates = [ATCoordinates]@{
                        Row    = 7
                        Column = 52
                    }
                }
                UserData   = [InventoryWindow]::ItemLabelBlank
                UseATReset = $true
            }
        )
        $this.ItemLabelBlanks.Add(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    Coordinates = [ATCoordinates]@{
                        Row    = 9
                        Column = 52
                    }
                }
                UserData   = [InventoryWindow]::ItemLabelBlank
                UseATReset = $true
            }
        )
        $this.ItemLabelBlanks.Add(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    Coordinates = [ATCoordinates]@{
                        Row    = 11
                        Column = 52
                    }
                }
                UserData   = [InventoryWindow]::ItemLabelBlank
                UseATReset = $true
            }
        )
    }

    [Void]CalculateNumPages() {
        $pp = $Script:ThePlayer.Inventory.Count / $this.ItemsPerPage
        If($pp -LT 1) {
            $this.NumPages = 1
        } Else {
            $this.NumPages = [Math]::Ceiling($pp)
        }
        If($this.CurrentPage -GT $this.NumPages) {
            $this.CurrentPage = $this.NumPages
        }
    }

    [Void]TurnPageForward() {
        If(($this.CurrentPage + 1) -LE $this.NumPages) {
            $this.CurrentPage++
            $this.CurrentPageDirty   = $true
            $this.ActiveItemBlinking = $false
            $this.ItemDescDirty      = $true
        }
    }

    [Void]TurnPageBackward() {
        If(($this.CurrentPage - 1) -GE 1) {
            $this.CurrentPage--
            $this.CurrentPageDirty   = $true
            $this.ActiveItemBlinking = $false
            $this.ItemDescDirty      = $true
        }
    }

    [Void]PopulatePage() {
        If($Script:ThePlayer.Inventory.Count -LE 0) {
            $this.ZeroPageActive   = $true
            $this.CurrentPageDirty = $false
            $this.ZpPromptDirty    = $true
            $this.ZpBlankedDirty   = $true

            If([InventoryWindow]::MoronCounter -LT 20) {
                [InventoryWindow]::MoronCounter++
            } Else {
                $this.MoronPageActive = $true
            }
        } Else {
            $this.PageRefs        = [List[MapTileObject]]::new()
            $this.ZeroPageActive  = $false
            $this.MoronPageActive = $false
            $rs                   = (($this.CurrentPage * $this.ItemsPerPage) - $this.ItemsPerPage)
            $rs                   = [Math]::Clamp($rs, 0, [Int]::MaxValue)
            $re                   = 10

            Try {
                $this.PageRefs = $Script:ThePlayer.Inventory.GetRange($rs, $re)
            } Catch {
                $this.PageRefs = $Script:ThePlayer.Inventory.GetRange($rs, ($Script:ThePlayer.Inventory.Count - $rs))
            }
            $this.CreateItemLabels()
            $this.ItemsListDirty   = $true
            $this.CurrentPageDirty = $false
        }
    }

    [Void]WriteItemLabels() {
        Foreach($i in $this.ItemLabelBlanks) {
            Write-Host "$($i.ToAnsiControlSequenceString())"
        }
        Foreach($i in $this.ItemLabels) {
            Write-Host "$($i.ToAnsiControlSequenceString())"
        }
    }

    [ATString]GetActiveIChevron() {
        $this.ActiveIChevronIndex = 0
        Foreach($a in $this.IChevrons) {
            If($a.Item2 -EQ $true) {
                Return $a.Item1
            }
            $this.ActiveIChevronIndex++
        }
        $this.ActiveIChevronIndex                        = 0
        $this.IChevrons[$this.ActiveIChevronIndex].Item2 = $true

        Return $this.IChevrons[$this.ActiveIChevronIndex].Item1
    }

    [Void]WriteZeroInventoryPage() {
        If($this.ZpBlankedDirty -EQ $true) {
            Foreach($a in 2..19) {
                [ATString]$b = [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCTextDefault24]::new()
                        Coordinates     = [ATCoordinates]@{
                            Row    = $a
                            Column = 2
                        }
                    }
                    UserData   = [InventoryWindow]::ZpLineBlank
                    UseATReset = $true
                }
                Write-Host "$($b.ToAnsiControlSequenceString())"
            }
            $this.ZpBlankedDirty = $false
        }
        If($this.ZpPromptDirty -EQ $true) {
            [ATString]$a = [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = $this.Height / 2
                        Column = ($this.Width / 2) - ([InventoryWindow]::ZeroPagePrompt.Length / 2)
                    }
                }
                UserData   = [InventoryWindow]::ZeroPagePrompt
                UseATReset = $true
            }
            Write-Host "$($a.ToAnsiControlSequenceString())"
            $this.ZpPromptDirty = $false
        }
    }

    [Void]WriteMoronPage() {}

    [Void]ResetIChevronPosition() {
        $this.IChevrons[$this.ActiveIChevronIndex].Item2          = $false
        $this.IChevrons[$this.ActiveIChevronIndex].Item1.UserData = [InventoryWindow]::IChevronBlankCharacter
        Try {
            $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.Decorations     = [ATDecorationNone]::new()
            $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.ForegroundColor = [CCTextDefault24]::new()
        } Catch {}
        $this.ActiveIChevronIndex                                          = 0
        $this.IChevrons[$this.ActiveIChevronIndex].Item2                   = $true
        $this.IChevrons[$this.ActiveIChevronIndex].Item1.UserData          = [InventoryWindow]::IChevronCharacter
        $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.Decorations     = [ATDecoration]@{
            Blink = $true
        }
        $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.ForegroundColor = [CCApplePinkLight24]::new()
        $this.PlayerChevronDirty                                           = $true
        $this.ActiveItemBlinking                                           = $false
        $this.ItemDescDirty                                                = $true
    }

    [Void]HandleInput() {
        $keyCap = $(Get-Host).UI.RawUI.ReadKey('IncludeKeyDown, NoEcho')

        #######################################################################
        #
        # BECAUSE POWERSHELL HAS BEEN REALLY WEIRD ABOUT MAPPING THE VALUE
        # OF VIRTUALKEYCODE TO AN ENUMERATION, TYPED OR OTHERWISE, I SHOULD
        # COMMENT THE MAPPINGS HERE SO THAT IT'S OBVIOUS WHAT KEY IS DOING
        # WHAT.
        #
        #######################################################################
        Switch($keyCap.VirtualKeyCode) {
            27 {
                $Script:ThePreviousGlobalGameState = $Script:TheGlobalGameState
                $Script:TheGlobalGameState         = [GameStatePrimary]::GamePlayScreen
            }

            38 {
                If(($this.ActiveIChevronIndex - 1) -GE 0) {
                    $this.IChevrons[$this.ActiveIChevronIndex].Item2                   = $false
                    $this.IChevrons[$this.ActiveIChevronIndex].Item1.UserData          = [InventoryWindow]::IChevronBlankCharacter
                    $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.Decorations     = [ATDecorationNone]::new()
                    $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.ForegroundColor = [CCTextDefault24]::new()
                    $this.ActiveIChevronIndex--
                    $this.IChevrons[$this.ActiveIChevronIndex].Item2                   = $true
                    $this.IChevrons[$this.ActiveIChevronIndex].Item1.UserData          = [InventoryWindow]::IChevronCharacter
                    $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.Decorations     = [ATDecoration]@{
                        Blink = $true
                    }
                    $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.ForegroundColor = [CCApplePinkLight24]::new()
                }
                $this.PlayerChevronDirty = $true
                $this.ActiveItemBlinking = $false
                $this.ItemDescDirty      = $true
            }

            40 {
                If(($this.ActiveIChevronIndex + 1) -LT $this.PageRefs.Count) {
                    $this.IChevrons[$this.ActiveIChevronIndex].Item2                   = $false
                    $this.IChevrons[$this.ActiveIChevronIndex].Item1.UserData          = [InventoryWindow]::IChevronBlankCharacter
                    $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.Decorations     = [ATDecorationNone]::new()
                    $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.ForegroundColor = [CCTextDefault24]::new()
                    $this.ActiveIChevronIndex++
                    $this.IChevrons[$this.ActiveIChevronIndex].Item2                   = $true
                    $this.IChevrons[$this.ActiveIChevronIndex].Item1.UserData          = [InventoryWindow]::IChevronCharacter
                    $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.Decorations     = [ATDecoration]@{
                        Blink = $true
                    }
                    $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.ForegroundColor = [CCApplePinkLight24]::new()
                }
                $this.PlayerChevronDirty                                               = $true
                $this.ActiveItemBlinking                                               = $false
                $this.ItemDescDirty                                                    = $true
            }

            39 {
                If(($this.ActiveIChevronIndex + 5) -LT $this.PageRefs.Count) {
                    $this.IChevrons[$this.ActiveIChevronIndex].Item2                   = $false
                    $this.IChevrons[$this.ActiveIChevronIndex].Item1.UserData          = [InventoryWindow]::IChevronBlankCharacter
                    $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.Decorations     = [ATDecorationNone]::new()
                    $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.ForegroundColor = [CCTextDefault24]::new()
                    $this.ActiveIChevronIndex += 5
                    $this.IChevrons[$this.ActiveIChevronIndex].Item2                   = $true
                    $this.IChevrons[$this.ActiveIChevronIndex].Item1.UserData          = [InventoryWindow]::IChevronCharacter
                    $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.Decorations     = [ATDecoration]@{
                        Blink = $true
                    }
                    $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.ForegroundColor = [CCApplePinkLight24]::new()
                }
                $this.PlayerChevronDirty                                               = $true
                $this.ActiveItemBlinking                                               = $false
                $this.ItemDescDirty                                                    = $true
            }

            37 {
                If(($this.ActiveIChevronIndex -5) -GE 0) {
                    $this.IChevrons[$this.ActiveIChevronIndex].Item2                   = $false
                    $this.IChevrons[$this.ActiveIChevronIndex].Item1.UserData          = [InventoryWindow]::IChevronBlankCharacter
                    $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.Decorations     = [ATDecorationNone]::new()
                    $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.ForegroundColor = [CCTextDefault24]::new()
                    $this.ActiveIChevronIndex -= 5
                    $this.IChevrons[$this.ActiveIChevronIndex].Item2                   = $true
                    $this.IChevrons[$this.ActiveIChevronIndex].Item1.UserData          = [InventoryWindow]::IChevronCharacter
                    $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.Decorations     = [ATDecoration]@{
                        Blink = $true
                    }
                    $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.ForegroundColor = [CCApplePinkLight24]::new()
                }
                $this.PlayerChevronDirty                                               = $true
                $this.ActiveItemBlinking                                               = $false
                $this.ItemDescDirty                                                    = $true
            }

            68 {
                $this.TurnPageForward()
            }

            65 {
                $this.TurnPageBackward()
            }

            83 {
                Switch($this.CurrentPage) {
                    1 {
                        [ItemRemovalStatus]$a = $Script:ThePlayer.RemoveInventoryItemByIndex($this.ActiveIChevronIndex)
                        If($a -EQ [ItemRemovalStatus]::Success) {
                            [Console]::Beep(493.9, 250)
                            [Console]::Beep((493.9 * 2), 250)
                            $this.BookDirty        = $true
                            $this.CurrentPageDirty = $true

                            Return
                        }
                        [Console]::Beep(493.9, 250)
                        [Console]::Beep((493.9 / 2), 250)
                    }

                    { $_ -GT 1 } {
                        [Int]$a               = ((10 * ($this.CurrentPage - 1)) + $this.ActiveIChevronIndex)
                        [ItemRemovalStatus]$b = $Script:ThePlayer.RemoveInventoryItemByIndex($a)
                        If($b -EQ [ItemRemovalStatus]::Success) {
                            [Console]::Beep(493.9, 250)
                            [Console]::Beep((493.9 * 2), 250)
                            $this.BookDirty        = $true
                            $this.CurrentPageDirty = $true

                            Return
                        }
                        [Console]::Beep(493.9, 250)
                        [Console]::Beep((493.9 / 2), 250)
                    }
                }
            }
        }
    }
}





###############################################################################
#
# BATTLE ENTITY STATUS WINDOW
#
# THIS IS THE STATUS WINDOW THAT DISPLAYS THE STATUS OF A BATTLE ENTITY IN THE
# BATTLE SCREEN.
#
# BECAUSE IN THE BATTLE SCREEN MULTIPLE INSTANCES OF THIS WINDOW EXIST, THERE
# ARE SOME ANTI-PATTERNS EXHIBITED HERE IN RELATION TO THE OTHER WINDOWS. THE
# FOLLOWING VARIABLES ARE DEMOTED FROM STATIC TO INSTANCE MEMBERS:
#
# WINDOWLTROW
# WINDOWLTCOLUMN
# WINDOWRBROW
# WINDOWRBCOLUMN
#
###############################################################################
Class BattleEntityStatusWindow : WindowBase {
    Static [String]$FullLineBlankActual    = '                '

    [ATCoordinates]$HpDrawCoordinates
    [ATCoordinates]$MpDrawCoordinates
    [ATCoordinates]$StatL1DrawCoordinates
    [ATCoordinates]$StatL2DrawCoordinates
    [ATCoordinates]$StatL3DrawCoordinates
    [ATCoordinates]$StatL4DrawCoordinates
    [Int]$WindowLTRow
    [Int]$WindowLTColumn
    [Int]$WindowRBRow
    [Int]$WindowRBColumn
    [Boolean]$HpDrawDirty
    [Boolean]$MpDrawDirty
    [Boolean]$StatL1DrawDirty
    [Boolean]$StatL2DrawDirty
    [Boolean]$StatL3DrawDirty
    [Boolean]$StatL4DrawDirty
    [Boolean]$EntityBattlePhaseActive
    [Boolean]$HasSetEntityActive
    [ATString]$FullLineBlank
    [ATStringComposite]$HpDrawString
    [ATStringComposite]$MpDrawString
    [ATStringComposite]$StatL1DrawString
    [ATStringComposite]$StatL2DrawString
    [ATStringComposite]$StatL3DrawString
    [ATStringComposite]$StatL4DrawString
    [BattleEntity]$BERef

    BattleEntityStatusWindow() : base() {
        $this.WindowLTRow    = 1
        $this.WindowLTColumn = 1
        $this.WindowRBRow    = 1
        $this.WindowRBColumn = 1
        $this.LeftTop = [ATCoordinates]@{
            Row    = $this.WindowLTRow
            Column = $this.WindowLTColumn
        }
        $this.RightBottom = [ATCoordinates]@{
            Row    = $this.WindowRBRow
            Column = $this.WindowRBColumn
        }

        $this.UpdateDimensions()

        [Int]$ColDef = $this.LeftTop.Column + 2
        $this.HpDrawCoordinates = [ATCoordinates]@{
            Row    = $this.LeftTop.Row + 2
            Column = $ColDef
        }
        $this.MpDrawCoordinates = [ATCoordinates]@{
            Row    = $this.LeftTop.Row + 5
            Column = $ColDef
        }
        $this.StatL1DrawCoordinates = [ATCoordinates]@{
            Row    = $this.LeftTop.Row + 9
            Column = $ColDef
        }
        $this.StatL2DrawCoordinates = [ATCoordinates]@{
            Row    = $this.LeftTop.Row + 11
            Column = $ColDef
        }
        $this.StatL3DrawCoordinates = [ATCoordinates]@{
            Row    = $this.LeftTop.Row + 13
            Column = $ColDef
        }
        $this.StatL4DrawCoordinates = [ATCoordinates]@{
            Row    = $this.LeftTop.Row + 15
            Column = $ColDef
        }
        $this.HpDrawDirty             = $true
        $this.MpDrawDirty             = $true
        $this.StatL1DrawDirty         = $true
        $this.StatL2DrawDirty         = $true
        $this.StatL3DrawDirty         = $true
        $this.StatL4DrawDirty         = $true
        $this.EntityBattlePhaseActive = $false
        $this.HasSetEntityActive      = $false
        $this.BERef                   = $null
        $this.FullLineBlank           = [ATString]@{
            UserData   = [BattleEntityStatusWindow]::FullLineBlankActual
            UseATReset = $true
        }
    }

    BattleEntityStatusWindow(
        [Int]$WindowLTRow,
        [Int]$WindowLTColumn,
        [Int]$WindowRBRow,
        [Int]$WindowRBColumn,
        [BattleEntity]$BERef
    ) : base() {
        $this.WindowLTRow    = $WindowLTRow
        $this.WindowLTColumn = $WindowLTColumn
        $this.WindowRBRow    = $WindowRBRow
        $this.WindowRBColumn = $WindowRBColumn
        $this.LeftTop = [ATCoordinates]@{
            Row    = $this.WindowLTRow
            Column = $this.WindowLTColumn
        }
        $this.RightBottom = [ATCoordinates]@{
            Row    = $this.WindowRBRow
            Column = $this.WindowRBColumn
        }

        $this.UpdateDimensions()

        [Int]$ColDef = $this.LeftTop.Column + 2
        $this.HpDrawCoordinates = [ATCoordinates]@{
            Row    = $this.LeftTop.Row + 2
            Column = $ColDef
        }
        $this.MpDrawCoordinates = [ATCoordinates]@{
            Row    = $this.HpDrawCoordinates.Row + 3
            Column = $ColDef
        }
        $this.StatL1DrawCoordinates = [ATCoordinates]@{
            Row    = $this.MpDrawCoordinates.Row + 3
            Column = $ColDef
        }
        $this.StatL2DrawCoordinates = [ATCoordinates]@{
            Row    = $this.StatL1DrawCoordinates.Row + 2
            Column = $ColDef
        }
        $this.StatL3DrawCoordinates = [ATCoordinates]@{
            Row    = $this.StatL2DrawCoordinates.Row + 2
            Column = $ColDef
        }
        $this.StatL4DrawCoordinates = [ATCoordinates]@{
            Row    = $this.StatL3DrawCoordinates.Row + 2
            Column = $ColDef
        }
        $this.HpDrawDirty             = $true
        $this.MpDrawDirty             = $true
        $this.StatL1DrawDirty         = $true
        $this.StatL2DrawDirty         = $true
        $this.StatL3DrawDirty         = $true
        $this.StatL4DrawDirty         = $true
        $this.EntityBattlePhaseActive = $false
        $this.HasSetEntityActive      = $false
        $this.BERef                   = $BERef
        $this.FullLineBlank           = [ATString]@{
            Prefix     = [ATStringPrefix]::new()
            UserData   = [BattleEntityStatusWindow]::FullLineBlankActual
            UseATReset = $true
        }

        $this.SetupTitle("$(
            (
                [ATStringComposite]::new(@(
                    [ATString]@{
                        Prefix = [ATStringPrefix]@{
                            ForegroundColor = $Script:BATAdornmentCharTable[$this.BERef.Affinity].Item2
                        }
                        UserData   = "$($Script:BATAdornmentCharTable[$this.BERef.Affinity].Item1)"
                        UseATReset = $true
                    },
                    [ATString]@{
                        Prefix = [ATStringPrefix]@{
                            ForegroundColor = $this.BERef.NameDrawColor
                        }
                        UserData   = " $($this.BERef.Name)"
                        UseATReset = $true
                    }
                ))
            ).ToAnsiControlSequenceString()
        )", $this.BERef.NameDrawColor)
    }

    [Void]Draw() {
        If(($this.EntityBattlePhaseActive -EQ $true) -AND ($this.HasSetEntityActive -EQ $false)) {
            $this.BorderDrawColors = [ConsoleColor24[]](
                [CCAppleYellowDark24]::new(),
                [CCAppleYellowDark24]::new(),
                [CCAppleYellowDark24]::new(),
                [CCAppleYellowDark24]::new(),
                [CCAppleYellowDark24]::new(),
                [CCAppleYellowDark24]::new(),
                [CCAppleYellowDark24]::new(),
                [CCAppleYellowDark24]::new()
            )
            $this.BorderDrawDirty = [Boolean[]](
                $true,
                $true,
                $true,
                $true,
                $true,
                $true,
                $true,
                $true
            )
            $this.HasSetEntityActive = $true
            $this.TitleDirty         = $true
        } Elseif($this.EntityBattlePhaseActive -EQ $false) {
            $this.BorderDrawColors = [ConsoleColor24[]](
                [CCWindowBorderDefault24]::new(),
                [CCWindowBorderDefault24]::new(),
                [CCWindowBorderDefault24]::new(),
                [CCWindowBorderDefault24]::new(),
                [CCWindowBorderDefault24]::new(),
                [CCWindowBorderDefault24]::new(),
                [CCWindowBorderDefault24]::new(),
                [CCWindowBorderDefault24]::new()
            )
            $this.BorderDrawDirty = [Boolean[]](
                $true,
                $true,
                $true,
                $true,
                $true,
                $true,
                $true,
                $true
            )
            $this.HasSetEntityActive = $false
            $this.TitleDirty         = $true
        }

        ([WindowBase]$this).Draw()
        If($this.HpDrawDirty -EQ $true) {
            $this.CreateHpDrawString()
            $this.FullLineBlank.Prefix.Coordinates = [ATCoordinates]::new($this.HpDrawCoordinates)
            Write-Host "$($this.FullLineBlank.ToAnsiControlSequenceString())"
            $this.FullLineBlank.Prefix.Coordinates.Row++
            Write-Host "$($this.FullLineBlank.ToAnsiControlSequenceString())$($this.HpDrawString.ToAnsiControlSequenceString())"
            $this.HpDrawDirty = $false
        }
        If($this.MpDrawDirty -EQ $true) {
            $this.CreateMpDrawString()
            $this.FullLineBlank.Prefix.Coordinates = [ATCoordinates]::new($this.MpDrawCoordinates)
            Write-Host "$($this.FullLineBlank.ToAnsiControlSequenceString())$($this.MpDrawString.ToAnsiControlSequenceString())"
            $this.MpDrawDirty = $false
        }
        If($this.StatL1DrawDirty -EQ $true) {
            $this.CreateStatL1DrawString()
            $this.FullLineBlank.Prefix.Coordinates = [ATCoordinates]::new($this.StatL1DrawCoordinates)
            Write-Host "$($this.FullLineBlank.ToAnsiControlSequenceString())$($this.StatL1DrawString.ToAnsiControlSequenceString())"
            $this.StatL1DrawDirty = $false
        }
        If($this.StatL2DrawDirty -EQ $true) {
            $this.CreateStatL2DrawString()
            $this.FullLineBlank.Prefix.Coordinates = [ATCoordinates]::new($this.StatL2DrawCoordinates)
            Write-Host "$($this.FullLineBlank.ToAnsiControlSequenceString())$($this.StatL2DrawString.ToAnsiControlSequenceString())"
            $this.StatL2DrawDirty = $false
        }
        If($this.StatL3DrawDirty -EQ $true) {
            $this.CreateStatL3DrawString()
            $this.FullLineBlank.Prefix.Coordinates = [ATCoordinates]::new($this.StatL3DrawCoordinates)
            Write-Host "$($this.FullLineBlank.ToAnsiControlSequenceString())$($this.StatL3DrawString.ToAnsiControlSequenceString())"
            $this.StatL3DrawDirty = $false
        }
        If($this.StatL4DrawDirty -EQ $true) {
            $this.CreateStatL4DrawString()
            $this.FullLineBlank.Prefix.Coordinates = [ATCoordinates]::new($this.StatL4DrawCoordinates)
            Write-Host "$($this.FullLineBlank.ToAnsiControlSequenceString())$($this.StatL4DrawString.ToAnsiControlSequenceString())"
            $this.StatL4DrawDirty = $false
        }
    }

    [Void]CreateHpDrawString() {
        [ConsoleColor24]$NumDrawColor = [CCTextDefault24]::new()
        [ATDecoration]$NumDeco        = [ATDecorationNone]::new()

        Switch($this.BERef.Stats[[StatId]::HitPoints].State) {
            ([StatNumberState]::Normal) {
                $NumDrawColor = [BattleEntityProperty]::StatNumDrawColorSafe
            }

            ([StatNumberState]::Caution) {
                $NumDrawColor = [BattleEntityProperty]::StatNumDrawColorCaution
            }

            ([StatNumberState]::Danger) {
                $NumDrawColor = [BattleEntityProperty]::StatNumDrawColorDanger
                $NumDeco      = [ATDecoration]@{
                    Blink = $true
                }
            }

            Default {
                $NumDrawColor = [BattleEntityProperty]::StatNumDrawColorSafe
            }
        }

        $this.HpDrawString = [ATStringComposite]::new(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                    Coordinates     = $this.HpDrawCoordinates
                }
                UserData = 'H '
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $NumDrawColor
                    Decorations     = $NumDeco
                }
                UserData = "$($this.BERef.Stats[[StatId]::HitPoints].Base)"
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                    Coordinates = [ATCoordinates]@{
                        Row    = $this.HpDrawCoordinates.Row + 1
                        Column = $this.HpDrawCoordinates.Column + 6
                    }
                }
                UserData = '/ '
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $NumDrawColor
                    Decorations     = $NumDeco
                }
                UserData   = "$($this.BERef.Stats[[StatId]::HitPoints].Max)"
                UseATReset = $true
            }
        ))
    }

    [Void]CreateMpDrawString() {
        [ConsoleColor24]$NumDrawColor = [CCTextDefault24]::new()
        [ATDecoration]$NumDeco        = [ATDecorationNone]::new()

        Switch($this.BERef.Stats[[StatId]::MagicPoints].State) {
            ([StatNumberState]::Normal) {
                $NumDrawColor = [BattleEntityProperty]::StatNumDrawColorSafe
            }

            ([StatNumberState]::Caution) {
                $NumDrawColor = [BattleEntityProperty]::StatNumDrawColorCaution
            }

            ([StatNumberState]::Danger) {
                $NumDrawColor = [BattleEntityProperty]::StatNumDrawColorDanger
                $NumDeco      = [ATDecoration]@{
                    Blink = $true
                }
            }

            Default {
                $NumDrawColor = [BattleEntityProperty]::StatNumDrawColorSafe
            }
        }

        $this.MpDrawString = [ATStringComposite]::new(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                    Coordinates     = $this.MpDrawCoordinates
                }
                UserData = 'M '
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $NumDrawColor
                    Decorations     = $NumDeco
                }
                UserData = "$($this.BERef.Stats[[StatId]::MagicPoints].Base)"
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                    Coordinates = [ATCoordinates]@{
                        Row    = $this.MpDrawCoordinates.Row + 1
                        Column = $this.MpDrawCoordinates.Column + 6
                    }
                }
                UserData = '/ '
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $NumDrawColor
                    Decorations     = $NumDeco
                }
                UserData   = "$($this.BERef.Stats[[StatId]::MagicPoints].Max)"
                UseATReset = $true
            }
        ))
    }

    [Void]CreateStatL1DrawString() {
        [BattleEntityProperty]$AtkStat = $this.BERef.Stats[[StatId]::Attack]
        [BattleEntityProperty]$DefStat = $this.BERef.Stats[[StatId]::Defense]
        [ConsoleColor24]$AtkDrawColor  = [CCTextDefault24]::new()
        [ConsoleColor24]$DefDrawColor  = [CCTextDefault24]::new()
        [String]$AtkStatSignStr        = ''
        [String]$DefStatSignStr        = ''
        [String]$AtkStatFmtStr         = ''
        [String]$DefStatFmtStr         = ''

        If($AtkStat.AugmentTurnDuration -GT 0) {
            Switch($AtkStat.BaseAugmentValue) {
                { $_ -GT 0 } {
                    $AtkDrawColor   = [BattleEntityProperty]::StatAugDrawColorPositive
                    $AtkStatSignStr = '+'
                }

                { $_ -LT 0 } {
                    $AtkDrawColor   = [BattleEntityProperty]::StatAugDrawColorNegative
                    $AtkStatSignStr = '-'
                }

                Default {
                    $AtkDrawColor   = [CCTextDefault24]::new()
                    $AtkStatSignStr = ' '
                }
            }
        } Else {
            $AtkDrawColor   = [CCTextDefault24]::new()
            $AtkStatSignStr = ' '
        }
        If($AtkStat.Base -LT 10) {
            $AtkStatFmtStr = "{0:d2}" -F $AtkStat.Base
        } Elseif($AtkStat.Base -GE 10) {
            $AtkStatFmtStr = "$($AtkStat.Base)"
        }

        If($DefStat.AugmentTurnDuration -GT 0) {
            Switch($DefStat.BaseAugmentValue) {
                { $_ -GT 0 } {
                    $DefDrawColor   = [BattleEntityProperty]::StatAugDrawColorPositive
                    $DefStatSignStr = '+'
                }

                { $_ -LT 0 } {
                    $DefDrawColor   = [BattleEntityProperty]::StatAugDrawColorNegative
                    $DefStatSignStr = '-'
                }

                Default {
                    $DefDrawColor   = [CCTextDefault24]::new()
                    $DefStatSignStr = ' '
                }
            }
        } Else {
            $DefDrawColor   = [CCTextDefault24]::new()
            $DefStatSignStr = ' '
        }
        If($DefStat.Base -LT 10) {
            $DefStatFmtStr = "{0:d2}" -F $DefStat.Base
        } Elseif($DefStat.Base -GE 10) {
            $DefStatFmtStr = "$($DefStat.Base)"
        }

        $this.StatL1DrawString = [ATStringComposite]::new(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                    Coordinates     = $this.StatL1DrawCoordinates
                }
                UserData = 'ATK '
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $AtkDrawColor
                }
                UserData = "$($AtkStatSignStr)"
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $AtkDrawColor
                }
                UserData = "$($AtkStatFmtStr)"
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData = ' DEF '
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $DefDrawColor
                }
                UserData = "$($DefStatSignStr)"
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $DefDrawColor
                }
                UserData   = "$($DefStatFmtStr)"
                UseATReset = $true
            }
        ))
    }

    [Void]CreateStatL2DrawString() {
        [BattleEntityProperty]$MatStat = $this.BERef.Stats[[StatId]::MagicAttack]
        [BattleEntityProperty]$MdfStat = $this.BERef.Stats[[StatId]::MagicDefense]
        [ConsoleColor24]$MatDrawColor  = [CCTextDefault24]::new()
        [ConsoleColor24]$MdfDrawColor  = [CCTextDefault24]::new()
        [String]$MatStatSignStr        = ''
        [String]$MdfStatSignStr        = ''
        [String]$MatStatFmtStr         = ''
        [String]$MdfStatFmtStr         = ''

        If($MatStat.AugmentTurnDuration -GT 0) {
            Switch($MatStat.BaseAugmentValue) {
                { $_ -GT 0 } {
                    $MatDrawColor   = [BattleEntityProperty]::StatAugDrawColorPositive
                    $MatStatSignStr = '+'
                }

                { $_ -LT 0 } {
                    $MatDrawColor = [BattleEntityProperty]::StatAugDrawColorNegative
                    $MatStatSignStr = '-'
                }

                Default {
                    $MatDrawColor   = [CCTextDefault24]::new()
                    $MatStatSignStr = ' '
                }
            }
        } Else {
            $MatDrawColor   = [CCTextDefault24]::new()
            $MatStatSignStr = ' '
        }
        If($MatStat.Base -LT 10) {
            $MatStatFmtStr = "{0:d2}" -F $MatStat.Base
        } Elseif($MatStat.Base -GE 10) {
            $MatStatFmtStr = "$($MatStat.Base)"
        }

        If($MdfStat.AugmentTurnDuration -GT 0) {
            Switch($MdfStat.BaseAugmentValue) {
                { $_ -GT 0 } {
                    $MdfDrawColor   = [BattleEntityProperty]::StatAugDrawColorPositive
                    $MdfStatSignStr = '+'
                }

                { $_ -LT 0 } {
                    $MdfDrawColor   = [BattleEntityProperty]::StatAugDrawColorNegative
                    $MdfStatSignStr = '-'
                }

                Default {
                    $MdfDrawColor   = [CCTextDefault24]::new()
                    $MdfStatSignStr = ' '
                }
            }
        } Else {
            $MdfDrawColor   = [CCTextDefault24]::new()
            $MdfStatSignStr = ' '
        }
        If($MdfStat.Base -LT 10) {
            $MdfStatFmtStr = "{0:d2}" -F $MdfStat.Base
        } Elseif($MdfStat.Base -GE 10) {
            $MdfStatFmtStr = "$($MdfStat.Base)"
        }

        $this.StatL2DrawString = [ATStringComposite]::new(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                    Coordinates     = $this.StatL2DrawCoordinates
                }
                UserData = 'MAT '
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $MatDrawColor
                }
                UserData = "$($MatStatSignStr)"
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $MatDrawColor
                }
                UserData = "$($MatStatFmtStr)"
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData = ' MDF '
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $MdfDrawColor
                }
                UserData = "$($MdfStatSignStr)"
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $MdfDrawColor
                }
                UserData   = "$($MdfStatFmtStr)"
                UseATReset = $true
            }
        ))
    }

    [Void]CreateStatL3DrawString() {
        [BattleEntityProperty]$SpdStat = $this.BERef.Stats[[StatId]::Speed]
        [BattleEntityProperty]$AccStat = $this.BERef.Stats[[StatId]::Accuracy]
        [ConsoleColor24]$SpdDrawColor  = [CCTextDefault24]::new()
        [ConsoleColor24]$AccDrawColor  = [CCTextDefault24]::new()
        [String]$SpdStatSignStr        = ''
        [String]$AccStatSignStr        = ''
        [String]$SpdStatFmtStr         = ''
        [String]$AccStatFmtStr         = ''

        If($SpdStat.AugmentTurnDuration -GT 0) {
            Switch($SpdStat.BaseAugmentValue) {
                { $_ -GT 0 } {
                    $SpdDrawColor   = [BattleEntityProperty]::StatAugDrawColorPositive
                    $SpdStatSignStr = '+'
                }

                { $_ -LT 0 } {
                    $SpdDrawColor = [BattleEntityProperty]::StatAugDrawColorNegative
                    $SpdStatSignStr = '-'
                }

                Default {
                    $SpdDrawColor   = [CCTextDefault24]::new()
                    $SpdStatSignStr = ' '
                }
            }
        } Else {
            $SpdDrawColor   = [CCTextDefault24]::new()
            $SpdStatSignStr = ' '
        }
        If($SpdStat.Base -LT 10) {
            $SpdStatFmtStr = "{0:d2}" -F $SpdStat.Base
        } Elseif($SpdStat.Base -GE 10) {
            $SpdStatFmtStr = "$($SpdStat.Base)"
        }

        If($AccStat.AugmentTurnDuration -GT 0) {
            Switch($AccStat.BaseAugmentValue) {
                { $_ -GT 0 } {
                    $AccDrawColor   = [BattleEntityProperty]::StatAugDrawColorPositive
                    $AccStatSignStr = '+'
                }

                { $_ -LT 0 } {
                    $AccDrawColor   = [BattleEntityProperty]::StatAugDrawColorNegative
                    $AccStatSignStr = '-'
                }

                Default {
                    $AccDrawColor   = [CCTextDefault24]::new()
                    $AccStatSignStr = ' '
                }
            }
        } Else {
            $AccDrawColor   = [CCTextDefault24]::new()
            $AccStatSignStr = ' '
        }
        If($AccStat.Base -LT 10) {
            $AccStatFmtStr = "{0:d2}" -F $AccStat.Base
        } Elseif($AccStat.Base -GE 10) {
            $AccStatFmtStr = "$($AccStat.Base)"
        }

        $this.StatL3DrawString = [ATStringComposite]::new(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                    Coordinates     = $this.StatL3DrawCoordinates
                }
                UserData = 'SPD '
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $SpdDrawColor
                }
                UserData = "$($SpdStatSignStr)"
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $SpdDrawColor
                }
                UserData = "$($SpdStatFmtStr)"
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData = ' ACC '
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $AccDrawColor
                }
                UserData = "$($AccStatSignStr)"
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $AccDrawColor
                }
                UserData   = "$($AccStatFmtStr)"
                UseATReset = $true
            }
        ))
    }

    [Void]CreateStatL4DrawString() {
        [BattleEntityProperty]$LckStat = $this.BERef.Stats[[StatId]::Luck]
        [ConsoleColor24]$LckDrawColor  = [CCTextDefault24]::new()
        [String]$LckStatSignStr        = ''
        [String]$LckStatFmtStr         = ''

        If($LckStat.AugmentTurnDuration -GT 0) {
            Switch($LckStat.BaseAugmentValue) {
                { $_ -GT 0 } {
                    $LckDrawColor   = [BattleEntityProperty]::StatAugDrawColorPositive
                    $LckStatSignStr = '+'
                }

                { $_ -LT 0 } {
                    $LckDrawColor   = [BattleEntityProperty]::StatAugDrawColorNegative
                    $LckStatSignStr = '-'
                }

                Default {
                    $LckDrawColor   = [CCTextDefault24]::new()
                    $LckStatSignStr = ' '
                }
            }
        } Else {
            $LckDrawColor   = [CCTextDefault24]::new()
            $LckStatSignStr = ' '
        }
        If($LckStat.Base -LT 10) {
            $LckStatFmtStr = "{0:d2}" -F $LckStat.Base
        } Elseif($LckStat.Base -GE 10) {
            $LckStatFmtStr = "$($LckStat.Base)"
        }

        $this.StatL4DrawString = [ATStringComposite]::new(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                    Coordinates     = $this.StatL4DrawCoordinates
                }
                UserData = 'LCK '
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $LckDrawColor
                }
                UserData = "$($LckStatSignStr)"
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $LckDrawColor
                }
                UserData   = "$($LckStatFmtStr)"
                UseATReset = $true
            }
        ))
    }

    [Void]SetAllFlagsDirty() {
        $this.HpDrawDirty     = $true
        $this.MpDrawDirty     = $true
        $this.StatL1DrawDirty = $true
        $this.StatL2DrawDirty = $true
        $this.StatL3DrawDirty = $true
        $this.StatL4DrawDirty = $true
    }
}





###############################################################################
#
# BATTLE PLAYER ACTION WINDOW
#
###############################################################################
Class BattlePlayerActionWindow : WindowBase {
    Static [Int]$WindowLTRow    = 18
    Static [Int]$WindowLTColumn = 1
    Static [Int]$WindowRBRow    = 23
    Static [Int]$WindowRBCOlumn = 19

    Static [String]$PlayerChevronCharacter      = '❱'
    Static [String]$PlayerChevronBlankCharacter = ' '
    Static [String]$WindowTitle                 = 'Actions'

    Static [ATString]$PlayerChevron = [ATString]@{
        Prefix = [ATStringPrefix]@{
            ForegroundColor = [CCTextDefault24]::new()
        }
        UserData   = "$([BattlePlayerActionWindow]::PlayerChevronCharacter)"
        UseATReset = $true
    }
    Static [ATString]$PlayerChevronBlank = [ATString]@{
        UserData   = "$([BattlePlayerActionWindow]::PlayerChevronBlankCharacter)"
        UseATReset = $true
    }

    [Int]$ActiveChevronIndex
    [Boolean]$PlayerChevronDirty
    [Boolean]$ActiveItemBlinking
    [Boolean]$ActionADrawDirty
    [Boolean]$ActionBDrawDirty
    [Boolean]$ActionCDrawDirty
    [Boolean]$ActionDDrawDirty
    [ATCoordinates]$ActionADrawCoords
    [ATCoordinates]$ActionBDrawCoords
    [ATCoordinates]$ActionCDrawCoords
    [ATCoordinates]$ActionDDrawCoords
    [List[ValueTuple[[ATString], [Boolean]]]]$Chevrons

    BattlePlayerActionWindow() : base() {
        $this.LeftTop = [ATCoordinates]@{
            Row    = [BattlePlayerActionWindow]::WindowLTRow
            Column = [BattlePlayerActionWindow]::WindowLTColumn
        }
        $this.RightBottom = [ATCoordinates]@{
            Row    = [BattlePlayerActionWindow]::WindowRBRow
            Column = [BattlePlayerActionWindow]::WindowRBColumn
        }

        $this.UpdateDimensions()

        $this.SetupTitle([BattlePlayerActionWindow]::WindowTitle, [CCTextDefault24]::new())

        $this.ActiveChevronIndex = 0
        $this.PlayerChevronDirty = $true
        $this.ActiveItemBlinking = $false
        $this.ActionADrawDirty   = $true
        $this.ActionBDrawDirty   = $true
        $this.ActionCDrawDirty   = $true
        $this.ActionDDrawDirty   = $true
        $this.ActionADrawCoords = [ATCoordinates]@{
            Row    = $this.LeftTop.Row + 1
            Column = $this.LeftTop.Column + 3
        }
        $this.ActionBDrawCoords = [ATCoordinates]@{
            Row    = $this.ActionADrawCoords.Row + 1
            Column = $this.ActionADrawCoords.Column
        }
        $this.ActionCDrawCoords = [ATCoordinates]@{
            Row    = $this.ActionBDrawCoords.Row + 1
            Column = $this.ActionBDrawCoords.Column
        }
        $this.ActionDDrawCoords = [ATCoordinates]@{
            Row    = $this.ActionCDrawCoords.Row + 1
            Column = $this.ActionCDrawCoords.Column
        }
        $this.CreateChevrons()
    }

    [Void]CreateChevrons() {
        $this.Chevrons = [List[ValueTuple[[ATString], [Boolean]]]]::new()
        $this.Chevrons.Add(
            [ValueTuple]::Create(
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCAppleGreenLight24]::new()
                        Coordinates     = [ATCoordinates]@{
                            Row    = $this.ActionADrawCoords.Row
                            Column = $this.ActionADrawCoords.Column - 2
                        }
                    }
                    UserData   = "$([BattlePlayerActionWindow]::PlayerChevronCharacter)"
                    UseATReset = $true
                },
                $true
            )
        )
        $this.Chevrons.Add(
            [ValueTuple]::Create(
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCAppleGreenLight24]::new()
                        Coordinates     = [ATCoordinates]@{
                            Row    = $this.ActionBDrawCoords.Row
                            Column = $this.ActionBDrawCoords.Column - 2
                        }
                    }
                    UserData   = "$([BattlePlayerActionWindow]::PlayerChevronBlankCharacter)"
                    UseATReset = $true
                },
                $false
            )
        )
        $this.Chevrons.Add(
            [ValueTuple]::Create(
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCAppleGreenLight24]::new()
                        Coordinates     = [ATCoordinates]@{
                            Row    = $this.ActionCDrawCoords.Row
                            Column = $this.ActionCDrawCoords.Column - 2
                        }
                    }
                    UserData   = "$([BattlePlayerActionWindow]::PlayerChevronBlankCharacter)"
                    UseATReset = $true
                },
                $false
            )
        )
        $this.Chevrons.Add(
            [ValueTuple]::Create(
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCAppleGreenLight24]::new()
                        Coordinates     = [ATCoordinates]@{
                            Row    = $this.ActionDDrawCoords.Row
                            Column = $this.ActionDDrawCoords.Column - 2
                        }
                    }
                    UserData   = "$([BattlePlayerActionWindow]::PlayerChevronBlankCharacter)"
                    UseATReset = $true
                },
                $false
            )
        )
    }

    [ATString]GetActiveChevron() {
        Foreach($a in $this.Chevrons) {
            If($a.Item2 -EQ $true) {
                Return $a.Item1
            }
        }
        $this.ActiveChevronIndex                       = 0
        $this.Chevrons[$this.ActiveChevronIndex].Item2 = $true

        Return $this.Chevrons[$this.ActiveChevronIndex].Item1
    }

    [Void]ResetChevronPosition() {
        $this.Chevrons[$this.ActiveChevronIndex].Item2          = $false
        $this.Chevrons[$this.ActiveChevronIndex].Item1.UserData = "$([BattlePlayerActionWindow]::PlayerChevronBlankCharacter)"
        $this.ActiveChevronIndex                                = 0
        $this.Chevrons[$this.ActiveChevronIndex].Item2          = $true
        $this.Chevrons[$this.ActiveChevronIndex].Item1.UserData = "$([BattlePlayerActionWindow]::PlayerChevronCharacter)"
    }

    [Void]Draw() {
        ([WindowBase]$this).Draw()

        If($this.ActionADrawDirty -EQ $true) {
            [ATStringComposite]$a = [ATStringComposite]::new(@(
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = $Script:BATAdornmentCharTable[$Script:ThePlayer.ActionListing[[ActionSlot]::A].Type].Item2
                        Coordinates     = $this.ActionADrawCoords
                    }
                    UserData   = "$($Script:BATAdornmentCharTable[$Script:ThePlayer.ActionListing[[ActionSlot]::A].Type].Item1)"
                    UseATReset = $true
                },
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCTextDefault24]::new()
                    }
                    UserData   = " $($Script:ThePlayer.ActionListing[[ActionSlot]::A].Name)"
                    UseATReset = $true
                }
            ))
            Write-Host "$($a.ToAnsiControlSequenceString())"
            $this.ActionADrawDirty = $false
        }
        If($this.ActionBDrawDirty -EQ $true) {
            [ATStringComposite]$a = [ATStringComposite]::new(@(
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = $Script:BATAdornmentCharTable[$Script:ThePlayer.ActionListing[[ActionSlot]::B].Type].Item2
                        Coordinates     = $this.ActionBDrawCoords
                    }
                    UserData   = "$($Script:BATAdornmentCharTable[$Script:ThePlayer.ActionListing[[ActionSlot]::B].Type].Item1)"
                    UseATReset = $true
                },
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCTextDefault24]::new()
                    }
                    UserData   = " $($Script:ThePlayer.ActionListing[[ActionSlot]::B].Name)"
                    UseATReset = $true
                }
            ))
            Write-Host "$($a.ToAnsiControlSequenceString())"
            $this.ActionBDrawDirty = $false
        }
        If($this.ActionCDrawDirty -EQ $true) {
            [ATStringComposite]$a = [ATStringComposite]::new(@(
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = $Script:BATAdornmentCharTable[$Script:ThePlayer.ActionListing[[ActionSlot]::C].Type].Item2
                        Coordinates     = $this.ActionCDrawCoords
                    }
                    UserData   = "$($Script:BATAdornmentCharTable[$Script:ThePlayer.ActionListing[[ActionSlot]::C].Type].Item1)"
                    UseATReset = $true
                },
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCTextDefault24]::new()
                    }
                    UserData   = " $($Script:ThePlayer.ActionListing[[ActionSlot]::C].Name)"
                    UseATReset = $true
                }
            ))
            Write-Host "$($a.ToAnsiControlSequenceString())"
            $this.ActionCDrawDirty = $false
        }
        If($this.ActionDDrawDirty -EQ $true) {
            [ATStringComposite]$a = [ATStringComposite]::new(@(
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = $Script:BATAdornmentCharTable[$Script:ThePlayer.ActionListing[[ActionSlot]::D].Type].Item2
                        Coordinates     = $this.ActionDDrawCoords
                    }
                    UserData   = "$($Script:BATAdornmentCharTable[$Script:ThePlayer.ActionListing[[ActionSlot]::D].Type].Item1)"
                    UseATReset = $true
                },
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCTextDefault24]::new()
                    }
                    UserData   = " $($Script:ThePlayer.ActionListing[[ActionSlot]::D].Name)"
                    UseATReset = $true
                }
            ))
            Write-Host "$($a.ToAnsiControlSequenceString())"
            $this.ActionDDrawDirty = $false
        }
        If($this.PlayerChevronDirty -EQ $true) {
            Foreach($c in $this.Chevrons) {
                Write-Host "$($c.Item1.ToAnsiControlSequenceString())"
            }
            $this.PlayerChevronDirty = $false
        }
    }

    [BattleAction]HandleInput() {
        $keyCap = $(Get-Host).UI.RawUI.ReadKey('IncludeKeyDown, NoEcho')
        Switch($keyCap.VirtualKeyCode) {
            13 {
                Switch($this.ActiveChevronIndex) {
                    0 {
                        If(($Script:ThePlayer.ActionListing[[ActionSlot]::A].MpCost -GT 0) -AND ($Script:ThePlayer.Stats[[StatId]::MagicPoints].Base -LT $Script:ThePlayer.ActionListing[[ActionSlot]::A].MpCost)) {
                            Try {
                                $Script:TheSfxMPlayer.Open($Script:SfxBattleNem)
                                $Script:TheSfxMPlayer.Play()
                            } Catch {}
                            $Script:TheBattleStatusMessageWindow.WriteNotEnoughMpMessage()
                            $Script:TheBattleStatusMessageWindow.Draw()

                            Return $null
                        }

                        Return $Script:ThePlayer.ActionListing[[ActionSlot]::A]
                    }

                    1 {
                        If(($Script:ThePlayer.ActionListing[[ActionSlot]::B].MpCost -GT 0) -AND ($Script:ThePlayer.Stats[[StatId]::MagicPoints].Base -LT $Script:ThePlayer.ActionListing[[ActionSlot]::B].MpCost)) {
                            Try {
                                $Script:TheSfxMPlayer.Open($Script:SfxBattleNem)
                                $Script:TheSfxMPlayer.Play()
                            } Catch {}
                            $Script:TheBattleStatusMessageWindow.WriteNotEnoughMpMessage()
                            $Script:TheBattleStatusMessageWindow.Draw()

                            Return $null
                        }

                        Return $Script:ThePlayer.ActionListing[[ActionSlot]::B]
                    }

                    2 {
                        If(($Script:ThePlayer.ActionListing[[ActionSlot]::C].MpCost -GT 0) -AND ($Script:ThePlayer.Stats[[StatId]::MagicPoints].Base -LT $Script:ThePlayer.ActionListing[[ActionSlot]::C].MpCost)) {
                            Try {
                                $Script:TheSfxMPlayer.Open($Script:SfxBattleNem)
                                $Script:TheSfxMPlayer.Play()
                            } Catch {}
                            $Script:TheBattleStatusMessageWindow.WriteNotEnoughMpMessage()
                            $Script:TheBattleStatusMessageWindow.Draw()

                            Return $null
                        }

                        Return $Script:ThePlayer.ActionListing[[ActionSlot]::C]
                    }

                    3 {
                        If(($Script:ThePlayer.ActionListing[[ActionSlot]::D].MpCost -GT 0) -AND ($Script:ThePlayer.Stats[[StatId]::MagicPoints].Base -LT $Script:ThePlayer.ActionListing[[ActionSlot]::D].MpCost)) {
                            Try {
                                $Script:TheSfxMPlayer.Open($Script:SfxBattleNem)
                                $Script:TheSfxMPlayer.Play()
                            } Catch {}
                            $Script:TheBattleStatusMessageWindow.WriteNotEnoughMpMessage()
                            $Script:TheBattleStatusMessageWindow.Draw()

                            Return $null
                        }

                        Return $Script:ThePlayer.ActionListing[[ActionSlot]::D]
                    }

                    Default {
                        Return $null
                    }
                }
            }

            38 {
                Try {
                    $Script:TheSfxMPlayer.Open($Script:SfxUiChevronMove)
                    $Script:TheSfxMPlayer.Play()
                } Catch {
                    Write-Host 'Blew up'
                }
                If(($this.ActiveChevronIndex - 1) -LT 0) {
                    $this.Chevrons[$this.ActiveChevronIndex].Item2          = $false
                    $this.Chevrons[$this.ActiveChevronIndex].Item1.UserData = "$([BattlePlayerActionWindow]::PlayerChevronBlankCharacter)"
                    $this.ActiveChevronIndex                                = 3
                    $this.Chevrons[$this.ActiveChevronIndex].Item2          = $true
                    $this.Chevrons[$this.ActiveChevronIndex].Item1.UserData = "$([BattlePlayerActionWindow]::PlayerChevronCharacter)"
                } Elseif(($this.ActiveChevronIndex - 1) -GE 0) {
                    $this.Chevrons[$this.ActiveChevronIndex].Item2          = $false
                    $this.Chevrons[$this.ActiveChevronIndex].Item1.UserData = "$([BattlePlayerActionWindow]::PlayerChevronBlankCharacter)"
                    $this.ActiveChevronIndex--
                    $this.Chevrons[$this.ActiveChevronIndex].Item2          = $true
                    $this.Chevrons[$this.ActiveChevronIndex].Item1.UserData = "$([BattlePlayerActionWindow]::PlayerChevronCharacter)"
                }
                $this.PlayerChevronDirty = $true
            }

            40 {
                Try {
                    $Script:TheSfxMPlayer.Open($Script:SfxUiChevronMove)
                    $Script:TheSfxMPlayer.Play()
                } Catch {
                    Write-Host 'Blew up'
                }
                If(($this.ActiveChevronIndex + 1) -GT 3) {
                    $this.Chevrons[$this.ActiveChevronIndex].Item2          = $false
                    $this.Chevrons[$this.ActiveChevronIndex].Item1.UserData = "$([BattlePlayerActionWindow]::PlayerChevronBlankCharacter)"
                    $this.ActiveChevronIndex                                = 0
                    $this.Chevrons[$this.ActiveChevronIndex].Item2          = $true
                    $this.Chevrons[$this.ActiveChevronIndex].Item1.UserData = "$([BattlePlayerActionWindow]::PlayerChevronCharacter)"
                } Elseif(($this.ActiveChevronIndex + 1) -LE 3) {
                    $this.Chevrons[$this.ActiveChevronIndex].Item2          = $false
                    $this.Chevrons[$this.ActiveChevronIndex].Item1.UserData = "$([BattlePlayerActionWindow]::PlayerChevronBlankCharacter)"
                    $this.ActiveChevronIndex++
                    $this.Chevrons[$this.ActiveChevronIndex].Item2          = $true
                    $this.Chevrons[$this.ActiveChevronIndex].Item1.UserData = "$([BattlePlayerActionWindow]::PlayerChevronCharacter)"
                }
                $this.PlayerChevronDirty = $true
            }
        }

        Return $null
    }

    [Void]SetAllActionDrawDirty() {
        $this.ActionADrawDirty = $true
        $this.ActionBDrawDirty = $true
        $this.ActionCDrawDirty = $true
        $this.ActionDDrawDirty = $true
    }
}





###############################################################################
#
# BATTLE STATUS MESSAGE WINDOW
#
###############################################################################
Class BattleStatusMessageWindow : WindowBase {
    Static [Int]$MessageHistoryARef = 0
    Static [Int]$MessageHistoryBRef = 1
    Static [Int]$MessageHistoryCRef = 2
    Static [Int]$MessageHistoryDRef = 3
    Static [Int]$MessageHistoryERef = 4
    Static [Int]$WindowLTRow        = 18
    Static [Int]$WindowLTColumn     = 22
    Static [Int]$WindowRBRow        = 24
    Static [Int]$WindowRBColumn     = 81

    Static [String]$MessageBlankActual = '                                                         '
    Static [String]$WindowTitle        = 'Log'

    Static [Single]$MessageSleepTime = 0.2

    [Boolean]$MessageADirty
    [Boolean]$MessageBDirty
    [Boolean]$MessageCDirty
    [Boolean]$MessageDDirty
    [Boolean]$MessageEDirty
    [ATString]$MessageBlank
    [ATCoordinates]$MessageADrawCoords
    [ATCoordinates]$MessageBDrawCoords
    [ATCoordinates]$MessageCDrawCoords
    [ATCoordinates]$MessageDDrawCoords
    [ATCoordinates]$MessageEDrawCoords
    [ATStringComposite[]]$MessageHistory

    BattleStatusMessageWindow() : base() {
        $this.LeftTop = [ATCoordinates]@{
            Row    = [BattleStatusMessageWindow]::WindowLTRow
            Column = [BattleStatusMessageWindow]::WindowLTColumn
        }
        $this.RightBottom = [ATCoordinates]@{
            Row    = [BattleStatusMessageWindow]::WindowRBRow
            Column = [BattleStatusMessageWindow]::WindowRBColumn
        }

        $this.UpdateDimensions()

        $this.SetupTitle([BattleStatusMessageWindow]::WindowTitle, [CCTextDefault24]::new())

        $this.MessageADirty = $false
        $this.MessageBDirty = $false
        $this.MessageCDirty = $false
        $this.MessageDDirty = $false
        $this.MessageEDirty = $false

        $this.MessageBlank = [ATString]@{
            Prefix     = [ATStringPrefix]::new()
            UserData   = "$([BattleStatusMessageWindow]::MessageBlankActual)"
            UseATReset = $true
        }

        $this.MessageADrawCoords = [ATCoordinates]@{
            Row    = $this.LeftTop.Row + 1
            Column = $this.LeftTop.Column + 1
        }
        $this.MessageBDrawCoords = [ATCoordinates]@{
            Row    = $this.MessageADrawCoords.Row + 1
            Column = $this.MessageADrawCoords.Column
        }
        $this.MessageCDrawCoords = [ATCoordinates]@{
            Row    = $this.MessageBDrawCoords.Row + 1
            Column = $this.MessageBDrawCoords.Column
        }
        $this.MessageDDrawCoords = [ATCoordinates]@{
            Row    = $this.MessageCDrawCoords.Row + 1
            Column = $this.MessageCDrawCoords.Column
        }
        $this.MessageEDrawCoords = [ATCoordinates]@{
            Row    = $this.MessageDDrawCoords.Row + 1
            Column = $this.MessageDDrawCoords.Column
        }

        $this.MessageHistory = [ATStringComposite[]](
            [ATStringComposite]::new(),
            [ATStringComposite]::new(),
            [ATStringComposite]::new(),
            [ATStringComposite]::new(),
            [ATStringComposite]::new()
        )
        $this.MessageHistory[[BattleStatusMessageWindow]::MessageHistoryARef].CompositeActual[0].Prefix.Coordinates = $this.MessageADrawCoords
        $this.MessageHistory[[BattleStatusMessageWindow]::MessageHistoryBRef].CompositeActual[0].Prefix.Coordinates = $this.MessageBDrawCoords
        $this.MessageHistory[[BattleStatusMessageWindow]::MessageHistoryCRef].CompositeActual[0].Prefix.Coordinates = $this.MessageCDrawCoords
        $this.MessageHistory[[BattleStatusMessageWindow]::MessageHistoryDRef].CompositeActual[0].Prefix.Coordinates = $this.MessageDDrawCoords
        $this.MessageHistory[[BattleStatusMessageWindow]::MessageHistoryERef].CompositeActual[0].Prefix.Coordinates = $this.MessageEDrawCoords
    }

    [Void]Draw() {
        ([WindowBase]$this).Draw()

        If($this.MessageEDirty -EQ $true) {
            $this.MessageBlank.Prefix.Coordinates = $this.MessageEDrawCoords
            Write-Host "$($this.MessageBlank.ToAnsiControlSequenceString())$($this.MessageEDrawCoords.ToAnsiControlSequenceString())$($this.MessageHistory[[BattleStatusMessageWindow]::MessageHistoryERef].ToAnsiControlSequenceString())"
            $this.MessageEDirty = $false
            Start-Sleep -Seconds $([BattleStatusMessageWindow]::MessageSleepTime)
        }
        If($this.MessageDDirty -EQ $true) {
            $this.MessageBlank.Prefix.Coordinates = $this.MessageDDrawCoords
            Write-Host "$($this.MessageBlank.ToAnsiControlSequenceString())$($this.MessageDDrawCoords.ToAnsiControlSequenceString())$($this.MessageHistory[[BattleStatusMessageWindow]::MessageHistoryDRef].ToAnsiControlSequenceString())"
            $this.MessageDDirty = $false
            Start-Sleep -Seconds $([BattleStatusMessageWindow]::MessageSleepTime)
        }
        If($this.MessageCDirty -EQ $true) {
            $this.MessageBlank.Prefix.Coordinates = $this.MessageCDrawCoords
            Write-Host "$($this.MessageBlank.ToAnsiControlSequenceString())$($this.MessageCDrawCoords.ToAnsiControlSequenceString())$($this.MessageHistory[[BattleStatusMessageWindow]::MessageHistoryCRef].ToAnsiControlSequenceString())"
            $this.MessageCDirty = $false
            Start-Sleep -Seconds $([BattleStatusMessageWindow]::MessageSleepTime)
        }
        If($this.MessageBDirty -EQ $true) {
            $this.MessageBlank.Prefix.Coordinates = $this.MessageBDrawCoords
            Write-Host "$($this.MessageBlank.ToAnsiControlSequenceString())$($this.MessageBDrawCoords.ToAnsiControlSequenceString())$($this.MessageHistory[[BattleStatusMessageWindow]::MessageHistoryBRef].ToAnsiControlSequenceString())"
            $this.MessageBDirty = $false
            Start-Sleep -Seconds $([BattleStatusMessageWindow]::MessageSleepTime)
        }
        If($this.MessageADirty -EQ $true) {
            $this.MessageBlank.Prefix.Coordinates = $this.MessageADrawCoords
            Write-Host "$($this.MessageBlank.ToAnsiControlSequenceString())$($this.MessageADrawCoords.ToAnsiControlSequenceString())$($this.MessageHistory[[BattleStatusMessageWindow]::MessageHistoryARef].ToAnsiControlSequenceString())"
            $this.MessageADirty = $false
            Start-Sleep -Seconds $([BattleStatusMessageWindow]::MessageSleepTime + 0.4)
        }
    }

    [Void]WriteMessageComposite(
        [ATString[]]$ATComposite
    ) {
        $this.MessageHistory[[BattleStatusMessageWindow]::MessageHistoryARef].CompositeActual = [List[ATString]]::new($this.MessageHistory[[BattleStatusMessageWindow]::MessageHistoryBRef].CompositeActual)
        $this.MessageHistory[[BattleStatusMessageWindow]::MessageHistoryBRef].CompositeActual = [List[ATString]]::new($this.MessageHistory[[BattleStatusMessageWindow]::MessageHistoryCRef].CompositeActual)
        $this.MessageHistory[[BattleStatusMessageWindow]::MessageHistoryCRef].CompositeActual = [List[ATString]]::new($this.MessageHistory[[BattleStatusMessageWindow]::MessageHistoryDRef].CompositeActual)
        $this.MessageHistory[[BattleStatusMessageWindow]::MessageHistoryDRef].CompositeActual = [List[ATString]]::new($this.MessageHistory[[BattleStatusMessageWindow]::MessageHistoryERef].CompositeActual)
        $this.MessageHistory[[BattleStatusMessageWindow]::MessageHistoryERef]                 = [ATStringComposite]::new($ATComposite)

        $this.MessageADirty = $true
        $this.MessageBDirty = $true
        $this.MessageCDirty = $true
        $this.MessageDDirty = $true
        $this.MessageEDirty = $true
    }

    [Void]WriteNotEnoughMpMessage() {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleVYellowADark24]::new()
                    Decorations     = [ATDecoration]@{
                        Blink = $true
                    }
                }
                UserData   = 'Not enough MP!'
                UseATReset = $true
            }
        ))
    }

    [Void]WriteEntityUsesMessage(
        [BattleEntity]$Originator,
        [BattleEntity]$Target,
        [BattleAction]$Action
    ) {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Originator.NameDrawColor
                }
                UserData   = "$($Originator.Name)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' uses '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Script:BATAdornmentCharTable[$Action.Type].Item2
                }
                UserData   = "$($Action.Name)"
                UseATReset = $true
            }
        ))
    }

    [Void]WriteBarSwc(
        [BattleAction]$Action
    ) {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Script:BATAdornmentCharTable[$Action.Type].Item2
                }
                UserData   = "$($Action.Name)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' was successful! '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleYellowLight24]::new()
                    Decorations     = [ATDecoration]@{
                        Blink = $true
                    }
                }
                UserData   = 'CRITICAL!'
                UseATReset = $true
            }
        ))
    }

    [Void]WriteBarAff(
        [BattleAction]$Action
    ) {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Script:BATAdornmentCharTable[$Action.Type].Item2
                }
                UserData   = "$($Action.Name)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' was successful! '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleYellowLight24]::new()
                    Decorations     = [ATDecoration]@{
                        Blink = $true
                    }
                }
                UserData   = 'AFFINITY!'
                UseATReset = $true
            }
        ))
    }

    [Void]WriteBarCritAff(
        [BattleAction]$Action
    ) {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Script:BATAdornmentCharTable[$Action.Type].Item2
                }
                UserData   = "$($Action.Name)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData = ' was successful! '
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleYellowLight24]::new()
                    Decorations = [ATDecoration]@{
                        Blink = $true
                    }
                }
                UserData   = 'CRIT AND AFFINITY!'
                UseATReset = $true
            }
        ))
    }

    [Void]WriteBarSuccess(
        [BattleAction]$Action
    ) {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Script:BATAdornmentCharTable[$Action.Type].Item2
                }
                UserData   = "$($Action.Name)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' was successful!'
                UseATReset = $true
            }
        ))
    }

    [Void]WriteBarFailMissed(
        [BattleAction]$Action
    ) {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Script:BATAdornmentCharTable[$Action.Type].Item2
                }
                UserData   = "$($Action.Name)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' missed!'
                UseATReset = $true
            }
        ))
    }

    [Void]WriteBarFailFailed(
        [BattleAction]$Action
    ) {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Script:BATAdornmentCharTable[$Action.Type].Item2
                }
                UserData   = "$($Action.Name)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' failed!'
                UseATReset = $true
            }
        ))
    }

    [Void]WriteBatPhysical(
        [BattleEntity]$Originator,
        [BattleEntity]$Target,
        [BattleAction]$Action,
        [BattleActionResult]$Result
    ) {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Originator.NameDrawColor
                }
                UserData   = "$($Originator.Name)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' hit '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Target.NameDrawColor
                }
                UserData   = "$($Target.Name)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATSTringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' for '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Script:BATAdornmentCharTable[$Action.Type].Item2
                }
                UserData   = "$($Result.ActionEffectSum)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' damage.'
                UseATReset = $true
            }
        ))
    }

    [Void]WriteBatElementalFire(
        [BattleEntity]$Originator,
        [BattleEntity]$Target,
        [BattleAction]$Action,
        [BattleActionResult]$Result
    ) {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Originator.NameDrawColor
                }
                UserData   = "$($Originator.Name)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' burned '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Target.NameDrawColor
                }
                UserData   = "$($Target.Name)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATSTringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' for '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Script:BATAdornmentCharTable[$Action.Type].Item2
                }
                UserData   = "$($Result.ActionEffectSum)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' damage.'
                UseATReset = $true
            }
        ))
    }

    [Void]WriteBatElementalWater(
        [BattleEntity]$Originator,
        [BattleEntity]$Target,
        [BattleAction]$Action,
        [BattleActionResult]$Result
    ) {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Originator.NameDrawColor
                }
                UserData   = "$($Originator.Name)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' soaked '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Target.NameDrawColor
                }
                UserData   = "$($Target.Name)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATSTringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' for '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Script:BATAdornmentCharTable[$Action.Type].Item2
                }
                UserData   = "$($Result.ActionEffectSum)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' damage.'
                UseATReset = $true
            }
        ))
    }

    [Void]WriteBatElementalEarth(
        [BattleEntity]$Originator,
        [BattleEntity]$Target,
        [BattleAction]$Action,
        [BattleActionResult]$Result
    ) {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Originator.NameDrawColor
                }
                UserData   = "$($Originator.Name)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' stoned '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Target.NameDrawColor
                }
                UserData   = "$($Target.Name)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATSTringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' for '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Script:BATAdornmentCharTable[$Action.Type].Item2
                }
                UserData   = "$($Result.ActionEffectSum)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' damage.'
                UseATReset = $true
            }
        ))
    }

    [Void]WriteBatElementalWind(
        [BattleEntity]$Originator,
        [BattleEntity]$Target,
        [BattleAction]$Action,
        [BattleActionResult]$Result
    ) {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Originator.NameDrawColor
                }
                UserData   = "$($Originator.Name)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' sheared '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Target.NameDrawColor
                }
                UserData   = "$($Target.Name)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATSTringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' for '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Script:BATAdornmentCharTable[$Action.Type].Item2
                }
                UserData   = "$($Result.ActionEffectSum)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' damage.'
                UseATReset = $true
            }
        ))
    }

    [Void]WriteBatElementalLight(
        [BattleEntity]$Originator,
        [BattleEntity]$Target,
        [BattleAction]$Action,
        [BattleActionResult]$Result
    ) {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Originator.NameDrawColor
                }
                UserData   = "$($Originator.Name)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' cast holy power on '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Target.NameDrawColor
                }
                UserData   = "$($Target.Name)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATSTringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' for '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Script:BATAdornmentCharTable[$Action.Type].Item2
                }
                UserData   = "$($Result.ActionEffectSum)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' damage.'
                UseATReset = $true
            }
        ))
    }

    [Void]WriteBatElementalDark(
        [BattleEntity]$Originator,
        [BattleEntity]$Target,
        [BattleAction]$Action,
        [BattleActionResult]$Result
    ) {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Originator.NameDrawColor
                }
                UserData   = "$($Originator.Name)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' cast unholy power on '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Target.NameDrawColor
                }
                UserData   = "$($Target.Name)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATSTringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' for '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Script:BATAdornmentCharTable[$Action.Type].Item2
                }
                UserData   = "$($Result.ActionEffectSum)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' damage.'
                UseATReset = $true
            }
        ))
    }

    [Void]WriteBatElementalIce(
        [BattleEntity]$Originator,
        [BattleEntity]$Target,
        [BattleAction]$Action,
        [BattleActionResult]$Result
    ) {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Originator.NameDrawColor
                }
                UserData   = "$($Originator.Name)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' froze '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Target.NameDrawColor
                }
                UserData   = "$($Target.Name)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATSTringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' for '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Script:BATAdornmentCharTable[$Action.Type].Item2
                }
                UserData   = "$($Result.ActionEffectSum)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' damage.'
                UseATReset = $true
            }
        ))
    }

    [Void]WriteBatMagicPoison(
        [BattleEntity]$Originator,
        [BattleEntity]$Target,
        [BattleAction]$Action,
        [BattleActionResult]$Result
    ) {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Originator.NameDrawColor
                }
                UserData   = "$($Originator.Name)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' poisoned '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Target.NameDrawColor
                }
                UserData   = "$($Target.Name)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATSTringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' for '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Script:BATAdornmentCharTable[$Action.Type].Item2
                }
                UserData   = "$($Result.ActionEffectSum)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' damage.'
                UseATReset = $true
            }
        ))
    }

    [Void]WriteBatMagicConfuse(
        [BattleEntity]$Originator,
        [BattleEntity]$Target,
        [BattleAction]$Action,
        [BattleActionResult]$Result
    ) {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Originator.NameDrawColor
                }
                UserData   = "$($Originator.Name)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' confused '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Target.NameDrawColor
                }
                UserData   = "$($Target.Name)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = '!'
                UseATReset = $true
            }
        ))
    }

    [Void]WriteBatMagicSleep(
        [BattleEntity]$Originator,
        [BattleEntity]$Target,
        [BattleAction]$Action,
        [BattleActionResult]$Result
    ) {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Originator.NameDrawColor
                }
                UserData   = "$($Originator.Name)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' put '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Target.NameDrawColor
                }
                UserData   = "$($Target.Name)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' to sleep!'
                UseATReset = $true
            }
        ))
    }

    [Void]WriteBatMagicAging(
        [BattleEntity]$Originator,
        [BattleEntity]$Target,
        [BattleAction]$Action,
        [BattleActionResult]$Result
    ) {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Originator.NameDrawColor
                }
                UserData   = "$($Originator.Name)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' made '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Target.NameDrawColor
                }
                UserData   = "$($Target.Name)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' grow old!'
                UseATReset = $true
            }
        ))
    }

    [Void]WriteBatMagicHealing(
        [BattleEntity]$Originator,
        [BattleEntity]$Target,
        [BattleAction]$Action,
        [BattleActionResult]$Result
    ) {
        If($Originator == $Target) {
            # Healed themselves
            $this.WriteMessageComposite(@(
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = $Originator.NameDrawColor
                    }
                    UserData   = "$($Originator.Name)"
                    UseATReset = $true
                },
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCTextDefault24]::new()
                    }
                    UserData   = ' healed themself '
                    UseATReset = $true
                },
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCAppleGreenLight24]::new()
                    }
                    UserData   = "$($Result.ActionEfffectSum)"
                    UseATReset = $true
                },
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCTextDefault24]::new()
                    }
                    UserData   = '!'
                    UseATReset = $true
                }
            ))
        } Else {
            # Healed Target
            $this.WriteMessageComposite(@(
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = $Originator.NameDrawColor
                    }
                    UserData   = "$($Originator.Name)"
                    UseATReset = $true
                },
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCTextDefault24]::new()
                    }
                    UserData   = ' healed '
                    UseATReset = $true
                },
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = $Target.NameDrawColor
                    }
                    UserData   = "$($Target.Name)"
                    UseATReset = $true
                },
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCTextDefault24]::new()
                    }
                    UserData   = ' for '
                    UseATReset = $true
                },
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCAppleGreenLight24]::new()
                    }
                    UserData   = "$($Result.ActionEfffectSum)"
                    UseATReset = $true
                },
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCTextDefault24]::new()
                    }
                    UserData   = '!'
                    UseATReset = $true
                }
            ))
        }
    }

    [Void]WriteEntityCantActMessage(
        [BattleEntity]$Originator
    ) {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Originator.NameDrawColor
                }
                UserData = "$($Originator.Name)"
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' is unable to act!'
                UseATReset = $true
            }
        ))
    }

    [Void]WriteBattleWonMessage() {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = 'You''ve won the battle!'
                UseATReset = $true
            }
        ))
    }
	
	[Void]WriteBattleLostMessage() {
		$this.WriteMessageComposite(@(
			[ATString]@{
				Prefix = [ATStringPrefix]@{
					ForegroundColor = [CCTextDefault24]::new()
				}
				UserData   = 'You''ve lost the battle.'
				UseATReset = $true
			}
		))
	}
	
	[Void]WriteGameOverMessage() {
		$this.WriteMessageComposite(@(
			[ATString]@{
				Prefix = [ATStringPrefix]@{
					ForegroundColor = [CCTextDefault24]::new()
				}
				UserData   = 'GAME OVER'
				UseATReset = $true
			}
		))
	}

    [Void]WriteBattleEndPrompt() {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = 'Press ''Enter'' to exit.'
                UseATReset = $true
            }
        ))
    }

    [Void]WriteSpoilsMessage(
        [EnemyBattleEntity]$Opponent
    ) {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Opponent.NameDrawColor
                }
                UserData   = "$($Opponent.Name)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' dropped '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleYellowDark24]::new()
                }
                UserData   = "$($Opponent.SpoilsGold)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = ' gold.'
                UseATReset = $true
            }
        ))
    }

    [Void]WriteItemsFoundMessage(
        [String]$ItemNames
    ) {
        $this.WriteMessageComposite(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = 'Also found '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleYellowDark24]::new()
                }
                UserData   = "$($ItemNames)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = '.'
                UseATReset = $true
            }
        ))
    }
}





###############################################################################
#
# BATTLE ENEMY IMAGE WINDOW
#
###############################################################################
Class BattleEnemyImageWindow : WindowBase {
    Static [Int]$WindowLTRow           = 1
    Static [Int]$WindowLTColumn        = 43
    Static [Int]$WindowRBRow           = 17
    Static [Int]$WindowRBColumn        = 81
    Static [Int]$ImageDrawRowOffset    = [BattleEnemyImageWindow]::WindowLTRow + 1
    Static [Int]$ImageDrawColumnOffset = [BattleEnemyImageWindow]::WindowLTColumn + 1

    [Boolean]$ImageDirty
    [ATCoordinates]$ImageDrawCoords
    [EnemyEntityImage]$Image

    BattleEnemyImageWindow() : base() {
        $this.LeftTop = [ATCoordinates]@{
            Row    = [BattleEnemyImageWindow]::WindowLTRow
            Column = [BattleEnemyImageWindow]::WindowLTColumn
        }
        $this.RightBottom = [ATCoordinates]@{
            Row    = [BattleEnemyImageWindow]::WindowRBRow
            Column = [BattleEnemyImageWindow]::WindowRBColumn
        }

        $this.UpdateDimensions()

        $this.SetupTitle("$($Script:TheCurrentEnemy.Name)", [CCTextDefault24]::new())

        $this.ImageDirty      = $true
        $this.Image           = [EEIEmpty]::new()
        $this.ImageDrawCoords = [ATCoordinates]@{
            Row    = [BattleEnemyImageWindow]::ImageDrawRowOffset
            Column = [BattleEnemyImageWindow]::ImageDrawColumnOffset
        }
    }

    [Void]Draw() {
        ([WindowBase]$this).Draw()
        If($this.ImageDirty -EQ $true) {
            $this.Image = $Script:TheCurrentEnemy.Image
            Write-Host "$($this.Image.ToAnsiControlSequenceString())"
            $this.ImageDirty = $false
        }
    }
}





###############################################################################
#
# STATUS HUD WINDOW
#
###############################################################################
Class StatusHudWindow : WindowBase {
    Static [Int]$WindowLTRow    = 1
    Static [Int]$WindowLTColumn = 1
    Static [Int]$WindowRBRow    = 3
    Static [Int]$WindowRBColumn = 80

    Static [String]$LineBlankStr = '                                                                              '
    Static [String]$WindowTitle  = 'Status'

    [Boolean]$StatLineDrawDirty
    [ATString]$LineBlank
    [ATCoordinates]$StatLineDrawCoords
    [ATCoordinates]$StatSeparatorDrawCoords
    [ATStringComposite]$StatLineActual

    StatusHudWindow() : base() {
        $this.LeftTop = [ATCoordinates]@{
            Row    = [StatusHudWindow]::WindowLTRow
            Column = [StatusHudWindow]::WindowLTColumn
        }
        $this.RightBottom = [ATCoordinates]@{
            Row    = [StatusHudWindow]::WindowRBRow
            Column = [StatusHudWindow]::WindowRBColumn
        }

        $this.UpdateDimensions()

        $this.StatLineDrawDirty = $true
        $this.LineBlank = [ATString]@{
            UserData   = [StatusHudWindow]::LineBlankStr
            UseATReset = $true
        }
        $this.StatLineDrawCoords = [ATCoordinates]@{
            Row    = 2
            Column = 3
        }
        $this.StatSeparatorDrawCoords = [ATCoordinates]@{
            Row    = 2
            Column = [StatusHudWindow]::WindowRBColumn - 48
        }

        $this.SetupTitle([StatusHudWindow]::WindowTitle, [CCTextDefault24]::new())
    }

    [Void]Draw() {
        ([WindowBase]$this).Draw()

        If($this.StatLineDrawDirty -EQ $true) {
            $this.ComposeStatLineString()
            $this.LineBlank.Prefix.Coordinates = [ATCoordinates]::new($this.StatLineDrawCoords)
            Write-Host "$($this.LineBlank.ToAnsiControlSequenceString())$($this.StatLineActual.ToAnsiControlSequenceString())"
            $this.StatLineDrawDirty = $false
        }

        # FOR SOME REASON, THE SETUP TITLE CAUSES THE LEFT BAR TO DISAPPEAR?
        # THIS IS REQUIRED TO DEAL WITH THAT.
        ([WindowBase]$this).Draw()
    }

    [Void]ComposeStatLineString() {
        [String]$AtkStatFmtStr = ''
        [String]$DefStatFmtStr = ''
        [String]$MatStatFmtStr = ''
        [String]$MdfStatFmtStr = ''
        [String]$SpdStatFmtStr = ''
        [String]$AccStatFmtStr = ''
        [String]$LckStatFmtStr = ''
        [String]$AtkDispStr    = 'ATK:'
        [String]$DefDispStr    = 'DEF:'
        [String]$MatDispStr    = 'MAT:'
        [String]$MdfDispStr    = 'MDF:'
        [String]$SpdDispStr    = 'SPD:'
        [String]$AccDispStr    = 'ACC:'
        [String]$LckDispStr    = 'LCK:'

        If($Script:ThePlayer.Stats[[StatId]::Attack].Base -LT 10) {
            $AtkStatFmtStr = "{0:d2}" -F $Script:ThePlayer.Stats[[StatId]::Attack].Base
        } Elseif($Script:ThePlayer.Stats[[StatId]::Attack].Base -GE 10) {
            $AtkStatFmtStr = "$($Script:ThePlayer.Stats[[StatId]::Attack].Base)"
        }
        If($Script:ThePlayer.Stats[[StatId]::Defense].Base -LT 10) {
            $DefStatFmtStr = "{0:d2}" -F $Script:ThePlayer.Stats[[StatId]::Defense].Base
        } Elseif($Script:ThePlayer.Stats[[StatId]::Defense].Base -GE 10) {
            $DefStatFmtStr = "$($Script:ThePlayer.Stats[[StatId]::Defense].Base)"
        }
        If($Script:ThePlayer.Stats[[StatId]::MagicAttack].Base -LT 10) {
            $MatStatFmtStr = "{0:d2}" -F $Script:ThePlayer.Stats[[StatId]::MagicAttack].Base
        } Elseif($Script:ThePlayer.Stats[[StatId]::MagicAttack].Base -GE 10) {
            $MatStatFmtStr = "$($Script:ThePlayer.Stats[[StatId]::MagicAttack].Base)"
        }
        If($Script:ThePlayer.Stats[[StatId]::MagicDefense].Base -LT 10) {
            $MdfStatFmtStr = "{0:d2}" -F $Script:ThePlayer.Stats[[StatId]::MagicDefense].Base
        } Elseif($Script:ThePlayer.Stats[[StatId]::MagicDefense].Base -GE 10) {
            $MdfStatFmtStr = "$($Script:ThePlayer.Stats[[StatId]::MagicDefense].Base)"
        }
        If($Script:ThePlayer.Stats[[StatId]::Speed].Base -LT 10) {
            $SpdStatFmtStr = "{0:d2}" -F $Script:ThePlayer.Stats[[StatId]::Speed].Base
        } Elseif($Script:ThePlayer.Stats[[StatId]::Speed].Base -GE 10) {
            $SpdStatFmtStr = "$($Script:ThePlayer.Stats[[StatId]::Speed].Base)"
        }
        If($Script:ThePlayer.Stats[[StatId]::Accuracy].Base -LT 10) {
            $AccStatFmtStr = "{0:d2}" -F $Script:ThePlayer.Stats[[StatId]::Accuracy].Base
        } Elseif($Script:ThePlayer.Stats[[StatId]::Accuracy].Base -GE 10) {
            $AccStatFmtStr = "$($Script:ThePlayer.Stats[[StatId]::Accuracy].Base)"
        }
        If($Script:ThePlayer.Stats[[StatId]::Luck].Base -LT 10) {
            $LckStatFmtStr = "{0:d2}" -F $Script:ThePlayer.Stats[[StatId]::Luck].Base
        } Elseif($Script:ThePlayer.Stats[[StatId]::Luck].Base -GE 10) {
            $LckStatFmtStr = "$($Script:ThePlayer.Stats[[StatId]::Luck].Base)"
        }

        $this.StatLineActual = [ATStringComposite]::new(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = $Script:BATAdornmentCharTable[$Script:ThePlayer.Affinity].Item2
                    Coordinates     = [ATCoordinates]::new($this.StatLineDrawCoords)
                }
                UserData = "$($Script:BATAdornmentCharTable[$Script:ThePlayer.Affinity].Item1) "
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData = "$($Script:ThePlayer.Name)"
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                    Coordinates     = [ATCoordinates]::new($this.StatSeparatorDrawCoords)
                }
                UserData = "$($AtkDispStr)"
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData = "$($AtkStatFmtStr) "
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData = "$($DefDispStr)"
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData = "$($DefStatFmtStr) "
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData = "$($MatDispStr)"
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData = "$($MatStatFmtStr) "
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData = "$($MdfDispStr)"
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData = "$($MdfStatFmtStr) "
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData = "$($SpdDispStr)"
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData = "$($SpdStatFmtStr) "
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData = "$($AccDispStr)"
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData = "$($AccStatFmtStr) "
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData = "$($LckDispStr)"
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                }
                UserData   = "$($LckStatFmtStr)"
                UseATReset = $true
            }
        ))
    }
}





###############################################################################
#
# STATUS TECHNIQUE SELECTION WINDOW
#
###############################################################################
Class StatusTechniqueSelectionWindow : WindowBase {
    Static [Int]$WindowLTRow    = 4
    Static [Int]$WindowLTColumn = 1
    Static [Int]$WindowRBRow    = 9
    Static [Int]$WindowRBColumn = 19

    Static [String]$PlayerChevronCharacter      = '❱'
    Static [String]$PlayerChevronBlankCharacter = ' '
    Static [String]$NameBlank                   = '              '
    Static [String]$WindowTitle                 = 'Equipped'

    Static [ATString]$PlayerChevron = [ATString]@{
        Prefix = [ATStringPrefix]@{
            ForegroundColor = [CCTextDefault24]::new()
        }
        UserData   = "$([StatusTechniqueSelectionWindow]::PlayerChevronCharacter)"
        UseATReset = $true
    }
    Static [ATString]$PlayerChevronBlank = [ATString]@{
        UserData   = "$([StatusTechniqueSelectionWindow]::PlayerChevronBlankCharacter)"
        UseATReset = $true
    }
    Static [ATString]$BaNameBlank = [ATString]@{
        Prefix     = [ATStringPrefix]::new()
        UserData   = "$([StatusTechniqueSelectionWindow]::NameBlank)"
        UseATReset = $true
    }

    [Int]$ActiveChevronIndex
    [Boolean]$PlayerChevronDirty
    [Boolean]$ActiveItemBlinking
    [Boolean]$ActionADrawDirty
    [Boolean]$ActionBDrawDirty
    [Boolean]$ActionCDrawDirty
    [Boolean]$ActionDDrawDirty
    [Boolean]$IsActive
    [ATCoordinates]$ActionADrawCoords
    [ATCoordinates]$ActionBDrawCoords
    [ATCoordinates]$ActionCDrawCoords
    [ATCoordinates]$ActionDDrawCoords
    [List[ValueTuple[[ATString], [Boolean]]]]$Chevrons

    StatusTechniqueSelectionWindow() : base() {
        $this.LeftTop = [ATCoordinates]@{
            Row    = [StatusTechniqueSelectionWindow]::WindowLTRow
            Column = [StatusTechniqueSelectionWindow]::WindowLTColumn
        }
        $this.RightBottom = [ATCoordinates]@{
            Row    = [StatusTechniqueSelectionWindow]::WindowRBRow
            Column = [StatusTechniqueSelectionWindow]::WindowRBColumn
        }

        $this.UpdateDimensions()

        $this.ActiveChevronIndex = 0
        $this.PlayerChevronDirty = $true
        $this.ActiveItemBlinking = $false
        $this.ActionADrawDirty   = $true
        $this.ActionBDrawDirty   = $true
        $this.ActionCDrawDirty   = $true
        $this.ActionDDrawDirty   = $true
        $this.IsActive           = $true
        $this.ActionADrawCoords = [ATCoordinates]@{
            Row    = $this.LeftTop.Row + 1
            Column = $this.LeftTop.Column + 3
        }
        $this.ActionBDrawCoords = [ATCoordinates]@{
            Row    = $this.ActionADrawCoords.Row + 1
            Column = $this.ActionADrawCoords.Column
        }
        $this.ActionCDrawCoords = [ATCoordinates]@{
            Row    = $this.ActionBDrawCoords.Row + 1
            Column = $this.ActionBDrawCoords.Column
        }
        $this.ActionDDrawCoords = [ATCoordinates]@{
            Row    = $this.ActionCDrawCoords.Row + 1
            Column = $this.ActionCDrawCoords.Column
        }
        $this.CreateChevrons()

        $this.SetupTitle([StatusTechniqueSelectionWindow]::WindowTitle, [CCTextDefault24]::new())
    }

    [Void]CreateChevrons() {
        $this.Chevrons = [List[ValueTuple[[ATString], [Boolean]]]]::new()
        $this.Chevrons.Add(
            [ValueTuple]::Create(
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCAPpleGreenLight24]::new()
                        Coordinates     = [ATCoordinates]@{
                            Row    = $this.ActionADrawCoords.Row
                            Column = $this.ActionADrawCoords.Column - 2
                        }
                    }
                    UserData   = "$([StatusTechniqueSelectionWindow]::PlayerChevronCharacter)"
                    UseATReset = $true
                },
                $true
            )
        )
        $this.Chevrons.Add(
            [ValueTuple]::Create(
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCAPpleGreenLight24]::new()
                        Coordinates     = [ATCoordinates]@{
                            Row    = $this.ActionBDrawCoords.Row
                            Column = $this.ActionBDrawCoords.Column - 2
                        }
                    }
                    UserData   = "$([StatusTechniqueSelectionWindow]::PlayerChevronBlankCharacter)"
                    UseATReset = $true
                },
                $false
            )
        )
        $this.Chevrons.Add(
            [ValueTuple]::Create(
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCAPpleGreenLight24]::new()
                        Coordinates     = [ATCoordinates]@{
                            Row    = $this.ActionCDrawCoords.Row
                            Column = $this.ActionCDrawCoords.Column - 2
                        }
                    }
                    UserData   = "$([StatusTechniqueSelectionWindow]::PlayerChevronBlankCharacter)"
                    UseATReset = $true
                },
                $false
            )
        )
        $this.Chevrons.Add(
            [ValueTuple]::Create(
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCAPpleGreenLight24]::new()
                        Coordinates     = [ATCoordinates]@{
                            Row    = $this.ActionDDrawCoords.Row
                            Column = $this.ActionDDrawCoords.Column - 2
                        }
                    }
                    UserData   = "$([StatusTechniqueSelectionWindow]::PlayerChevronBlankCharacter)"
                    UseATReset = $true
                },
                $false
            )
        )
    }

    [ATString]GetActiveChevron() {
        Foreach($a in $this.Chevrons) {
            If($a.Item2 -EQ $true) {
                Return $a.Item1
            }
        }
        $this.ActiveChevronIndex                       = 0
        $this.Chevrons[$this.ActiveChevronIndex].Item2 = $true

        Return $this.Chevrons[$this.ActiveChevronIndex].Item1
    }

    [Void]ResetChevronPosition() {
        $this.Chevrons[$this.ActiveChevronIndex].Item2          = $false
        $this.Chevrons[$this.ActiveChevronIndex].Item1.UserData = "$([StatusTechniqueSelectionWindow]::PlayerChevronBlankCharacter)"
        $this.ActiveChevronIndex                                = 0
        $this.Chevrons[$this.ActiveChevronIndex].Item2          = $true
        $this.Chevrons[$this.ActiveChevronIndex].Item1.UserData = "$([StatusTechniqueSelectionWindow]::PlayerChevronCharacter)"
    }

    [Void]Draw() {
        ([WindowBase]$this).Draw()

        If($this.ActionADrawDirty -EQ $true) {
            [StatusTechniqueSelectionWindow]::BaNameBlank.Prefix.Coordinates = [ATCoordinates]@{
                Row    = $this.ActionADrawCoords.Row
                Column = $this.ActionADrawCoords.Column + 1
            }
            [ATStringComposite]$a = [ATStringComposite]::new(@(
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = $Script:BATAdornmentCharTable[$Script:ThePlayer.ActionListing[[ActionSlot]::A].Type].Item2
                        Coordinates     = $this.ActionADrawCoords
                    }
                    UserData   = "$($Script:BATAdornmentCharTable[$Script:ThePlayer.ActionListing[[ActionSlot]::A].Type].Item1)"
                    UseATReset = $true
                },
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCTextDefault24]::new()
                    }
                    UserData   = " $($Script:ThePlayer.ActionListing[[ActionSlot]::A].Name)"
                    UseATReset = $true
                }
            ))
            Write-Host "$([StatusTechniqueSelectionWindow]::BaNameBlank.ToAnsiControlSequenceString())$($a.ToAnsiControlSequenceString())"
            $this.ActionADrawDirty = $false
        }
        If($this.ActionBDrawDirty -EQ $true) {
            [StatusTechniqueSelectionWindow]::BaNameBlank.Prefix.Coordinates = [ATCoordinates]@{
                Row    = $this.ActionBDrawCoords.Row
                Column = $this.ActionBDrawCoords.Column + 1
            }
            [ATStringComposite]$a = [ATStringComposite]::new(@(
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = $Script:BATAdornmentCharTable[$Script:ThePlayer.ActionListing[[ActionSlot]::B].Type].Item2
                        Coordinates     = $this.ActionBDrawCoords
                    }
                    UserData   = "$($Script:BATAdornmentCharTable[$Script:ThePlayer.ActionListing[[ActionSlot]::B].Type].Item1)"
                    UseATReset = $true
                },
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCTextDefault24]::new()
                    }
                    UserData   = " $($Script:ThePlayer.ActionListing[[ActionSlot]::B].Name)"
                    UseATReset = $true
                }
            ))
            Write-Host "$([StatusTechniqueSelectionWindow]::BaNameBlank.ToAnsiControlSequenceString())$($a.ToAnsiControlSequenceString())"
            $this.ActionBDrawDirty = $false
        }
        If($this.ActionCDrawDirty -EQ $true) {
            [StatusTechniqueSelectionWindow]::BaNameBlank.Prefix.Coordinates = [ATCoordinates]@{
                Row    = $this.ActionCDrawCoords.Row
                Column = $this.ActionCDrawCoords.Column + 1
            }
            [ATStringComposite]$a = [ATStringComposite]::new(@(
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = $Script:BATAdornmentCharTable[$Script:ThePlayer.ActionListing[[ActionSlot]::C].Type].Item2
                        Coordinates     = $this.ActionCDrawCoords
                    }
                    UserData   = "$($Script:BATAdornmentCharTable[$Script:ThePlayer.ActionListing[[ActionSlot]::C].Type].Item1)"
                    UseATReset = $true
                },
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCTextDefault24]::new()
                    }
                    UserData   = " $($Script:ThePlayer.ActionListing[[ActionSlot]::C].Name)"
                    UseATReset = $true
                }
            ))
            Write-Host "$([StatusTechniqueSelectionWindow]::BaNameBlank.ToAnsiControlSequenceString())$($a.ToAnsiControlSequenceString())"
            $this.ActionCDrawDirty = $false
        }
        If($this.ActionDDrawDirty -EQ $true) {
            [StatusTechniqueSelectionWindow]::BaNameBlank.Prefix.Coordinates = [ATCoordinates]@{
                Row    = $this.ActionDDrawCoords.Row
                Column = $this.ActionDDrawCoords.Column + 1
            }
            [ATStringComposite]$a = [ATStringComposite]::new(@(
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = $Script:BATAdornmentCharTable[$Script:ThePlayer.ActionListing[[ActionSlot]::D].Type].Item2
                        Coordinates     = $this.ActionDDrawCoords
                    }
                    UserData   = "$($Script:BATAdornmentCharTable[$Script:ThePlayer.ActionListing[[ActionSlot]::D].Type].Item1)"
                    UseATReset = $true
                },
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCTextDefault24]::new()
                    }
                    UserData   = " $($Script:ThePlayer.ActionListing[[ActionSlot]::D].Name)"
                    UseATReset = $true
                }
            ))
            Write-Host "$([StatusTechniqueSelectionWindow]::BaNameBlank.ToAnsiControlSequenceString())$($a.ToAnsiControlSequenceString())"
            $this.ActionDDrawDirty = $false
        }
        If($this.PlayerChevronDirty -EQ $true) {
            If($this.IsActive -EQ $true) {
                Foreach($c in $this.Chevrons) {
                    $c.Item1.Prefix.ForegroundColor = [CCAppleNGreenLight24]::new()
                    Write-Host "$($c.Item1.ToAnsiControlSequenceString())"
                }
            } Else {
                Foreach($c in $this.Chevrons) {
                    $c.Item1.Prefix.ForegroundColor = [CCAppleNOrangeLight24]::new()
                    Write-Host "$($c.Item1.ToAnsiControlSequenceString())"
                }
            }
            $this.PlayerChevronDirty = $false
        }
    }

    [Void]HandleInput() {
        $keyCap = $(Get-Host).UI.RawUI.ReadKey('IncludeKeyDown, NoEcho')
        Switch($keyCap.VirtualKeyCode) {
            13 {
                Switch($this.ActiveChevronIndex) {
                    0 {
                        $Script:StatusEsSelectedSlot = [ActionSlot]::A
                    }

                    1 {
                        $Script:StatusEsSelectedSlot = [ActionSlot]::B
                    }

                    2 {
                        $Script:StatusEsSelectedSlot = [ActionSlot]::C
                    }

                    3 {
                        $Script:StatusEsSelectedSlot = [ActionSlot]::D
                    }
                }
                $Script:StatusScreenMode = [StatusScreenMode]::TechInventorySelection
            }

            27 {
                $Script:ThePreviousGlobalGameState = $Script:TheGlobalGameState
                $Script:TheGlobalGameState         = [GameStatePrimary]::GamePlayScreen
            }

            38 {
                Try {
                    $Script:TheSfxMPlayer.Open($Script:SfxUiChevronMove)
                    $Script:TheSfxMPlayer.Play()
                } Catch {
                    Write-Host 'Blew up.'
                }

                If(($this.ActiveChevronIndex - 1) -LT 0) {
                    $this.Chevrons[$this.ActiveChevronIndex].Item2          = $false
                    $this.Chevrons[$this.ActiveChevronIndex].Item1.UserData = "$([StatusTechniqueSelectionWindow]::PlayerChevronBlankCharacter)"
                    $this.ActiveChevronIndex                                = 3
                    $this.Chevrons[$this.ActiveChevronIndex].Item2          = $true
                    $this.Chevrons[$this.ActiveChevronIndex].Item1.UserData = "$([StatusTechniqueSelectionWindow]::PlayerChevronCharacter)"
                } Elseif(($this.ActiveChevronIndex - 1) -GE 0) {
                    $this.Chevrons[$this.ActiveChevronIndex].Item2          = $false
                    $this.Chevrons[$this.ActiveChevronIndex].Item1.UserData = "$([StatusTechniqueSelectionWindow]::PlayerChevronBlankCharacter)"
                    $this.ActiveChevronIndex--
                    $this.Chevrons[$this.ActiveChevronIndex].Item2          = $true
                    $this.Chevrons[$this.ActiveChevronIndex].Item1.UserData = "$([StatusTechniqueSelectionWindow]::PlayerChevronCharacter)"
                }
                $this.PlayerChevronDirty = $true
            }

            40 {
                Try {
                    $Script:TheSfxMPlayer.Open($Script:SfxUiChevronMove)
                    $Script:TheSfxMPlayer.Play()
                } Catch {
                    Write-Host 'Blew up'
                }
                If(($this.ActiveChevronIndex + 1) -GT 3) {
                    $this.Chevrons[$this.ActiveChevronIndex].Item2          = $false
                    $this.Chevrons[$this.ActiveChevronIndex].Item1.UserData = "$([StatusTechniqueSelectionWindow]::PlayerChevronBlankCharacter)"
                    $this.ActiveChevronIndex                                = 0
                    $this.Chevrons[$this.ActiveChevronIndex].Item2          = $true
                    $this.Chevrons[$this.ActiveChevronIndex].Item1.UserData = "$([StatusTechniqueSelectionWindow]::PlayerChevronCharacter)"
                } Elseif(($this.ActiveChevronIndex + 1) -LE 3) {
                    $this.Chevrons[$this.ActiveChevronIndex].Item2          = $false
                    $this.Chevrons[$this.ActiveChevronIndex].Item1.UserData = "$([StatusTechniqueSelectionWindow]::PlayerChevronBlankCharacter)"
                    $this.ActiveChevronIndex++
                    $this.Chevrons[$this.ActiveChevronIndex].Item2          = $true
                    $this.Chevrons[$this.ActiveChevronIndex].Item1.UserData = "$([StatusTechniqueSelectionWindow]::PlayerChevronCharacter)"
                }
                $this.PlayerChevronDirty = $true
            }
        }
    }

    [Void]SetAllActionDrawDirty() {
        $this.ActionADrawDirty = $true
        $this.ActionBDrawDirty = $true
        $this.ActionCDrawDirty = $true
        $this.ActionDDrawDirty = $true
    }
}





###############################################################################
#
# STATUS TECHNIQUE INVENTORY WINDOW
#
###############################################################################
Class StatusTechniqueInventoryWindow : WindowBase {
    Static [Int]$WindowLTRow    = 4
    Static [Int]$WindowLTColumn = 22
    Static [Int]$WindowRBRow    = 16
    Static [Int]$WindowRBColumn = 80

    Static [String]$IChevronCharacter           = '❱'
    Static [String]$IChevronCharacterBlank      = ' '
    Static [String]$PagingChevronRightCharacter = "`u{1433}"
    Static [String]$PagingChevronLeftCharacter  = "`u{1438}"
    Static [String]$PagingChevronBlankCharacter = ' '
    Static [String]$DivLineHorizontalString     = '─────────────────────────────────────────────────────────'
    Static [String]$ZpLineBlank                 = '                                                         '
    Static [String]$DescLineBlank               = '                                                         '
    Static [String]$ZeroPagePrompt              = 'You have no techniques in your inventory.'
    Static [String]$WindowTitle                 = 'Inventory'

    Static [ATString]$PagingChevronRight = [ATString]@{
        Prefix = [ATStringPrefix]@{
            ForegroundColor = [CCAppleYellowLight24]::new()
        }
        UserData   = "$([StatusTechniqueInventoryWindow]::PagingChevronRightCharacter)"
        UseATReset = $true
    }
    Static [ATString]$PagingChevronLeft = [ATString]@{
        Prefix = [ATStringPrefix]@{
            ForegroundColor = [CCAppleYellowLight24]::new()
        }
        UserData   = "$([StatusTechniqueInventoryWindow]::PagingChevronLeftCharacter)"
        UseATReset = $true
    }
    Static [ATString]$PagingChevronRightBlank = [ATStringNone]::new()
    Static [ATString]$PagingChevronLeftBlank = [ATStringNone]::new()
    Static [ATString]$DivLineHorizontal = [ATString]@{
        Prefix = [ATStringPrefix]@{
            ForegroundColor = [CCTextDefault24]::new()
        }
        UserData   = "$([StatusTechniqueInventoryWindow]::DivLineHorizontalString)"
        UseATReset = $true
    }

    Static [Boolean]$DebugMode = $false

    [Int]$ItemsPerPage
    [Int]$NumPages
    [Int]$CurrentPage
    [Int]$ActiveIChevronIndex
    [Boolean]$PlayerChevronDirty
    [Boolean]$PagingChevronRightDirty
    [Boolean]$PagingChevronLeftDirty
    [Boolean]$ItemsListDirty
    [Boolean]$CurrentPageDirty
    [Boolean]$PlayerChevronVisible
    [Boolean]$PagingChevronRightVisible
    [Boolean]$PagingChevronLeftVisible
    [Boolean]$ZeroPageActive
    [Boolean]$BookDirty
    [Boolean]$ActiveItemBlinking
    [Boolean]$DivLineDirty
    [Boolean]$ItemDescDirty
    [Boolean]$ZpBlankedDirty
    [Boolean]$ZpPromptDirty
    [Boolean]$IsActive
    [Boolean]$IsBlanked
    [List[ATString]]$ItemLabels
    [List[ATString]]$ItemLabelBlanks
    [List[BattleAction]]$PageRefs
    [List[ValueTuple[[ATString], [Boolean]]]]$IChevrons

    StatusTechniqueInventoryWindow() : base() {
        $this.LeftTop = [ATCoordinates]@{
            Row    = [StatusTechniqueInventoryWindow]::WindowLTRow
            Column = [StatusTechniqueInventoryWindow]::WindowLTColumn
        }
        $this.RightBottom = [ATCoordinates]@{
            Row    = [StatusTechniqueInventoryWindow]::WindowRBRow
            Column = [StatusTechniqueInventoryWindow]::WindowRBColumn
        }

        $this.UpdateDimensions()

        $this.SetupTitle([StatusTechniqueInventoryWindow]::WindowTitle, [CCTextDefault24]::new())

        $this.ItemsPerPage              = 10
        $this.NumPages                  = 1
        $this.CurrentPage               = 1
        $this.ActiveIChevronIndex       = 0
        $this.PlayerChevronDirty        = $true
        $this.PagingChevronRightDirty   = $true
        $this.PagingChevronLeftDirty    = $true
        $this.ItemsListDirty            = $true
        $this.CurrentPageDirty          = $true
        $this.PlayerChevronVisible      = $true
        $this.PagingChevronRightVisible = $false
        $this.PagingChevronLeftVisible  = $false
        $this.ZeroPageActive            = $false
        $this.BookDirty                 = $true
        $this.ActiveItemBlinking        = $false
        $this.DivLineDirty              = $true
        $this.ItemDescDirty             = $true
        $this.ZpBlankedDirty            = $true
        $this.ZpPromptDirty             = $true
        $this.IsActive                  = $false
        $this.IsBlanked                 = $false
        $this.PageRefs                  = $null

        $this.CreateIChevrons()
        $this.ConfigurePagingChevrons()
        $this.ConfigureDivLine()
    }

    [Void]Draw() {
        ([WindowBase]$this).Draw()

        If($this.IsActive -EQ $true) {
            $this.IsBlanked = $false
            If($this.BookDirty -EQ $true) {
                $this.CalculateNumPages()
                $this.BookDirty = $false
            }
            If($this.CurrentPageDirty -EQ $true) {
                $this.PopulatePage()
            }
            If($this.ZeroPageActive -EQ $true) {
                $this.WriteZeroInventoryPage()
            } Else {
                If($this.DivLineDirty -EQ $true) {
                    Write-Host "$([StatusTechniqueInventoryWindow]::DivLineHorizontal.ToAnsiControlSequenceString())"
                    $this.DivLineDirty = $false
                }
                If($this.PlayerChevronVisible -EQ $true -AND $this.PlayerChevronDirty -EQ $true) {
                    Foreach($ic in $this.IChevrons) {
                        Write-Host "$($ic.Item1.ToAnsiControlSequenceString())"
                    }
                    $this.PlayerChevronDirty = $false
                }
                If($this.NumPages -GT 1) {
                    If($this.CurrentPage -EQ 1) {
                        If($this.PagingChevronLeftVisible -EQ $true) {
                            Write-Host "$([StatusTechniqueInventoryWindow]::PagingChevronLeftBlank.ToAnsiControlSequenceString())"
                            $this.PagingChevronLeftVisible = $false
                            $this.PagingChevronLeftDirty   = $true
                        }
                        If($this.PagingChevronRightVisible -EQ $false) {
                            $this.PagingChevronRightVisible = $true
                        }
                        If(($this.PagingChevronRightVisible -EQ $true) -AND ($this.PagingChevronRightDirty -EQ $true)) {
                            Write-Host "$([StatusTechniqueInventoryWindow]::PagingChevronRight.ToAnsiControlSequenceString())"
                            $this.PagingChevronRightDirty = $false
                        }
                    } Elseif(($this.CurrentPage -GT 1) -AND ($this.CurrentPage -LT $this.NumPages)) {
                        If($this.PagingChevronLeftVisible -EQ $false) {
                            $this.PagingChevronLeftVisible = $true
                        }
                        If($this.PagingChevronRightVisible -EQ $false) {
                            $this.PagingChevronRightVisible = $true
                        }
                        If(($this.PagingChevronRightVisible -EQ $true) -AND ($this.PagingChevronRightDirty -EQ $true)) {
                            Write-Host "$([StatusTechniqueInventoryWindow]::PagingChevronLeft.ToAnsiControlSequenceString())"
                            $this.PagingChevronRightDirty = $false
                        }
                        If(($this.PagingChevronLeftVisible -EQ $true) -AND ($this.PagingChevronLeftDirty -EQ $true)) {
                            Write-Host "$([StatusTechniqueInventoryWindow]::PagingChevronRight.ToAnsiControlSequenceString())"
                            $this.PagingChevronLeftDirty = $false
                        }
                    } Elseif($this.CurrentPage -GE $this.NumPages) {
                        If($this.PagingChevronRightVisible -EQ $true) {
                            Write-Host "$([StatusTechniqueInventoryWindow]::PagingChevronRightBlank.ToAnsiControlSequenceString())"
                            $this.PagingChevronRightVisible = $false
                            $this.PagingChevronRightDirty   = $true
                        }
                        If($this.PagingChevronLeftVisible -EQ $false) {
                            $this.PagingChevronLeftVisible = $true
                        }
                        If(($this.PagingChevronLeftVisible -EQ $true) -AND ($this.PagingChevronLeftDirty -EQ $true)) {
                            Write-Host "$([StatusTechniqueInventoryWindow]::PagingChevronLeft.ToAnsiControlSequenceString())"
                            $this.PagingChevronLeftDirty = $false
                        }
                    }
                } Elseif($this.NumPages -EQ 1) {
                    If($this.PagingChevronLeftVisible -EQ $true) {
                        $this.PagingChevronLeftVisible = $false
                    }
                    If($this.PagingChevronRightVisible -EQ $true) {
                        $this.PagingChevronRightVisible = $false
                    }
                    If($this.PagingChevronLeftVisible -EQ $false) {
                        Write-Host "$([StatusTechniqueInventoryWindow]::PagingChevronLeftBlank.ToAnsiControlSequenceString())"
                    }
                    If($this.PagingChevronRightVisible -EQ $false) {
                        Write-Host "$([StatusTechniqueInventoryWindow]::PagingChevronRightBlank.ToAnsiControlSequenceString())"
                    }
                }
                If($this.ActiveItemBlinking -EQ $false) {
                    $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.Decorations = [ATDecoration]@{
                        Blink = $true
                    }
                    $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.ForegroundColor = [CCListItemCurrentHighlight24]::new()
                    $this.ItemsListDirty                                               = $true
                    $this.ActiveItemBlinking                                           = $true
                }
                If($this.ItemsListDirty -EQ $true) {
                    $this.WriteItemLabels()
                    Write-Host "$([ATControlSequences]::CursorHide)"
                    $this.ItemsListDirty = $false
                }
                If($this.ItemDescDirty -EQ $true) {
                    [ATStringComposite]$a = [ATStringComposite]::new(@(
                        [ATString]@{
                            Prefix = [ATStringPrefix]@{
                                ForegroundColor = [CCTextDefault24]::new()
                                Coordinates     = [ATCoordinates]@{
                                    Row    = $this.RightBottom.Row - 3
                                    Column = $this.LeftTop.Column + 1
                                }
                            }
                            UserData   = "$([StatusTechniqueInventoryWindow]::DescLineBlank)"
                            UseATReset = $true
                        },
                        [ATString]@{
                            Prefix = [ATStringPrefix]@{
                                ForegroundColor = [CCTextDefault24]::new()
                                Coordinates     = [ATCoordinates]@{
                                    Row    = $this.RightBottom.Row - 3
                                    Column = $this.LeftTop.Column + 2
                                }
                            }
                            UserData   = "$($this.PageRefs[$this.ActiveIChevronIndex].Description)"
                            UseATReset = $true
                        },
                        [ATString]@{
                            Prefix = [ATStringPrefix]@{
                                ForegroundColor = [CCTextDefault24]::new()
                                Coordinates     = [ATCoordinates]@{
                                    Row    = $this.RightBottom.Row - 1
                                    Column = $this.LeftTop.Column + 1
                                }
                            }
                            UserData   = "$([StatusTechniqueInventoryWindow]::DescLineBlank)"
                            UseATReset = $true
                        },
                        [ATString]@{
                            Prefix = [ATStringPrefix]@{
                                ForegroundColor = [CCTextDefault24]::new()
                                Coordinates     = [ATCoordinates]@{
                                    Row    = $this.RightBottom.Row - 1
                                    Column = $this.LeftTop.Column + 2
                                }
                            }
                            UserData = 'AFF: '
                        },
                        [ATString]@{
                            Prefix = [ATStringPrefix]@{
                                ForegroundColor = $Script:BATAdornmentCharTable[$this.PageRefs[$this.ActiveIChevronIndex].Type].Item2
                            }
                            UserData   = "$($Script:BATAdornmentCharTable[$this.PageRefs[$this.ActiveIChevronIndex].Type].Item1)"
                            UseATReset = $true
                        },
                        [ATString]@{
                            Prefix = [ATStringPrefix]@{
                                ForegroundColor = [CCTextDefault24]::new()
                            }
                            UserData   = "   PWR: $($this.PageRefs[$this.ActiveIChevronIndex].EffectValue)   MP COST: $("{0:d2}" -F $this.PageRefs[$this.ActiveIChevronIndex].MpCost)   CHANCE: $("{0:f0}" -F ($this.PageRefs[$this.ActiveIChevronIndex].Chance * 100))%"
                            UseATReset = $true
                        }
                    ))
                    Write-Host "$($a.ToAnsiControlSequenceString())"
                }
            }
        } Else {
            If($this.IsBlanked -EQ $false) {
                Foreach($Row in 5..15) {
                    [ATString]$a = [ATString]@{
                        Prefix = [ATStringPrefix]@{
                            Coordinates = [ATCoordinates]@{
                                Row    = $Row
                                Column = $this.LeftTop.Column + 1
                            }
                        }
                        UserData   = "$([StatusTechniqueInventoryWindow]::ZpLineBlank)"
                        UseATReset = $true
                    }
                    Write-Host "$($a.ToAnsiControlSequenceString())"
                }
                $this.IsBlanked = $true
            }
        }
    }

    [Void]CreateIChevrons() {
        $this.IChevrons = [List[ValueTuple[[ATString], [Boolean]]]]::new()
        $this.IChevrons.Add([ValueTuple]::Create(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleGreenLight24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = $this.LeftTop.Row + 2
                        Column = $this.LeftTop.Column + 1
                    }
                }
                UserData   = "$([StatusTechniqueInventoryWindow]::IChevronCharacter)"
                UseATReset = $true
            },
            $true
        ))
        $this.IChevrons.Add([ValueTuple]::Create(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleGreenLight24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = $this.LeftTop.Row + 3
                        Column = $this.LeftTop.Column + 1
                    }
                }
                UserData   = "$([StatusTechniqueInventoryWindow]::IChevronCharacterBlank)"
                UseATReset = $true
            },
            $false
        ))
        $this.IChevrons.Add([ValueTuple]::Create(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleGreenLight24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = $this.LeftTop.Row + 4
                        Column = $this.LeftTop.Column + 1
                    }
                }
                UserData   = "$([StatusTechniqueInventoryWindow]::IChevronCharacterBlank)"
                UseATReset = $true
            },
            $false
        ))
        $this.IChevrons.Add([ValueTuple]::Create(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleGreenLight24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = $this.LeftTop.Row + 5
                        Column = $this.LeftTop.Column + 1
                    }
                }
                UserData   = "$([StatusTechniqueInventoryWindow]::IChevronCharacterBlank)"
                UseATReset = $true
            },
            $false
        ))
        $this.IChevrons.Add([ValueTuple]::Create(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleGreenLight24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = $this.LeftTop.Row + 6
                        Column = $this.LeftTop.Column + 1
                    }
                }
                UserData   = "$([StatusTechniqueInventoryWindow]::IChevronCharacterBlank)"
                UseATReset = $true
            },
            $false
        ))
        $this.IChevrons.Add([ValueTuple]::Create(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleGreenLight24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = $this.LeftTop.Row + 2
                        Column = $this.RightBottom.Column - 17
                    }
                }
                UserData   = "$([StatusTechniqueInventoryWindow]::IChevronCharacterBlank)"
                UseATReset = $true
            },
            $false
        ))
        $this.IChevrons.Add([ValueTuple]::Create(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleGreenLight24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = $this.LeftTop.Row + 3
                        Column = $this.RightBottom.Column - 17
                    }
                }
                UserData   = "$([StatusTechniqueInventoryWindow]::IChevronCharacterBlank)"
                UseATReset = $true
            },
            $false
        ))
        $this.IChevrons.Add([ValueTuple]::Create(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleGreenLight24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = $this.LeftTop.Row + 4
                        Column = $this.RightBottom.Column - 17
                    }
                }
                UserData   = "$([StatusTechniqueInventoryWindow]::IChevronCharacterBlank)"
                UseATReset = $true
            },
            $false
        ))
        $this.IChevrons.Add([ValueTuple]::Create(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleGreenLight24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = $this.LeftTop.Row + 5
                        Column = $this.RightBottom.Column - 17
                    }
                }
                UserData   = "$([StatusTechniqueInventoryWindow]::IChevronCharacterBlank)"
                UseATReset = $true
            },
            $false
        ))
        $this.IChevrons.Add([ValueTuple]::Create(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleGreenLight24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = $this.LeftTop.Row + 6
                        Column = $this.RightBottom.Column - 17
                    }
                }
                UserData   = "$([StatusTechniqueInventoryWindow]::IChevronCharacterBlank)"
                UseATReset = $true
            },
            $false
        ))
    }

    [Void]CreateItemLabels() {
        $this.ItemLabels = [List[ATString]]::new()
        [Int]$c = 0

        Foreach($i in $this.PageRefs) {
            $this.ItemLabels.Add(
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCTextDefault24]::new()
                        Coordinates     = [ATCoordinates]@{
                            Row    = $this.IChevrons[$c].Item1.Prefix.Coordinates.Row
                            Column = $this.IChevrons[$c].Item1.Prefix.Coordinates.Column + 2
                        }
                    }
                    UserData   = "$($i.Name)"
                    UseATReset = $true
                }
            )
            $c++ # TOTALLY A PROGRAMMER JOKE
        }
        $this.ResetIChevronPositions()
        $this.CreateItemLabelBlanks()
    }

    [Void]CreateItemLabelBlanks() {
        $this.ItemLabelBlanks = [List[ATString]]::new()
        $this.ItemLabelBlanks.Add(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    Coordinates = [ATCoordinates]@{
                        Row    = $this.LeftTop.Row + 2
                        Column = $this.LeftTop.Column + 2
                    }
                }
                UserData   = '               '
                UseATReset = $true
            }
        )
        $this.ItemLabelBlanks.Add(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    Coordinates = [ATCoordinates]@{
                        Row    = $this.LeftTop.Row + 3
                        Column = $this.LeftTop.Column + 2
                    }
                }
                UserData   = '               '
                UseATReset = $true
            }
        )
        $this.ItemLabelBlanks.Add(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    Coordinates = [ATCoordinates]@{
                        Row    = $this.LeftTop.Row + 4
                        Column = $this.LeftTop.Column + 2
                    }
                }
                UserData   = '               '
                UseATReset = $true
            }
        )
        $this.ItemLabelBlanks.Add(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    Coordinates = [ATCoordinates]@{
                        Row    = $this.LeftTop.Row + 5
                        Column = $this.LeftTop.Column + 2
                    }
                }
                UserData   = '               '
                UseATReset = $true
            }
        )
        $this.ItemLabelBlanks.Add(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    Coordinates = [ATCoordinates]@{
                        Row    = $this.LeftTop.Row + 6
                        Column = $this.LeftTop.Column + 2
                    }
                }
                UserData   = '               '
                UseATReset = $true
            }
        )
        $this.ItemLabelBlanks.Add(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    Coordinates = [ATCoordinates]@{
                        Row    = $this.LeftTop.Row + 2
                        Column = $this.RightBottom.Column - 16
                    }
                }
                UserData   = '               '
                UseATReset = $true
            }
        )
        $this.ItemLabelBlanks.Add(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    Coordinates = [ATCoordinates]@{
                        Row    = $this.LeftTop.Row + 3
                        Column = $this.RightBottom.Column - 16
                    }
                }
                UserData   = '               '
                UseATReset = $true
            }
        )
        $this.ItemLabelBlanks.Add(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    Coordinates = [ATCoordinates]@{
                        Row    = $this.LeftTop.Row + 4
                        Column = $this.RightBottom.Column - 16
                    }
                }
                UserData   = '               '
                UseATReset = $true
            }
        )
        $this.ItemLabelBlanks.Add(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    Coordinates = [ATCoordinates]@{
                        Row    = $this.LeftTop.Row + 5
                        Column = $this.RightBottom.Column - 16
                    }
                }
                UserData   = '               '
                UseATReset = $true
            }
        )
        $this.ItemLabelBlanks.Add(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    Coordinates = [ATCoordinates]@{
                        Row    = $this.LeftTop.Row + 6
                        Column = $this.RightBottom.Column - 16
                    }
                }
                UserData   = '               '
                UseATReset = $true
            }
        )
    }

    [Void]CalculateNumPages() {
        $pp = $Script:ThePlayer.ActionInventory.Listing.Count / $this.ItemsPerPage
        If($pp -LT 1) {
            $this.NumPages = 1
        } Else {
            $this.NumPages = [Math]::Ceiling($pp)
        }
        If($this.CurrentPage -GT $this.NumPages) {
            $this.CurrentPage = $this.NumPages
        }
    }

    [Void]TurnPageForward() {
        If(($this.CurrentPage + 1) -LE $this.NumPages) {
            $this.CurrentPage++
            $this.CurrentPageDirty   = $true
            $this.ActiveItemBlinking = $false
            $this.ItemDescDirty      = $true
        }
    }

    [Void]TurnPageBackward() {
        If(($this.CurrentPage - 1) -GE 1) {
            $this.CurrentPage--
            $this.CurrentPageDirty   = $true
            $this.ActiveItemBlinking = $false
            $this.ItemDescDirty      = $true
        }
    }

    [Void]PopulatePage() {
        If($Script:ThePlayer.ActionInventory.Listing.Count -LE 0) {
            $this.ZeroPageActive   = $true
            $this.CurrentPageDirty = $false
            $this.ZpPromptDirty    = $true
            $this.ZpBlankedDirty   = $true
        } Else {
            $this.PageRefs       = [List[BattleAction]]::new()
            $this.ZeroPageActive = $false
            $rs                  = (($this.CurrentPage * $this.ItemsPerPage) - $this.ItemsPerPage)
            $rs                  = [Math]::Clamp($rs, 0, [Int]::MaxValue)
            $re                  = 10
            
            Try {
                $this.PageRefs = $Script:ThePlayer.ActionInventory.Listing.GetRange($rs, $re)
            } Catch {
                $this.PageRefs = $Script:ThePlayer.ActionInventory.Listing.GetRange($rs, ($Script:ThePlayer.ActionInventory.Listing.Count - $rs))
            }
            $this.CreateItemLabels()
            $this.ItemsListDirty   = $true
            $this.CurrentPageDirty = $false
        }
    }

    [Void]WriteItemLabels() {
        Foreach($i in $this.ItemLabelBlanks) {
            Write-Host "$($i.ToAnsiControlSequenceString())"
        }
        Foreach($i in $this.ItemLabels) {
            Write-Host "$($i.ToAnsiControlSequenceString())"
        }
    }

    [ATString]GetActiveIChevron() {
        $this.ActiveIChevronIndex = 0

        Foreach($a in $this.IChevrons) {
            If($a.Item2 -EQ $true) {
                Return $a.Item1
            }
            $this.ActiveIChevronIndex++
        }
        $this.ActiveIChevronIndex                        = 0
        $this.IChevrons[$this.ActiveIChevronIndex].Item2 = $true

        Return $this.IChevrons[$this.ActiveIChevronIndex].Item1
    }

    [Void]WriteZeroInventoryPage() {
        If($this.ZpBlankedDirty -EQ $true) {
            Foreach($a in 5..15) {
                [ATString]$b = [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCTextDefault24]::new()
                        BackgroundColor = [CCAppleBlueDark24]::new()
                        Coordinates = [ATCoordinates]@{
                            Row    = $a
                            Column = $this.LeftTop.Column + 1
                        }
                    }
                    UserData   = "$([StatusTechniqueInventoryWindow]::ZpLineBlank)"
                    UseATReset = $true
                }
                Write-Host "$($b.ToAnsiControlSequenceString())"
            }
            $this.ZpBlankedDirty = $false
        }
        If($this.ZpPromptDirty -EQ $true) {
            [ATString]$a = [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = $this.LeftTop.Row + ($this.Height / 2)
                        Column = $this.LeftTop.Column + (($this.Width / 2) - ([StatusTechniqueInventoryWindow]::ZeroPagePrompt.Length / 2))
                    }
                }
                UserData   = "$([StatusTechniqueInventoryWindow]::ZeroPagePrompt)"
                UseATReset = $true
            }
            Write-Host "$($a.ToAnsiControlSequenceString())"
            $this.ZpPromptDirty = $false
        }
    }

    [Void]WriteMoronPage() {}

    [Void]ResetIChevronPositions() {
        $this.IChevrons[$this.ActiveIChevronIndex].Item2          = $false
        $this.IChevrons[$this.ActiveIChevronIndex].Item1.UserData = "$([StatusTechniqueInventoryWindow]::IChevronCharacterBlank)"
        Try {
            $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.Decorations     = [ATDecorationNone]::new()
            $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.ForegroundColor = [CCTextDefault24]::new()
        } Catch {}
        $this.ActiveIChevronIndex                                      = 0
        $this.IChevrons[$this.ActiveIChevronIndex].Item2               = $true
        $this.IChevrons[$this.ActiveIChevronIndex].Item1.UserData      = "$([StatusTechniqueInventoryWindow]::IChevronCharacter)"
        $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.Decorations = [ATDecoration]@{
            Blink = $true
        }
        $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.ForegroundColor = [CCApplePinkLight24]::new()
        $this.PlayerChevronDirty                                           = $true
        $this.ActiveItemBlinking                                           = $false
        $this.ItemDescDirty                                                = $true
    }

    [Void]HandleInput() {
        $keyCap = $(Get-Host).UI.RawUI.ReadKey('IncludeKeyDown, NoEcho')
        Switch($keyCap.VirtualKeyCode) {
            13 {
                $Script:StatusIsSelected      = $this.PageRefs[$this.ActiveIChevronIndex]
                [BattleAction]$EquippedAction = $Script:ThePlayer.ActionListing[$Script:StatusEsSelectedSlot]
                If($null -EQ $EquippedAction) {
                    $Script:ThePlayer.ActionListing[$Script:StatusEsSelectedSlot] = [BattleAction]::new($Script:StatusIsSelected)
                    $Script:ThePlayer.ActionInventory.RemoveActionByName($Script:StatusIsSelected.Name)
                } Else {
                    [Int]$RootCollectionIndex = $this.CurrentPage -EQ 1 ? $this.ActiveIChevronIndex : ((($this.CurrentPage - 1) * $this.ItemsPerPage) + $this.ActiveIChevronIndex)
                    $Script:ThePlayer.ActionListing[$Script:StatusEsSelectedSlot]   = [BattleAction]::new($Script:StatusIsSelected)
                    $Script:ThePlayer.ActionInventory.Listing[$RootCollectionIndex] = [BattleAction]::new($EquippedAction)
                }
                $Script:StatusScreenMode = [StatusScreenMode]::EquippedTechSelection
            }

            27 {
                $Script:StatusScreenMode = [StatusScreenMode]::EquippedTechSelection
            }

            38 {
                Try {
                    $Script:TheSfxMPlayer.Open($Script:SfxUiChevronMove)
                    $Script:TheSfxMPlayer.Play()
                } Catch {
                    Write-Host 'Blew up.'
                }
                If(($this.ActiveIChevronIndex -1) -GE 0) {
                    $this.IChevrons[$this.ActiveIChevronIndex].Item2                   = $false
                    $this.IChevrons[$this.ActiveIChevronIndex].Item1.UserData          = "$([StatusTechniqueInventoryWindow]::IChevronCharacterBlank)"
                    $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.Decorations     = [ATDecorationNone]::new()
                    $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.ForegroundColor = [CCTextDefault24]::new()
                    $this.ActiveIChevronIndex--
                    $this.IChevrons[$this.ActiveIChevronIndex].Item2                   = $true
                    $this.IChevrons[$this.ActiveIChevronIndex].Item1.UserData          = "$([StatusTechniqueInventoryWindow]::IChevronCharacter)"
                    $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.Decorations     = [ATDecoration]@{
                        Blink = $true
                    }
                    $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.ForegroundColor = [CCApplePinkLight24]::new()
                }
                $this.PlayerChevronDirty = $true
                $this.ActiveItemBlinking = $false
                $this.ItemDescDirty      = $true
                $this.DivLineDirty       = $true
            }

            40 {
                Try {
                    $Script:TheSfxMPlayer.Open($Script:SfxUiChevronMove)
                    $Script:TheSfxMPlayer.Play()
                } Catch {
                    Write-Host 'Blew up.'
                }
                If(($this.ActiveIChevronIndex + 1) -LT $this.PageRefs.Count) {
                    $this.IChevrons[$this.ActiveIChevronIndex].Item2                   = $false
                    $this.IChevrons[$this.ActiveIChevronIndex].Item1.UserData          = "$([StatusTechniqueInventoryWindow]::IChevronCharacterBlank)"
                    $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.Decorations     = [ATDecorationNone]::new()
                    $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.ForegroundColor = [CCTextDefault24]::new()
                    $this.ActiveIChevronIndex++
                    $this.IChevrons[$this.ActiveIChevronIndex].Item2                   = $true
                    $this.IChevrons[$this.ActiveIChevronIndex].Item1.UserData          = "$([StatusTechniqueInventoryWindow]::IChevronCharacter)"
                    $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.Decorations     = [ATDecoration]@{
                        Blink = $true
                    }
                    $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.ForegroundColor = [CCApplePinkLight24]::new()
                }
                $this.PlayerChevronDirty = $true
                $this.ActiveItemBlinking = $false
                $this.ItemDescDirty      = $true
                $this.DivLineDirty       = $true
            }

            39 {
                Try {
                    $Script:TheSfxMPlayer.Open($Script:SfxUiChevronMove)
                    $Script:TheSfxMPlayer.Play()
                } Catch {
                    Write-Host 'Blew up.'
                }
                If(($this.ActiveIChevronIndex + 5) -LT $this.PageRefs.Count) {
                    $this.IChevrons[$this.ActiveIChevronIndex].Item2                   = $false
                    $this.IChevrons[$this.ActiveIChevronIndex].Item1.UserData          = "$([StatusTechniqueInventoryWindow]::IChevronCharacterBlank)"
                    $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.Decorations     = [ATDecorationNone]::new()
                    $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.ForegroundColor = [CCTextDefault24]::new()
                    $this.ActiveIChevronIndex += 5
                    $this.IChevrons[$this.ActiveIChevronIndex].Item2                   = $true
                    $this.IChevrons[$this.ActiveIChevronIndex].Item1.UserData          = "$([StatusTechniqueInventoryWindow]::IChevronCharacter)"
                    $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.Decorations     = [ATDecoration]@{
                        Blink = $true
                    }
                    $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.ForegroundColor = [CCApplePinkLight24]::new()
                }
                $this.PlayerChevronDirty = $true
                $this.ActiveItemBlinking = $false
                $this.ItemDescDirty      = $true
                $this.DivLineDirty       = $true
            }

            37 {
                Try {
                    $Script:TheSfxMPlayer.Open($Script:SfxUiChevronMove)
                    $Script:TheSfxMPlayer.Play()
                } Catch {
                    Write-Host 'Blew up.'
                }
                If(($this.ActiveIChevronIndex - 5) -GE 0) {
                    $this.IChevrons[$this.ActiveIChevronIndex].Item2                   = $false
                    $this.IChevrons[$this.ActiveIChevronIndex].Item1.UserData          = "$([StatusTechniqueInventoryWindow]::IChevronCharacterBlank)"
                    $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.Decorations     = [ATDecorationNone]::new()
                    $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.ForegroundColor = [CCTextDefault24]::new()
                    $this.ActiveIChevronIndex -= 5
                    $this.IChevrons[$this.ActiveIChevronIndex].Item2                   = $true
                    $this.IChevrons[$this.ActiveIChevronIndex].Item1.UserData          = "$([StatusTechniqueInventoryWindow]::IChevronCharacter)"
                    $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.Decorations     = [ATDecoration]@{
                        Blink = $true
                    }
                    $this.ItemLabels[$this.ActiveIChevronIndex].Prefix.ForegroundColor = [CCApplePinkLight24]::new()
                }
                $this.PlayerChevronDirty = $true
                $this.ActiveItemBlinking = $false
                $this.ItemDescDirty      = $true
                $this.DivLineDirty       = $true
            }

            68 {
                $this.TurnPageForward()
            }

            65 {
                $this.TurnPageBackward()
            }
        }
    }

    [Void]ConfigurePagingChevrons() {
        [StatusTechniqueInventoryWindow]::PagingChevronRight.Prefix.Coordinates = [ATCoordinates]@{
            Row    = $this.LeftTop.Row + 1
            Column = $this.RightBottom.Column - 2
        }
        [StatusTechniqueInventoryWindow]::PagingChevronRightBlank = [ATString]@{
            Prefix     = [ATStringPrefix]::new()
            UserData   = ' '
            UseATReset = $true
        }
        [StatusTechniqueInventoryWindow]::PagingChevronRightBlank.Prefix.Coordinates = [ATCoordinates]::new([StatusTechniqueInventoryWindow]::PagingChevronRight.Prefix.Coordinates)
        [StatusTechniqueInventoryWindow]::PagingChevronLeft.Prefix.Coordinates = [ATCoordinates]@{
            Row    = $this.LeftTop.Row + 1
            Column = $this.LeftTop.Column + 2
        }
        [StatusTechniqueInventoryWindow]::PagingChevronLeftBlank = [ATString]@{
            Prefix     = [ATStringPrefix]::new()
            UserData   = ' '
            UseATReset = $true
        }
        [StatusTechniqueInventoryWindow]::PagingChevronLeftBlank.Prefix.Coordinates = [ATCoordinates]::new([StatusTechniqueInventoryWindow]::PagingChevronLeft.Prefix.Coordinates)
    }

    [Void]ConfigureDivLine() {
        [StatusTechniqueInventoryWindow]::DivLineHorizontal.Prefix.Coordinates = [ATCoordinates]@{
            Row    = $this.RightBottom.Row - 4
            Column = $this.LeftTop.Column + 1
        }
    }

    [Void]SetFlagsDirty() {
        $this.BookDirty        = $true
        $this.CurrentPageDirty = $true
        $this.DivLineDirty     = $true
        $this.CurrentPage      = 1
    }
}





###############################################################################
#
# BATTLE PHASE INDICATOR
#
###############################################################################
Class BattlePhaseIndicator {
    [Boolean]$IndicatorDrawDirty
    [ATCoordinates]$IndicatorDrawCoords
    [ATStringComposite]$IndicatorStringActual
    [ATStringComposite]$IndicatorStringBlank

    BattlePhaseIndicator() {
        $this.IndicatorDrawCoords = [ATCoordinates]@{
            Row    = 24
            Column = 1
        }
    }

    [Void]Draw(
        [BattleEntity]$ActingEntity
    ) {
        If($this.IndicatorDrawDirty -EQ $true) {
            $this.IndicatorStringBlank = [ATStringComposite]::new(@(
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCApplePinkLight24]::new()
                        Coordinates     = $this.IndicatorDrawCoords
                    }
                    UserData = 'Turn: '
                },
                [ATString]@{
                    UserData   = '              '
                    UseATReset = $true
                }
            ))
            $this.IndicatorStringActual = [ATStringComposite]::new(@(
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = [CCApplePinkLight24]::new()
                        Coordinates     = $this.IndicatorDrawCoords
                    }
                    UserData = 'Turn: '
                },
                [ATString]@{
                    Prefix = [ATStringPrefix]@{
                        ForegroundColor = $ActingEntity.NameDrawColor
                    }
                    UserData   = "$($ActingEntity.Name)"
                    UseATReset = $true
                }
            ))
            Write-Host "$($this.IndicatorStringBlank.ToAnsiControlSequenceString())$($this.IndicatorStringActual.ToAnsiControlSequenceString())"
            # I'M OMITTING THE ORIGINAL CALL I MADE HERE TO RESET THE CURSOR POSITION TO ORIGIN - SEEMS LIKE A SHIT CALL TO MAKE
            $this.IndicatorDrawDirty = $true
        }
    }
}





###############################################################################
#
# SPLASH SCREEN A (SSA) "FIGLET"
#
# I'M HIJACKING THE FIGLET!
#
# ... SORT OF. IT'S HARD CODED. DOES THIS STILL COUNT?
#
###############################################################################
Class SSAFiglet {
    # I DID IT AGAIN! FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
    Static [String]$LineBlankData = ' ' * $Script:MaxWidth

    # THIS LOOKS REALLY NEAT IN HERE
    # DOESN'T LINE UP FOR SHIT IN THE CODE, BUT WHATEVS
    Static [String]$TitleDataLine1 = '     ░        ░░  ░░░░░░░░       ░░░░      ░░░       ░░░        ░░░      ░░     '
    Static [String]$TitleDataLine2 = '     ▒  ▒▒▒▒▒▒▒▒  ▒▒▒▒▒▒▒▒  ▒▒▒▒  ▒▒  ▒▒▒▒  ▒▒  ▒▒▒▒  ▒▒▒▒▒  ▒▒▒▒▒  ▒▒▒▒  ▒     '
    Static [String]$TitleDataLine3 = '     ▓      ▓▓▓▓  ▓▓▓▓▓▓▓▓  ▓▓▓▓  ▓▓  ▓▓▓▓  ▓▓       ▓▓▓▓▓▓  ▓▓▓▓▓  ▓▓▓▓  ▓     '
    Static [String]$TitleDataLine4 = '     █  ████████  ████████  ████  ██  ████  ██  ███  ██████  █████        █     '
    Static [String]$TitleDataLine5 = '     █        ██        ██       ████      ███  ████  ██        ██  ████  █     '

    Static [Int]$DrawTop  = 1
    Static [Int]$DrawLeft = 1

    [Boolean]$Dirty
    [ATStringComposite]$Title

    SSAFiglet() {
        $this.Dirty = $true
        $this.Title = [ATStringComposite]::new(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCBlack24]::new()
                    BackgroundColor = [CCBlack24]::new()
                    Coordinates = [ATCoordinates]@{
                        Row    = [SSAFiglet]::DrawTop
                        Column = [SSAFiglet]::DrawLeft
                    }
                }
                UserData   = "$([SSAFiglet]::LineBlankData)"
                UseATReset = $true
            }
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleNMintLight24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = [SSAFiglet]::DrawTop
                        Column = [SSAFiglet]::DrawLeft
                    }
                }
                UserData   = "$([SSAFiglet]::TitleDataLine1)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCBlack24]::new()
                    BackgroundColor = [CCBlack24]::new()
                    Coordinates = [ATCoordinates]@{
                        Row    = [SSAFiglet]::DrawTop + 1
                        Column = [SSAFiglet]::DrawLeft
                    }
                }
                UserData   = "$([SSAFiglet]::LineBlankData)"
                UseATReset = $true
            }
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleNGreenLight24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = [SSAFiglet]::DrawTop + 1
                        Column = [SSAFiglet]::DrawLeft
                    }
                }
                UserData   = "$([SSAFiglet]::TitleDataLine2)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCBlack24]::new()
                    BackgroundColor = [CCBlack24]::new()
                    Coordinates = [ATCoordinates]@{
                        Row    = [SSAFiglet]::DrawTop + 2
                        Column = [SSAFiglet]::DrawLeft
                    }
                }
                UserData   = "$([SSAFiglet]::LineBlankData)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleNMintLight24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = [SSAFiglet]::DrawTop + 2
                        Column = [SSAFiglet]::DrawLeft
                    }
                }
                UserData   = "$([SSAFiglet]::TitleDataLine3)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCBlack24]::new()
                    BackgroundColor = [CCBlack24]::new()
                    Coordinates = [ATCoordinates]@{
                        Row    = [SSAFiglet]::DrawTop + 3
                        Column = [SSAFiglet]::DrawLeft
                    }
                }
                UserData   = "$([SSAFiglet]::LineBlankData)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleNGreenLight24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = [SSAFiglet]::DrawTop + 3
                        Column = [SSAFiglet]::DrawLeft
                    }
                }
                UserData   = "$([SSAFiglet]::TitleDataLine4)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCBlack24]::new()
                    BackgroundColor = [CCBlack24]::new()
                    Coordinates = [ATCoordinates]@{
                        Row    = [SSAFiglet]::DrawTop + 4
                        Column = [SSAFiglet]::DrawLeft
                    }
                }
                UserData   = "$([SSAFiglet]::LineBlankData)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCAppleNMintLight24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = [SSAFiglet]::DrawTop + 4
                        Column = [SSAFiglet]::DrawLeft
                    }
                }
                UserData   = "$([SSAFiglet]::TitleDataLine5)"
                UseATReset = $true
            }
        ))
    }

    [Void]Draw() {
        If($this.Dirty -EQ $true) {
            Write-Host "$($this.Title.CompositeActual[0].ToAnsiControlSequenceString())$($this.Title.CompositeActual[1].ToAnsiControlSequenceString())"
            Start-Sleep -Seconds 0.75
            Write-Host "$($this.Title.CompositeActual[2].ToAnsiControlSequenceString())$($this.Title.CompositeActual[3].ToAnsiControlSequenceString())"
            Start-Sleep -Seconds 0.75
            Write-Host "$($this.Title.CompositeActual[4].ToAnsiControlSequenceString())$($this.Title.CompositeActual[5].ToAnsiControlSequenceString())"
            Start-Sleep -Seconds 0.75
            Write-Host "$($this.Title.CompositeActual[6].ToAnsiControlSequenceString())$($this.Title.CompositeActual[7].ToAnsiControlSequenceString())"
            Start-Sleep -Seconds 0.75
            Write-Host "$($this.Title.CompositeActual[8].ToAnsiControlSequenceString())$($this.Title.CompositeActual[9].ToAnsiControlSequenceString())"
            Start-Sleep -Seconds 0.75
            $this.Dirty = $false
        }
    }
}

Class SSASubtitle {
    Static [Int]$DrawTop  = 9
    Static [Int]$DrawLeft = 33

    [Boolean]$Dirty
    [ATStringComposite]$Text

    SSASubtitle() {
        $this.Dirty = $true
        $this.Text  = [ATStringComposite]::new(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCBlack24]::new()
                    BackgroundColor = [CCBlack24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = [SSASubtitle]::DrawTop
                        Column = [SSASubtitle]::DrawLeft
                    }
                }
                UserData   = ' '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCRandom24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = [SSASubtitle]::DrawTop
                        Column = [SSASubtitle]::DrawLeft
                    }
                }
                UserData   = 'A'
                UseATReset = $true
            },

            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCBlack24]::new()
                    BackgroundColor = [CCBlack24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = [SSASubtitle]::DrawTop
                        Column = [SSASubtitle]::DrawLeft + 1
                    }
                }
                UserData   = ' '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    Coordinates = [ATCoordinates]@{
                        Row    = [SSASubtitle]::DrawTop
                        Column = [SSASubtitle]::DrawLeft + 1
                    }
                }
                UserData   = ' '
                UseATReset = $true
            },

            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCBlack24]::new()
                    BackgroundColor = [CCBlack24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = [SSASubtitle]::DrawTop
                        Column = [SSASubtitle]::DrawLeft + 2
                    }
                }
                UserData   = ' '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCRandom24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = [SSASubtitle]::DrawTop
                        Column = [SSASubtitle]::DrawLeft + 2
                    }
                }
                UserData   = 'N'
                UseATReset = $true
            },

            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCBlack24]::new()
                    BackgroundColor = [CCBlack24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = [SSASubtitle]::DrawTop
                        Column = [SSASubtitle]::DrawLeft + 3
                    }
                }
                UserData   = ' '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCRandom24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = [SSASubtitle]::DrawTop
                        Column = [SSASubtitle]::DrawLeft + 3
                    }
                }
                UserData   = 'O'
                UseATReset = $true
            },

            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCBlack24]::new()
                    BackgroundColor = [CCBlack24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = [SSASubtitle]::DrawTop
                        Column = [SSASubtitle]::DrawLeft + 4
                    }
                }
                UserData   = ' '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCRandom24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = [SSASubtitle]::DrawTop
                        Column = [SSASubtitle]::DrawLeft + 4
                    }
                }
                UserData   = 'T'
                UseATReset = $true
            },

            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCBlack24]::new()
                    BackgroundColor = [CCBlack24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = [SSASubtitle]::DrawTop
                        Column = [SSASubtitle]::DrawLeft + 5
                    }
                }
                UserData   = ' '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    Coordinates = [ATCoordinates]@{
                        Row    = [SSASubtitle]::DrawTop
                        Column = [SSASubtitle]::DrawLeft + 5
                    }
                }
                UserData   = ' '
                UseATReset = $true
            },

            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCBlack24]::new()
                    BackgroundColor = [CCBlack24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = [SSASubtitle]::DrawTop
                        Column = [SSASubtitle]::DrawLeft + 6
                    }
                }
                UserData   = ' '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCRandom24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = [SSASubtitle]::DrawTop
                        Column = [SSASubtitle]::DrawLeft + 6
                    }
                }
                UserData   = 'G'
                UseATReset = $true
            },

            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCBlack24]::new()
                    BackgroundColor = [CCBlack24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = [SSASubtitle]::DrawTop
                        Column = [SSASubtitle]::DrawLeft + 7
                    }
                }
                UserData   = ' '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCRandom24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = [SSASubtitle]::DrawTop
                        Column = [SSASubtitle]::DrawLeft + 7
                    }
                }
                UserData   = 'A'
                UseATReset = $true
            },

            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCBlack24]::new()
                    BackgroundColor = [CCBlack24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = [SSASubtitle]::DrawTop
                        Column = [SSASubtitle]::DrawLeft + 8
                    }
                }
                UserData   = ' '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCRandom24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = [SSASubtitle]::DrawTop
                        Column = [SSASubtitle]::DrawLeft + 8
                    }
                }
                UserData   = 'R'
                UseATReset = $true
            },

            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCBlack24]::new()
                    BackgroundColor = [CCBlack24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = [SSASubtitle]::DrawTop
                        Column = [SSASubtitle]::DrawLeft + 9
                    }
                }
                UserData   = ' '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCRandom24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = [SSASubtitle]::DrawTop
                        Column = [SSASubtitle]::DrawLeft + 9
                    }
                }
                UserData   = 'Y'
                UseATReset = $true
            },

            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCBlack24]::new()
                    BackgroundColor = [CCBlack24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = [SSASubtitle]::DrawTop
                        Column = [SSASubtitle]::DrawLeft + 10
                    }
                }
                UserData   = ' '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    Coordinates = [ATCoordinates]@{
                        Row    = [SSASubtitle]::DrawTop
                        Column = [SSASubtitle]::DrawLeft + 10
                    }
                }
                UserData   = ' '
                UseATReset = $true
            },

            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCBlack24]::new()
                    BackgroundColor = [CCBlack24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = [SSASubtitle]::DrawTop
                        Column = [SSASubtitle]::DrawLeft + 11
                    }
                }
                UserData   = ' '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCRandom24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = [SSASubtitle]::DrawTop
                        Column = [SSASubtitle]::DrawLeft + 11
                    }
                }
                UserData   = 'G'
                UseATReset = $true
            },

            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCBlack24]::new()
                    BackgroundColor = [CCBlack24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = [SSASubtitle]::DrawTop
                        Column = [SSASubtitle]::DrawLeft + 12
                    }
                }
                UserData   = ' '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCRandom24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = [SSASubtitle]::DrawTop
                        Column = [SSASubtitle]::DrawLeft + 12
                    }
                }
                UserData   = 'A'
                UseATReset = $true
            },

            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCBlack24]::new()
                    BackgroundColor = [CCBlack24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = [SSASubtitle]::DrawTop
                        Column = [SSASubtitle]::DrawLeft + 13
                    }
                }
                UserData   = ' '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCRandom24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = [SSASubtitle]::DrawTop
                        Column = [SSASubtitle]::DrawLeft + 13
                    }
                }
                UserData   = 'M'
                UseATReset = $true
            },

            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCBlack24]::new()
                    BackgroundColor = [CCBlack24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = [SSASubtitle]::DrawTop
                        Column = [SSASubtitle]::DrawLeft + 14
                    }
                }
                UserData   = ' '
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCRandom24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = [SSASubtitle]::DrawTop
                        Column = [SSASubtitle]::DrawLeft + 14
                    }
                }
                UserData   = 'E'
                UseATReset = $true
            }
        ))
    }

    [Void]Draw() {
        $this.Text.CompositeActual[1].Prefix.ForegroundColor = [CCRandom24]::new()
        $this.Text.CompositeActual[5].Prefix.ForegroundColor = [CCRandom24]::new()
        $this.Text.CompositeActual[7].Prefix.ForegroundColor = [CCRandom24]::new()
        $this.Text.CompositeActual[9].Prefix.ForegroundColor = [CCRandom24]::new()
        $this.Text.CompositeActual[13].Prefix.ForegroundColor = [CCRandom24]::new()
        $this.Text.CompositeActual[15].Prefix.ForegroundColor = [CCRandom24]::new()
        $this.Text.CompositeActual[17].Prefix.ForegroundColor = [CCRandom24]::new()
        $this.Text.CompositeActual[19].Prefix.ForegroundColor = [CCRandom24]::new()
        $this.Text.CompositeActual[23].Prefix.ForegroundColor = [CCRandom24]::new()
        $this.Text.CompositeActual[25].Prefix.ForegroundColor = [CCRandom24]::new()
        $this.Text.CompositeActual[27].Prefix.ForegroundColor = [CCRandom24]::new()
        $this.Text.CompositeActual[29].Prefix.ForegroundColor = [CCRandom24]::new()

        If($this.Dirty -EQ $true) {
            Write-Host "$($this.Text.ToAnsiControlSequenceString())"
            $this.Dirty = $false
        }
    }
}

Class SSAPressEnterPrompt {
    Static [Int]$DrawTop    = 15
    Static [Int]$DrawLeft   = 35
    Static [Int]$DataLength = 11

    Static [String]$LineBlankData = ' ' * [SSAPressEnterPrompt]::DataLength

    [Boolean]$Dirty
    [Boolean]$DrawMode
    [ATStringComposite]$Text

    SSAPressEnterPrompt() {
        $this.Dirty    = $true
        $this.DrawMode = $false
        $this.Text     = [ATStringComposite]::new(@(
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    Coordinates     = [ATCoordinates]@{
                        Row    = [SSAPressEnterPrompt]::DrawTop
                        Column = [SSAPressEnterPrompt]::DrawLeft
                    }
                }
                UserData   = "$([SSAPressEnterPrompt]::LineBlankData)"
                UseATReset = $true
            },
            [ATString]@{
                Prefix = [ATStringPrefix]@{
                    ForegroundColor = [CCTextDefault24]::new()
                    Coordinates     = [ATCoordinates]@{
                        Row    = [SSAPressEnterPrompt]::DrawTop
                        Column = [SSAPressEnterPrompt]::DrawLeft
                    }
                }
                UserData   = 'PRESS ENTER'
                UseATReset = $true
            }
        ))
    }

    [Void]Draw() {
        If($this.Dirty -EQ $true) {
            If($this.DrawMode -EQ $false) {
                Write-Host "$($this.Text.CompositeActual[0].ToAnsiControlSequenceString())"
                $this.Dirty = $false
            } Else {
                Write-Host "$($this.Text.CompositeActual[1].ToAnsiControlSequenceString())"
                $this.Dirty = $false
            }
        }
    }
}





###############################################################################
#
# BATTLE MANAGER
#
# THIS CLASS IS SUBJECT TO SERIOUS REFACTORING AT THIS POINT. MOST OF THE CODE
# HERE IS TOTAL GARBAGE.
#
###############################################################################
Class BattleManager {
    [Int]$TurnCounter
    [Int]$TurnLimit
    [BattleEntity]$PhaseOneEntity
    [BattleEntity]$PhaseTwoEntity
    [BattleManagerState]$State

    # AT THIS POINT, I'VE OMITTED THE TWO ACTION FLAGS (THESE SHOULD COME FROM THE ENTITIES THEMSELVES)
    # AND THE SPOILS ACTION MEMBER; NOT SURE WHAT THE FUCK I NEEDED THAT THING FOR. I PROBABLY STILL
    # NEED IT, BUT I'LL WORK AROUND IT.

    BattleManager() {
        # THIS CTOR DID A WHOLE BUNCH OF CRAP THAT REALLY SHOULD BE IN THE STATE TABLE. I'M NOT DOING
        # THAT STUFF HERE.
    }

    [Void]Update() {
        # MAKE PRELIMINARY OUT-OF-BAND DRAW CALLS TO ENSURE THAT THE VISUAL DISPLAY IS KOSHER
        $Script:ThePlayer.Update()
        $Script:TheCurrentEnemy.Update()
        $Script:ThePlayerBattleStatWindow.Draw()
        $Script:TheEnemyBattleStatWindow.Draw()
        $Script:TheBattleEnemyImageWindow.Draw()
        $Script:ThePlayerBattleActionWindow.Draw()
        $Script:TheBattleStatusMessageWindow.Draw()
        $Script:Rui.CursorPosition = $([ATCoordinates]::new(0, 0)).ToAutomationCoordinates()

        # HERE COMES THE HONKER BLOCK
        # THESE CASES WERE ORIGINALLY UNSCOPED, WHICH IS FUCKING LAZY ON MY PART
        Switch($this.State) {
            ([BattleManagerState]::TurnIncrement) {
                If($this.TurnLimit -GT 0) {
                    If(($this.TurnCounter + 1) -GT $this.TurnLimit) {
                        $this.State = [BattleManagerState]::BattleLost

                        Return
                    }
                }
                $this.TurnCounter++
                $this.State = [BattleManagerState]::PhaseOrdering

                Return
            }

            ([BattleManagerState]::PhaseOrdering) {
                [Single]$PlayerEffectiveSpeed = 0.0
                [Single]$EnemyEffectiveSpeed  = 0.0

                $PlayerEffectiveSpeed = $Script:ThePlayer.Stats[[StatId]::Speed].Base + ($(Get-Random -Minimum 0.0 -Maximum 1.0) * $Script:ThePlayer.Stats[[StatId]::Luck].Base)
                $EnemyEffectiveSpeed  = $Script:TheCurrentEnemy.Stats[[StatId]::Speed].Base + ($(Get-Random -Minimum 0.0 -Maximum 1.0) * $Script:TheCurrentEnemy.Stats[[StatId]::Luck].Base)
                [Single]$EsWinner     = [Math]::Max($PlayerEffectiveSpeed, $EnemyEffectiveSpeed)
                If($EsWinner -EQ $PlayerEffectiveSpeed) {
                    $this.PhaseOneEntity = $Script:ThePlayer
                    $this.PhaseTwoEntity = $Script:TheCurrentEnemy
                } Elseif($EsWinner -EQ $EnemyEffectiveSpeed) {
                    $this.PhaseOneEntity = $Script:TheCurrentEnemy
                    $this.PhaseTwoEntity = $Script:ThePlayer
                }
                $this.State = [BattleManagerState]::PhaseAExecution

                Return
            }

            ([BattleManagerState]::PhaseAExecution) {
                # THE FIRST OF THE NASTY BLOCKS
                # DESPITE THIS BEING A SECOND PASS AT THIS CODE, I'LL BE COMMENTING ALONG THE WAY

                # BEFORE DOING ANYTHING, MAKE SURE THAT WE DON'T NEED TO CHANGE OUT TO THE CALCULATION STATE
                # THIS HELPS FACILITATE, PRIMARILY, THAT AN ENTITY CAN'T ACT IF THEY'RE ACTUALLY "DEAD"
                If(($this.PhaseOneEntity.Stats[[StatId]::HitPoints].Base -LE 0) -OR ($this.PhaseTwoEntity.Stats[[StatId]::HitPoints].Base -LE 0)) {
                    $this.State = [BattleManagerState]::Calculation

                    Break
                }

                # UPDATE THE PHASE INDICATOR
                $Script:TheBattlePhaseIndicator.IndicatorDrawDirty = $true
                $Script:TheBattlePhaseIndicator.Draw($this.PhaseOneEntity)

                # ENSURE THAT THE CORRESPONDING STATUS WINDOW HAS A HIGHLIGHT AROUND THE BORDER
                If($this.PhaseOneEntity -IS [Player]) {
                    $Script:ThePlayerBattleStatWindow.EntityBattlePhaseActive = $true
                    $Script:TheEnemyBattleStatWindow.EntityBattlePhaseActive  = $false
                } Else {
                    $Script:ThePlayerBattleStatWindow.EntityBattlePhaseActive = $false
                    $Script:TheEnemyBattleStatWindow.EntityBattlePhaseActive  = $true
                }
                $Script:ThePlayerBattleStatWindow.Draw()
                $Script:TheEnemyBattleStatWindow.Draw()

                # CHECK TO SEE IF THE PHASE ONE ENTITY CAN ACTUALLY ACT
                # REASONS THEY COULDN'T INCLUDE, BUT AREN'T LIMITED TO, STATUS AILMENTS LIKE SLEEP OR PARALYSIS
                If($this.PhaseOneEntity.CanAct -EQ $true) {
                    [BattleAction]$ToExecute          = $null
                    [BattleActionResult]$ActionResult = $null

                    # DETERMINE IF THE PHASE ONE ENTITY IS THE PLAYER OR NOT
                    # DIFFERENT LOGIC NEEDS TO OCCUR DEPENDING UPON THIS DECISION
                    # IF IT'S THE PLAYER, WE NEED TO BLOCK LOOP ON THE BATTLE ACTION
                    # SELECTION WINDOW SO THE PLAYER CAN CHOOSE AN ATTACK TO EXECUTE.
                    If($this.PhaseOneEntity -IS [Player]) {
                        # REFRESH THE BATTLE ACTION SELECTION WINDOW AND BLOCK LOOP ON IT
                        # THE RESULT OF THE SELECTION IS STORED IN TOEXECUTE
                        # NOTE THAT THIS IMPLEMENTATION OF HANDLEINPUT IS AN ANTI-PATTERN
                        # BUT IS REQUIRED
                        $Script:ThePlayerBattleActionWindow.SetAllActionDrawDirty()
                        While($null -EQ $ToExecute) {
                            $Script:ThePlayerBattleActionWindow.Draw()
                            $ToExecute = $Script:ThePlayerBattleActionWindow.HandleInput()
                        }

                        # THIS IS WHERE THINGS START GETTING HAIRY
                        # A LITANY OF CALLS TO WRITECOMPOSITEMESSAGE ON THE BATTLESTATUSMESSAGEWINDOW
                        # OCCUR FOLLOWING. I'M GOING TO ATTEMPT TO CONDENSE THESE CALLS.
                        $Script:TheBattleStatusMessageWindow.WriteEntityUsesMessage(
                            $this.PhaseOneEntity,
                            $this.PhaseTwoEntity,
                            $ToExecute
                        )

                        # ACTUALLY EXECUTE THE SELECTED COMMAND
                        # PS DOES SOME GOOFY SHIT WITH DISPATCHING THESE CALLS TO ICM, BUT THIS HASN'T CAUSED ANY PROBLEMS AFTER MANY HOURS
                        # OF TESTING THUS FAR.
                        $ActionResult = $(Invoke-Command $ToExecute.Effect -ArgumentList $this.PhaseOneEntity, $this.PhaseTwoEntity, $ToExecute)

                        # REFRESH THE PLAYER BATTLE STATUS WINDOW
                        $Script:ThePlayerBattleStatWindow.Draw()
                    } Else {
                        # THE PHASE ONE ENTITY IS THE ENEMY
                        # THE ACTION THE ENEMY USES IS SELECTED FROM THE "MARBLE BAG", SO NO DELAY IS NEEDED HERE.
                        [ActionSlot]$SelectedSlot = $($this.PhaseOneEntity.ActionMarbleBag | Get-Random)
                        $ToExecute                = $this.PhaseOneEntity.ActionListing[$SelectedSlot]

                        # NOTIFY THE BATTLE STATUS MESSAGE WINDOW
                        $Script:TheBattleStatusMessageWindow.WriteEntityUsesMessage(
                            $this.PhaseOneEntity,
                            $this.PhaseTwoEntity,
                            $ToExecute
                        )

                        # EXECUTE THE ACTION AND UPDATE THE ENEMY'S BATTLE STATUS WINDOW
                        $ActionResult = $(Invoke-Command $ToExecute.Effect -ArgumentList $this.PhaseOneEntity, $this.PhaseTwoEntity, $ToExecute)
                        $Script:TheEnemyBattleStatWindow.Draw()
                    }

                    # WE NEED TO EXAMINE THE ACTION RESULT TO SEE WHAT HAPPENED AS A CONSEQUENCE OF RUNNING THE SELECTED ACTION
                    # THIS IS DONE FIRST BY LOOKING AT THE VALUE OF THE TYPE PROPERTY
                    Switch($ActionResult.Type) {
                        ([BattleActionResultType]::SuccessWithCritical) {
                            $Script:TheBattleStatusMessageWindow.WriteBarSwc($ToExecute)

                            Break
                        }

                        ([BattleActionResultType]::SuccessWithAffinityBonus) {
                            $Script:TheBattleStatusMessageWindow.WriteBarAff($ToExecute)

                            Break
                        }

                        ([BattleActionResultType]::SuccessWithCritAndAffinityBonus) {
                            $Script:TheBattleStatusMessageWindow.WriteBarCritAff($ToExecute)

                            Break
                        }

                        ([BattleActionResultType]::Success) {
                            $Script:TheBattleStatusMessageWindow.WriteBarSuccess($ToExecute)

                            Break
                        }

                        ([BattleActionResultType]::FailedAttackMissed) {
                            Try {
                                $Script:TheSfxMPlayer.Open($Script:SfxBaMissFail)
                                $Script:TheSfxMPlayer.Play()
                            } Catch {}

                            $Script:TheBattleStatusMessageWindow.WriteBarFailMissed($ToExecute)

                            Break
                        }

                        ([BattleActionResultType]::FailedAttackFailed) {
                            Try {
                                $Script:TheSfxMPlayer.Open($Script:SfxBaMissFail)
                                $Script:TheSfxMPlayer.Play()
                            } Catch {}

                            $Script:TheBattleStatusMessageWindow.WriteBarFailFailed($ToExecute)

                            Break
                        }
                    }

                    # NEXT WE NEED TO EXAMINE THE TYPE OF THE ACTION EXECUTED TO DO PROVIDE SOME
                    # ADDITIONAL FEEDBACK
                    Switch($ToExecute.Type) {
                        ([BattleActionType]::Physical) {
                            Try {
                                $Script:TheSfxMPlayer.Open($Script:SfxBaPhysicalStrikeA)
                                $Script:TheSfxMPlayer.Play()
                            } Catch {}

                            $Script:TheBattleStatusMessageWindow.WriteBatPhysical(
                                $this.PhaseOneEntity,
                                $this.PhaseTwoEntity,
                                $ToExecute,
                                $ActionResult
                            )

                            Break
                        }

                        ([BattleActionType]::ElementalFire) {
                            Try {
                                $Script:TheSfxMPlayer.Open($Script:SfxBaFireStrikeA)
                                $Script:TheSfxMPlayer.Play()
                            } Catch {}

                            $Script:TheBattleStatusMessageWindow.WriteBatElementalFire(
                                $this.PhaseOneEntity,
                                $this.PhaseTwoEntity,
                                $ToExecute,
                                $ActionResult
                            )

                            Break
                        }

                        ([BattleActionType]::ElementalWater) {
                            # TODO: ADD SOUND EFFECT FOR THIS ELEMENT

                            $Script:TheBattleStatusMessageWindow.WriteBatElementalWater(
                                $this.PhaseOneEntity,
                                $this.PhaseTwoEntity,
                                $ToExecute,
                                $ActionResult
                            )

                            Break
                        }

                        ([BattleActionType]::ElementalEarth) {
                            # TODO: ADD SOUND EFFECT FOR THIS ELEMENT

                            $Script:TheBattleStatusMessageWindow.WriteBatElementalEarth(
                                $this.PhaseOneEntity,
                                $this.PhaseTwoEntity,
                                $ToExecute,
                                $ActionResult
                            )

                            Break
                        }

                        ([BattleActionType]::ElementalWind) {
                            # TODO: ADD SOUND EFFECT FOR THIS ELEMENT

                            $Script:TheBattleStatusMessageWindow.WriteBatElementalWind(
                                $this.PhaseOneEntity,
                                $this.PhaseTwoEntity,
                                $ToExecute,
                                $ActionResult
                            )

                            Break
                        }

                        ([BattleActionType]::ElementalLight) {
                            # TODO: ADD SOUND EFFECT FOR THIS ELEMENT

                            $Script:TheBattleStatusMessageWindow.WriteBatElementalLight(
                                $this.PhaseOneEntity,
                                $this.PhaseTwoEntity,
                                $ToExecute,
                                $ActionResult
                            )

                            Break
                        }

                        ([BattleActionType]::ElementalDark) {
                            # TODO: ADD SOUND EFFECT FOR THIS ELEMENT

                            $Script:TheBattleStatusMessageWindow.WriteBatElementalDark(
                                $this.PhaseOneEntity,
                                $this.PhaseTwoEntity,
                                $ToExecute,
                                $ActionResult
                            )

                            Break
                        }

                        ([BattleActionType]::ElementalIce) {
                            # TODO: ADD SOUND EFFECT FOR THIS ELEMENT

                            $Script:TheBattleStatusMessageWindow.WriteBatElementalIce(
                                $this.PhaseOneEntity,
                                $this.PhaseTwoEntity,
                                $ToExecute,
                                $ActionResult
                            )

                            Break
                        }

                        ([BattleActionType]::MagicPoison) {
                            # TODO: ADD SOUND EFFECT FOR THIS MAGIC

                            $Script:TheBattleStatusMessageWindow.WriteBatMagicPoison(
                                $this.PhaseOneEntity,
                                $this.PhaseTwoEntity,
                                $ToExecute,
                                $ActionResult
                            )

                            Break
                        }

                        ([BattleActionType]::MagicConfuse) {
                            # TODO: ADD SOUND EFFECT FOR THIS MAGIC

                            $Script:TheBattleStatusMessageWindow.WriteBatMagicPoison(
                                $this.PhaseOneEntity,
                                $this.PhaseTwoEntity,
                                $ToExecute,
                                $ActionResult
                            )

                            Break
                        }

                        ([BattleActionType]::MagicSleep) {
                            # TODO: ADD SOUND EFFECT FOR THIS MAGIC

                            $Script:TheBattleStatusMessageWindow.WriteBatMagicSleep(
                                $this.PhaseOneEntity,
                                $this.PhaseTwoEntity,
                                $ToExecute,
                                $ActionResult
                            )

                            Break
                        }

                        ([BattleActionType]::MagicAging) {
                            # TODO: ADD SOUND EFFECT FOR THIS MAGIC

                            $Script:TheBattleStatusMessageWindow.WriteBatMagicAging(
                                $this.PhaseOneEntity,
                                $this.PhaseTwoEntity,
                                $ToExecute,
                                $ActionResult
                            )

                            Break
                        }

                        ([BattleActionType]::MagicHealing) {
                            # TODO: ADD SOUND EFFECT FOR THIS MAGIC

                            $Script:TheBattleStatusMessageWindow.WriteBatMagicHealing(
                                $this.PhaseOneEntity,
                                $this.PhaseTwoEntity,
                                $ToExecute,
                                $ActionResult
                            )

                            Break
                        }

                        ([BattleActionType]::MagicStatAugment) {
                            # TODO: ADD SOUND EFFECT FOR THIS MAGIC

                            # TODO: I'M NOT SURE I'VE CODIFIED IN THE BATTLE RESULT FOR STAT AUGS.

                            Break
                        }
                    }
                } Else {
                    # THE PHASE ONE ENTITY CAN'T ACT AT THIS TIME
                    Try {
                        $Script:TheSfxMPlayer.Open($Script:SfxBaActionDisabled)
                        $Script:TheSfxMPlayer.Play()
                    } Catch {}

                    $Script:TheBattleStatusMessageWindow.WriteEntityCantActMessage(
                        $this.PhaseOneEntity
                    )
                }

                # FACILITATE THE UPDATE OF AUGMENTS AT THE END OF THE TURN
                Foreach($Stat in $this.PhaseOneEntity.Stats.Values) {
                    $Stat.Update()
                    If($Stat.AugmentTurnDuration -EQ 0) {
                        If($this.PhaseOneEntity -IS [Player]) {
                            $Script:ThePlayerBattleStatWindow.SetAllFlagsDirty()
                            $Script:ThePlayerBattleStatWindow.Draw()
                        } Else {
                            $Script:TheEnemyBattleStatWindow.SetAllFlagsDirty()
                            $Script:TheEnemyBattleStatWindow.Draw()
                        }
                    }
                }

                # CHANGE STATE TO PHASE B
                $this.State = [BattleManagerState]::PhaseBExecution

                Break
            }

            ([BattleManagerState]::PhaseBExecution) {
                # THE SECOND OF THE NASTY BLOCKS
                # THIS IS A CARBON COPY OF PHASE A, EXCEPT THAT THE ENTITY CONSIDERED IS THE PHASETWOENTITY

                # BEFORE DOING ANYTHING, MAKE SURE THAT WE DON'T NEED TO CHANGE OUT TO THE CALCULATION STATE
                # THIS HELPS FACILITATE, PRIMARILY, THAT AN ENTITY CAN'T ACT IF THEY'RE ACTUALLY "DEAD"
                If(($this.PhaseOneEntity.Stats[[StatId]::HitPoints].Base -LE 0) -OR ($this.PhaseTwoEntity.Stats[[StatId]::HitPoints].Base -LE 0)) {
                    $this.State = [BattleManagerState]::Calculation

                    Break
                }

                # UPDATE THE PHASE INDICATOR
                $Script:TheBattlePhaseIndicator.IndicatorDrawDirty = $true
                $Script:TheBattlePhaseIndicator.Draw($this.PhaseTwoEntity)

                # ENSURE THAT THE CORRESPONDING STATUS WINDOW HAS A HIGHLIGHT AROUND THE BORDER
                If($this.PhaseTwoEntity -IS [Player]) {
                    $Script:ThePlayerBattleStatWindow.EntityBattlePhaseActive = $true
                    $Script:TheEnemyBattleStatWindow.EntityBattlePhaseActive  = $false
                } Else {
                    $Script:ThePlayerBattleStatWindow.EntityBattlePhaseActive = $false
                    $Script:TheEnemyBattleStatWindow.EntityBattlePhaseActive  = $true
                }
                $Script:ThePlayerBattleStatWindow.Draw()
                $Script:TheEnemyBattleStatWindow.Draw()

                # CHECK TO SEE IF THE PHASE TWO ENTITY CAN ACTUALLY ACT
                # REASONS THEY COULDN'T INCLUDE, BUT AREN'T LIMITED TO, STATUS AILMENTS LIKE SLEEP OR PARALYSIS
                If($this.PhaseTwoEntity.CanAct -EQ $true) {
                    [BattleAction]$ToExecute          = $null
                    [BattleActionResult]$ActionResult = $null

                    # DETERMINE IF THE PHASE TWO ENTITY IS THE PLAYER OR NOT
                    # DIFFERENT LOGIC NEEDS TO OCCUR DEPENDING UPON THIS DECISION
                    # IF IT'S THE PLAYER, WE NEED TO BLOCK LOOP ON THE BATTLE ACTION
                    # SELECTION WINDOW SO THE PLAYER CAN CHOOSE AN ATTACK TO EXECUTE.
                    If($this.PhaseTwoEntity -IS [Player]) {
                        # REFRESH THE BATTLE ACTION SELECTION WINDOW AND BLOCK LOOP ON IT
                        # THE RESULT OF THE SELECTION IS STORED IN TOEXECUTE
                        # NOTE THAT THIS IMPLEMENTATION OF HANDLEINPUT IS AN ANTI-PATTERN
                        # BUT IS REQUIRED
                        $Script:ThePlayerBattleActionWindow.SetAllActionDrawDirty()
                        While($null -EQ $ToExecute) {
                            $Script:ThePlayerBattleActionWindow.Draw()
                            $ToExecute = $Script:ThePlayerBattleActionWindow.HandleInput()
                        }

                        # THIS IS WHERE THINGS START GETTING HAIRY
                        # A LITANY OF CALLS TO WRITECOMPOSITEMESSAGE ON THE BATTLESTATUSMESSAGEWINDOW
                        # OCCUR FOLLOWING. I'M GOING TO ATTEMPT TO CONDENSE THESE CALLS.
                        $Script:TheBattleStatusMessageWindow.WriteEntityUsesMessage(
                            $this.PhaseTwoEntity,
                            $this.PhaseOneEntity,
                            $ToExecute
                        )

                        # ACTUALLY EXECUTE THE SELECTED COMMAND
                        # PS DOES SOME GOOFY SHIT WITH DISPATCHING THESE CALLS TO ICM, BUT THIS HASN'T CAUSED ANY PROBLEMS AFTER MANY HOURS
                        # OF TESTING THUS FAR.
                        $ActionResult = $(Invoke-Command $ToExecute.Effect -ArgumentList $this.PhaseTwoEntity, $this.PhaseOneEntity, $ToExecute)

                        # REFRESH THE PLAYER BATTLE STATUS WINDOW
                        $Script:ThePlayerBattleStatWindow.Draw()
                    } Else {
                        # THE PHASE TWO ENTITY IS THE ENEMY
                        # THE ACTION THE ENEMY USES IS SELECTED FROM THE "MARBLE BAG", SO NO DELAY IS NEEDED HERE.
                        [ActionSlot]$SelectedSlot = $($this.PhaseTwoEntity.ActionMarbleBag | Get-Random)
                        $ToExecute                = $this.PhaseTwoEntity.ActionListing[$SelectedSlot]

                        # NOTIFY THE BATTLE STATUS MESSAGE WINDOW
                        $Script:TheBattleStatusMessageWindow.WriteEntityUsesMessage(
                            $this.PhaseTwoEntity,
                            $this.PhaseOneEntity,
                            $ToExecute
                        )

                        # EXECUTE THE ACTION AND UPDATE THE ENEMY'S BATTLE STATUS WINDOW
                        $ActionResult = $(Invoke-Command $ToExecute.Effect -ArgumentList $this.PhaseTwoEntity, $this.PhaseOneEntity, $ToExecute)
                        $Script:TheEnemyBattleStatWindow.Draw()
                    }

                    # WE NEED TO EXAMINE THE ACTION RESULT TO SEE WHAT HAPPENED AS A CONSEQUENCE OF RUNNING THE SELECTED ACTION
                    # THIS IS DONE FIRST BY LOOKING AT THE VALUE OF THE TYPE PROPERTY
                    Switch($ActionResult.Type) {
                        ([BattleActionResultType]::SuccessWithCritical) {
                            $Script:TheBattleStatusMessageWindow.WriteBarSwc($ToExecute)

                            Break
                        }

                        ([BattleActionResultType]::SuccessWithAffinityBonus) {
                            $Script:TheBattleStatusMessageWindow.WriteBarAff($ToExecute)

                            Break
                        }

                        ([BattleActionResultType]::SuccessWithCritAndAffinityBonus) {
                            $Script:TheBattleStatusMessageWindow.WriteBarCritAff($ToExecute)

                            Break
                        }

                        ([BattleActionResultType]::Success) {
                            $Script:TheBattleStatusMessageWindow.WriteBarSuccess($ToExecute)

                            Break
                        }

                        ([BattleActionResultType]::FailedAttackMissed) {
                            Try {
                                $Script:TheSfxMPlayer.Open($Script:SfxBaMissFail)
                                $Script:TheSfxMPlayer.Play()
                            } Catch {}

                            $Script:TheBattleStatusMessageWindow.WriteBarFailMissed($ToExecute)

                            Break
                        }

                        ([BattleActionResultType]::FailedAttackFailed) {
                            Try {
                                $Script:TheSfxMPlayer.Open($Script:SfxBaMissFail)
                                $Script:TheSfxMPlayer.Play()
                            } Catch {}

                            $Script:TheBattleStatusMessageWindow.WriteBarFailFailed($ToExecute)

                            Break
                        }
                    }

                    # NEXT WE NEED TO EXAMINE THE TYPE OF THE ACTION EXECUTED TO DO PROVIDE SOME
                    # ADDITIONAL FEEDBACK
                    Switch($ToExecute.Type) {
                        ([BattleActionType]::Physical) {
                            Try {
                                $Script:TheSfxMPlayer.Open($Script:SfxBaPhysicalStrikeA)
                                $Script:TheSfxMPlayer.Play()
                            } Catch {}

                            $Script:TheBattleStatusMessageWindow.WriteBatPhysical(
                                $this.PhaseTwoEntity,
                                $this.PhaseOneEntity,
                                $ToExecute,
                                $ActionResult
                            )

                            Break
                        }

                        ([BattleActionType]::ElementalFire) {
                            Try {
                                $Script:TheSfxMPlayer.Open($Script:SfxBaFireStrikeA)
                                $Script:TheSfxMPlayer.Play()
                            } Catch {}

                            $Script:TheBattleStatusMessageWindow.WriteBatElementalFire(
                                $this.PhaseTwoEntity,
                                $this.PhaseOneEntity,
                                $ToExecute,
                                $ActionResult
                            )

                            Break
                        }

                        ([BattleActionType]::ElementalWater) {
                            # TODO: ADD SOUND EFFECT FOR THIS ELEMENT

                            $Script:TheBattleStatusMessageWindow.WriteBatElementalWater(
                                $this.PhaseTwoEntity,
                                $this.PhaseOneEntity,
                                $ToExecute,
                                $ActionResult
                            )

                            Break
                        }

                        ([BattleActionType]::ElementalEarth) {
                            # TODO: ADD SOUND EFFECT FOR THIS ELEMENT

                            $Script:TheBattleStatusMessageWindow.WriteBatElementalEarth(
                                $this.PhaseTwoEntity,
                                $this.PhaseOneEntity,
                                $ToExecute,
                                $ActionResult
                            )

                            Break
                        }

                        ([BattleActionType]::ElementalWind) {
                            # TODO: ADD SOUND EFFECT FOR THIS ELEMENT

                            $Script:TheBattleStatusMessageWindow.WriteBatElementalWind(
                                $this.PhaseTwoEntity,
                                $this.PhaseOneEntity,
                                $ToExecute,
                                $ActionResult
                            )

                            Break
                        }

                        ([BattleActionType]::ElementalLight) {
                            # TODO: ADD SOUND EFFECT FOR THIS ELEMENT

                            $Script:TheBattleStatusMessageWindow.WriteBatElementalLight(
                                $this.PhaseTwoEntity,
                                $this.PhaseOneEntity,
                                $ToExecute,
                                $ActionResult
                            )

                            Break
                        }

                        ([BattleActionType]::ElementalDark) {
                            # TODO: ADD SOUND EFFECT FOR THIS ELEMENT

                            $Script:TheBattleStatusMessageWindow.WriteBatElementalDark(
                                $this.PhaseTwoEntity,
                                $this.PhaseOneEntity,
                                $ToExecute,
                                $ActionResult
                            )

                            Break
                        }

                        ([BattleActionType]::ElementalIce) {
                            # TODO: ADD SOUND EFFECT FOR THIS ELEMENT

                            $Script:TheBattleStatusMessageWindow.WriteBatElementalIce(
                                $this.PhaseTwoEntity,
                                $this.PhaseOneEntity,
                                $ToExecute,
                                $ActionResult
                            )

                            Break
                        }

                        ([BattleActionType]::MagicPoison) {
                            # TODO: ADD SOUND EFFECT FOR THIS MAGIC

                            $Script:TheBattleStatusMessageWindow.WriteBatMagicPoison(
                                $this.PhaseTwoEntity,
                                $this.PhaseOneEntity,
                                $ToExecute,
                                $ActionResult
                            )

                            Break
                        }

                        ([BattleActionType]::MagicConfuse) {
                            # TODO: ADD SOUND EFFECT FOR THIS MAGIC

                            $Script:TheBattleStatusMessageWindow.WriteBatMagicPoison(
                                $this.PhaseTwoEntity,
                                $this.PhaseOneEntity,
                                $ToExecute,
                                $ActionResult
                            )

                            Break
                        }

                        ([BattleActionType]::MagicSleep) {
                            # TODO: ADD SOUND EFFECT FOR THIS MAGIC

                            $Script:TheBattleStatusMessageWindow.WriteBatMagicSleep(
                                $this.PhaseTwoEntity,
                                $this.PhaseOneEntity,
                                $ToExecute,
                                $ActionResult
                            )

                            Break
                        }

                        ([BattleActionType]::MagicAging) {
                            # TODO: ADD SOUND EFFECT FOR THIS MAGIC

                            $Script:TheBattleStatusMessageWindow.WriteBatMagicAging(
                                $this.PhaseTwoEntity,
                                $this.PhaseOneEntity,
                                $ToExecute,
                                $ActionResult
                            )

                            Break
                        }

                        ([BattleActionType]::MagicHealing) {
                            # TODO: ADD SOUND EFFECT FOR THIS MAGIC

                            $Script:TheBattleStatusMessageWindow.WriteBatMagicHealing(
                                $this.PhaseTwoEntity,
                                $this.PhaseOneEntity,
                                $ToExecute,
                                $ActionResult
                            )

                            Break
                        }

                        ([BattleActionType]::MagicStatAugment) {
                            # TODO: ADD SOUND EFFECT FOR THIS MAGIC

                            # TODO: I'M NOT SURE I'VE CODIFIED IN THE BATTLE RESULT FOR STAT AUGS.

                            Break
                        }
                    }
                } Else {
                    # THE PHASE ONE ENTITY CAN'T ACT AT THIS TIME
                    Try {
                        $Script:TheSfxMPlayer.Open($Script:SfxBaActionDisabled)
                        $Script:TheSfxMPlayer.Play()
                    } Catch {}

                    $Script:TheBattleStatusMessageWindow.WriteEntityCantActMessage(
                        $this.PhaseTwoEntity
                    )
                }

                # FACILITATE THE UPDATE OF AUGMENTS AT THE END OF THE TURN
                Foreach($Stat in $this.PhaseTwoEntity.Stats.Values) {
                    $Stat.Update()
                    If($Stat.AugmentTurnDuration -EQ 0) {
                        If($this.PhaseOneEntity -IS [Player]) {
                            $Script:ThePlayerBattleStatWindow.SetAllFlagsDirty()
                            $Script:ThePlayerBattleStatWindow.Draw()
                        } Else {
                            $Script:TheEnemyBattleStatWindow.SetAllFlagsDirty()
                            $Script:TheEnemyBattleStatWindow.Draw()
                        }
                    }
                }

                # CHANGE STATE TO TURN INCREMENT
                $this.State = [BattleManagerState]::TurnIncrement

                Break
            }

            ([BattleManagerState]::Calculation) {
                # GIVEN HOW THIS STATE IS ENTERED, THIS MAY BE A REDUNDANT CHECK, BUT I DON'T CARE
                If($this.PhaseOneEntity.Stats[[StatId]::HitPoints].Base -LE 0) {
                    If($this.PhaseOneEntity -IS [Player]) {
                        $this.State = [BattleManagerState]::BattleLost

                        Break
                    } Else {
                        # $this.SpoilsAction = $this.PhaseTwoEntity.SpoilsEffect
                        $this.State = [BattleManagerState]::BattleWon

                        Break
                    }
                } Elseif($this.PhaseTwoEntity.Stats[[StatId]::HitPoints].Base -LE 0) {
                    If($this.PhaseTwoEntity -IS [Player]) {
                        $this.State = [BattleManagerState]::BattleLost

                        Break
                    } Else {
                        # $this.SpoilsAction = $this.PhaseOneEntity.SpoilsEffect
                        $this.State = [BattleManagerState]::BattleWon

                        Break
                    }
                }

                # DO NOTHING, TRANSITION BACK TO TURN INCREMENT STATE
                $this.State = [BattleManagerState]::BattleWon

                Break
            }

            ([BattleManagerState]::BattleWon) {
                $Script:TheBgmMPlayer.Stop() # STOP PLAYING THE BATTLE BGM
                
                # CHECK TO SEE IF THE BATTLE WON CHIME HAS PLAYED
                # PLAY IT IF IT HASN'T
                If($Script:HasBattleWonChimePlayed -EQ $false) {
                    Try {
                        $Script:TheSfxMPlayer.Open($Script:SfxBattlePlayerWin)
                        $Script:TheSfxMPlayer.Play()
                    } Catch {}
                    $Script:HasBattleWonChimePlayed = $true
                }

                # THE FOLLOWING CODE WILL WRITE TWO OUT-OF-BAND MESSAGES TO THE STATUS WINDOW
                # OUT-OF-BAND MEANING THAT EXPLICIT CALLS TO THE DRAW FUNCTION ARE MADE BECAUSE
                # THE NORMAL SEQUENCING WOULD CAUSE THESE TO NOT BE DRAWN IN TIME
                
                # WRITE THE WON MESSAGE TO THE STATUS WINDOW
                $Script:TheBattleStatusMessageWindow.WriteBattleWonMessage()
                $Script:TheBattleStatusMessageWindow.Draw()

                # RUN THE SPOILS EFFECT; NEED TO DETERMINE WHICH ENTITY IS THE PLAYER
                If($this.PhaseOneEntity -IS [Player]) {
                    # THE ORIGINAL CODE RESET THE SPOILSACTION MEMBER; NOT SURE WHY
                    # THE LIKELY CAUSE IS I'M AN IDIOT
                    Invoke-Command $this.PhaseTwoEntity.SpoilsEffect -ArgumentList ([Player]$this.PhaseOneEntity), ([EnemyBattleEntity]$this.PhaseTwoEntity)
                } Elseif($this.PhaseTwoEntity -IS [Player]) {
                    Invoke-Command $this.PhaseOneEntity.SpoilsEffect -ArgumentList ([Player]$this.PhaseTwoEntity), ([EnemyBattleEntity]$this.PhaseOneEntity)
                }

                # WRITE THE BATTLE END PROMPT
                $Script:TheBattleStatusMessageWindow.WriteBattleEndPrompt()
                $Script:TheBattleStatusMessageWindow.Draw()

                # BLOCK FOR THE ENTER KEY (ACKSHUALEE ENTER KEY)
                $a = $Script:Rui.ReadKey('IncludeKeyDown, NoEcho')
                While($a.VirtualKeyCode -NE 13) {
                    $a = $Script:Rui.ReadKey('IncludeKeyDown, NoEcho')
                }

                # CHANGE GLOBAL STATE
                $Script:ThePreviousGlobalGameState = $Script:TheGlobalGameState
                $Script:TheGlobalGameState         = [GameStatePrimary]::GamePlayScreen

                Break
            }

            ([BattleManagerState]::BattleLost) {
				$Script:TheBgmMPlayer.Stop() # STOP PLAYING THE BATTLE BGM
				
				# CHECK TO SEE IF THE BATTLE LOST CHIME HAS PLAYED
				# PLAY IT IF IT HASN'T
				If($Script:HasBattleLostChimePlayed -EQ $false) {
					Try {
						$Script:TheSfxMPlayer.Open($Script:SfxBattlePlayerLose)
						$Script:TheSfxMPlayer.Play()
					} Catch {}
					$Script:HasBattleLostChimPlayed = $true
				}
				
				# WRITE THE LOST MESSAGE TO THE STATUS WINDOW
				$Script:TheBattleStatusMessageWindow.WriteBattleLostMessage()
				$Script:TheBattleStatusMessageWindow.Draw()
				$Script:TheBattleStatusMessageWindow.WriteGameOverMessage()
				$Script:TheBattleStatusMessageWindow.Draw()
				
				# SLEEP THEN DIE
				Start-Sleep -Seconds 5
				Clear-Host
				
				Exit
			}

            Default {}
        }
    }

    [Void]Cleanup() {
        $Script:BattleCursorVisible          = $false
        $Script:HasBattleIntroPlayed         = $false
        $Script:IsBattleBgmPlaying           = $false
        $Script:HasBattleWonChimePlayed      = $false
        $Script:HasBattleLostChimePlayed     = $false
    }
}





###############################################################################
#
# GAME CORE
#
# ENTRY POINT FOR THE GAME PROGRAM
#
###############################################################################
Class GameCore {
    [Boolean]$GameRunning

    GameCore() {
        $this.GameRunning          = $true
        $Script:TheGlobalGameState = [GameStatePrimary]::GamePlayScreen
    }

    [Void]Run() {
        While($this.GameRunning -EQ $true) {
            $this.Logic()
        }
    }

    [Void]Logic() {
        Invoke-Command $Script:TheGlobalStateBlockTable[$Script:TheGlobalGameState]
        $Script:Rui.FlushInputBuffer()
    }
}





###############################################################################
#
# DUMMY SETUP CODE
#
###############################################################################
Clear-Host

$Script:ThePlayer.Inventory.Add([MTOLadder]::new()) | Out-Null
$Script:ThePlayer.Inventory.Add([MTORope]::new()) | Out-Null
$Script:ThePlayer.Inventory.Add([MTOStairs]::new()) | Out-Null
$Script:ThePlayer.Inventory.Add([MTOPole]::new()) | Out-Null
$Script:ThePlayer.Inventory.Add([MTOBacon]::new()) | Out-Null
$Script:ThePlayer.Inventory.Add([MTOApple]::new()) | Out-Null
$Script:ThePlayer.Inventory.Add([MTOStick]::new()) | Out-Null
$Script:ThePlayer.Inventory.Add([MTOYogurt]::new()) | Out-Null
$Script:ThePlayer.Inventory.Add([MTORock]::new()) | Out-Null
$Script:ThePlayer.Inventory.Add([MTORope]::new()) | Out-Null
$Script:ThePlayer.Inventory.Add([MTOPole]::new()) | Out-Null
# $Script:ThePlayer.Inventory.Add([MTOBacon]::new()) | Out-Null
$Script:ThePlayer.Inventory.Add([MTOApple]::new()) | Out-Null
$Script:ThePlayer.Inventory.Add([MTOStick]::new()) | Out-Null
$Script:ThePlayer.Inventory.Add([MTOYogurt]::new()) | Out-Null
$Script:ThePlayer.Inventory.Add([MTORock]::new()) | Out-Null
$Script:ThePlayer.Inventory.Add([MTORope]::new()) | Out-Null
$Script:ThePlayer.Inventory.Add([MTOLadder]::new()) | Out-Null
$Script:ThePlayer.Inventory.Add([MTORope]::new()) | Out-Null
$Script:ThePlayer.Inventory.Add([MTOStairs]::new()) | Out-Null
$Script:ThePlayer.Inventory.Add([MTOPole]::new()) | Out-Null
# $Script:ThePlayer.Inventory.Add([MTOBacon]::new()) | Out-Null
$Script:ThePlayer.Inventory.Add([MTOApple]::new()) | Out-Null
$Script:ThePlayer.Inventory.Add([MTOStick]::new()) | Out-Null
$Script:ThePlayer.Inventory.Add([MTOYogurt]::new()) | Out-Null
$Script:ThePlayer.Inventory.Add([MTORock]::new()) | Out-Null
$Script:ThePlayer.Inventory.Add([MTORope]::new()) | Out-Null
$Script:ThePlayer.Inventory.Add([MTOPole]::new()) | Out-Null
# $Script:ThePlayer.Inventory.Add([MTOBacon]::new()) | Out-Null
$Script:ThePlayer.Inventory.Add([MTOApple]::new()) | Out-Null
$Script:ThePlayer.Inventory.Add([MTOStick]::new()) | Out-Null
$Script:ThePlayer.Inventory.Add([MTOYogurt]::new()) | Out-Null
$Script:ThePlayer.Inventory.Add([MTORock]::new()) | Out-Null
$Script:ThePlayer.Inventory.Add([MTORope]::new()) | Out-Null
$Script:ThePlayer.Inventory.Add([MTOTree]::new()) | Out-Null
$Script:ThePlayer.Inventory.Add([MTOMilk]::new()) | Out-Null
$Script:ThePlayer.Inventory.Add([MTOMilk]::new()) | Out-Null
$Script:ThePlayer.Inventory.Add([MTOMilk]::new()) | Out-Null

$Script:ThePlayer.ActionInventory.Add([BASwordStab]::new()) | Out-Null
$Script:ThePlayer.ActionInventory.Add([BAPunch]::new()) | Out-Null
$Script:ThePlayer.ActionInventory.Add([BAKick]::new()) | Out-Null
$Script:ThePlayer.ActionInventory.Add([BAKarateChop]::new()) | Out-Null
$Script:ThePlayer.ActionInventory.Add([BAKarateKick]::new()) | Out-Null
$Script:ThePlayer.ActionInventory.Add([BAFlamePunch]::new()) | Out-Null
$Script:ThePlayer.ActionInventory.Add([BAFlameKick]::new()) | Out-Null
$Script:ThePlayer.ActionInventory.Add([BASwordStab]::new()) | Out-Null
$Script:ThePlayer.ActionInventory.Add([BAPunch]::new()) | Out-Null
$Script:ThePlayer.ActionInventory.Add([BAKick]::new()) | Out-Null
$Script:ThePlayer.ActionInventory.Add([BAKarateChop]::new()) | Out-Null
$Script:ThePlayer.ActionInventory.Add([BAKarateKick]::new()) | Out-Null
$Script:ThePlayer.ActionInventory.Add([BAFlamePunch]::new()) | Out-Null
$Script:ThePlayer.ActionInventory.Add([BAFlameKick]::new()) | Out-Null
$Script:ThePlayer.ActionInventory.Add([BASeafoamBolt]::new()) | Out-Null
$Script:ThePlayer.ActionInventory.Add([BATyphoon]::new()) | Out-Null
$Script:ThePlayer.ActionInventory.Add([BATerraStrike]::new()) | Out-Null
$Script:ThePlayer.ActionInventory.Add([BABoulderBash]::new()) | Out-Null
$Script:ThePlayer.ActionInventory.Add([BAIcicleStrike]::new()) | Out-Null
$Script:ThePlayer.ActionInventory.Add([BAGaleStrike]::new()) | Out-Null
$Script:ThePlayer.ActionInventory.Add([BARadiance]::new()) | Out-Null
$Script:ThePlayer.ActionInventory.Add([BASunfire]::new()) | Out-Null

# $Script:SampleMap.CreateMapTiles()
# $Script:SampleMap.Tiles[0, 0] = [MapTile]::new(
#     $Script:FieldNorthEastRoadImage,
#     @(
#         [MTOApple]::new(),
#         [MTOTree]::new(),
#         [MTOLadder]::new(),
#         [MTORope]::new(),
#         [MTOStairs]::new(),
#         [MTOPole]::new()
#     ),
#     @(
#         $true,
#         $false,
#         $true,
#         $false
#     ),
#     $true,
#     0.5,
#     0
# )
# $Script:SampleMap.Tiles[0, 1] = [MapTile]::new(
#     $Script:FieldNorthWestRoadImage,
#     @(
#         [MTOApple]::new()
#     ),
#     @(
#         $true,
#         $false,
#         $false,
#         $true
#     ),
#     $true,
#     0.5,
#     0
# )
# $Script:SampleMap.Tiles[1, 0] = [MapTile]::new(
#     $Script:FieldSouthEastRoadImage,
#     @(
#         [MTOTree]::new()
#     ),
#     @(
#         $false,
#         $true,
#         $true,
#         $false
#     ),
#     $true,
#     0.5,
#     0
# )
# $Script:SampleMap.Tiles[1, 1] = [MapTile]::new(
#     $Script:FieldSouthWestRoadImage,
#     @(
#         [MTOTree]::new()
#     ),
#     @(
#         $false,
#         $true,
#         $false,
#         $true
#     ),
#     $true,
#     0.5,
#     0
# )

$Script:TheGameCore.Run()
